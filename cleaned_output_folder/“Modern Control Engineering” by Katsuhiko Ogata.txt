Modern Control Engineering Fifth Edition Katsuhiko Ogata Prentice Hall Boston Columbus Indianapolis New York San Francisco Upper Saddle River Amsterdam Cape Town Dubai London Madrid Milan Munich Paris Montreal Toronto Delhi Mexico City Sao Paulo Sydney Hong Kong Seoul Singapore Taipei Tokyo VP/Editorial Director, Engineering/Computer Science: Marcia J. Horton Assistant/Supervisor: Dolores Mars Senior Editor: Andrew Gilfillan Associate Editor: Alice Dworkin Editorial Assistant: William Opaluch Director of Marketing: Margaret Waples Senior Marketing Manager: Tim Galligan Marketing Assistant: Mack Patterson Senior Managing Editor: Scott Disanno Art Editor: Greg Dulles Senior Operations Supervisor: Alan Fischer Operations Specialist: Lisa McDowell Art Director: Kenny Beck Cover Designer: Carole Anson Media Editor: Daniel Sandin Credits and acknowledgments borrowed from other sources and reproduced, with permission, in this textbook appear on appropriate page within text. MATLAB is a registered trademark of The Mathworks, Inc., 3 Apple Hill Drive, Natick MA 01760-2098. Copyright © 2010, 2002, 1997, 1990, 1970 Pearson Education, Inc., publishing as Prentice Hall, One Lake Street, Upper Saddle River, New Jersey 07458. All rights reserved. Manufactured in the United States of America. This publication is protected by Copyright, and permission should be obtained from the publisher prior to any prohibited reproduction, storage in a retrieval system, or transmission in any form or by any means, electronic, mechanical, photocopying, recording, or likewise. To obtain permission(s) to use material from this work, please submit a written request to Pearson Education, Inc., Permissions Department, One Lake Street, Upper Saddle River, New Jersey 07458. Many of the designations by manufacturers and seller to distinguish their products are claimed as trademarks. Where those designations appear in this book, and the publisher was aware of a trademark claim, the designations have been printed in initial caps or all caps. Library of Congress Cataloging-in-Publication Data on File 10 9 8 7 6 5 4 3 2 1 ISBN 10: 0-13-615673-8 ISBN 13: 978-0-13-615673-4 Openmirrors.comC iiiContents Preface ix Chapter 1 Introduction to Control Systems 1 1–1 Introduction 1 1–2 Examples of Control Systems 41–3 Closed-Loop Control Versus Open-Loop Control 71–4 Design and Compensation of Control Systems 91–5 Outline of the Book 10 Chapter 2 Mathematical Modeling of Control Systems 13 2–1 Introduction 13 2–2 Transfer Function and Impulse-Response Function 152–3 Automatic Control Systems 172–4 Modeling in State Space 292–5 State-Space Representation of Scalar Differential Equation Systems 35 2–6 Transformation of Mathematical Models with MATLAB 392–7 Linearization of Nonlinear Mathematical Models 43 Example Problems and Solutions 46 Problems 60 Chapter 3 Mathematical Modeling of Mechanical Systems and Electrical Systems 63 3–1 Introduction 63 3–2 Mathematical Modeling of Mechanical Systems 633–3 Mathematical Modeling of Electrical Systems 72 Example Problems and Solutions 86Problems 97 Chapter 4 Mathematical Modeling of Fluid Systems and Thermal Systems 100 4–1 Introduction 100 4–2 Liquid-Level Systems 1014–3 Pneumatic Systems 1064–4 Hydraulic Systems 1234–5 Thermal Systems 136 Example Problems and Solutions 140 Problems 152 Chapter 5 Transient and Steady-State Response Analyses 159 5–1 Introduction 159 5–2 First-Order Systems 1615–3 Second-Order Systems 1645–4 Higher-Order Systems 1795–5 Transient-Response Analysis with MATLAB 1835–6 Routh’s Stability Criterion 2125–7 Effects of Integral and Derivative Control Actions on System Performance 218 5–8 Steady-State Errors in Unity-Feedback Control Systems 225 Example Problems and Solutions 231 Problems 263 iv ContentsChapter 6 Control Systems Analysis and Design by the Root-Locus Method 269 6–1 Introduction 269 6–2 Root-Locus Plots 270 6–3 Plotting Root Loci with MATLAB 2906–4 Root-Locus Plots of Positive Feedback Systems 3036–5 Root-Locus Approach to Control-Systems Design 3086–6 Lead Compensation 3116–7 Lag Compensation 3216–8 Lag–Lead Compensation 3306–9 Parallel Compensation 342 Example Problems and Solutions 347 Problems 394 Chapter 7 Control Systems Analysis and Design by the Frequency-Response Method 398 7–1 Introduction 398 7–2 Bode Diagrams 4037–3 Polar Plots 4277–4 Log-Magnitude-versus-Phase Plots 4437–5 Nyquist Stability Criterion 4457–6 Stability Analysis 4547–7 Relative Stability Analysis 4627–8 Closed-Loop Frequency Response of Unity-Feedback Systems 477 7–9 Experimental Determination of Transfer Functions 4867–10 Control Systems Design by Frequency-Response Approach 4917–11 Lead Compensation 4937–12 Lag Compensation 5027–13 Lag–Lead Compensation 511 Example Problems and Solutions 521 Problems 561 Chapter 8 PID Controllers and Modified PID Controllers 567 8–1 Introduction 567 8–2 Ziegler–Nichols Rules for Tuning PID Controllers 568 Contents v8–3 Design of PID Controllers with Frequency-Response Approach 577 8–4 Design of PID Controllers with Computational Optimization Approach 583 8–5 Modifications of PID Control Schemes 5908–6 Two-Degrees-of-Freedom Control 5928–7 Zero-Placement Approach to Improve Response Characteristics 595 Example Problems and Solutions 614 Problems 641 Chapter 9 Control Systems Analysis in State Space 648 9–1 Introduction 648 9–2 State-Space Representations of Transfer-Function Systems 649 9–3 Transformation of System Models with MATLAB 6569–4 Solving the Time-Invariant State Equation 6609–5 Some Useful Results in Vector-Matrix Analysis 6689–6 Controllability 6759–7 Observability 682 Example Problems and Solutions 688 Problems 720 Chapter 10 Control Systems Design in State Space 722 10–1 Introduction 722 10–2 Pole Placement 72310–3 Solving Pole-Placement Problems with MATLAB 73510–4 Design of Servo Systems 73910–5 State Observers 75110–6 Design of Regulator Systems with Observers 77810–7 Design of Control Systems with Observers 78610–8 Quadratic Optimal Regulator Systems 79310–9 Robust Control Systems 806 Example Problems and Solutions 817Problems 855 vi ContentsAppendix A Laplace Transform Tables 859 Appendix B Partial-Fraction Expansion 867Appendix C Vector-Matrix Algebra 874References 882Index 886 Contents viiThis page intentionally left blankP ixPreface This book introduces important concepts in the analysis and design of control systems. Readers will find it to be a clear and understandable textbook for control system coursesat colleges and universities. It is written for senior electrical, mechanical, aerospace, orchemical engineering students. The reader is expected to have fulfilled the followingprerequisites: introductory courses on differential equations, Laplace transforms, vector-matrix analysis, circuit analysis, mechanics, and introductory thermodynamics. The main revisions made in this edition are as follows: The use of MATLAB for obtaining responses of control systems to various inputs has been increased. The usefulness of the computational optimization approach with MATLAB has been demonstrated. New example problems have been added throughout the book.• Materials in the previous edition that are of secondary importance have been deleted in order to provide space for more important subjects. Signal flow graphs weredropped from the book. A chapter on Laplace transform was deleted. Instead,Laplace transform tables, and partial-fraction expansion with MATLAB are pre-sented in Appendix A and Appendix B, respectively. A short summary of vector-matrix analysis is presented in Appendix C; this will help the reader to find the inverses of n x n matrices that may be involved in the analy-sis and design of control systems. This edition of Modern Control Engineering is organized into ten chapters.The outline of this book is as follows: Chapter 1 presents an introduction to control systems. Chapter 2deals with mathematical modeling of control systems. A linearization technique for non- linear mathematical models is presented in this chapter. Chapter 3 derives mathematicalmodels of mechanical systems and electrical systems. Chapter 4 discusses mathematicalmodeling of fluid systems (such as liquid-level systems, pneumatic systems, and hydraulicsystems) and thermal systems. Chapter 5 treats transient response and steady-state analyses of control systems. MATLAB is used extensively for obtaining transient response curves. Routh’s stabilitycriterion is presented for stability analysis of control systems. Hurwitz stability criterionis also presented. Chapter 6 discusses the root-locus analysis and design of control systems, including positive feedback systems and conditionally stable systems Plotting root loci with MAT-LAB is discussed in detail. Design of lead, lag, and lag-lead compensators with the root-locus method is included. Chapter 7 treats the frequency-response analysis and design of control systems.The Nyquist stability criterion is presented in an easily understandable manner.The Bode di-agram approach to the design of lead, lag, and lag-lead compensators is discussed. Chapter 8 deals with basic and modified PID controllers. Computational approaches for obtaining optimal parameter values for PID controllers are discussed in detail, par-ticularly with respect to satisfying requirements for step-response characteristics. Chapter 9 treats basic analyses of control systems in state space. Concepts of con- trollability and observability are discussed in detail. Chapter 10 deals with control systems design in state space.The discussions include pole placement, state observers, and quadratic optimal control. An introductory dis-cussion of robust control systems is presented at the end of Chapter 10. The book has been arranged toward facilitating the student’s gradual understanding of control theory. Highly mathematical arguments are carefully avoided in the presen-tation of the materials. Statement proofs are provided whenever they contribute to theunderstanding of the subject matter presented. Special effort has been made to provide example problems at strategic points so that the reader will have a clear understanding of the subject matter discussed. In addition,a number of solved problems (A-problems) are provided at the end of each chapter,except Chapter 1. The reader is encouraged to study all such solved problems carefully;this will allow the reader to obtain a deeper understanding of the topics discussed. Inaddition, many problems (without solutions) are provided at the end of each chapter,except Chapter 1. The unsolved problems (B-problems) may be used as homework orquiz problems. If this book is used as a text for a semester course (with 56 or so lecture hours), a good portion of the material may be covered by skipping certain subjects. Because of theabundance of example problems and solved problems (A-problems) that might answermany possible questions that the reader might have, this book can also serve as a self-study book for practicing engineers who wish to study basic control theories. I would like to thank the following reviewers for this edition of the book: Mark Camp- bell, Cornell University; Henry Sodano, Arizona State University; and Atul G. Kelkar,Iowa State University. Finally, I wish to offer my deep appreciation to Ms.Alice Dworkin,Associate Editor, Mr. Scott Disanno, Senior Managing Editor, and all the people in-volved in this publishing project, for the speedy yet superb production of this book. Katsuhiko Ogata x Preface1Introduction to Control Systems 1–1 INTRODUCTION Control theories commonly used today are classical control theory (also called con- ventional control theory), modern control theory, and robust control theory. This bookpresents comprehensive treatments of the analysis and design of control systems basedon the classical control theory and modern control theory.A brief introduction of robustcontrol theory is included in Chapter 10. Automatic control is essential in any field of engineering and science. Automatic control is an important and integral part of space-vehicle systems, robotic systems, mod-ern manufacturing systems, and any industrial operations involving control of temper-ature, pressure, humidity, flow, etc. It is desirable that most engineers and scientists arefamiliar with theory and practice of automatic control. This book is intended to be a text book on control systems at the senior level at a col- lege or university. All necessary background materials are included in the book. Math-ematical background materials related to Laplace transforms and vector-matrix analysisare presented separately in appendixes. Brief Review of Historical Developments of Control Theories and Practices. The first significant work in automatic control was James Watt’s centrifugal gover-nor for the speed control of a steam engine in the eighteenth century. Othersignificant works in the early stages of development of control theory were due to12 Chapter 1 / Introduction to Control SystemsMinorsky, Hazen, and Nyquist, among many others. In 1922, Minorsky worked on automatic controllers for steering ships and showed how stability could be deter-mined from the differential equations describing the system. In 1932, Nyquistdeveloped a relatively simple procedure for determining the stability of closed-loopsystems on the basis of open-loop response to steady-state sinusoidal inputs. In 1934,Hazen, who introduced the term servomechanisms for position control systems, discussed the design of relay servomechanisms capable of closely following a chang-ing input. During the decade of the 1940s, frequency-response methods (especially the Bode diagram methods due to Bode) made it possible for engineers to design linear closed-loop control systems that satisfied performance requirements. Many industrial controlsystems in 1940s and 1950s used PID controllers to control pressure, temperature, etc.In the early 1940s Ziegler and Nichols suggested rules for tuning PID controllers, calledZiegler–Nichols tuning rules. From the end of the 1940s to the 1950s, the root-locusmethod due to Evans was fully developed. The frequency-response and root-locus methods, which are the core of classical con- trol theory, lead to systems that are stable and satisfy a set of more or less arbitrary per-formance requirements. Such systems are, in general, acceptable but not optimal in anymeaningful sense. Since the late 1950s, the emphasis in control design problems has beenshifted from the design of one of many systems that work to the design of one optimalsystem in some meaningful sense. As modern plants with many inputs and outputs become more and more complex, the description of a modern control system requires a large number of equations. Clas-sical control theory, which deals only with single-input, single-output systems, becomespowerless for multiple-input, multiple-output systems. Since about 1960, because theavailability of digital computers made possible time-domain analysis of complex sys-tems, modern control theory, based on time-domain analysis and synthesis using statevariables, has been developed to cope with the increased complexity of modern plantsand the stringent requirements on accuracy, weight, and cost in military, space, and in-dustrial applications. During the years from 1960 to 1980, optimal control of both deterministic and sto- chastic systems, as well as adaptive and learning control of complex systems, were fullyinvestigated. From 1980s to 1990s, developments in modern control theory were cen-tered around robust control and associated topics. Modern control theory is based on time-domain analysis of differential equation systems. Modern control theory made the design of control systems simpler becausethe theory is based on a model of an actual control system. However, the system’sstability is sensitive to the error between the actual system and its model. Thismeans that when the designed controller based on a model is applied to the actualsystem, the system may not be stable. To avoid this situation, we design the controlsystem by first setting up the range of possible errors and then designing the con-troller in such a way that, if the error of the system stays within the assumedrange, the designed control system will stay stable. The design method based on thisprinciple is called robust control theory.This theory incorporates both the frequency-response approach and the time-domain approach.The theory is mathematically verycomplex.Section 1–1 / Introduction 3Because this theory requires mathematical background at the graduate level, inclu- sion of robust control theory in this book is limited to introductory aspects only. Thereader interested in details of robust control theory should take a graduate-level controlcourse at an established college or university. Definitions. Before we can discuss control systems, some basic terminologies must be defined. Controlled Variable and Control Signal or Manipulated Variable. The controlled variable is the quantity or condition that is measured and controlled.The control signal ormanipulated variable is the quantity or condition that is varied by the controller so as to affect the value of the controlled variable. Normally, the controlled variable is theoutput of the system. Control means measuring the value of the controlled variable of the system and applying the control signal to the system to correct or limit deviation ofthe measured value from a desired value. In studying control engineering, we need to define additional terms that are neces- sary to describe control systems. Plants. A plant may be a piece of equipment, perhaps just a set of machine parts functioning together, the purpose of which is to perform a particular operation. In thisbook, we shall call any physical object to be controlled (such as a mechanical device, aheating furnace, a chemical reactor, or a spacecraft) a plant. Processes. The Merriam–Webster Dictionary defines a process to be a natural, pro- gressively continuing operation or development marked by a series of gradual changesthat succeed one another in a relatively fixed way and lead toward a particular result orend; or an artificial or voluntary, progressively continuing operation that consists of a se-ries of controlled actions or movements systematically directed toward a particular re-sult or end. In this book we shall call any operation to be controlled a process. Examples are chemical, economic, and biological processes. Systems. A system is a combination of components that act together and perform a certain objective. A system need not be physical. The concept of the system can beapplied to abstract, dynamic phenomena such as those encountered in economics. Theword system should, therefore, be interpreted to imply physical, biological, economic, andthe like, systems. Disturbances. A disturbance is a signal that tends to adversely affect the value of the output of a system. If a disturbance is generated within the system, it is calledinternal, while an external disturbance is generated outside the system and is an input. Feedback Control. Feedback control refers to an operation that, in the presence of disturbances, tends to reduce the difference between the output of a system and somereference input and does so on the basis of this difference. Here only unpredictable dis-turbances are so specified, since predictable or known disturbances can always be com-pensated for within the system.4 Chapter 1 / Introduction to Control Systems 1–2 EXAMPLES OF CONTROL SYSTEMS In this section we shall present a few examples of control systems. Speed Control System. The basic principle of a Watt’s speed governor for an en- gine is illustrated in the schematic diagram of Figure 1–1. The amount of fuel admitted to the engine is adjusted according to the difference between the desired and the actual engine speeds. The sequence of actions may be stated as follows: The speed governor is ad- justed such that, at the desired speed, no pressured oil will flow into either side of the power cylinder. If the actual speed drops below the desired value due to disturbance, then the decrease in the centrifugal force of the speed governor causes the control valve to move downward, supplying more fuel, and the speed of the engine increases until the desired value is reached. On the other hand, if the speed of the engine increases above the desired value, then the increase in the centrifu- gal force of the governor causes the control valve to move upward. This decreases the supply of fuel, and the speed of the engine decreases until the desired value is reached. In this speed control system, the plant (controlled system) is the engine and the controlled variable is the speed of the engine. The difference between the desired speed and the actual speed is the error signal.The control signal (the amount of fuel) to be applied to the plant (engine) is the actuating signal. The external input to dis- turb the controlled variable is the disturbance. An unexpected change in the load is a disturbance. Temperature Control System. Figure 1–2 shows a schematic diagram of tem- perature control of an electric furnace.The temperature in the electric furnace is meas- ured by a thermometer, which is an analog device.The analog temperature is converted Oil under pressurePower cylinder Close OpenPilot valve Control valveFuelEngine Load Figure 1–1 Speed control system. Openmirrors.comSection 1–2 / Examples of Control Systems 5Thermometer HeaterInterface Controller Interface AmplifierA/D converter Programmed inputElectric furnace RelayFigure 1–2 Temperature controlsystem. to a digital temperature by an A/D converter. The digital temperature is fed to a con- troller through an interface.This digital temperature is compared with the programmedinput temperature, and if there is any discrepancy (error), the controller sends out a sig-nal to the heater, through an interface, amplifier, and relay, to bring the furnace tem-perature to a desired value. Business Systems. A business system may consist of many groups. Each task assigned to a group will represent a dynamic element of the system. Feedback methodsof reporting the accomplishments of each group must be established in such a system forproper operation. The cross-coupling between functional groups must be made a mini-mum in order to reduce undesirable delay times in the system. The smaller this cross-coupling, the smoother the flow of work signals and materials will be. A business system is a closed-loop system.A good design will reduce the manageri- al control required. Note that disturbances in this system are the lack of personnel or ma-terials, interruption of communication, human errors, and the like. The establishment of a well-founded estimating system based on statistics is manda- tory to proper management. It is a well-known fact that the performance of such a systemcan be improved by the use of lead time, or anticipation. To apply control theory to improve the performance of such a system, we must rep- resent the dynamic characteristic of the component groups of the system by a relative-ly simple set of equations. Although it is certainly a difficult problem to derive mathematical representations of the component groups, the application of optimization techniques to business sys-tems significantly improves the performance of the business system. Consider, as an example, an engineering organizational system that is composed of major groups such as management, research and development, preliminary design, ex-periments, product design and drafting, fabrication and assembling, and tesing. Thesegroups are interconnected to make up the whole operation. Such a system may be analyzed by reducing it to the most elementary set of com- ponents necessary that can provide the analytical detail required and by representing thedynamic characteristics of each component by a set of simple equations. (The dynamicperformance of such a system may be determined from the relation between progres-sive accomplishment and time.)6 Chapter 1 / Introduction to Control Systems Required product ManagementResearch and developmentPreliminary designExperimentsProduct design and draftingFabrication and assemblingTestingProduct Figure 1–3 Block diagram of an engineering organizational system. A functional block diagram may be drawn by using blocks to represent the func- tional activities and interconnecting signal lines to represent the information or product output of the system operation. Figure 1–3 is a possible block diagram for this system. Robust Control System. The first step in the design of a control system is to obtain a mathematical model of the plant or control object. In reality, any model of a plant we want to control will include an error in the modeling process.That is, the actual plant differs from the model to be used in the design of the control system. To ensure the controller designed based on a model will work satisfactorily when this controller is used with the actual plant, one reasonable approach is to assume from the start that there is an uncertainty or error between the actual plant and its mathe matical model and include such uncertainty or error in the design process of the control system. The control system designed based on this approach is called a robust control system. Suppose that the actual plant we want to control is (s)and the mathematical model of the actual plant is G(s) , that is, (s)= actual plant model that has uncertainty ¢(s) G(s)= nominal plant model to be used for designing the control system (s)andG(s) may be related by a multiplicative factor such as or an additive factor or in other forms. Since the exact description of the uncertainty or error ¢(s)is unknown, we use an estimate of ¢(s)and use this estimate, W(s) , in the design of the controller. W(s) is a scalar transfer function such that where is the maximum value of for and is called the H infinity norm of W(s) .0/H11349v/H11349q /H20895W(jv)/H20895 /H20895/H20895W(s) /H20895/H20895 q /H20895/H20895¢(s) /H20895/H20895 q 6/H20895/H20895W(s) /H20895/H20895 q =max 0/H11349v/H11349q /H20895W(jv)/H20895G/H33522(s)=G(s) +¢(s)G/H33522(s)=G(s)[1 + ¢(s)]G/H33522G/H33522G/H33522 Openmirrors.comSection 1–3 / Closed-Loop Control versus Open-Loop Control 7 Using the small gain theorem, the design procedure here boils down to the deter- mination of the controller K(s) such that the inequality is satisfied, where G(s) is the transfer function of the model used in the design process, K(s) is the transfer function of the controller, and W(s) is the chosen transfer function to approximate ¢(s). In most practical cases, we must satisfy more than one such inequality that involves G(s) ,K(s) , and W(s) ’s. For example, to guarantee robust sta- bility and robust performance we may require two inequalities, such as for robust stability for robust performance be satisfied. (These inequalities are derived in Section 10–9.) There are many different such inequalities that need to be satisfied in many different robust control systems. (Robust stability means that the controller K(s) guarantees internal stability of all systems that belong to a group of systems that include the system with the actual plant. Robust performance means the specified performance is satisfied in all systems that be- long to the group.) In this book all the plants of control systems we discuss are assumed to be known precisely, except the plants we discuss in Section 10–9 where an introduc- tory aspect of robust control theory is presented. 1–3 CLOSED-LOOP CONTROL VERSUS OPEN-LOOP CONTROL Feedback Control Systems. A system that maintains a prescribed relationship between the output and the reference input by comparing them and using the difference as a means of control is called a feedback control system. An example would be a room- temperature control system. By measuring the actual room temperature and comparing it with the reference temperature (desired temperature), the thermostat turns the heat- ing or cooling equipment on or off in such a way as to ensure that the room tempera- ture remains at a comfortable level regardless of outside conditions. Feedback control systems are not limited to engineering but can be found in various nonengineering fields as well. The human body, for instance, is a highly advanced feed- back control system. Both body temperature and blood pressure are kept constant by means of physiological feedback. In fact, feedback performs a vital function: It makes the human body relatively insensitive to external disturbances, thus enabling it to func- tion properly in a changing environment. ß W s (s) 1+K(s)G(s) ß q 61 ß W m (s)K(s)G(s) 1+K(s)G(s) ß q 61 ß W(s) 1+K(s)G(s) ß q 61 Openmirrors.com8 Chapter 1 / Introduction to Control Systems Closed-Loop Control Systems. Feedback control systems are often referred to asclosed-loop control systems. In practice, the terms feedback control and closed-loop control are used interchangeably. In a closed-loop control system the actuating error signal, which is the difference between the input signal and the feedback signal (which may be the output signal itself or a function of the output signal and its derivatives and/or integrals), is fed to the controller so as to reduce the error and bring the output of the system to a desired value.The term closed-loop control always implies the use of feedback control action in order to reduce system error. Open-Loop Control Systems. Those systems in which the output has no effect on the control action are called open-loop control systems. In other words, in an open- loop control system the output is neither measured nor fed back for comparison with the input. One practical example is a washing machine. Soaking, washing, and rinsing in the washer operate on a time basis. The machine does not measure the output signal, that is, the cleanliness of the clothes. In any open-loop control system the output is not compared with the reference input. Thus, to each reference input there corresponds a fixed operating condition; as a result, the accuracy of the system depends on calibration. In the presence of disturbances, an open-loop control system will not perform the desired task. Open-loop control can be used, in practice, only if the relationship between the input and output is known and if there are neither internal nor external disturbances. Clearly, such systems are not feed- back control systems. Note that any control system that operates on a time basis is open loop. For instance, traffic control by means of signals operated on a time basis is another example of open-loop control. Closed-Loop versus Open-Loop Control Systems. An advantage of the closed- loop control system is the fact that the use of feedback makes the system response rela- tively insensitive to external disturbances and internal variations in system parameters. It is thus possible to use relatively inaccurate and inexpensive components to obtain the accurate control of a given plant, whereas doing so is impossible in the open-loop case. From the point of view of stability, the open-loop control system is easier to build be- cause system stability is not a major problem. On the other hand, stability is a major problem in the closed-loop control system, which may tend to overcorrect errors and thereby can cause oscillations of constant or changing amplitude. It should be emphasized that for systems in which the inputs are known ahead of time and in which there are no disturbances it is advisable to use open-loop control. Closed-loop control systems have advantages only when unpredictable disturbances and/or unpredictable variations in system components are present. Note that the output power rating partially determines the cost, weight, and size of a control system. The number of components used in a closed-loop control system is more than that for a corresponding open-loop control system. Thus, the closed-loop control system is generally higher in cost and power.To decrease the required power of a system, open- loop control may be used where applicable. A proper combination of open-loop and closed-loop controls is usually less expensive and will give satisfactory overall system performance. Most analyses and designs of control systems presented in this book are concerned with closed-loop control systems. Under certain circumstances (such as where no disturbances exist or the output is hard to measure) open-loop control systems may be Openmirrors.comdesired. Therefore, it is worthwhile to summarize the advantages and disadvantages of using open-loop control systems. The major advantages of open-loop control systems are as follows: 1.Simple construction and ease of maintenance. 2.Less expensive than a corresponding closed-loop system. 3.There is no stability problem. 4.Convenient when output is hard to measure or measuring the output precisely is economically not feasible. (For example, in the washer system, it would be quite ex-pensive to provide a device to measure the quality of the washer’s output, clean-liness of the clothes.) The major disadvantages of open-loop control systems are as follows: 1.Disturbances and changes in calibration cause errors, and the output may be different from what is desired. 2.To maintain the required quality in the output, recalibration is necessary from time to time. 1–4 DESIGN AND COMPENSATION OF CONTROL SYSTEMS This book discusses basic aspects of the design and compensation of control systems. Compensation is the modification of the system dynamics to satisfy the given specifi-cations.The approaches to control system design and compensation used in this bookare the root-locus approach, frequency-response approach, and the state-space ap-proach. Such control systems design and compensation will be presented in Chapters6, 7, 9 and 10. The PID-based compensational approach to control systems design isgiven in Chapter 8. In the actual design of a control system, whether to use an electronic, pneumatic, or hydraulic compensator is a matter that must be decided partially based on the nature ofthe controlled plant. For example, if the controlled plant involves flammable fluid, thenwe have to choose pneumatic components (both a compensator and an actuator) toavoid the possibility of sparks. If, however, no fire hazard exists, then electronic com-pensators are most commonly used. (In fact, we often transform nonelectrical signals intoelectrical signals because of the simplicity of transmission, increased accuracy, increasedreliability, ease of compensation, and the like.) Performance Specifications. Control systems are designed to perform specific tasks. The requirements imposed on the control system are usually spelled out as per-formance specifications. The specifications may be given in terms of transient responserequirements (such as the maximum overshoot and settling time in step response) andof steady-state requirements (such as steady-state error in following ramp input) or maybe given in frequency-response terms. The specifications of a control system must begiven before the design process begins. For routine design problems, the performance specifications (which relate to accura- cy, relative stability, and speed of response) may be given in terms of precise numericalvalues. In other cases they may be given partially in terms of precise numerical values and Section 1–4 / Design and Compensation of Control Systems 9partially in terms of qualitative statements. In the latter case the specifications may have to be modified during the course of design, since the given specifications may never be satisfied (because of conflicting requirements) or may lead to a very expensive system. Generally, the performance specifications should not be more stringent than neces- sary to perform the given task. If the accuracy at steady-state operation is of prime im- portance in a given control system, then we should not require unnecessarily rigid performance specifications on the transient response, since such specifications will require expensive components. Remember that the most important part of control system design is to state the performance specifications precisely so that they will yield an optimal control system for the given purpose. System Compensation. Setting the gain is the first step in adjusting the system for satisfactory performance. In many practical cases, however, the adjustment of the gain alone may not provide sufficient alteration of the system behavior to meet the given specifications. As is frequently the case, increasing the gain value will improve the steady-state behavior but will result in poor stability or even instability. It is then nec- essary to redesign the system (by modifying the structure or by incorporating addi- tional devices or components) to alter the overall behavior so that the system will behave as desired. Such a redesign or addition of a suitable device is called compensa- tion. A device inserted into the system for the purpose of satisfying the specifications is called a compensator. The compensator compensates for deficient performance of the original system. Design Procedures. In the process of designing a control system, we set up a mathematical model of the control system and adjust the parameters of a compensator. The most time-consuming part of the work is the checking of the system performance by analysis with each adjustment of the parameters.The designer should use MATLAB or other available computer package to avoid much of the numerical drudgery neces- sary for this checking. Once a satisfactory mathematical model has been obtained, the designer must con- struct a prototype and test the open-loop system. If absolute stability of the closed loop is assured, the designer closes the loop and tests the performance of the resulting closed- loop system. Because of the neglected loading effects among the components, nonlin- earities, distributed parameters, and so on, which were not taken into consideration in the original design work, the actual performance of the prototype system will probably differ from the theoretical predictions. Thus the first design may not satisfy all the re- quirements on performance. The designer must adjust system parameters and make changes in the prototype until the system meets the specificications. In doing this, he or she must analyze each trial, and the results of the analysis must be incorporated into the next trial. The designer must see that the final system meets the performance apec- ifications and, at the same time, is reliable and economical. 1–5 OUTLINE OF THE BOOK This text is organized into 10 chapters.The outline of each chapter may be summarized as follows: Chapter 1 presents an introduction to this book. 10 Chapter 1 / Introduction to Control Systems Openmirrors.comChapter 2 deals with mathematical modeling of control systems that are described by linear differential equations. Specifically, transfer function expressions of differentialequation systems are derived.Also, state-space expressions of differential equation sys-tems are derived. MATLAB is used to transform mathematical models from transferfunctions to state-space equations and vice versa.This book treats linear systems in de-tail. If the mathematical model of any system is nonlinear, it needs to be linearized be-fore applying theories presented in this book. A technique to linearize nonlinearmathematical models is presented in this chapter. Chapter 3 derives mathematical models of various mechanical and electrical sys- tems that appear frequently in control systems. Chapter 4 discusses various fluid systems and thermal systems, that appear in control systems. Fluid systems here include liquid-level systems, pneumatic systems, and hydraulicsystems. Thermal systems such as temperature control systems are also discussed here.Control engineers must be familiar with all of these systems discussed in this chapter. Chapter 5 presents transient and steady-state response analyses of control systems defined in terms of transfer functions. MATLAB approach to obtain transient andsteady-state response analyses is presented in detail. MATLAB approach to obtainthree-dimensional plots is also presented. Stability analysis based on Routh’s stabilitycriterion is included in this chapter and the Hurwitz stability criterion is briefly discussed. Chapter 6 treats the root-locus method of analysis and design of control systems. It is a graphical method for determining the locations of all closed-loop poles from theknowledge of the locations of the open-loop poles and zeros of a closed-loop systemas a parameter (usually the gain) is varied from zero to infinity. This method was de-veloped by W. R. Evans around 1950. These days MATLAB can produce root-locusplots easily and quickly.This chapter presents both a manual approach and a MATLABapproach to generate root-locus plots. Details of the design of control systems using leadcompensators, lag compensators, are lag–lead compensators are presented in thischapter. Chapter 7 presents the frequency-response method of analysis and design of control systems. This is the oldest method of control systems analysis and design and was de-veloped during 1940–1950 by Nyquist, Bode, Nichols, Hazen, among others. This chap-ter presents details of the frequency-response approach to control systems design usinglead compensation technique, lag compensation technique, and lag–lead compensationtechnique. The frequency-response method was the most frequently used analysis anddesign method until the state-space method became popular. However, since H-infini-ty control for designing robust control systems has become popular, frequency responseis gaining popularity again. Chapter 8 discusses PID controllers and modified ones such as multidegrees-of- freedom PID controllers. The PID controller has three parameters; proportional gain,integral gain, and derivative gain. In industrial control systems more than half of the con-trollers used have been PID controllers. The performance of PID controllers dependson the relative magnitudes of those three parameters. Determination of the relativemagnitudes of the three parameters is called tuning of PID controllers. Ziegler and Nichols proposed so-called “Ziegler–Nichols tuning rules” as early as Since then numerous tuning rules have been proposed.These days manufacturersof PID controllers have their own tuning rules. In this chapter we present a computeroptimization approach using MATLAB to determine the three parameters to satisfy Section 1–5 / Outline of the Book 11given transient response characteristics.The approach can be expanded to determine the three parameters to satisfy any specific given characteristics. Chapter 9 presents basic analysis of state-space equations. Concepts of controllabil- ity and observability, most important concepts in modern control theory, due to Kalman are discussed in full. In this chapter, solutions of state-space equations are derived in detail. Chapter 10 discusses state-space designs of control systems. This chapter first deals with pole placement problems and state observers. In control engineering, it is frequently desirable to set up a meaningful performance index and try to minimize it (or maximize it, as the case may be). If the performance index selected has a clear physical meaning, then this approach is quite useful to determine the optimal control variable. This chap- ter discusses the quadratic optimal regulator problem where we use a performance index which is an integral of a quadratic function of the state variables and the control vari- able.The integral is performed from t=0 tot= .This chapter concludes with a brief discussion of robust control systems.q 12 Chapter 1 / Introduction to Control Systems Openmirrors.com2 13Mathematical Modeling of Control Systems 2–1 INTRODUCTION In studying control systems the reader must be able to model dynamic systems in math- ematical terms and analyze their dynamic characteristics.A mathematical model of a dy-namic system is defined as a set of equations that represents the dynamics of the systemaccurately, or at least fairly well. Note that a mathematical model is not unique to agiven system.A system may be represented in many different ways and, therefore, mayhave many mathematical models, depending on one’s perspective. The dynamics of many systems, whether they are mechanical, electrical, thermal, economic, biological, and so on, may be described in terms of differential equations.Such differential equations may be obtained by using physical laws governing a partic-ular system—for example, Newton’s laws for mechanical systems and Kirchhoff’s lawsfor electrical systems. We must always keep in mind that deriving reasonable mathe-matical models is the most important part of the entire analysis of control systems. Throughout this book we assume that the principle of causality applies to the systems considered.This means that the current output of the system (the output at time t=0 ) depends on the past input (the input for t<0 ) but does not depend on the future input (the input for t>0 ). Mathematical Models. Mathematical models may assume many different forms. Depending on the particular system and the particular circumstances, one mathemati-cal model may be better suited than other models. For example, in optimal control prob-lems, it is advantageous to use state-space representations. On the other hand, for the14 Chapter 2 / Mathematical Modeling of Control Systems transient-response or frequency-response analysis of single-input, single-output, linear, time-invariant systems, the transfer-function representation may be more convenient than any other. Once a mathematical model of a system is obtained, various analytical and computer tools can be used for analysis and synthesis purposes. Simplicity Versus Accuracy. In obtaining a mathematical model, we must make a compromise between the simplicity of the model and the accuracy of the results of the analysis. In deriving a reasonably simplified mathematical model, we frequently find it necessary to ignore certain inherent physical properties of the system. In particular, if a linear lumped-parameter mathematical model (that is, one employing ordinary dif- ferential equations) is desired, it is always necessary to ignore certain nonlinearities and distributed parameters that may be present in the physical system. If the effects that these ignored properties have on the response are small, good agreement will be obtained between the results of the analysis of a mathematical model and the results of the experimental study of the physical system. In general, in solving a new problem, it is desirable to build a simplified model so that we can get a general feeling for the solution.A more complete mathematical model may then be built and used for a more accurate analysis. We must be well aware that a linear lumped-parameter model, which may be valid in low-frequency operations, may not be valid at sufficiently high frequencies, since the neg- lected property of distributed parameters may become an important factor in the dynamic behavior of the system. For example, the mass of a spring may be neglected in low- frequency operations, but it becomes an important property of the system at high fre- quencies. (For the case where a mathematical model involves considerable errors, robust control theory may be applied. Robust control theory is presented in Chapter 10.) Linear Systems. A system is called linear if the principle of superposition applies. The principle of superposition states that the response produced by the simultaneous application of two different forcing functions is the sum of the two individual responses. Hence, for the linear system, the response to several inputs can be calculated by treating one input at a time and adding the results. It is this principle that allows one to build up complicated solutions to the linear differential equation from simple solutions. In an experimental investigation of a dynamic system, if cause and effect are pro- portional, thus implying that the principle of superposition holds, then the system can be considered linear. Linear Time-Invariant Systems and Linear Time-Varying Systems. A differ- ential equation is linear if the coefficients are constants or functions only of the in- dependent variable. Dynamic systems that are composed of linear time-invariant lumped-parameter components may be described by linear time-invariant differen- tial equations—that is, constant-coefficient differential equations. Such systems are called linear time-invariant (orlinear constant-coefficient ) systems. Systems that are represented by differential equations whose coefficients are functions of time are called linear time-varying systems. An example of a time-varying control sys- tem is a spacecraft control system. (The mass of a spacecraft changes due to fuel consumption.) Openmirrors.comSection 2–2 / Transfer Function and Impulse-Response Function 15Outline of the Chapter. Section 2–1 has presented an introduction to the math- ematical modeling of dynamic systems. Section 2–2 presents the transfer function andimpulse-response function. Section 2–3 introduces automatic control systems and Sec-tion 2–4 discusses concepts of modeling in state space. Section 2–5 presents state-spacerepresentation of dynamic systems. Section 2–6 discusses transformation of mathemat-ical models with MATLAB. Finally, Section 2–7 discusses linearization of nonlinearmathematical models. 2–2 TRANSFER FUNCTION AND IMPULSE- RESPONSE FUNCTION In control theory, functions called transfer functions are commonly used to character- ize the input-output relationships of components or systems that can be described by lin-ear, time-invariant, differential equations. We begin by defining the transfer functionand follow with a derivation of the transfer function of a differential equation system.Then we discuss the impulse-response function. Transfer Function. The transfer function of a linear, time-invariant, differential equation system is defined as the ratio of the Laplace transform of the output (responsefunction) to the Laplace transform of the input (driving function) under the assumptionthat all initial conditions are zero. Consider the linear time-invariant system defined by the following differential equation: where yis the output of the system and xis the input. The transfer function of this sys- tem is the ratio of the Laplace transformed output to the Laplace transformed inputwhen all initial conditions are zero, or By using the concept of transfer function, it is possible to represent system dynam- ics by algebraic equations in s. If the highest power of sin the denominator of the trans- fer function is equal to n, the system is called an nth-order system . Comments on Transfer Function. The applicability of the concept of the trans- fer function is limited to linear, time-invariant, differential equation systems.The trans-fer function approach, however, is extensively used in the analysis and design of suchsystems. In what follows, we shall list important comments concerning the transfer func-tion. (Note that a system referred to in the list is one described by a linear, time-invariant,differential equation.)=Y(s) X(s)=b0 sm+b1 sm-1+p+bm-1 s+bm a0 sn+a1 sn-1+p+an-1 s+an Transfer function =G(s) =l[output ] l[input ]2 zero initial conditions=b0 x(m) + b1x(m-1) +p+bm-1 x#+bm x (n/H11350m)a0 y(n) + a1y(n-1) +p+an-1 y#+an y16 Chapter 2 / Mathematical Modeling of Control Systems 1.The transfer function of a system is a mathematical model in that it is an opera- tional method of expressing the differential equation that relates the output vari- able to the input variable. 2.The transfer function is a property of a system itself, independent of the magnitude and nature of the input or driving function. 3.The transfer function includes the units necessary to relate the input to the output; however, it does not provide any information concerning the physical structure of the system. (The transfer functions of many physically different systems can be identical.) 4.If the transfer function of a system is known, the output or response can be stud- ied for various forms of inputs with a view toward understanding the nature of the system. 5.If the transfer function of a system is unknown, it may be established experimen- tally by introducing known inputs and studying the output of the system. Once established, a transfer function gives a full description of the dynamic character- istics of the system, as distinct from its physical description. Convolution Integral. For a linear, time-invariant system the transfer function G(s) is where X(s) is the Laplace transform of the input to the system and Y(s) is the Laplace transform of the output of the system, where we assume that all initial conditions in- volved are zero. It follows that the output Y(s) can be written as the product of G(s) and X(s) ,o r (2–1) Note that multiplication in the complex domain is equivalent to convolution in the time domain (see Appendix A), so the inverse Laplace transform of Equation (2–1) is given by the following convolution integral: where both g(t) andx(t) are 0 for t<0. Impulse-Response Function. Consider the output (response) of a linear time- invariant system to a unit-impulse input when the initial conditions are zero. Since the Laplace transform of the unit-impulse function is unity, the Laplace transform of the output of the system is (2–2) Y(s) =G(s) = 3 t 0 g(t)x(t -t)dt y(t) = 3 t 0 x(t)g(t -t)dtY(s) =G(s)X(s)G(s) =Y(s) X(s) Openmirrors.comSection 2–3 / Automatic Control Systems 17The inverse Laplace transform of the output given by Equation (2–2) gives the impulse response of the system. The inverse Laplace transform of G(s) ,o r is called the impulse-response function. This function g(t) is also called the weighting function of the system. The impulse-response function g(t) is thus the response of a linear time-invariant system to a unit-impulse input when the initial conditions are zero.The Laplace trans-form of this function gives the transfer function. Therefore, the transfer function andimpulse-response function of a linear, time-invariant system contain the same infor-mation about the system dynamics. It is hence possible to obtain complete informa-tion about the dynamic characteristics of the system by exciting it with an impulseinput and measuring the response. (In practice, a pulse input with a very short dura-tion compared with the significant time constants of the system can be considered animpulse.) 2–3 AUTOMATIC CONTROL SYSTEMS A control system may consist of a number of components. To show the functions performed by each component, in control engineering, we commonly use a diagramcalled the block diagram . This section first explains what a block diagram is. Next, it discusses introductory aspects of automatic control systems, including various controlactions.Then, it presents a method for obtaining block diagrams for physical systems, and,finally, discusses techniques to simplify such diagrams. Block Diagrams. Ablock diagram of a system is a pictorial representation of the functions performed by each component and of the flow of signals. Such a diagram de-picts the interrelationships that exist among the various components. Differing from apurely abstract mathematical representation, a block diagram has the advantage ofindicating more realistically the signal flows of the actual system. In a block diagram all system variables are linked to each other through functional blocks.The functional block or simply block is a symbol for the mathematical operation on the input signal to the block that produces the output. The transfer functions of thecomponents are usually entered in the corresponding blocks, which are connected by ar-rows to indicate the direction of the flow of signals. Note that the signal can pass onlyin the direction of the arrows.Thus a block diagram of a control system explicitly showsa unilateral property. Figure 2–1 shows an element of the block diagram. The arrowhead pointing toward the block indicates the input, and the arrowhead leading away from the block repre-sents the output. Such arrows are referred to as signals .l -1CG(s)D=g(t) Transfer function G(s)Figure 2–1 Element of a blockdiagram.18 Chapter 2 / Mathematical Modeling of Control Systems +– R(s) E(s) G(s)C(s)Summing pointBranch point Figure 2–3 Block diagram of a closed-loop system. Note that the dimension of the output signal from the block is the dimension of the input signal multiplied by the dimension of the transfer function in the block. The advantages of the block diagram representation of a system are that it is easy to form the overall block diagram for the entire system by merely connecting the blocks of the components according to the signal flow and that it is possible to evaluate the contribution of each component to the overall performance of the system. In general, the functional operation of the system can be visualized more readily by examining the block diagram than by examining the physical system itself. A block di- agram contains information concerning dynamic behavior, but it does not include any information on the physical construction of the system. Consequently, many dissimilar and unrelated systems can be represented by the same block diagram. It should be noted that in a block diagram the main source of energy is not explicitly shown and that the block diagram of a given system is not unique. A number of different block diagrams can be drawn for a system, depending on the point of view of the analysis. Summing Point. Referring to Figure 2–2, a circle with a cross is the symbol that indicates a summing operation. The plus or minus sign at each arrowhead indicates whether that signal is to be added or subtracted. It is important that the quantities being added or subtracted have the same dimensions and the same units. Branch Point. Abranch point is a point from which the signal from a block goes concurrently to other blocks or summing points. Block Diagram of a Closed-Loop System. Figure 2–3 shows an example of a block diagram of a closed-loop system. The output C(s) is fed back to the summing point, where it is compared with the reference input R(s) . The closed-loop nature of the system is clearly indicated by the figure. The output of the block, C(s) in this case, is obtained by multiplying the transfer function G(s) by the input to the block, E(s) .Any linear control system may be represented by a block diagram consisting of blocks, sum- ming points, and branch points. When the output is fed back to the summing point for comparison with the input, it is necessary to convert the form of the output signal to that of the input signal. For example, in a temperature control system, the output signal is usually the controlled temperature. The output signal, which has the dimension of temperature, must be con- verted to a force or position or voltage before it can be compared with the input signal. This conversion is accomplished by the feedback element whose transfer function is H(s) , as shown in Figure 2–4. The role of the feedback element is to modify the output before it is compared with the input. (In most cases the feedback element is a sensor that measures +–aa – b b Figure 2–2 Summing point. Openmirrors.comthe output of the plant.The output of the sensor is compared with the system input, and the actuating error signal is generated.) In the present example, the feedback signal thatis fed back to the summing point for comparison with the input is B(s) =H(s)C(s) . Open-Loop Transfer Function and Feedforward Transfer Function. Refer- ring to Figure 2–4, the ratio of the feedback signal B(s) to the actuating error signal E(s) is called the open-loop transfer function . That is, The ratio of the output C(s) to the actuating error signal E(s) is called the feed- forward transfer function , so that If the feedback transfer function H(s) is unity, then the open-loop transfer function and the feedforward transfer function are the same. Closed-Loop Transfer Function. For the system shown in Figure 2–4, the output C(s) and input R(s) are related as follows: since eliminating E(s) from these equations gives or (2–3) The transfer function relating C(s) toR(s) is called the closed-loop transfer function .I t relates the closed-loop system dynamics to the dynamics of the feedforward elementsand feedback elements. From Equation (2–3), C(s) is given by C(s) =G(s) 1+G(s)H(s)R(s)C(s) R(s)=G(s) 1+G(s)H(s)C(s) =G(s)CR(s) -H(s)C(s)D =R(s) -H(s)C(s) E(s) =R(s) -B(s) C(s) =G(s)E(s)Feedforward transfer function =C(s) E(s)=G(s)Open-loop transfer function =B(s) E(s)=G(s)H(s) Section 2–3 / Automatic Control Systems 19R(s) B(s)E(s) G(s) H(s)C(s) +– Figure 2–4 Closed-loop system.20 Chapter 2 / Mathematical Modeling of Control Systems G 1 (s) G 1 (s) G 2 (s) G 2 (s)C(s) R(s) C(s) C(s)R(s) R(s) + + G 1 (s) G 2 (s) +–(a) (b) (c) Figure 2–5 (a) Cascaded system; (b) parallel system; (c) feedback (closed- loop) system. Thus the output of the closed-loop system clearly depends on both the closed-loop trans- fer function and the nature of the input. Obtaining Cascaded, Parallel, and Feedback (Closed-Loop) Transfer Functions with MATLAB. In control-systems analysis, we frequently need to calculate the cas- caded transfer functions, parallel-connected transfer functions, and feedback-connected (closed-loop) transfer functions. MATLAB has convenient commands to obtain the cas- caded, parallel, and feedback (closed-loop) transfer functions. Suppose that there are two components G 1 (s)and G 2 (s)connected differently as shown in Figure 2–5 (a), (b), and (c), where To obtain the transfer functions of the cascaded system, parallel system, or feedback (closed-loop) system, the following commands may be used: [num, den] = series(num1,den1,num2,den2) [num, den] = parallel(num1,den1,num2,den2) [num, den] = feedback(num1,den1,num2,den2) As an example, consider the case where MATLAB Program 2–1 gives C(s)/R(s)= num /H20862den for each arrangement of G 1 (s) andG 2 (s).Note that the command printsys(num,den) displays the num /H20862denCthat is, the transfer function C(s)/R(s)Dof the system considered.G 1 (s)=10 s 2 +2s+10=num 1 den1, G 2 (s)=5 s+5=num 2 den2G 1 (s)=num 1 den1, G 2 (s)=num 2 den2 Openmirrors.comSection 2–3 / Automatic Control Systems 21Automatic Controllers. An automatic controller compares the actual value of the plant output with the reference input (desired value), determines the deviation, andproduces a control signal that will reduce the deviation to zero or to a small value.The manner in which the automatic controller produces the control signal is calledthecontrol action . Figure 2–6 is a block diagram of an industrial control system, whichMATLAB Program 2–1 num1 = [10]; den1 = [1 2 10];num2 = [5];den2 = [1 5];[num, den] = series(num1,den1,num2,den2);printsys(num,den) num/den = [num, den] = parallel(num1,den1,num2,den2); printsys(num,den) num/den = [num, den] = feedback(num1,den1,num2,den2); printsys(num,den) num/den = 10s +50 s^3 +7s^2 +20s +1005s^2 +20s +100 s^3 +7s^2 +20s +5050 s^3 +7s^2 +20s +50 Automatic controller Error detector Amplifier Actuator PlantOutput SensorReference input Actuating error signalSet point/H20920 /H20921+–Figure 2–6 Block diagram of anindustrial controlsystem, whichconsists of anautomatic controller, an actuator, a plant, and a sensor(measuring element).22 Chapter 2 / Mathematical Modeling of Control Systems consists of an automatic controller, an actuator , a plant, and a sensor (measuring ele- ment). The controller detects the actuating error signal, which is usually at a very low power level, and amplifies it to a sufficiently high level. The output of an automatic controller is fed to an actuator, such as an electric motor, a hydraulic motor, or a pneumatic motor or valve. (The actuator is a power device that produces the input to the plant according to the control signal so that the output signal will approach the reference input signal.) The sensor or measuring element is a device that converts the output variable into an- other suitable variable, such as a displacement, pressure, voltage, etc., that can be used to compare the output to the reference input signal.This element is in the feedback path of the closed-loop system. The set point of the controller must be converted to a reference input with the same units as the feedback signal from the sensor or measuring element. Classifications of Industrial Controllers. Most industrial controllers may be classified according to their control actions as: 1.Two-position or on–off controllers 2.Proportional controllers 3.Integral controllers 4.Proportional-plus-integral controllers 5.Proportional-plus-derivative controllers 6.Proportional-plus-integral-plus-derivative controllers Most industrial controllers use electricity or pressurized fluid such as oil or air as power sources. Consequently, controllers may also be classified according to the kind of power employed in the operation, such as pneumatic controllers, hydraulic controllers, or electronic controllers. What kind of controller to use must be decided based on the nature of the plant and the operating conditions, including such considerations as safety, cost, availability, reliability, accuracy, weight, and size. Two-Position or On–Off Control Action. In a two-position control system, the actuating element has only two fixed positions, which are, in many cases, simply on and off.Two-position or on–off control is relatively simple and inexpensive and, for this rea- son, is very widely used in both industrial and domestic control systems. Let the output signal from the controller be u(t) and the actuating error signal be e(t). In two-position control, the signal u(t) remains at either a maximum or minimum value, depending on whether the actuating error signal is positive or negative, so that where U 1 and U 2 are constants. The minimum value U 2 is usually either zero or –U 1 . Two-position controllers are generally electrical devices, and an electric solenoid-oper- ated valve is widely used in such controllers. Pneumatic proportional controllers with very high gains act as two-position controllers and are sometimes called pneumatic two- position controllers. Figures 2–7(a) and (b) show the block diagrams for two-position or on–off controllers. The range through which the actuating error signal must move before the switching occurs =U 2 , for e(t) 60 u(t) =U 1 , for e(t) 70 Openmirrors.comSection 2–3 / Automatic Control Systems 23is called the differential gap . A differential gap is indicated in Figure 2–7(b). Such a dif- ferential gap causes the controller output u(t) to maintain its present value until the ac- tuating error signal has moved slightly beyond the zero value. In some cases, the differentialgap is a result of unintentional friction and lost motion; however, quite often it is inten-tionally provided in order to prevent too-frequent operation of the on–off mechanism. Consider the liquid-level control system shown in Figure 2–8(a), where the electromag- netic valve shown in Figure 2–8(b) is used for controlling the inflow rate.This valve is eitheropen or closed.With this two-position control, the water inflow rate is either a positive con-stant or zero. As shown in Figure 2–9, the output signal continuously moves between thetwo limits required to cause the actuating element to move from one fixed position to theother. Notice that the output curve follows one of two exponential curves, one correspon-ding to the filling curve and the other to the emptying curve. Such output oscillation be-tween two limits is a typical response characteristic of a system under two-position control.(a) (b)U1 U2u eU1 U2u eDifferential gap +–+–Figure 2–7 (a) Block diagram ofan on–off controller; (b) block diagram of an on–off controllerwith differential gap. 115 V Float RCh (a) (b)qiMovable iron core Magnetic coil Figure 2–8 (a) Liquid-levelcontrol system; (b) electromagnetic valve. h(t) t 0Differential gap Figure 2–9 Level h(t)-versus- t curve for the systemshown in Figure 2–8(a).24 Chapter 2 / Mathematical Modeling of Control Systems From Figure 2–9, we notice that the amplitude of the output oscillation can be reduced by decreasing the differential gap. The decrease in the differential gap, however, increases the number of on–off switchings per minute and reduces the useful life of the component. The magnitude of the differential gap must be determined from such considerations as the accuracy required and the life of the component. Proportional Control Action. For a controller with proportional control action, the relationship between the output of the controller u(t) and the actuating error signal e(t) is or, in Laplace-transformed quantities, where K p is termed the proportional gain. Whatever the actual mechanism may be and whatever the form of the operating power, the proportional controller is essentially an amplifier with an adjustable gain. Integral Control Action. In a controller with integral control action, the value of the controller output u(t) is changed at a rate proportional to the actuating error signal e(t). That is, or where K i is an adjustable constant. The transfer function of the integral controller is Proportional-Plus-Integral Control Action. The control action of a proportional- plus-integral controller is defined by u(t) =K p e(t) +K p T i 3 t 0 e(t)dtU(s) E(s)=K i su(t) =K i 3 t 0 e(t)dtdu(t) dt=K i e(t)U(s) E(s)=K p u(t) =K p e(t) Openmirrors.comSection 2–3 / Automatic Control Systems 25 or the transfer function of the controller is where is called the integral time . Proportional-Plus-Derivative Control Action. The control action of a proportional- plus-derivative controller is defined by and the transfer function is where is called the derivative time . Proportional-Plus-Integral-Plus-Derivative Control Action. The combination of proportional control action, integral control action, and derivative control action is termed proportional-plus-integral-plus-derivative control action. It has the advantages of each of the three individual control actions. The equation of a controller with this combined action is given by or the transfer function is where K p is the proportional gain, is the integral time, and is the derivative time. The block diagram of a proportional-plus-integral-plus-derivative controller is shown in Figure 2–10.T d T i U(s) E(s)=K p a 1+1 T i s+T d s b u(t) =K p e(t) +K p T i 3 t 0 e(t)dt+K p T d de(t) dtT d U(s) E(s)=K p A1+T d sBu(t) =K p e(t) +K p T d de(t) dtT i U(s) E(s)=K p a 1+1 T i s b +– E(s) U(s)K p (1+T i s+T i T d s 2 ) T i s Figure 2–10 Block diagram of a proportional-plus- integral-plus- derivative controller. Openmirrors.com26 Chapter 2 / Mathematical Modeling of Control Systems R(s) G 1 (s) G 2 (s) H(s)Disturbance D(s) C(s) +– ++ Figure 2–11 Closed-loop system subjected to a disturbance. Closed-Loop System Subjected to a Disturbance. Figure 2–11 shows a closed- loop system subjected to a disturbance. When two inputs (the reference input and dis- turbance) are present in a linear time-invariant system, each input can be treated independently of the other; and the outputs corresponding to each input alone can be added to give the complete output. The way each input is introduced into the system is shown at the summing point by either a plus or minus sign. Consider the system shown in Figure 2–11. In examining the effect of the distur- bance D(s) , we may assume that the reference input is zero; we may then calculate the response C D (s)to the disturbance only. This response can be found from On the other hand, in considering the response to the reference input R(s), we may assume that the disturbance is zero.Then the response C R (s)to the reference input R(s) can be obtained from The response to the simultaneous application of the reference input and disturbance can be obtained by adding the two individual responses. In other words, the response C(s) due to the simultaneous application of the reference input R(s) and disturbance D(s) is given by Consider now the case where |G 1 (s)H(s)| /H112711 and |G 1 (s)G 2 (s)H(s)| /H112711. In this case, the closed-loop transfer function C D (s)/D(s) becomes almost zero, and the effect of the disturbance is suppressed. This is an advantage of the closed-loop system. On the other hand, the closed-loop transfer function C R (s)/R(s) approaches 1/H(s) as the gain of G 1 (s)G 2 (s)H(s) increases.This means that if |G 1 (s)G 2 (s)H(s)| /H112711, then the closed-loop transfer function C R (s)/R(s) becomes independent of G 1 (s)andG 2 (s) and inversely proportional to H(s) , so that the variations of G 1 (s)and G 2 (s)do not affect the closed-loop transfer function C R (s)/R(s) . This is another advantage of the closed-loop system. It can easily be seen that any closed-loop system with unity feedback, H(s)=1, tends to equalize the input and output. =G 2 (s) 1+G 1 (s)G 2 (s)H(s) CG 1 (s)R(s) +D(s)D C(s) =C R (s)+C D (s)C R (s) R(s)=G 1 (s)G 2 (s) 1+G 1 (s)G 2 (s)H(s)C D (s) D(s)=G 2 (s) 1+G 1 (s)G 2 (s)H(s) Openmirrors.comSection 2–3 / Automatic Control Systems 27Procedures for Drawing a Block Diagram. To draw a block diagram for a sys- tem, first write the equations that describe the dynamic behavior of each component.Then take the Laplace transforms of these equations, assuming zero initial conditions,and represent each Laplace-transformed equation individually in block form. Finally, as-semble the elements into a complete block diagram. As an example, consider the RCcircuit shown in Figure 2–12(a). The equations for this circuit are (2–4) (2–5) The Laplace transforms of Equations (2–4) and (2–5), with zero initial condition, become (2–6) (2–7) Equation (2–6) represents a summing operation, and the corresponding diagram is shown in Figure 2–12(b). Equation (2–7) represents the block as shown in Figure 2–12(c).Assembling these two elements, we obtain the overall block diagram for the system asshown in Figure 2–12(d). Block Diagram Reduction. It is important to note that blocks can be connected in series only if the output of one block is not affected by the next following block. Ifthere are any loading effects between the components, it is necessary to combine thesecomponents into a single block. Any number of cascaded blocks representing nonloading components can be replaced by a single block, the transfer function of which is simply the product of theindividual transfer functions. E o(s)=I(s) Cs I(s) =Ei(s)-Eo(s) Reo=1id t Ci=ei-eo R (d)Ei(s) I(s) Eo(s)1 R1 CsEo(s) (b)Ei(s) I(s)1 R (c)I(s) Eo(s)1 Cs(a)R Ce o ei i +–+– Figure 2–12 (a)RCcircuit; (b) block diagram representing Equation (2–6);(c) block diagramrepresentingEquation (2–7); (d) block diagram of theRCcircuit.28 Chapter 2 / Mathematical Modeling of Control Systems R G 1 H 1 H 2 G 3 G 2 C R G 1 H 1 G 3 G 2 C R G 3 C RC RC(a) (b) (c) (d) (e)H 2 G 1 H 2 G 1 G 1 G 2 1–G 1 G 2 H 1 G 1 G 2 G 3 1–G 1 G 2 H 1 +G 2 G 3 H 2 G 1 G 2 G 3 1–G 1 G 2 H 1 +G 2 G 3 H 2 +G 1 G 2 G 3 +– +– ++ +– +– ++ +– +– +– Figure 2–13 (a) Multiple-loop system; (b)–(e) successive reductions of the block diagram shown in (a). A complicated block diagram involving many feedback loops can be simplified by a step-by-step rearrangement. Simplification of the block diagram by rearrangements considerably reduces the labor needed for subsequent mathematical analysis. It should be noted, however, that as the block diagram is simplified, the transfer functions in new blocks become more complex because new poles and new zeros are generated. EXAMPLE 2–1 Consider the system shown in Figure 2–13(a). Simplify this diagram. By moving the summing point of the negative feedback loop containing H 2 outside the posi- tive feedback loop containing H 1 , we obtain Figure 2–13(b). Eliminating the positive feedback loop, we have Figure 2–13(c).The elimination of the loop containing H 2 /G 1 gives Figure 2–13(d). Finally, eliminating the feedback loop results in Figure 2–13(e). Openmirrors.comSection 2–4 / Modeling in State Space 29Notice that the numerator of the closed-loop transfer function C(s)/R(s) is the product of the transfer functions of the feedforward path. The denominator of C(s)/R(s) is equal to (The positive feedback loop yields a negative term in the denominator.) 2–4 MODELING IN STATE SPACE In this section we shall present introductory material on state-space analysis of control systems. Modern Control Theory. The modern trend in engineering systems is toward greater complexity, due mainly to the requirements of complex tasks and good accu-racy. Complex systems may have multiple inputs and multiple outputs and may be timevarying. Because of the necessity of meeting increasingly stringent requirements onthe performance of control systems, the increase in system complexity, and easy accessto large scale computers, modern control theory, which is a new approach to the analy-sis and design of complex control systems, has been developed since around 1960.Thisnew approach is based on the concept of state. The concept of state by itself is notnew, since it has been in existence for a long time in the field of classical dynamics andother fields. Modern Control Theory Versus Conventional Control Theory. Modern con- trol theory is contrasted with conventional control theory in that the former is appli-cable to multiple-input, multiple-output systems, which may be linear or nonlinear,time invariant or time varying, while the latter is applicable only to linear time-invariant single-input, single-output systems. Also, modern control theory is essen-tially time-domain approach and frequency domain approach (in certain cases such asH-infinity control), while conventional control theory is a complex frequency-domainapproach. Before we proceed further, we must define state, state variables, state vector,and state space. State. The state of a dynamic system is the smallest set of variables (called state variables ) such that knowledge of these variables at t=t 0,together with knowledge of the input for t/H11350t0,completely determines the behavior of the system for any time t/H11350t0. Note that the concept of state is by no means limited to physical systems. It is appli- cable to biological systems, economic systems, social systems, and others. State Variables. The state variables of a dynamic system are the variables mak- ing up the smallest set of variables that determine the state of the dynamic system. If at =1-G1 G2 H1+G2 G3 H2+G1 G2 G3 =1+A-G1 G2 H1+G2 G3 H2+G1 G2 G3B1+a(product of the transfer functions around each loop )30 Chapter 2 / Mathematical Modeling of Control Systems least nvariables x 1 ,x 2 ,p,x n are needed to completely describe the behavior of a dy- namic system (so that once the input is given for t/H11350t 0 and the initial state at t=t 0 is specified, the future state of the system is completely determined), then such n variables are a set of state variables. Note that state variables need not be physically measurable or observable quantities. Variables that do not represent physical quantities and those that are neither measura- ble nor observable can be chosen as state variables. Such freedom in choosing state vari- ables is an advantage of the state-space methods. Practically, however, it is convenient to choose easily measurable quantities for the state variables, if this is possible at all, be- cause optimal control laws will require the feedback of all state variables with suitable weighting. State Vector. Ifnstate variables are needed to completely describe the behavior of a given system, then these nstate variables can be considered the ncomponents of a vector x. Such a vector is called a state vector . A state vector is thus a vector that deter- mines uniquely the system state x(t)for any time t/H11350t 0 , once the state at t=t 0 is given and the input u(t) fort/H11350t 0 is specified. State Space. The n-dimensional space whose coordinate axes consist of the x 1 axis, x 2 axis, p,x n axis, where x 1 ,x 2 ,p,x n are state variables, is called a state space .Any state can be represented by a point in the state space. State-Space Equations. In state-space analysis we are concerned with three types of variables that are involved in the modeling of dynamic systems: input variables, out- put variables, and state variables. As we shall see in Section 2–5, the state-space repre- sentation for a given system is not unique, except that the number of state variables is the same for any of the different state-space representations of the same system. The dynamic system must involve elements that memorize the values of the input for t/H11350t 1 . Since integrators in a continuous-time control system serve as memory devices, the outputs of such integrators can be considered as the variables that define the inter- nal state of the dynamic system.Thus the outputs of integrators serve as state variables. The number of state variables to completely define the dynamics of the system is equal to the number of integrators involved in the system. Assume that a multiple-input, multiple-output system involves nintegrators.Assume also that there are rinputs u 1 (t), u 2 (t),p,u r (t)and moutputs y 1 (t), y 2 (t),p,y m (t). Define noutputs of the integrators as state variables: x 1 (t), x 2 (t),p,x n (t)Then the system may be described by (2–8) x# n (t)=f n Ax 1 , x 2 ,p, x n ; u 1 , u 2 ,p, u r ; tB /H11080 /H11080 /H11080 x# 2 (t)=f 2 Ax 1 , x 2 ,p, x n ; u 1 , u 2 ,p, u r ; tB x# 1 (t)=f 1 Ax 1 , x 2 ,p, x n ; u 1 , u 2 ,p, u r ; tB Openmirrors.comSection 2–4 / Modeling in State Space 31The outputs y1(t), y2(t),p,ym(t)of the system may be given by (2–9) If we define ym(t)=gmAx1 , x2 ,p, xn ; u1 , u2 ,p, ur ; tB /H11080 /H11080 /H11080 y2(t)=g2Ax1 , x2 ,p, xn ; u1 , u2 ,p, ur ; tB y1(t)=g1Ax1 , x2 ,p, xn ; u1 , u2 ,p, ur ; tB u(t)=Fu1(t) u2(t) /H11080/H11080/H11080 u r(t)V g(x, u, t)=Fg1Ax1 ,x2 ,p,xn ;u1 ,u2 ,p,ur ;tB g2Ax1 ,x2 ,p,xn ;u1 ,u2 ,p,ur ;tB /H11080/H11080/H11080 g mAx1 ,x2 ,p,xn ;u1 ,u2 ,p,ur ;tBV, y(t)=Fy1(t) y2(t) /H11080/H11080/H11080 y m(t)V,f(x, u, t)=Ff1Ax1 ,x2 ,p,xn ;u1 ,u2 ,p,ur ;tB f2Ax1 ,x2 ,p,xn ;u1 ,u2 ,p,ur ;tB /H11080/H11080/H11080 f nAx1 ,x2 ,p,xn ;u1 ,u2 ,p,ur ;tBV, x(t)=Fx1(t) x2(t) /H11080/H11080/H11080 x n(t)V, then Equations (2–8) and (2–9) become (2–10) (2–11) where Equation (2–10) is the state equation and Equation (2–11) is the output equation. If vector functions fand/or ginvolve time texplicitly, then the system is called a time- varying system. If Equations (2–10) and (2–11) are linearized about the operating state, then we have the following linearized state equation and output equation: (2–12) (2–13) where A(t)is called the state matrix, B(t)the input matrix, C(t)the output matrix, and D(t)the direct transmission matrix. (Details of linearization of nonlinear systems about y(t)=C(t)x(t)+D(t)u(t) x#(t)=A(t)x(t)+B(t)u(t)y(t)=g(x, u, t) x#(t)=f(x, u, t)32 Chapter 2 / Mathematical Modeling of Control Systems m k bu(t) y(t) Figure 2–15 Mechanical system. u(t)D(t) B(t) A(t)C(t)y(t) x(t) dtÚx(t) ++ ++ Figure 2–14 Block diagram of the linear, continuous- time control system represented in state space. the operating state are discussed in Section 2–7.) A block diagram representation of Equations (2–12) and (2–13) is shown in Figure 2–14. If vector functions fandgdo not involve time texplicitly then the system is called a time-invariant system. In this case, Equations (2–12) and (2–13) can be simplified to (2–14) (2–15) Equation (2–14) is the state equation of the linear, time-invariant system and Equation (2–15) is the output equation for the same system. In this book we shall be concerned mostly with systems described by Equations (2–14) and (2–15). In what follows we shall present an example for deriving a state equation and output equation. EXAMPLE 2–2 Consider the mechanical system shown in Figure 2–15. We assume that the system is linear. The external force u(t) is the input to the system, and the displacement y(t) of the mass is the output. The displacement y(t) is measured from the equilibrium position in the absence of the external force. This system is a single-input, single-output system. From the diagram, the system equation is (2–16) This system is of second order.This means that the system involves two integrators. Let us define state variables x 1 (t)andx 2 (t)as Then we obtain or (2–17) (2–18) The output equation is (2–19) y=x 1 x# 2 =-k mx 1 -b mx 2 +1 mu x# 1 =x 2 x# 2 =1 m A-ky-by#B+1 m u x# 1 =x 2 x 2 (t)=y#(t)x 1 (t)=y(t)my$+by#+ky=u y#(t)=Cx(t)+Du(t) x#(t)=Ax(t)+Bu(t) Openmirrors.comIn a vector-matrix form, Equations (2–17) and (2–18) can be written as (2–20) The output equation, Equation (2–19), can be written as (2–21) Equation (2–20) is a state equation and Equation (2–21) is an output equation for the system. They are in the standard form: where Figure 2–16 is a block diagram for the system. Notice that the outputs of the integrators are state variables. Correlation Between Transfer Functions and State-Space Equations. In what follows we shall show how to derive the transfer function of a single-input, single-outputsystem from the state-space equations. Let us consider the system whose transfer function is given by (2–22) This system may be represented in state space by the following equations: (2–23) (2–24) y=Cx+Du x#=Ax+BuY(s) U(s)=G(s)A=C0 -k m1 -b mS, B=C0 1 mS, C=[1 0], D=0 y=Cx+Du x#=Ax+Buy=[1 0]Bx1 x2RBx# 1 x# 2R=C0 -k m1 -b mSBx1 x2R+C0 1 mSu Section 2–4 / Modeling in State Space 33u 1 m b m k mx2 x2•x1=y/H20885/H20885 +– ++ Figure 2–16 Block diagram of themechanical system shown in Figure 2–15.34 Chapter 2 / Mathematical Modeling of Control Systems where xis the state vector, uis the input, and yis the output.The Laplace transforms of Equations (2–23) and (2–24) are given by (2–25) (2–26) Since the transfer function was previously defined as the ratio of the Laplace transform of the output to the Laplace transform of the input when the initial conditions were zero, we set x(0)in Equation (2–25) to be zero. Then we have or By premultiplying to both sides of this last equation, we obtain (2–27) By substituting Equation (2–27) into Equation (2–26), we get (2–28) Upon comparing Equation (2–28) with Equation (2–22), we see that (2–29) This is the transfer-function expression of the system in terms of A,B,C, and D. Note that the right-hand side of Equation (2–29) involves Hence G(s) can be written as where Q(s) is a polynomial in s. Notice that is equal to the characteristic poly- nomial of G(s) . In other words, the eigenvalues of Aare identical to the poles of G(s) . EXAMPLE 2–3 Consider again the mechanical system shown in Figure 2–15. State-space equations for the system are given by Equations (2–20) and (2–21).We shall obtain the transfer function for the system from the state-space equations. By substituting A,B,C, and Dinto Equation (2–29), we obtain =[1 0] C s k m-1 s+b m S -1 C 0 1 m S =[1 0] c B s 00 s R C 0 -k m1 -b m S s -1 C 0 1 m S +0 G(s) =C(s I-A) -1 B+D ∑s I-A∑G(s) =Q(s) ∑s I-A∑(s I-A) -1 .G(s) =C(s I-A) -1 B+DY(s) =CC(s I-A) -1 B+DDU(s)X(s)=(s I-A) -1 BU(s)(s I-A) -1 (s I-A)X(s)=BU(s)s X(s)-AX(s)=BU(s) Y(s) =CX(s)+DU(s) sX(s)-x(0)=AX(s)+BU(s) Openmirrors.comSection 2–5 / State-Space Representation of Scalar Differential Equation Systems 35Note that (Refer to Appendix C for the inverse of the 2 /H11003 2 matrix.) Thus, we have which is the transfer function of the system. The same transfer function can be obtained from Equation (2–16). Transfer Matrix. Next, consider a multiple-input, multiple-output system.Assume that there are rinputs and moutputs Define The transfer matrix G(s)relates the output Y(s)to the input U(s),o r where G(s)is given by [The derivation for this equation is the same as that for Equation (2–29).] Since the input vector uisrdimensional and the output vector yismdimensional, the transfer ma- trixG(s) is an m*r matrix. 2–5 STATE-SPACE REPRESENTATION OF SCALAR DIFFERENTIAL EQUATION SYSTEMS A dynamic system consisting of a finite number of lumped elements may be described by ordinary differential equations in which time is the independent variable. By use ofvector-matrix notation, an nth-order differential equation may be expressed by a first- order vector-matrix differential equation. If nelements of the vector are a set of state variables, then the vector-matrix differential equation is a state equation. In this section we shall present methods for obtaining state-space representations of continuous-timesystems.G(s)=C(s I-A)-1 B+DY(s)=G(s )U(s )y=Fy1 y2 /H11080 /H11080/H11080 y mV, u=Fu1 u2 /H11080 /H11080/H11080 u rVy1 ,y2 ,p,ym . u1 ,u2 ,p,ur , =1 ms2+bs+k G(s) =[1 0]1 s2+b ms+k mDs+b m -k m1 sTC0 1 mSCs k m-1 s+b mS-1 =1 s2+b ms+k mDs+b m -k m1 sT36 Chapter 2 / Mathematical Modeling of Control Systems State-Space Representation of nth-Order Systems of Linear Differential Equa- tions in which the Forcing Function Does Not Involve Derivative Terms. Con- sider the following nth-order system: (2–30) Noting that the knowledge of together with the input u(t) for t/H113500, determines completely the future behavior of the system, we may take as a set of nstate variables. (Mathematically, such a choice of state variables is quite convenient. Practically, however, because higher-order derivative terms are inaccurate, due to the noise effects inherent in any practical situations, such a choice of the state variables may not be desirable.) Let us define Then Equation (2–30) can be written as or (2–31) where B= G 0 0 /H11080 /H11080 /H11080 0 1 W A= G 0 0 /H11080 /H11080 /H11080 0 -a n 1 0 /H11080 /H11080 /H11080 0 -a n-1 0 1 /H11080 /H11080 /H11080 0 -a n-2 p p p p0 0 /H11080 /H11080 /H11080 1 -a 1 W , x= F x 1 x 2 /H11080 /H11080 /H11080 x n V ,x#=Ax+Bux# n =-a n x 1 -p-a 1 x n +ux# n-1 =x n /H11080/H11080/H11080x# 2 =x 3 x# 1 =x 2 x n =y (n-1) /H11080 /H11080 /H11080 x 2 =y# x 1 =yy(t), y#(t),p,y (n-1) (t)y(0), y#(0), p,y (n-1) (0),y (n) + a 1 y (n-1) +p+a n-1 y#+a n y=u Openmirrors.comSection 2–5 / State-Space Representation of Scalar Differential Equation Systems 37The output can be given by or (2–32) where [Note that Din Equation (2–24) is zero.] The first-order differential equation, Equa- tion (2–31), is the state equation, and the algebraic equation, Equation (2–32), is theoutput equation. Note that the state-space representation for the transfer function system is given also by Equations (2–31) and (2–32). State-Space Representation of nth-Order Systems of Linear Differential Equa- tions in which the Forcing Function Involves Derivative Terms. Consider the dif- ferential equation system that involves derivatives of the forcing function, such as (2–33) The main problem in defining the state variables for this case lies in the derivative terms of the input u. The state variables must be such that they will eliminate the de- rivatives of uin the state equation. One way to obtain a state equation and output equation for this case is to define the following nvariables as a set of nstate variables: (2–34) x n=y(n-1) b0u(n-1) b1u(n-2) -p-bn-2 u#-bn-1 u=x# n-1-bn-1 u/H11080/H11080/H11080x3=y$-b0 u$-b1u#-b2 u=x# 2-b2 ux2=y#-b0 u#-b1 u=x# 1-b1 ux1=y-b0 uy(n) +a1 y(n-1) +p+an-1 y#+an y=b0 u(n) +b1 u(n-1) +p+bn-1 u#+bn uY(s) U(s)=1 sn+a1 sn-1+p+an-1 s+anC=[1 0 p0]y=Cxy=[1 0 p 0]Fx1 x2 /H11080 /H11080/H11080 x nV38 Chapter 2 / Mathematical Modeling of Control Systems where are determined from (2–35) With this choice of state variables the existence and uniqueness of the solution of the state equation is guaranteed. (Note that this is not the only choice of a set of state vari- ables.) With the present choice of state variables, we obtain (2–36) where is given by [To derive Equation (2–36), see Problem A–2–6 .] In terms of vector-matrix equations, Equation (2–36) and the output equation can be written as y=[1 0 p 0] F x 1 x 2 /H11080 /H11080 /H11080 x n V +b 0 u+ G b 1 b 2 /H11080 /H11080 /H11080 b n-1 b n W u G x 1 x 2 /H11080 /H11080 /H11080 x n-1 x n W G x# 1 x# 2 /H11080 /H11080 /H11080 x# n-1 x# n W = G 0 0 /H11080 /H11080 /H11080 0 -a n 1 0 /H11080 /H11080 /H11080 0 -a n-1 0 1 /H11080 /H11080 /H11080 0 -a n-2 p p p p0 0 /H11080 /H11080 /H11080 1 -a 1 W b n =b n -a 1 b n-1 -p-a n-1 b 1 -a n -1 b 0 b n x# n =-a n x 1 -a n-1 x 2 -p-a 1 x n +b n ux# n-1 =x n +b n-1 u/H11080/H11080/H11080x# 2 =x 3 +b 2 ux# 1 =x 2 +b 1 ub n-1 =b n-1 -a 1 b n-2 -p-a n-2 b 1 -a n -1 b 0 /H11080/H11080/H11080b 3 =b 3 -a 1 b 2 -a 2 b 1 -a 3 b 0 b 2 =b 2 -a 1 b 1 -a 2 b 0 b 1 =b 1 -a 1 b 0 b 0 =b 0 b 0 ,b 1 ,b 2 ,p,b n-1 Openmirrors.comSection 2–6 / Transformation of Mathematical Models with MATLAB 39or (2–37) (2–38) where In this state-space representation, matrices Aand Care exactly the same as those for the system of Equation (2–30).The derivatives on the right-hand side of Equation (2–33)affect only the elements of the Bmatrix. Note that the state-space representation for the transfer function is given also by Equations (2–37) and (2–38). There are many ways to obtain state-space representations of systems. Methods for obtaining canonical representations of systems in state space (such as controllable canon-ical form, observable canonical form, diagonal canonical form, and Jordan canonicalform) are presented in Chapter 9. MATLAB can also be used to obtain state-space representations of systems from transfer-function representations, and vice versa.This subject is presented in Section 2–6. 2–6 TRANSFORMATION OF MATHEMATICAL MODELS WITH MATLAB MATLAB is quite useful to transform the system model from transfer function to state space, and vice versa. We shall begin our discussion with transformation from transferfunction to state space.Y(s) U(s)=b0 sn+b1 sn-1+p+bn-1 s+bn sn+a1 sn-1+p+an-1 s+an B=Gb1 b2 /H11080 /H11080/H11080 b n-1 bnW, C=[1 0 p 0], D=b0=b0 x=Gx1 x2 /H11080 /H11080/H11080 x n-1 xnW, A=G0 0 /H11080/H11080/H11080 0 -a n1 0 /H11080/H11080/H11080 0 -a n-10 1 /H11080/H11080/H11080 0 -a n-2p p p p0 0 /H11080/H11080/H11080 1 -a 1W y=Cx+Du x#=Ax+Bu40 Chapter 2 / Mathematical Modeling of Control Systems Let us write the closed-loop transfer function as Once we have this transfer-function expression, the MATLAB command [A,B,C,D] = tf2ss(num,den) will give a state-space representation. It is important to note that the state-space repre- sentation for any system is not unique. There are many (infinitely many) state-space representations for the same system. The MATLAB command gives one possible such state-space representation. Transformation from Transfer Function to State Space Representation. Consider the transfer-function system (2–39) There are many (infinitely many) possible state-space representations for this system. One possible state-space representation is Another possible state-space representation (among infinitely many alternatives) is (2–40) C x# 1 x# 2 x# 3 S = C -14 1 0-56 0 1-160 0 0 SC x 1 x 2 x 3 S + C 1 0 0 S u y=[1 0 0] C x 1 x 2 x 3 S +[0]u C x# 1 x# 2 x# 3 S = C 0 0 -1601 0 -560 1 -14 SC x 1 x 2 x 3 S + C 0 1 -14 S u =s s 3 +14s 2 +56s +160 Y(s) U(s)=s (s+10)As 2 +4s+16BY(s) U(s)=numerator polynomial in s denominator polynomial in s=num den Openmirrors.comSection 2–6 / Transformation of Mathematical Models with MATLAB 41(2–41) MATLAB transforms the transfer function given by Equation (2–39) into the state-space representation given by Equations (2–40) and (2–41). For the examplesystem considered here, MATLAB Program 2–2 will produce matrices A,B,C, and D. y=[0 1 0]Cx1 x2 x3S+[0]u MATLAB Program 2–2 num = [1 0]; den = [1 14 56 160];[A,B,C,D] = tf2ss(num,den) A= -14 -56 -160 10 001 0 B = 1 00 C = 01 0 D = 0 Transformation from State Space Representation to Transfer Function. To obtain the transfer function from state-space equations, use the following command: [num,den] = ss2tf(A,B,C,D,iu) iumust be specified for systems with more than one input. For example, if the system has three inputs (u1, u2, u3) , then iumust be either 1, 2, or 3, where 1 implies u1, 2 implies u2,and 3 implies u3. If the system has only one input, then either [num,den] = ss2tf(A,B,C,D)42 Chapter 2 / Mathematical Modeling of Control Systems EXAMPLE 2–4 Obtain the transfer function of the system defined by the following state-space equations: MATLAB Program 2-3 will produce the transfer function for the given system.The transfer func- tion obtained is given by Y(s) U(s)=25s+5 s 3 +5s 2 +25s+5 y=[1 0 0] C x 1 x 2 x 3 S C x# 1 x# 2 x# 3 S = C 0 0 -51 0 -250 1 -5 SC x 1 x 2 x 3 S + C 0 25 -120 S u MATLAB Program 2–3 A = [0 1 0; 0 0 1; -5 -25 -5]; B = [0; 25; -120]; C = [1 0 0]; D = [0]; [num,den] = ss2tf(A,B,C,D) num = 0 0.0000 25.0000 5.0000 den 1.0000 5.0000 25.0000 5.0000 % ***** The same result can be obtained by entering the following command: ***** [num,den] = ss2tf(A,B,C,D,1) num = 0 0.0000 25.0000 5.0000 den = 1.0000 5.0000 25.0000 5.0000 or [num,den] = ss2tf(A,B,C,D,1) may be used. For the case where the system has multiple inputs and multiple outputs, see Problem A–2–12 . Openmirrors.comSection 2–7 / Linearization of Nonlinear Mathematical Models 432–7 LINEARIZATION OF NONLINEAR MATHEMATICAL MODELS Nonlinear Systems. A system is nonlinear if the principle of superposition does not apply. Thus, for a nonlinear system the response to two inputs cannot be calculatedby treating one input at a time and adding the results. Although many physical relationships are often represented by linear equations, in most cases actual relationships are not quite linear. In fact, a careful study of phys-ical systems reveals that even so-called “linear systems” are really linear only in lim-ited operating ranges. In practice, many electromechanical systems, hydraulic systems,pneumatic systems, and so on, involve nonlinear relationships among the variables.For example, the output of a component may saturate for large input signals.There maybe a dead space that affects small signals. (The dead space of a component is a smallrange of input variations to which the component is insensitive.) Square-law nonlin-earity may occur in some components. For instance, dampers used in physical systemsmay be linear for low-velocity operations but may become nonlinear at high veloci-ties, and the damping force may become proportional to the square of the operatingvelocity. Linearization of Nonlinear Systems. In control engineering a normal operation of the system may be around an equilibrium point, and the signals may be consideredsmall signals around the equilibrium. (It should be pointed out that there are many ex-ceptions to such a case.) However, if the system operates around an equilibrium pointand if the signals involved are small signals, then it is possible to approximate the non-linear system by a linear system. Such a linear system is equivalent to the nonlinear sys-tem considered within a limited operating range. Such a linearized model (linear,time-invariant model) is very important in control engineering. The linearization procedure to be presented in the following is based on the ex- pansion of nonlinear function into a Taylor series about the operating point and theretention of only the linear term. Because we neglect higher-order terms of the Taylorseries expansion, these neglected terms must be small enough; that is, the variablesdeviate only slightly from the operating condition. (Otherwise, the result will beinaccurate.) Linear Approximation of Nonlinear Mathematical Models. To obtain a linear mathematical model for a nonlinear system, we assume that the variables deviate onlyslightly from some operating condition. Consider a system whose input is x(t) and out- put is y(t). The relationship between y(t) andx(t) is given by (2–42) If the normal operating condition corresponds to then Equation (2–42) may be expanded into a Taylor series about this point as follows: (2–43) =f(x –)+df dx(x-x–)+1 2!d2f dx2(x-x–)2+py=f(x)x–,y–,y=f(x)44 Chapter 2 / Mathematical Modeling of Control Systems where the derivatives are evaluated at If the variation is small, we may neglect the higher-order terms in Then Equation (2–43) may be written as (2–44) where Equation (2–44) may be rewritten as (2–45) which indicates that is proportional to Equation (2–45) gives a linear math- ematical model for the nonlinear system given by Equation (2–42) near the operating point Next, consider a nonlinear system whose output yis a function of two inputs x 1 and x 2 ,so that (2–46) To obtain a linear approximation to this nonlinear system, we may expand Equation (2–46) into a Taylor series about the normal operating point Then Equation (2–46) becomes where the partial derivatives are evaluated at Near the normal oper- ating point, the higher-order terms may be neglected.The linear mathematical model of this nonlinear system in the neighborhood of the normal operating condition is then given by y-y – =K 1 Ax 1 -x – 1 B+K 2 Ax 2 -x – 2 Bx 2 =x – 2 . x 1 =x – 1 ,+0 2 f 0x 2 2 Ax 2 -x – 2 B 2 d +p+1 2! c 0 2 f 0x 2 1 Ax 1 -x – 1 B 2 +20 2 f 0x 1 0x 2 Ax 1 -x – 1 BAx 2 -x – 2 By=fAx – 1 ,x – 2 B+ c 0f 0x 1 Ax 1 -x – 1 B+0f 0x 2 Ax 2 -x – 2 B d x – 1 ,x – 2 .y=fAx 1 ,x 2 By=y – . x=x – ,x-x – . y-y – y-y – =K(x -x – )K=df dx 2 x=x – y – =f(x – )y=y – +K(x -x – )x-x – .x-x – x=x – . d 2 f/H20862dx 2 ,p df/H20862dx, Openmirrors.comSection 2–7 / Linearization of Nonlinear Mathematical Models 45where The linearization technique presented here is valid in the vicinity of the operating condition. If the operating conditions vary widely, however, such linearized equations arenot adequate, and nonlinear equations must be dealt with. It is important to rememberthat a particular mathematical model used in analysis and design may accurately rep-resent the dynamics of an actual system for certain operating conditions, but may not beaccurate for other operating conditions. EXAMPLE 2–5 Linearize the nonlinear equation z=xy in the region 5 /H11349x/H113497, 10 /H11349y/H1134912. Find the error if the linearized equation is used to calcu- late the value of zwhen x=5, y=10. Since the region considered is given by 5 /H11349x/H113497, 10 /H11349y/H1134912, choose Then Let us obtain a linearized equation for the nonlinear equation near a point Expanding the nonlinear equation into a Taylor series about point and neglecting the higher-order terms, we have where Hence the linearized equation is z-66=11(x-6)+6(y-11) or z=11x+6y-66 When x=5, y=10, the value of zgiven by the linearized equation is z=11x+6y-66=55+60-66=49 The exact value of zisz=xy=50. The error is thus 50-49=1. In terms of percentage, the error is 2 %.b=0(xy) 0y2 x=x–,y=y–=x–=6a=0(xy) 0x2 x=x–,y=y–=y–=11z-z–=aAx-x–B+bAy-y–By=y–x=x–,y–=11.x–=6, z–=x–y–=66.y–=11. x–=6,K2=0f 0x22 x1=x– 1 ,x2=x– 2K1=0f 0x12 x1=x– 1 ,x2=x– 2y–=fAx– 1 ,x– 2B46 Chapter 2 / Mathematical Modeling of Control Systems EXAMPLE PROBLEMS AND SOLUTIONS A–2–1. Simplify the block diagram shown in Figure 2–17. Solution. First, move the branch point of the path involving H 1 outside the loop involving H 2 ,a s shown in Figure 2–18(a). Then eliminating two loops results in Figure 2–18(b). Combining two blocks into one gives Figure 2–18(c). A–2–2. Simplify the block diagram shown in Figure 2–19. Obtain the transfer function relating C(s) and R(s). R(s) C(s) GH 1 H 2 +– ++ Figure 2–17 Block diagram of a system. R(s) C(s) R(s) C(s) C(s)G H 2 (a) (b) (c)H 1 G G 1 + GH 2 R(s)1 +H 1 G G+ H 1 1 + GH 2 +– ++ Figure 2–18 Simplified block diagrams for the system shown in Figure 2–17. G 1 G 2 R(s) C(s) X(s) ++ ++ Figure 2–19 Block diagram of a system. Openmirrors.comExample Problems and Solutions 47G1 G2R(s) C(s) G2R(s) C(s) G1+ 1 R(s) C(s) G1G2+G2+ 1(a) (b) (c)++++ ++ Figure 2–20 Reduction of theblock diagram shown in Figure 2–19. Solution. The block diagram of Figure 2–19 can be modified to that shown in Figure 2–20(a). Eliminating the minor feedforward path, we obtain Figure 2–20(b), which can be simplified toFigure 2–20(c). The transfer function C(s)/R(s) is thus given by The same result can also be obtained by proceeding as follows: Since signal X(s) is the sum of two signals G 1R(s) andR(s), we have The output signal C(s) is the sum of G2X(s) andR(s). Hence And so we have the same result as before: A–2–3. Simplify the block diagram shown in Figure 2–21. Then obtain the closed-loop transfer function C(s)/R(s).C(s) R(s)=G1 G2+G2+1C(s) =G2 X(s) +R(s) =G2CG1 R(s) +R(s)D+R(s)X(s) =G1 R(s) +R(s)C(s) R(s)=G1 G2+G2+1 G1 G2H3 G3 G4 H2 H1+–++ +–R(s) C(s) Figure 2–21 Block diagram of a system.48 Chapter 2 / Mathematical Modeling of Control Systems G 1 G 1 G 2 H 3 G 4 G 3 G 4 H 2 H 1 ++ ++ +– +–R(s) R(s) C(s) C(s) H 3 G 1 G 4 G 1 G 2 1+G 1 G 2 H 1 R(s) C(s) G 1 G 2 G 3 G 4 1+G 1 G 2 H 1 +G 3 G 4 H 2 –G 2 G 3 H 3 +G 1 G 2 G 3 G 4 H 1 H 2 G 3 G 4 1+G 3 G 4 H 2 1 (a) (b) (c) Figure 2–22 Successive reductions of the block diagram shown in Figure 2–21. G 1 G p ++ +– ++ G f C(s)D(s) R(s) E(s) U(s) H G c Figure 2–23 Control system with reference input and disturbance input.Solution. First move the branch point between G 3 andG 4 to the right-hand side of the loop con- taining G 3 ,G 4 , and H 2 .Then move the summing point between G 1 and G 2 to the left-hand side of the first summing point. See Figure 2–22(a). By simplifying each loop, the block diagram can be modified as shown in Figure 2–22(b). Further simplification results in Figure 2–22(c), from which the closed-loop transfer function C(s)/R(s) is obtained as A–2–4. Obtain transfer functions C(s)/R(s) andC(s)/D(s) of the system shown in Figure 2–23. Solution. From Figure 2–23 we have (2–47) (2–48) (2–49) E(s) =R(s) -HC(s) C(s) =G p CD(s) +G 1 U(s)D U(s) =G f R(s) +G c E(s)C(s) R(s)=G 1 G 2 G 3 G 4 1+G 1 G 2 H 1 +G 3 G 4 H 2 -G 2 G 3 H 3 +G 1 G 2 G 3 G 4 H 1 H 2 Openmirrors.comOpenmirrors.comExample Problems and Solutions 49By substituting Equation (2–47) into Equation (2–48), we get (2–50) By substituting Equation (2–49) into Equation (2–50), we obtain Solving this last equation for C(s), we get Hence (2–51) Note that Equation (2–51) gives the response C(s) when both reference input R(s) and distur- bance input D(s) are present. To find transfer function C(s)/R(s), we let D(s)=0 in Equation (2–51). Then we obtain Similarly, to obtain transfer function C(s)/D(s), we let R(s)=0 in Equation (2–51). Then C(s)/D(s) can be given by A–2–5. Figure 2–24 shows a system with two inputs and two outputs. Derive C1(s)/R1(s),C1(s)/R2(s), C2(s)/R1(s),andC2(s)/R2(s).(In deriving outputs for R1(s),assume that R2(s)is zero, and vice versa.)C(s) D(s)=Gp 1+G1 Gp Gc HC(s) R(s)=G1 GpAGf+GcB 1+G1 Gp Gc HC(s) =Gp D(s) +G1 GpAGf+GcBR(s) 1+G1 Gp Gc HC(s) +G1 Gp Gc HC(s) =Gp D(s) +G1 GpAGf+GcBR(s)C(s) =Gp D(s) +G1 GpEGf R(s) +GcCR(s) -HC(s)DFC(s) =Gp D(s) +G1 GpCGf R(s) +Gc E(s)D G1C1 C2R1 R2G3 G4+− +−G2 Figure 2–24 System with twoinputs and twooutputs.50 Chapter 2 / Mathematical Modeling of Control Systems Solution. From the figure, we obtain (2–52) (2–53) By substituting Equation (2–53) into Equation (2–52), we obtain (2–54) By substituting Equation (2–52) into Equation (2–53), we get (2–55) Solving Equation (2–54) for C 1 ,we obtain (2–56) Solving Equation (2–55) for C 2 gives (2–57) Equations (2–56) and (2–57) can be combined in the form of the transfer matrix as follows: Then the transfer functions C 1 (s)/R 1 (s),C 1 (s)/R 2 (s),C 2 (s)/R 1 (s)andC 2 (s)/R 2 (s)can be obtained as follows: Note that Equations (2–56) and (2–57) give responses C 1 andC 2 ,respectively, when both inputs R 1 andR 2 are present. Notice that when R 2 (s)=0, the original block diagram can be simplified to those shown in Figures 2–25(a) and (b). Similarly, when R 1 (s)=0, the original block diagram can be simplified to those shown in Figures 2–25(c) and (d). From these simplified block diagrams we can also ob- tain C 1 (s)/R 1 (s),C 2 (s)/R 1 (s),C 1 (s)/R 2 (s),andC 2 (s)/R 2 (s),as shown to the right of each corre- sponding block diagram. C 2 (s) R 1 (s)=- G 1 G 2 G 4 1-G 1 G 2 G 3 G 4 , C 2 (s) R 2 (s)=G 4 1-G 1 G 2 G 3 G 4 C 1 (s) R 1 (s)=G 1 1-G 1 G 2 G 3 G 4 , C 1 (s) R 2 (s)=- G 1 G 3 G 4 1-G 1 G 2 G 3 G 4 B C 1 C 2 R = D G 1 1-G 1 G 2 G 3 G 4 -G 1 G 2 G 4 1-G 1 G 2 G 3 G 4 -G 1 G 3 G 4 1-G 1 G 2 G 3 G 4 G 4 1-G 1 G 2 G 3 G 4 TB R 1 R 2 R C 2 =-G 1 G 2 G 4 R 1 +G 4 R 2 1-G 1 G 2 G 3 G 4 C 1 =G 1 R 1 -G 1 G 3 G 4 R 2 1-G 1 G 2 G 3 G 4 C 2 =G 4 CR 2 -G 2 G 1 AR 1 -G 3 C 2 BDC 1 =G 1 CR 1 -G 3 G 4 AR 2 -G 2 C 1 BD C 2 =G 4 AR 2 -G 2 C 1 B C 1 =G 1 AR 1 -G 3 C 2 B Openmirrors.comExample Problems and Solutions 51+–R1 C1 R1C1 1–G1G2G3G4G1G1 G3 G4 –G2 +–R1 C2 G3G1 –G2 G4= +–R2 C2 R2C2 1–G1G2G3G4G4G4 G2 G1 –G3=R1C2 1–G1G2G3G4–G1G2G4= +–R2 C1 G2G4 –G3 G1R2C1 1–G1G2G3G4–G1G3G4=(a) (b) (c) (d)Figure 2–25 Simplified blockdiagrams and corresponding closed-loop transferfunctions. A–2–6. Show that for the differential equation system (2–58) state and output equations can be given, respectively, by (2–59) and (2–60) where state variables are defined by x 3=y$-b0 u$-b1 u#-b2 u=x# 2-b2 u x2=y#-b0 u#-b1 u=x# 1-b1 u x1=y-b0 uy=[1 0 0]Cx1 x2 x3S+b0 uCx# 1 x# 2 x# 3S=C0 0 -a31 0 -a20 1 -a1SCx1 x2 x3S+Cb1 b2 b3Suy%+a1 y$+a2 y#+a3 y=b0 u%+b1 u$+b2 u#+b3 u52 Chapter 2 / Mathematical Modeling of Control Systems and Solution. From the definition of state variables x 2 andx 3 ,we have (2–61) (2–62) To derive the equation for we first note from Equation (2–58) that Since we have Hence, we get (2–63) Combining Equations (2–61), (2–62), and (2–63) into a vector-matrix equation, we obtain Equa- tion (2–59). Also, from the definition of state variable x 1 ,we get the output equation given by Equation (2–60). A–2–7. Obtain a state-space equation and output equation for the system defined by Solution. From the given transfer function, the differential equation for the system is Comparing this equation with the standard equation given by Equation (2–33), rewritten y%+a 1 y$+a 2 y#+a 3 y=b 0 u%+b 1 u$+b 2 u#+b 3 uy%+4y$+5y#+2y=2u%+u$+u#+2uY(s) U(s)=2s 3 +s 2 +s+2 s 3 +4s 2 +5s+2x# 3 =-a 3 x 1 -a 2 x 2 -a 1 x 3 +b 3 u=-a 1 x 3 -a 2 x 2 -a 3 x 1 +b 3 u=-a 1 x 3 -a 2 x 2 -a 3 x 1 +Ab 3 -a 1 b 2 -a 2 b 1 -a 3 b 0 Bu+Ab 2 -b 2 -a 1 b 1 -a 2 b 0 Bu#+Ab 3 -a 1 b 2 -a 2 b 1 -a 3 b 0 Bu=-a 1 x 3 -a 2 x 2 -a 3 x 1 +Ab 0 -b 0 Bu%+Ab 1 -b 1 -a 1 b 0 Bu$+b 0 u%+b 1 u$+b 2 u#+b 3 u-b 0 u%-b 1 u$-b 2 u#-a 2 Ay#-b 0 u#-b 1 uB-a 2 b 0 u#-a 2 b 1 u-a 3 Ay-b 0 uB-a 3 b 0 u=-a 1 Ay$-b 0 u$-b 1 u#-b 2 uB-a 1 b 0 u$-a 1 b 1 u#-a 1 b 2 u=A-a 1 y$-a 2 y#-a 3 yB+b 0 u%+b 1 u$+b 2 u#+b 3 u-b 0 u%-b 1 u$-b 2 u#x# 3 =y%-b 0 u%-b 1 u$-b 2 u#x 3 =y$-b 0 u$-b 1 u#-b 2 uy%=-a 1 y$-a 2 y#-a 3 y+b 0 u%+b 1 u$+b 2 u#+b 3 ux# 3 , x# 2 =x 3 +b 2 u x# 1 =x 2 +b 1 u b 3 =b 3 -a 1 b 2 -a 2 b 1 -a 3 b 0 b 2 =b 2 -a 1 b 1 -a 2 b 0 b 1 =b 1 -a 1 b 0 b 0 =b 0 Openmirrors.comExample Problems and Solutions 53we find Referring to Equation (2–35), we have Referring to Equation (2–34), we define Then referring to Equation (2–36), Hence, the state-space representation of the system is This is one possible state-space representation of the system. There are many (infinitely many) others. If we use MATLAB, it produces the following state-space representation: See MATLAB Program 2-4. (Note that all state-space representations for the same system are equivalent.)Cx1 x2 x3S+2u y=[-7 -9 -2] Cx# 1 x# 2 x# 3S=C-4 10-5 01-2 00 SCx1 x2 x3S+C100 Suy=[1 0 0]Cx1 x2 x3S+2uCx# 1 x# 2 x# 3S=C0 0 -21 0 -50 1 -4SCx1 x2 x3S+C-7 19 -43Su =-2x1-5x2-4x3-43u x# 3=-a3 x1-a2 x2-a1 x3+b3 u x# 2=x3+19u x# 1=x2-7u x3=x# 2-b2 u=x# 2-19u x2=x# 1-b1 u=x# 1+7u x1=y-b0 u=y-2u =2-4*19-5*(-7)-2*2=-43 b3=b3-a1 b2-a2 b1-a3 b0 b2=b2-a1 b1-a2 b0=1-4*(-7)-5*2=19 b1=b1-a1 b0=1-4*2=-7 b0=b0=2 b0=2, b1=1, b2=1, b3=2 a1=4, a2=5, a3=254 Chapter 2 / Mathematical Modeling of Control Systems A–2–8. Obtain a state-space model of the system shown in Figure 2–26. Solution. The system involves one integrator and two delayed integrators. The output of each integrator or delayed integrator can be a state variable. Let us define the output of the plant as x 1 ,the output of the controller as x 2 ,and the output of the sensor as x 3 .Then we obtain Y(s) =X 1 (s)X 3 (s) X 1 (s)=1 s+1X 2 (s) U(s) -X 3 (s)=1 sX 1 (s) X 2 (s)=10 s+5 U(s) Y(s)1 s Controller Plant Sensor 10 s+ 5 1 s+ 1 +– Figure 2–26 Control system. MATLAB Program 2–4 num = [2 1 1 2]; den = [1 4 5 2]; [A,B,C,D] = tf2ss(num,den) A= -4 -5 -2 100 010 B = 1 0 0 C = -7 -9 -2 D = 2 Openmirrors.comExample Problems and Solutions 55which can be rewritten as By taking the inverse Laplace transforms of the preceding four equations, we obtain Thus, a state-space model of the system in the standard form is given by It is important to note that this is not the only state-space representation of the system. Infinite- ly many other state-space representations are possible. However, the number of state variables isthe same in any state-space representation of the same system. In the present system, the num-ber of state variables is three, regardless of what variables are chosen as state variables. A–2–9. Obtain a state-space model for the system shown in Figure 2–27(a). Solution. First, notice that (as+b)/s 2involves a derivative term. Such a derivative term may be avoided if we modify (as+b)/s2as Using this modification, the block diagram of Figure 2–27(a) can be modified to that shown in Figure 2–27(b). Define the outputs of the integrators as state variables, as shown in Figure 2–27(b).Then from Figure 2–27(b) we obtain which may be modified to Y(s) =X1(s) sX2(s)=-bX1(s)+bU(s) sX1(s)=X2(s)+aCU(s) -X1(s)DY(s) =X1(s)X2(s) U(s) -X1(s)=b sX1(s) X2(s)+aCU(s) -X1(s)D=1 sas+b s2=aa+b sb1 sCx1 x2 x3S y=[1 0 0] Cx# 1 x# 2 x# 3S=C-5 0110 000 -1 -1 SCx1 x2 x3S+C0 10Su y=x1 x# 3=x1-x3 x# 2=-x3+u x# 1=-5x1+10x2 Y(s) =X1(s) sX3(s)=X1(s)-X3(s) sX2(s)=-X3(s)+U(s) sX1(s)=-5X1(s)+10X2(s)56 Chapter 2 / Mathematical Modeling of Control Systems Taking the inverse Laplace transforms of the preceding three equations, we obtain Rewriting the state and output equations in the standard vector-matrix form, we obtain A–2–10. Obtain a state-space representation of the system shown in Figure 2–28(a). Solution. In this problem, first expand (s+z)/(s+p) into partial fractions. Next, convert K/Cs(s+a)Dinto the product of K/s and1/(s+a). Then redraw the block diagram, as shown in Figure 2–28(b). Defining a set of state variables, as shown in Figure 2–28(b), we ob- tain the following equations: y=x 1 x# 3 =-(z-p)x 1 -px 3 +(z-p)u x# 2 =-Kx 1 +Kx 3 +Ku x# 1 =-ax 1 +x 2 s+z s+p=1+z-p s+p y=[1 0] B x 1 x 2 R B x# 1 x# 2 R = B -a -b1 0 RB x 1 x 2 R + B a b R u y=x 1 x# 2 =-bx 1 +bu x# 1 =-ax 1 +x 2 +au U(s) Y(s) as+b1 s 2 (a) (b)a U(s) Y(s)b s 1 s X 1 (s) X 2 (s) +– +– ++ Figure 2–27 (a) Control system; (b) modified block diagram. Openmirrors.comExample Problems and Solutions 57Rewriting gives Notice that the output of the integrator and the outputs of the first-order delayed integrators C1/(s+a) and(z-p)/(s+p)Dare chosen as state variables. It is important to remember that the output of the block (s+z)/(s+p) in Figure 2–28(a) cannot be a state variable, because this block involves a derivative term, s+z. A–2–11. Obtain the transfer function of the system defined by Solution. Referring to Equation (2–29), the transfer function G(s) is given by In this problem, matrices A,B,C, and Dare A=C-1 001 -1 00 1 -2S, B=C0 01S, C=[1 0 0], D=0G(s) =C(sI-A)-1B+Dy=[1 0 0]Cx1 x2 x3SCx# 1 x# 2 x# 3S=C-1 001 -1 00 1 -2SCx1 x2 x3S+C0 01Suy=[1 0 0]Cx1 x2 x3SCx# 1 x# 2 x# 3S=C-a -K -(z-p)1 000 K -pSCx1 x2 x3S+C0 K z-pSuuy uy(a) (b)s + z s + pK s(s + a) z – p s + pK s1 s + ax1 x2 x3+– +–++Figure 2–28 (a) Control system;(b) block diagram defining state variables for thesystem.58 Chapter 2 / Mathematical Modeling of Control Systems Hence A–2–12. Consider a system with multiple inputs and multiple outputs.When the system has more than one output, the MATLAB command [NUM,den] = ss2tf(A,B,C,D,iu) produces transfer functions for all outputs to each input. (The numerator coefficients are returned to matrix NUM with as many rows as there are outputs.) Consider the system defined by This system involves two inputs and two outputs. Four transfer functions are involved: and (When considering input u 1 ,we assume that input u 2 is zero and vice versa.) Solution. MATLAB Program 2-5 produces four transfer functions. This is the MATLAB representation of the following four transfer functions: Y 2 (s) U 2 (s)=s-25 s 2 +4s+25 Y 1 (s) U 2 (s)=s+5 s 2 +4s+25,Y 2 (s) U 1 (s)=-25 s 2 +4s+25 Y 1 (s) U 1 (s)=s+4 s 2 +4s+25,Y 2 (s) /H20862U 2 (s). Y 1 (s) /H20862U 2 (s), Y 2 (s) /H20862U 1 (s),Y 1 (s) /H20862U 1 (s), B y 1 y 2 R = B 1 00 1 RB x 1 x 2 R + B 0 00 0 RB u 1 u 2 RB x# 1 x# 2 R = B 0 -251 -4 RB x 1 x 2 R + B 1 01 1 RB u 1 u 2 R =1 (s+1) 2 (s+2)=1 s 3 +4s 2 +5s+2 =[1 0 0] F 1 s+1 0 01 (s+1) 2 1 s+1 01 (s+1) 2 (s+2) 1 (s+1)(s +2) 1 s+2 VC 0 0 1 S G(s) =[1 0 0] C s+1 0 0-1 s+1 00 -1 s+2 S -1 C 0 0 1 S Openmirrors.comExample Problems and Solutions 59A–2–13. Linearize the nonlinear equation in the region defined by 8 /H11349x/H1134910, 2 /H11349y/H113494. Solution. Define Then where we choose Since the higher-order terms in the expanded equation are small, neglecting these higher- order terms, we obtain where z–=x–2+4x–y–+6y–2=92+4*9*3+6*9=243K2=0f 0y2 x=x–,y=y–=4x–+12y–=4*9+12*3=72K1=0f 0x2 x=x–,y=y–=2x–+4y–=2*9+4*3=30z-z–=K1(x-x–)+K2(y-y–)x–=9, y–=3.z=f(x,y)=f(x–,y–)+c0f 0x(x-x–)+0f 0y(y-y–)d x=x–,y=y–+pf(x, y) =z=x2+4xy +6y2z=x2+4xy +6y2MATLAB Program 2–5 A = [0 1;-25 -4]; B = [1 1;0 1];C = [1 0;0 1];D = [0 0;0 0];[NUM,den] = ss2tf(A,B,C,D,1) NUM = 01 40 0 –25 den = 14 2 5 [NUM,den] = ss2tf(A,B,C,D,2) NUM = 0 1.0000 5.0000 0 1.0000 -25.0000 den = 14 2 560 Chapter 2 / Mathematical Modeling of Control Systems Thus Hence a linear approximation of the given nonlinear equation near the operating point is z-30x -72y +243 =0z-243 =30(x -9)+72(y -3) R(s) C(s) G 1 G 2 G 3 H 1 H 2 H 3 +– +– +– ++ Figure 2–31 Block diagram of a system.B–2–1. Simplify the block diagram shown in Figure 2–29 and obtain the closed-loop transfer function C(s)/R(s).B–2–2. Simplify the block diagram shown in Figure 2–30 and obtain the closed-loop transfer function C(s)/R(s). B–2–3. Simplify the block diagram shown in Figure 2–31 and obtain the closed-loop transfer function C(s)/R(s). PROBLEMS R(s) C(s)G 1 G 2 G 3 G 4 +– +– + + Figure 2–29 Block diagram of a system. R(s) C(s)G 1 G 2 H 1 H 2 +– ++ + – Figure 2–30 Block diagram of a system. Openmirrors.comProblems 61C(s)D(s) R(s) Gc(s) Gp(s) +–++ Controller PlantFigure 2–32 Closed-loop system.B–2–4. Consider industrial automatic controllers whose control actions are proportional, integral, proportional-plus-integral, proportional-plus-derivative, and proportional-plus-integral-plus-derivative. The transfer functions of thesecontrollers can be given, respectively, by where U(s) is the Laplace transform of u(t), the controller output, and E(s) the Laplace transform of e(t), the actuat- U(s) E(s)=Kpa1+1 Ti s+Td sb U(s) E(s)=KpA1+Td sB U(s) E(s)=Kpa1+1 Ti sb U(s) E(s)=Ki s U(s) E(s)=Kping error signal. Sketch u(t)-versus- tcurves for each of the five types of controllers when the actuating error signal is (a)e(t)= unit-step function (b)e(t)= unit-ramp function In sketching curves, assume that the numerical values of Kp, Ki,and are given as proportional gain =4 integral gain =2 integral time =2 sec derivative time =0.8 sec B–2–5. Figure 2–32 shows a closed-loop system with a ref- erence input and disturbance input. Obtain the expressionfor the output C(s) when both the reference input and dis- turbance input are present. B–2–6. Consider the system shown in Figure 2–33. Derive the expression for the steady-state error when both the ref-erence input R(s) and disturbance input D(s) are present. B–2–7. Obtain the transfer functions C(s)/R(s) and C(s)/D(s) of the system shown in Figure 2–34. T d= Ti= Ki= Kp=Td Ti , C(s) R(s) E(s)D(s) +–++G2(s) G1(s) G2 H1G3G1 GcR(s) C(s)D(s) +–+–++ H2Figure 2–33 Control system. Figure 2–34 Control system.62 Chapter 2 / Mathematical Modeling of Control Systems B–2–8. Obtain a state-space representation of the system shown in Figure 2–35. B–2–9. Consider the system described by Derive a state-space representation of the system. B–2–10. Consider the system described by Obtain the transfer function of the system. y=[1 0] B x 1 x 2 R B x# 1 x# 2 R = B -4 3-1 -1 RB x 1 x 2 R + B 1 1 R uy%+3y$+2y#=u uy s+z s+p 1 s 2 +– Figure 2–35 Control system.B–2–11. Consider a system defined by the following state- space equations: Obtain the transfer function G(s) of the system. B–2–12. Obtain the transfer matrix of the system defined by B–2–13. Linearize the nonlinear equation z=x 2 +8xy+3y 2 in the region defined by 2 /H11349x/H113494, 10 /H11349y/H1134912. B–2–14. Find a linearized equation for y=0.2x 3 about a point x=2. B y 1 y 2 R = B 1 00 10 0 RC x 1 x 2 x 3 S C x# 1 x# 2 x# 3 S = C 0 0 -21 0 -40 1 -6 SC x 1 x 2 x 3 S + C 0 0 10 1 0 SB u 1 u 2 R y=[1 2] B x 1 x 2 R B x# 1 x# 2 R = B -5 3-1 -1 RB x 1 x 2 R + B 2 5 R u Openmirrors.com3 63Mathematical Modeling of Mechanical Systems and Electrical Systems 3–1 INTRODUCTION This chapter presents mathematical modeling of mechanical systems and electrical systems. In Chapter 2 we obtained mathematical models of a simple electrical circuitand a simple mechanical system. In this chapter we consider mathematical modelingof a variety of mechanical systems and electrical systems that may appear in controlsystems. The fundamental law govering mechanical systems is Newton’s second law. In Section 3–2 we apply this law to various mechanical systems and derive transfer-function models and state-space models. The basic laws governing electrical circuits are Kirchhoff’s laws. In Section 3–3 we obtain transfer-function models and state-space models of various electrical circuitsand operational amplifier systems that may appear in many control systems. 3–2 MATHEMATICAL MODELING OF MECHANICAL SYSTEMS This section first discusses simple spring systems and simple damper systems. Then we derive transfer-function models and state-space models of various mechanicalsystems.64 Chapter 3 / Mathematical Modeling of Mechanical Systems and Electrical Systems EXAMPLE 3–1 Let us obtain the equivalent spring constants for the systems shown in Figures 3–1(a) and (b), respectively. For the springs in parallel [Figure 3–1(a)] the equivalent spring constant k eq is obtained from or For the springs in series [Figure–3–1(b)], the force in each spring is the same. Thus Elimination of yfrom these two equations results in or The equivalent spring constant k eq for this case is then found as EXAMPLE 3–2 Let us obtain the equivalent viscous-friction coefficient for each of the damper systems shown in Figures 3–2(a) and (b).An oil-filled damper is often called a dashpot.A dashpot is a device that provides viscous friction, or damping. It consists of a piston and oil-filled cylinder.Any relative mo- tion between the piston rod and the cylinder is resisted by the oil because the oil must flow around the piston (or through orifices provided in the piston) from one side of the piston to the other.The dashpot essentially absorbs energy.This absorbed energy is dissipated as heat, and the dashpot does not store any kinetic or potential energy.b eq k eq =F x=k 1 k 2 k 1 +k 2 =1 1 k 1 +1 k 2 k 2 x=F+k 2 k 1 F=k 1 +k 2 k 1 Fk 2 a x-F k 1 b =Fk 1 y=F, k 2 (x-y)=Fk eq =k 1 +k 2 k 1 x+k 2 x=F=k eq x k 1 k 2 yx F (a) (b) x Fk 1 k 2 Figure 3–1 (a) System consisting of two springs in parallel; (b) system consisting of two springs in series. Openmirrors.comSection 3–2 / Mathematical Modeling of Mechanical Systems 65(a) The force fdue to the dampers is In terms of the equivalent viscous-friction coefficient beq, force fis given by Hence (b) The force fdue to the dampers is (3–1) where zis the displacement of a point between damper b1and damper b2.(Note that the same force is transmitted through the shaft.) From Equation (3–1), we have or (3–2) In terms of the equivalent viscous-friction coefficient beq,force fis given by By substituting Equation (3–2) into Equation (3–1), we have Thus, Hence, beq=b1 b2 b1+b2=1 1 b1+1 b2f=beq(y#-x#)=b1 b2 b1+b2(y#-x#) =b1 b2 b1+b2 (y#-x#) f=b2(y#-z#)=b2cy#- 1 b1+b2 Ab2y#+b1x#Bdf=beqAy#-x#Bz#=1 b1+b2Ab2 y#+b1 x#BAb1+b2Bz#=b2 y#+b1 x#f=b1(z#-x#)=b2 (y#-z#)beq=b1+b2f=beq(y#-x#)f=b1(y#-x#)+b2(y#-x#)=Ab1+b2B(y#-x#)x y (a)b2 x y z (b)b1b1 b2 Figure 3–2 (a) Two dampersconnected in parallel; (b) two dampers connected in series.66 Chapter 3 / Mathematical Modeling of Mechanical Systems and Electrical Systems EXAMPLE 3–3 Consider the spring-mass-dashpot system mounted on a massless cart as shown in Figure 3–3. Let us obtain mathematical models of this system by assuming that the cart is standing still for t<0 and the spring-mass-dashpot system on the cart is also standing still for t<0. In this system, u(t) is the displacement of the cart and is the input to the system.At t=0, the cart is moved at a constant speed, or constant. The displacement y(t) of the mass is the output. (The displacement is relative to the ground.) In this system, mdenotes the mass, bdenotes the viscous-friction coefficient, and kde- notes the spring constant.We assume that the friction force of the dashpot is proportional to and that the spring is a linear spring; that is, the spring force is proportional to y-u. For translational systems, Newton’s second law states that where mis a mass, ais the acceleration of the mass, and is the sum of the forces acting on the mass in the direction of the acceleration a.Applying Newton’s second law to the present system and noting that the cart is massless, we obtain or This equation represents a mathematical model of the system considered. Taking the Laplace transform of this last equation, assuming zero initial condition, gives Taking the ratio of Y(s) toU(s) , we find the transfer function of the system to be Such a transfer-function representation of a mathematical model is used very frequently in control engineering.Transfer function =G(s) =Y(s) U(s)=bs+k ms 2 +bs+kAms 2 +bs+kBY(s) =(bs+k)U(s)md 2 y dt 2 +bdy dt+ky=bdu dt+kumd 2 y dt 2 =-b a dy dt-du dt b -k(y -u)gFma=aFy#-u#u#= mu y k bMassless cart Figure 3–3 Spring-mass- dashpot system mounted on a cart. Openmirrors.comSection 3–2 / Mathematical Modeling of Mechanical Systems 67Next we shall obtain a state-space model of this system. We shall first compare the differen- tial equation for this system with the standard form and identify a1, a2, b0, b1,andb2as follows: Referring to Equation (3–35), we have Then, referring to Equation (2–34), define From Equation (2–36) we have and the output equation becomes or (3–3) and (3–4) Equations (3–3) and (3–4) give a state-space representation of the system. (Note that this is not the only state-space representation.There are infinitely many state-space representations for thesystem.)y=[1 0]Bx1 x2RBx# 1 x# 2R=C0 -k m1 -b mSBx1 x2R+Db m k m-ab mb2Tuy=x1 x# 2=-a2 x1-a1 x2+b2 u=- k m x1-b m x2+ck m-ab mb2 du x# 1=x2+b1 u=x2+b m u x2=x# 1-b1 u=x# 1-b m u x1=y-b0 u=y b2=b2-a1 b1-a2 b0=k m-ab mb2 b1=b1-a1 b0=b m b0=b0=0a1=b m, a2=k m , b0=0, b1=b m , b2=k my$+a1 y#+a2 y=b0 u$+b1 u#+b2 uy$+b my#+k my=b mu#+k mu68 Chapter 3 / Mathematical Modeling of Mechanical Systems and Electrical Systems EXAMPLE 3–4 Obtain the transfer functions and of the mechanical system shown in Figure 3–4. The equations of motion for the system shown in Figure 3–4 are Simplifying, we obtain Taking the Laplace transforms of these two equations, assuming zero initial conditions, we obtain (3–5) (3–6) Solving Equation (3–6) for and substituting it into Equation (3–5) and simplifying, we get from which we obtain (3–7) From Equations (3–6) and (3–7) we have (3–8) Equations (3–7) and (3–8) are the transfer functions and respectively. EXAMPLE 3–5 An inverted pendulum mounted on a motor-driven cart is shown in Figure 3–5(a).This is a model of the attitude control of a space booster on takeoff. (The objective of the attitude control prob- lem is to keep the space booster in a vertical position.) The inverted pendulum is unstable in that it may fall over any time in any direction unless a suitable control force is applied. Here we considerX 2 (s) /H20862U(s), X 1 (s) /H20862U(s)X 2 (s) U(s)=bs+k 2 Am 1 s 2 +bs+k 1 +k 2 BAm 2 s 2 +bs+k 2 +k 3 B-Abs+k 2 B 2 X 1 (s) U(s)=m 2 s 2 +bs+k 2 +k 3 Am 1 s 2 +bs+k 1 +k 2 BAm 2 s 2 +bs+k 2 +k 3 B-Abs+k 2 B 2 =Am 2 s 2 +bs+k 2 +k 3 BU(s) CAm 1 s 2 +bs+k 1 +k 2 BAm 2 s 2 +bs+k 2 +k 3 B-Abs+k 2 B 2 DX 1 (s)X 2 (s) Cm 2 s 2 +bs+Ak 2 +k 3 BDX 2 (s)=Abs+k 2 BX 1 (s) Cm 1 s 2 +bs+Ak 1 +k 2 BDX 1 (s)=Abs+k 2 BX 2 (s)+U(s) m 2 x$ 2 +bx# 2 +Ak 2 +k 3 Bx 2 =bx# 1 +k 2 x 1 m 1 x$ 1 +bx# 1 +Ak 1 +k 2 Bx 1 =bx# 2 +k 2 x 2 +u m 2 x$ 2 =-k 3 x 2 -k 2 Ax 2 -x 1 B-bAx# 2 -x# 1 B m 1 x$ 1 =-k 1 x 1 -k 2 Ax 1 -x 2 B-bAx# 1 -x# 2 B+uX 2 (s) /H20862U(s) X 1 (s) /H20862U(s) m 1 m 2 k 2 x 1 k 1 k 3 bu x 2 Figure 3–4 Mechanical system. Openmirrors.comonly a two-dimensional problem in which the pendulum moves only in the plane of the page.The control force uis applied to the cart. Assume that the center of gravity of the pendulum rod is at its geometric center. Obtain a mathematical model for the system. Define the angle of the rod from the vertical line as u. Define also the (x, y) coordinates of the center of gravity of the pendulum rod as AxG,yGB. Then yG=l cosuxG=x+lsinu Section 3–2 / Mathematical Modeling of Mechanical Systems 69MPy x uOx (a)mg/H5129 /H5129/H5129cosuu (b)u V VH H My x uOx mg/H5129/H5129 Figure 3–5 (a) Invertedpendulum system; (b) free-body diagram.70 Chapter 3 / Mathematical Modeling of Mechanical Systems and Electrical Systems To derive the equations of motion for the system, consider the free-body diagram shown in Figure 3–5(b). The rotational motion of the pendulum rod about its center of gravity can be described by (3–9) where Iis the moment of inertia of the rod about its center of gravity. The horizontal motion of center of gravity of pendulum rod is given by (3–10) The vertical motion of center of gravity of pendulum rod is (3–11) The horizontal motion of cart is described by (3–12) Since we must keep the inverted pendulum vertical, we can assume that u(t)and are small quantities such that sin u/H11216u, cosu=1 , and Then, Equations (3–9) through (3–11) can be linearized. The linearized equations are (3–13) (3–14) (3–15) From Equations (3–12) and (3–14), we obtain (3–16) From Equations (3–13), (3–14), and (3–15), we have or (3–17) Equations (3–16) and (3–17) describe the motion of the inverted-pendulum-on-the-cart system. They constitute a mathematical model of the system. EXAMPLE 3–6 Consider the inverted-pendulum system shown in Figure 3–6. Since in this system the mass is con- centrated at the top of the rod, the center of gravity is the center of the pendulum ball. For this case, the moment of inertia of the pendulum about its center of gravity is small, and we assume I=0 in Equation (3–17). Then the mathematical model for this system becomes as follows: (3–18) (3–19) Equations (3–18) and (3–19) can be modified to (3–20) (3–21) Mx$=u-mguMlu$ =(M +m)gu-u ml 2 u$+mlx$=mglu (M +m)x$+mlu$=uAI+ml 2 Bu$+mlx$=mglu =mglu-l(mx$+mlu$) Iu$ =mglu-Hl(M +m)x$+mlu$ =u0=V-mgm(x$+lu$)=HIu$=Vlu-Hluu # 2 =0.u#(t)Md 2 x dt 2 =u-Hmd 2 dt 2 (lcosu)=V-mgmd 2 dt 2 (x+lsinu)=HIu$ =Vlsinu-Hlcosu Openmirrors.comSection 3–2 / Mathematical Modeling of Mechanical Systems 71Equation (3–20) was obtained by eliminating from Equations (3–18) and (3–19). Equation (3–21) was obtained by eliminating from Equations (3–18) and (3–19). From Equation (3–20)we obtain the plant transfer function to be The inverted-pendulum plant has one pole on the negative real axis and another on the positive real axis Hence, the plant is open-loop unstable. Define state variables x 1, x2, x3,andx4by Note that angle uindicates the rotation of the pendulum rod about point P, and xis the location of the cart. If we consider uandxas the outputs of the system, then (Notice that both uandxare easily measurable quantities.) Then, from the definition of the state variables and Equations (3–20) and (3–21), we obtain x# 4=-m Mgx1+1 Mu x# 3=x4 x# 2=M+m Ml gx1-1 Ml u x# 1=x2y=By1 y2R=Bu xR=Bx1 x3R x4=x# x3=x x2=u# x1=uCs=A1M+m/H208621MlB1gD.Cs=-A1M+m/H208621MlB1gD=1 Mlas+AM+m Mlgbas-AM+m MlgbQ (s) -U(s)=1 Mls2-(M +m)gu$x$0 MPz umgm/H5129 sin u xx /H5129 cos u /H5129u Figure 3–6 Inverted-pendulumsystem.72 Chapter 3 / Mathematical Modeling of Mechanical Systems and Electrical Systems In terms of vector-matrix equations, we have (3–22) (3–23) Equations (3–22) and (3–23) give a state-space representation of the inverted-pendulum system. (Note that state-space representation of the system is not unique. There are infinitely many such representations for this system.) B y 1 y 2 R = B 1000 0010 RD x 1 x 2 x 3 x 4 TD x# 1 x# 2 x# 3 x# 4 T = F 0 M+m Mlg 0 -m Mg1 0 0 00 0 0 00 0 1 0 VD x 1 x 2 x 3 x 4 T + F 0 -1 Ml 0 1 M V u 3–3 MATHEMATICAL MODELING OF ELECTRICAL SYSTEMS Basic laws governing electrical circuits are Kirchhoff’s current law and voltage law. Kirchhoff’s current law (node law) states that the algebraic sum of all currents entering and leaving a node is zero. (This law can also be stated as follows: The sum of currents enter- ing a node is equal to the sum of currents leaving the same node.) Kirchhoff’s voltage law (loop law) states that at any given instant the algebraic sum of the voltages around any loop in an electrical circuit is zero. (This law can also be stated as follows: The sum of the volt- age drops is equal to the sum of the voltage rises around a loop.) A mathematical model of an electrical circuit can be obtained by applying one or both of Kirchhoff’s laws to it. This section first deals with simple electrical circuits and then treats mathematical modeling of operational amplifier systems. LRCCircuit. Consider the electrical circuit shown in Figure 3–7. The circuit con- sists of an inductance L(henry), a resistance R(ohm), and a capacitance C(farad). Applying Kirchhoff’s voltage law to the system, we obtain the following equations: (3–24) (3–25) 1 C 3i dt=e o L di dt+Ri+1 C 3i dt=e i L e o R C e i i Figure 3–7 Electrical circuit. Openmirrors.comSection 3–3 / Mathematical Modeling of Electrical Systems 73Equations (3–24) and (3–25) give a mathematical model of the circuit. A transfer-function model of the circuit can also be obtained as follows: Taking the Laplace transforms of Equations (3–24) and (3–25), assuming zero initial conditions,we obtain Ife iis assumed to be the input and eothe output, then the transfer function of this system is found to be (3–26) A state-space model of the system shown in Figure 3–7 may be obtained as follows: First, note that the differential equation for the system can be obtained from Equation (3–26) as Then by defining state variables by and the input and output variables by we obtain and These two equations give a mathematical model of the system in state space. Transfer Functions of Cascaded Elements. Many feedback systems have com- ponents that load each other. Consider the system shown in Figure 3–8. Assume that ei is the input and eois the output. The capacitances C1and C2are not charged initially.y=[1 0]Bx1 x2RBx# 1 x# 2R=C0 -1 LC1 -R LSBx1 x2R+C0 1 LCSu y=eo=x1 u=ei x2=e# o x1=eoe$ o+R Le# o+1 LCeo=1 LCeiEo(s) Ei(s)=1 LCs2+RCs +1 1 C 1 s I(s) =Eo(s) LsI(s) +RI(s) +1 C 1 s I(s) =Ei(s) R1 C1eoR2 C2ei i1 i2 Figure 3–8 Electrical system.74 Chapter 3 / Mathematical Modeling of Mechanical Systems and Electrical Systems It will be shown that the second stage of the circuit ( R 2 C 2 portion) produces a loading effect on the first stage ( R 1 C 1 portion). The equations for this system are (3–27) and (3–28) (3–29) Taking the Laplace transforms of Equations (3–27) through (3–29), respectively, using zero initial conditions, we obtain (3–30) (3–31) (3–32) Eliminating I 1 (s)from Equations (3–30) and (3–31) and writing E i (s)in terms of I 2 (s), we find the transfer function between E o (s)andE i (s) to be (3–33) The term R 1 C 2 sin the denominator of the transfer function represents the interaction of two simple RCcircuits. Since the two roots of the denominator of Equation (3–33) are real. The present analysis shows that, if two RCcircuits are connected in cascade so that the output from the first circuit is the input to the second, the overall transfer function is not the product of and The reason for this is that, when we derive the transfer function for an isolated circuit, we implicitly as- sume that the output is unloaded. In other words, the load impedance is assumed to be infinite, which means that no power is being withdrawn at the output.When the sec- ond circuit is connected to the output of the first, however, a certain amount of power is withdrawn, and thus the assumption of no loading is violated.Therefore, if the trans- fer function of this system is obtained under the assumption of no loading, then it is not valid. The degree of the loading effect determines the amount of modification of the transfer function.1/H20862AR 2 C 2 s+1B. 1/H20862AR 1 C 1 s+1BAR 1 C 1 +R 2 C 2 +R 1 C 2 B 2 74R 1 C 1 R 2 C 2 , =1 R 1 C 1 R 2 C 2 s 2 +AR 1 C 1 +R 2 C 2 +R 1 C 2 Bs+1 E o (s) E i (s)=1 AR 1 C 1 s+1BAR 2 C 2 s+1B+R 1 C 2 s 1 C 2 s I 2 (s)=E o (s) 1 C 1 sCI 2 (s)-I 1 (s)D+R 2 I 2 (s)+1 C 2 s I 2 (s)=0 1 C 1 sCI 1 (s)-I 2 (s)D+R 1 I 1 (s)=E i (s) 1 C 2 3i 2 dt=e o 1 C 1 3Ai 2 -i 1 Bdt+R 2 i 2 +1 C 2 3i 2 dt=01 C 1 3Ai 1 -i 2 Bdt+R 1 i 1 =e i Openmirrors.comOpenmirrors.comSection 3–3 / Mathematical Modeling of Electrical Systems 75Complex Impedances. In deriving transfer functions for electrical circuits, we frequently find it convenient to write the Laplace-transformed equations directly,without writing the differential equations. Consider the system shown in Figure 3–9(a).In this system, Z 1and Z2represent complex impedances. The complex impedance Z(s) of a two-terminal circuit is the ratio of E(s) , the Laplace transform of the voltage across the terminals, to I(s), the Laplace transform of the current through the element, under the assumption that the initial conditions are zero, so thatZ(s)=E(s)/I(s). If the two-terminal element is a resistance R, capacitance C,o r inductance L, then the complex impedance is given by R,1/Cs , or Ls, respectively. If complex impedances are connected in series, the total impedance is the sum of theindividual complex impedances. Remember that the impedance approach is valid only if the initial conditions involved are all zeros. Since the transfer function requires zero initial conditions, theimpedance approach can be applied to obtain the transfer function of the electricalcircuit. This approach greatly simplifies the derivation of transfer functions of elec-trical circuits. Consider the circuit shown in Figure 3–9(b).Assume that the voltages e iandeoare the input and output of the circuit, respectively. Then the transfer function of thiscircuit is For the system shown in Figure 3–7, Hence the transfer function E o(s)/Ei(s)can be found as follows: which is, of course, identical to Equation (3–26).Eo(s) Ei(s)=1 Cs Ls+R+1 Cs=1 LCs2+RCs +1Z1=Ls+R, Z2=1 CsEo(s) Ei(s)=Z2(s) Z1(s)+Z2(s) i i i e2 ee1eo eiZ1Z1 Z2Z2 (a) (b)Figure 3–9 Electrical circuits.76 Chapter 3 / Mathematical Modeling of Mechanical Systems and Electrical Systems EXAMPLE 3–7 Consider again the system shown in Figure 3–8. Obtain the transfer function E o (s)/E i (s)by use of the complex impedance approach. (Capacitors C 1 andC 2 are not charged initially.) The circuit shown in Figure 3–8 can be redrawn as that shown in Figure 3–10(a), which can be further modified to Figure 3–10(b). In the system shown in Figure 3–10(b) the current Iis divided into two currents I 1 and I 2 . Noting that we obtain Noting that we obtain Substituting Z 1 =R 1 , Z 2 =1/AC 1 sB,Z 3 =R 2 ,andZ 4 =1/AC 2 sBinto this last equation, we get which is the same as that given by Equation (3–33). =1 R 1 C 1 R 2 C 2 s 2 +AR 1 C 1 +R 2 C 2 +R 1 C 2 Bs+1 E o (s) E i (s)=1 C 1 s 1 C 2 s R 1 a 1 C 1 s+R 2 +1 C 2 s b +1 C 1 s a R 2 +1 C 2 s b E o (s) E i (s)=Z 2 Z 4 Z 1 AZ 2 +Z 3 +Z 4 B+Z 2 AZ 3 +Z 4 B E o (s)=Z 4 I 2 =Z 2 Z 4 Z 2 +Z 3 +Z 4 I E i (s)=Z 1 I+Z 2 I 1 = c Z 1 +Z 2 AZ 3 +Z 4 B Z 2 +Z 3 +Z 4 d II 1 =Z 3 +Z 4 Z 2 +Z 3 +Z 4 I, I 2 =Z 2 Z 2 +Z 3 +Z 4 IZ 2 I 1 =AZ 3 +Z 4 BI 2 , I 1 +I 2 =I Z 1 Z 3 Z 2 Z 4 Z 1 I 2 I 1 Z 2 Z 3 Z 4 I E i (s) E o (s)E o (s) E i (s) (a) (b) Figure 3–10 (a) The circuit of Figure 3–8 shown in terms of impedances; (b) equivalent circuit diagram. Openmirrors.comSection 3–3 / Mathematical Modeling of Electrical Systems 77Transfer Functions of Nonloading Cascaded Elements. The transfer function of a system consisting of two nonloading cascaded elements can be obtained by elimi-nating the intermediate input and output. For example, consider the system shown inFigure 3–11(a). The transfer functions of the elements are and If the input impedance of the second element is infinite, the output of the first element is not affected by connecting it to the second element.Then the transfer function of the wholesystem becomes The transfer function of the whole system is thus the product of the transfer functions of the individual elements. This is shown in Figure 3–11(b). As an example, consider the system shown in Figure 3–12.The insertion of an isolating amplifier between the circuits to obtain nonloading characteristics is frequently used incombining circuits. Since amplifiers have very high input impedances, an isolationamplifier inserted between the two circuits justifies the nonloading assumption. The two simple RCcircuits, isolated by an amplifier as shown in Figure 3–12, have negligible loading effects, and the transfer function of the entire circuit equals the prod-uct of the individual transfer functions. Thus, in this case, Electronic Controllers. In what follows we shall discuss electronic controllers using operational amplifiers. We begin by deriving the transfer functions of simple operational-amplifier circuits.Then we derive the transfer functions of some of the operational-amplifiercontrollers. Finally, we give operational-amplifier controllers and their transfer functions inthe form of a table.=K AR1 C1 s+1BAR2 C2 s+1BEo(s) Ei(s)=a1 R1 C1 s+1b(K)a1 R2 C2 s+1bG(s) =X3(s) X1(s)=X2(s)X3(s) X1(s)X2(s)=G1(s)G2(s)G2(s)=X3(s) X2(s)G1(s)=X2(s) X1(s)X1(s) G1(s)X2(s) X3(s) G2(s) (a) (b)X3(s) X1(s) G1(s)G2(s) Figure 3–11 (a) System consisting of two nonloading cascaded elements; (b) an equivalent system. R1 C1 eoR2 C2 eiIsolating amplifier (gain K) Figure 3–12 Electrical system.78 Chapter 3 / Mathematical Modeling of Mechanical Systems and Electrical Systems Operational Amplifiers. Operational amplifiers, often called op amps, are frequently used to amplify signals in sensor circuits. Op amps are also frequently used in filters used for compensation purposes. Figure 3–13 shows an op amp. It is a common practice to choose the ground as 0 volt and measure the input voltages e 1 ande 2 relative to the ground. The input e 1 to the minus terminal of the amplifier is inverted, and the input e 2 to the plus terminal is not inverted.The total input to the amplifier thus becomes e 2 -e 1 .Hence, for the circuit shown in Figure 3–13, we have where the inputs e 1 and e 2 may be dc or ac signals and Kis the differential gain (volt- age gain). The magnitude of Kis approximately 10 5 ~10 6 for dc signals and ac signals with frequencies less than approximately 10 Hz. (The differential gain Kdecreases with the signal frequency and becomes about unity for frequencies of 1 MHz ~50 MHz.) Note that the op amp amplifies the difference in voltages e 1 ande 2 .Such an amplifier is commonly called a differential amplifier. Since the gain of the op amp is very high, it is necessary to have a negative feedback from the output to the input to make the ampli- fier stable. (The feedback is made from the output to the inverted input so that the feed- back is a negative feedback.) In the ideal op amp, no current flows into the input terminals, and the output volt- age is not affected by the load connected to the output terminal. In other words, the input impedance is infinity and the output impedance is zero. In an actual op amp, a very small (almost negligible) current flows into an input terminal and the output can- not be loaded too much. In our analysis here, we make the assumption that the op amps are ideal. Inverting Amplifier. Consider the operational-amplifier circuit shown in Figure 3–14. Let us obtain the output voltage e o .e o =KAe 2 -e 1 B=-KAe 1 -e 2 B e i e o R 2 i 2 R 1 i 1 +– e9 Figure 3–14 Inverting amplifier. e 2 e 1 e o +– Figure 3–13 Operational amplifier. Openmirrors.comSection 3–3 / Mathematical Modeling of Electrical Systems 79The equation for this circuit can be obtained as follows: Define Since only a negligible current flows into the amplifier, the current i1must be equal to current i2.Thus Since and e¿must be almost zero, or Hence we have or Thus the circuit shown is an inverting amplifier. If R1=R2,then the op-amp circuit shown acts as a sign inverter. Noninverting Amplifier. Figure 3–15(a) shows a noninverting amplifier.A circuit equivalent to this one is shown in Figure 3–15(b). For the circuit of Figure 3–15(b), wehave where Kis the differential gain of the amplifier. From this last equation, we get Since if then This equation gives the output voltage e o.Since eoandeihave the same signs, the op-amp circuit shown in Figure 3–15(a) is noninverting.eo=a1+R2 R1beiR1/H20862AR1+R2B/H112711/H20862K, K/H112711,ei=aR1 R1+R2+1 Kbeoeo=Kaei-R1 R1+R2eobeo=-R2 R1eiei R1=-eo R2e¿/H112160. K /H11271 1, K(0 -e¿)=e0ei-e¿ R1=e¿-eo R2i1=ei-e¿ R1, i2=e¿-eo R2 eoeiR2 R1 +– eoeiR2 R1–+ (b) (a)Figure 3–15 (a) Noninvertingoperational amplifier; (b) equivalentcircuit.80 Chapter 3 / Mathematical Modeling of Mechanical Systems and Electrical Systems EXAMPLE 3–8 Figure 3–16 shows an electrical circuit involving an operational amplifier. Obtain the output e o . Let us define Noting that the current flowing into the amplifier is negligible, we have Hence Since we have Taking the Laplace transform of this last equation, assuming the zero initial condition, we have which can be written as The op-amp circuit shown in Figure 3–16 is a first-order lag circuit. (Several other circuits involving op amps are shown in Table 3–1 together with their transfer functions. Table 3–1 is given on page 85.)E o (s) E i (s)=-R 2 R 1 1 R 2 Cs+1E i (s) R 1 =-R 2 Cs+1 R 2 E o (s)e i R 1 =-Cde o dt-e o R 2 e¿/H112160,e i -e¿ R 1 =CdAe¿-e o B dt+e¿-e o R 2 i 1 =i 2 +i 3 i 1 =e i -e¿ R 1 , i 2 =CdAe¿-e o B dt, i 3 =e¿-e o R 2 e i e o R 2 R 1 C i 1 i 3 i 2 +– e9 Figure 3–16 First-order lag circuit using operational amplifier. Openmirrors.comSection 3–3 / Mathematical Modeling of Electrical Systems 81Impedance Approach to Obtaining Transfer Functions. Consider the op-amp circuit shown in Figure 3–17. Similar to the case of electrical circuits we discussed ear-lier, the impedance approach can be applied to op-amp circuits to obtain their transferfunctions. For the circuit shown in Figure 3–17, we have Since we have (3–34)E o(s) Ei(s)=-Z2(s) Z1(s)E¿(s)/H112160,Ei(s)-E¿(s) Z1=E¿(s)-Eo(s) Z2+– Eo(s)I(s) I(s) Ei(s)E9(s)Z1(s)Z2(s) Figure 3–17 Operational-amplifier circuit. EXAMPLE 3–9 Referring to the op-amp circuit shown in Figure 3–16, obtain the transfer function Eo(s)/Ei(s)by use of the impedance approach. The complex impedances Z1(s)andZ2(s)for this circuit are and The transfer function Eo(s)/Ei(s)is, therefore, obtained as which is, of course, the same as that obtained in Example 3-8.Eo(s) Ei(s)=-Z2(s) Z1(s)=-R2 R11 R2 Cs+1Z2(s)=1 Cs+1 R2=R2 R2 Cs+1Z1(s)=R182 Chapter 3 / Mathematical Modeling of Mechanical Systems and Electrical Systems Lead or Lag Networks Using Operational Amplifiers. Figure 3–18(a) shows an electronic circuit using an operational amplifier. The transfer function for this circuit can be obtained as follows: Define the input impedance and feedback impedance as Z 1 andZ 2 ,respectively. Then Hence, referring to Equation (3–34), we have (3–35) Notice that the transfer function in Equation (3–35) contains a minus sign.Thus, this circuit is sign inverting. If such a sign inversion is not convenient in the actual application, a sign inverter may be connected to either the input or the output of the circuit of Figure 3–18(a). An example is shown in Figure 3–18(b). The sign inverter has the transfer function of The sign inverter has the gain of Hence the network shown in Figure 3–18(b) has the following transfer function: (3–36) =K c aTs+1 aTs+1=K c s+1 T s+1 aTE o (s) E i (s)=R 2 R 4 R 1 R 3 R 1 C 1 s+1 R 2 C 2 s+1=R 4 C 1 R 3 C 2 s+1 R 1 C 1 s+1 R 2 C 2 -R 4 /H20862R 3 .E o (s) E(s)=-R 4 R 3 E(s) E i (s)=-Z 2 Z 1 =-R 2 R 1 R 1 C 1 s+1 R 2 C 2 s+1=-C 1 C 2 s+1 R 1 C 1 s+1 R 2 C 2 Z 1 =R 1 R 1 C 1 s+1 , Z 2 =R 2 R 2 C 2 s+1 +– +– +– (a) (b)Z 1 C 1 Z 2 C 2 R 2 i 2 i 1 R 1 E i (s)E9(s) E(s)C 1 C 2 E i (s) E o (s) E(s)R 1 R 2 R 3 R 4 Lead or lag network Sign inverter Figure 3–18 (a) Operational-amplifier circuit; (b) operational-amplifier circuit used as a lead or lag compensator. Openmirrors.comwhere Notice that This network has a dc gain of Note that this network, whose transfer function is given by Equation (3–36), is a lead network if or a<1. It is a lag network if PID Controller Using Operational Amplifiers. Figure 3–19 shows an electronic proportional-plus-integral-plus-derivative controller (a PID controller) using opera-tional amplifiers. The transfer function is given by where Thus Noting that E o(s) E(s)=-R4 R3E(s) Ei(s)=-aR2 C2 s+1 C2 sbaR1 C1 s+1 R1bZ1=R1 R1 C1s+1, Z2=R2 C2s+1 C2sE(s) Ei(s)=-Z2 Z1E(s) /H20862Ei(s)R1 C16R2 C2 . R1 C17R2 C2 ,Kc a=R2 R4/H20862AR1 R3B.Kc a=R4 C1 R3 C2R2 C2 R1 C1=R2 R4 R1 R3, a=R2 C2 R1 C1T=R1 C1 , aT=R2 C2 , Kc=R4 C1 R3 C2 Section 3–3 / Mathematical Modeling of Electrical Systems 83+ +– –Z1 C1Z2 C2 R2 R1 Ei(s) Eo(s)E(s)R3R4 Figure 3–19 Electronic PIDcontroller.84 Chapter 3 / Mathematical Modeling of Mechanical Systems and Electrical Systems we have (3–37) Notice that the second operational-amplifier circuit acts as a sign inverter as well as a gain adjuster. When a PID controller is expressed as K p is called the proportional gain, is called the integral time, and is called the derivative time. From Equation (3–37) we obtain the proportional gain K p ,integral time and derivative time to be When a PID controller is expressed as K p is called the proportional gain, K i is called the integral gain, and K d is called the derivative gain. For this controller Table 3–1 shows a list of operational-amplifier circuits that may be used as con- trollers or compensators.K d =R 4 R 2 C 1 R 3 K i =R 4 R 3 R 1 C 2 K p =R 4 AR 1 C 1 +R 2 C 2 B R 3 R 1 C 2 E o (s) E i (s)=K p +K i s+K d s T d =R 1 C 1 R 2 C 2 R 1 C 1 +R 2 C 2 T i =1 R 1 C 1 +R 2 C 2 K p =R 4 AR 1 C 1 +R 2 C 2 B R 3 R 1 C 2 T d T i ,T d T i E o (s) E i (s)=K p a 1+T i s+T d s b =R 4 AR 1 C 1 +R 2 C 2 B R 3 R 1 C 2 c 1+1 AR 1 C 1 +R 2 C 2 Bs+R 1 C 1 R 2 C 2 R 1 C 1 +R 2 C 2 s d =R 4 R 2 R 3 R 1 a R 1 C 1 +R 2 C 2 R 2 C 2 +1 R 2 C 2 s+R 1 C 1 s b E o (s) E i (s)=E o (s) E(s)E(s) E i (s)=R 4 R 2 R 3 R 1 AR 1 C 1 s+1BAR 2 C 2 s+1B R 2 C 2 s Openmirrors.comSection 3–3 / Mathematical Modeling of Electrical Systems 851 2 3 4 5 6 7P I PD PI PID Lead or lag Lag–leadControl ActionOperational-Amplifier Circuits G(s)=Eo(s) Ei(s) R4 R3R2 R1 1 R1C2sR4 R3 R4 R3R2 R1(R1C1s+ 1) R4 R3R2 R1R2C2s+ 1 R2C2s R4 R3R2 R1(R1C1s+ 1) (R2C2s+ 1) R2C2s R4 R3R2 R1R1C1s+ 1 R2C2s+ 1 R6 R5R4 R3[(R1+R3)C1s+ 1] (R2C2s+ 1) (R1C1s+ 1) [( R2+R4)C2s+ 1]eo eoei ei+– +– +– +–R1R2 R2R3R4 R1R3R4 C2 eoei+– +– R3R4 C1 R2 R1R1 eoei+– +–R3R4C2 R2 R1 eoei+– +–R3R4 C2 C1 R2 R1 eoei+– +– R3R4C2C1 R4R2 R1 R3 eoei+– +– R5R6C2C1Table 3–1 Operational-Amplifier Circuits That May Be Used as Compensators86 Chapter 3 / Mathematical Modeling of Mechanical Systems and Electrical Systems EXAMPLE PROBLEMS AND SOLUTIONS A–3–1. Figure 3–20(a) shows a schematic diagram of an automobile suspension system.As the car moves along the road, the vertical displacements at the tires act as the motion excitation to the auto- mobile suspension system.The motion of this system consists of a translational motion of the cen- ter of mass and a rotational motion about the center of mass. Mathematical modeling of the complete system is quite complicated. A very simplified version of the suspension system is shown in Figure 3–20(b).Assuming that the motion x i at point Pis the input to the system and the vertical motion x o of the body is the output, obtain the transfer function (Consider the motion of the body only in the ver- tical direction.) Displacement x o is measured from the equilibrium position in the absence of input x i . Solution. The equation of motion for the system shown in Figure 3–20(b) is or Taking the Laplace transform of this last equation, assuming zero initial conditions, we obtain Hence the transfer function X o (s)/X i (s)is given by X o (s) X i (s)=bs+k ms 2 +bs+kAms 2 +bs+kBX o (s)=(bs+k)X i (s)mx$ o +bx# o +kx o =bx i #+kx i mx$ o +bAx# o -x# i B+kAx o -x i B=0X o (s) /H20862X i (s). (a)k (b)x i Center of mass Auto bodyb Px o m Figure 3–20 (a) Automobile suspension system; (b) simplified suspension system. Openmirrors.comExample Problems and Solutions 87A–3–2. Obtain the transfer function Y(s)/U(s) of the system shown in Figure 3–21. The input uis a displacement input. (Like the system of Problem A–3–1 , this is also a simplified version of an automobile or motorcycle suspension system.) Solution. Assume that displacements xand yare measured from respective steady-state positions in the absence of the input u.Applying the Newton’s second law to this system, we obtain Hence, we have Taking Laplace transforms of these two equations, assuming zero initial conditions, we obtain Eliminating X(s) from the last two equations, we have which yields Y(s) U(s)=k1Abs+k2B m1 m2 s4+Am1+m2Bbs3+Ck1 m2+Am1+m2Bk2Ds2+k1 bs+k1 k2Am1 s2+bs+k1+k2Bm2 s2+bs+k2 bs+k2Y(s) =Abs+k2BY(s) +k1 U(s)Cm2 s2+bs+k2DY(s) =Abs+k2BX(s)Cm1 s2+bs+Ak1+k2BDX(s) =Abs+k2BY(s) +k1 U(s)m2 y$+by#+k2 y=bx#+k2 xm1 x$+bx#+Ak1+k2Bx=by#+k2 y+k1 u m2 y$=-k2(y-x)-b(y#-x#) m1 x$=k2(y-x)+b(y#-x#)+k1(u-x) y b x um2 m1k2 k1 Figure 3–21 Suspension system.88 Chapter 3 / Mathematical Modeling of Mechanical Systems and Electrical Systems A–3–3. Obtain a state-space representation of the system shown in Figure 3–22. Solution. The system equations are The output variables for this system are y 1 andy 2 .Define state variables as Then we obtain the following equations: Hence, the state equation is and the output equation is A–3–4. Obtain the transfer function X o (s)/X i (s)of the mechanical system shown in Figure 3–23(a). Also obtain the transfer function E o (s)/E i (s)of the electrical system shown in Figure 3–23(b). Show that these transfer functions of the two systems are of identical form and thus they are analogous systems. B y 1 y 2 R = B 1 00 00 10 0 RD x 1 x 2 x 3 x 4 TD x# 1 x# 2 x# 3 x# 4 T = F 0 -k m 1 0 k m 2 1 -b m 1 0 00 k m 1 0 -k m 2 0 0 1 0 VD x 1 x 2 x 3 x 4 T + E 0 0 0 1 m 2 U ux# 4 =1 m 2 C-kAy 2 -y 1 B+uD=k m 2 x 1 -k m 2 x 3 +1 m 2 ux# 3 =x 4 x# 2 =1 m 1 C-by# 1 -kAy 1 -y 2 BD=-k m 1 x 1 -b m 1 x 2 +k m 1 x 3 x# 1 =x 2 x 4 =y# 2 x 3 =y 2 x 2 =y# 1 x 1 =y 1 m 2 y$ 2 +kAy 2 -y 1 B=u m 1 y$ 1 +by# 1 +kAy 1 -y 2 B=0 m 1 m 2 ky 1 b u y 2 Figure 3–22 Mechanical system. Openmirrors.comExample Problems and Solutions 89Solution. In Figure 3–23(a) we assume that displacements xi, xo,andyare measured from their respective steady-state positions.Then the equations of motion for the mechanical system shown in Figure 3–23(a) are By taking the Laplace transforms of these two equations, assuming zero initial conditions, we have If we eliminate Y(s) from the last two equations, then we obtain or Hence the transfer function Xo(s)/Xi(s)can be obtained as For the electrical system shown in Figure 3–23(b), the transfer function Eo(s)/Ei(s)is found to be =AR1 C1 s+1BAR2 C2 s+1B AR1 C1 s+1BAR2 C2 s+1B+R2 C1 sEo(s) Ei(s)=R1+1 C1 s 1 A1/H20862R2B+C2 s+R1+1 C1 sXo(s) Xi(s)=ab1 k1s+1bab2 k2s+1b ab1 k1s+1bab2 k2s+1b+b2 k1sAb1 s+k1BXi(s)=ab1 s+k1+b2 s-b2 sb2 s b2 s+k2bXo(s)b1CsXi(s)-sXo(s)D+k1CXi(s)-Xo(s)D=b2 sXo(s)-b2 sb2 sXo(s) b2 s+k2b2CsXo(s)-sY(s)D=k2 Y(s)b1CsXi(s)-sXo(s)D+k1CXi(s)-Xo(s)D=b2CsXo(s)-sY(s)Db2Ax# o-y#B=k2 yb1Ax# i-x# oB+k1Axi-xoB=b2Ax# o-y#B(a) (b)xi xo y k2k1 b2b1R2 R1 eo eiC2 C1 Figure 3–23 (a) Mechanicalsystem; (b) analogous electrical system.90 Chapter 3 / Mathematical Modeling of Mechanical Systems and Electrical Systems A comparison of the transfer functions shows that the systems shown in Figures 3–23(a) and (b) are analogous. A–3–5. Obtain the transfer functions E o (s)/E i (s)of the bridged T networks shown in Figures 3–24(a) and (b). Solution. The bridged Tnetworks shown can both be represented by the network of Figure 3–25(a), where we used complex impedances.This network may be modified to that shown in Figure 3–25(b). In Figure 3–25(b), note that I 1 =I 2 +I 3 , I 2 Z 1 =AZ 3 +Z 4 BI 3 RR C 1 CCC 2 e i e o (a) R 1 R 2 e i e o (b) Figure 3–24 Bridged Tnetworks. Z 1 Z 4 Z 3 Z 2 Z 1 E i (s) Z 4 Z 3 Z 2 I 3 I 2 I 1 I 1 I 3 I 3 I 2 I 1 I 1 e i e o E o (s) (a) (b) Figure 3–25 (a) Bridged T network in terms of complex impedances; (b) equivalent network. Openmirrors.comExample Problems and Solutions 91Hence Then the voltages Ei(s)andEo(s)can be obtained as Hence, the transfer function Eo(s)/Ei(s)of the network shown in Figure 3–25(a) is obtained as (3–38) For the bridged T network shown in Figure 3–24(a), substitute into Equation (3–38). Then we obtain the transfer function Eo(s)/Ei(s)to be Similarly, for the bridged T network shown in Figure 3–24(b), we substitute into Equation (3–38). Then the transfer function Eo(s)/Ei(s)can be obtained as follows: =R1 CR2 Cs2+2R1 Cs+1 R1 CR2 Cs2+A2R1 C+R2 CBs+1Eo(s) Ei(s)=1 Cs1 Cs+R1a1 Cs+1 Cs+R2b R1a1 Cs+1 Cs+R2b+1 Cs1 Cs+R21 CsZ1=1 Cs, Z2=R1 , Z3=1 Cs, Z4=R2=RC1 RC2 s2+2RC2 s+1 RC1 RC2 s2+A2RC2+RC1Bs+1Eo(s) Ei(s)=R2+1 C1 saR+R+1 C2 sb 1 C1 saR+R+1 C2 sb+R2+R1 C2 sZ1=R, Z2=1 C1 s, Z3=R, Z4=1 C2 sEo(s) Ei(s)=Z3 Z1+Z2AZ1+Z3+Z4B Z2AZ1+Z3+Z4B+Z1 Z3+Z1 Z4 =Z3 Z1+Z2AZ1+Z3+Z4B Z1+Z3+Z4 I1 =Z3 Z1 Z1+Z3+Z4 I1+Z2 I1 Eo(s)=Z3 I3+Z2 I1 =Z2AZ1+Z3+Z4B+Z1 AZ3+Z4B Z1+Z3+Z4 I1 =cZ2+Z1AZ3+Z4B Z1+Z3+Z4dI1 Ei(s)=Z1 I2+Z2 I1I2=Z3+Z4 Z1+Z3+Z4I1 , I3=Z1 Z1+Z3+Z4I192 Chapter 3 / Mathematical Modeling of Mechanical Systems and Electrical Systems A–3–6. Obtain the transfer function of the op-amp circuit shown in Figure 3–26. Solution. The voltage at point Ais The Laplace-transformed version of this last equation is The voltage at point Bis Since and we must have Thus Hence A–3–7. Obtain the transfer function E o (s)/E i (s)of the op-amp system shown in Figure 3–27 in terms of complex impedances Z 1 ,Z 2 ,Z 3 , and Z 4 . Using the equation derived, obtain the transfer function E o (s)/E i (s)of the op-amp system shown in Figure 3–26. Solution. From Figure 3–27, we find E i (s)-E A (s) Z 3 =E A (s)-E o (s) Z 4 E o (s) E i (s)=-R 2 Cs-1 R 2 Cs+1=-s-1 R 2 C s+1 R 2 C1 2CE i (s)+E o (s)D=1 R 2 Cs+1E i (s)E A (s)=E B (s). K/H112711, CE B (s)-E A (s)DK=E o (s)E B (s)=1 Cs R 2 +1 CsE i (s)=1 R 2 Cs+1E i (s)E A (s)=1 2CE i (s)+E o (s)De A =1 2Ae i -e o B+e o E o (s) /H20862E i (s) – + CA BR 1 R 1 R 2 e i e o Figure 3–26 Operational- amplifier circuit. Openmirrors.comExample Problems and Solutions 93or (3–39) Since (3–40) by substituting Equation (3–40) into Equation (3–39), we obtain from which we get the transfer function Eo(s)/Ei(s)to be (3–41) To find the transfer function Eo(s)/Ei(s)of the circuit shown in Figure 3–26, we substitute into Equation (3–41). The result is which is, as a matter of course, the same as that obtained in Problem A–3–6 .Eo(s) Ei(s)=-R1 R2-R11 Cs R1a1 Cs+R2b=-R2 Cs-1 R2 Cs+1Z1=1 Cs , Z2=R2 , Z3=R1 , Z4=R1Eo(s) Ei(s)=-Z4 Z2-Z3 Z1 Z3AZ1+Z2BcZ4 Z1+Z4 Z2-Z4 Z1-Z3 Z1 Z4AZ1+Z2BdEi(s)=-Z3 Z4Eo(s)EA(s)=EB(s)=Z1 Z1+Z2Ei(s)Ei(s)-a1+Z3 Z4bEA(s)=-Z3 Z4Eo(s)A B eo eiZ3 Z1Z2Z4 – + Figure 3–27 Operational-amplifier circuit.94 Chapter 3 / Mathematical Modeling of Mechanical Systems and Electrical Systems A–3–8. Obtain the transfer function of the operational-amplifier circuit shown in Figure 3–28. Solution. We will first obtain currents i 1 ,i 2 ,i 3 ,i 4 , and i 5 .Then we will use node equations at nodes AandB. At node A, we have i 1 =i 2 +i 3 +i 4 ,or (3–42) At node B, we get i 4 =i 5 ,or (3–43) By rewriting Equation (3–42), we have (3–44) From Equation (3–43), we get (3–45) By substituting Equation (3–45) into Equation (3–44), we obtain Taking the Laplace transform of this last equation, assuming zero initial conditions, we obtain from which we get the transfer function as follows: E o (s) E i (s)=-1 R 1 C 1 R 2 C 2 s 2 +CR 2 C 2 +R 1 C 2 +AR 1 /H20862R 3 BR 2 C 2 Ds+AR 1 /H20862R 3 BE o (s) /H20862E i (s)-C 1 C 2 R 2 s 2 E o (s)+ a 1 R 1 +1 R 2 +1 R 3 b A-R 2 C 2 BsE o (s)-1 R 3 E o (s)=E i (s) R 1 C 1 a -R 2 C 2 d 2 e o dt 2 b + a 1 R 1 +1 R 2 +1 R 3 b A-R 2 C 2 Bde o dt=e i R 1 +e o R 3 e A =-R 2 C 2 de o dtC 1 de A dt+ a 1 R 1 +1 R 2 +1 R 3 b e A =e i R 1 +e o R 3 e A R 2 =C 2 -de o dte i -e A R 1 =e A -e o R 3 +C 1 de A dt+e A R 2 i 4 =e A R 2 , i 5 =C 2 -de o dti 1 =e i -e A R 1 ; i 2 =e A -e o R 3 , i 3 =C 1 de A dtE o (s) /H20862E i (s) i 1 R 1 i 2 i 4 i 3 A C 1 e i e o R 3 i 5 C 2 BR 2 – + Figure 3–28 Operational- amplifier circuit. Openmirrors.comExample Problems and Solutions 95A–3–9. Consider the servo system shown in Figure 3–29(a).The motor shown is a servomotor, a dc motor de- signed specifically to be used in a control system.The operation of this system is as follows:A pair ofpotentiometers acts as an error-measuring device. They convert the input and output positions intoproportional electric signals. The command input signal determines the angular position rof the wiper arm of the input potentiometer.The angular position ris the reference input to the system, and the electric potential of the arm is proportional to the angular position of the arm. The output shaftposition determines the angular position cof the wiper arm of the output potentiometer.The differ- ence between the input angular position rand the output angular position cis the error signal e,o r The potential difference is the error voltage, where e ris proportional to randecis pro- portional to c; that is, and where K0is a proportionality constant. The error volt- age that appears at the potentiometer terminals is amplified by the amplifier whose gain constant is K1. The output voltage of this amplifier is applied to the armature circuit of the dc motor.A fixed volt- age is applied to the field winding. If an error exists, the motor develops a torque to rotate the out-put load in such a way as to reduce the error to zero. For constant field current, the torquedeveloped by the motor is where K 2is the motor torque constant and iais the armature current. When the armature is rotating, a voltage proportional to the product of the flux and angular velocity is induced in the armature. For a constant flux, the induced voltage ebis directly propor- tional to the angular velocity or where ebis the back emf, K3is the back emf constant of the motor, and uis the angular displace- ment of the motor shaft.eb=K3du dtdu/H20862dt,T=K2 iaec=K0 c , er=K0 rer-ec=eve=r-c (a)Reference input Input deviceInput potentiometer Output potentiometer Feedback signalerec r cc K1iaTRa La Error measuring device Amplifier Motor Gear trainLoaduK1ev ev (b) (c)Ev(s) E(s) R(s) C(s) U(s) K1K2 s(Las+Ra) (Jos+bo)+K2K3sK0 nC(s) R(s) K s(Js+B)+–+– Figure 3–29 (a) Schematic diagram of servo system; (b) block diagram for the system; (c) simplified block diagram.96 Chapter 3 / Mathematical Modeling of Mechanical Systems and Electrical Systems Obtain the transfer function between the motor shaft angular displacement uand the error voltage e v .Obtain also a block diagram for this system and a simplified block diagram when L a is negligible. Solution. The speed of an armature-controlled dc servomotor is controlled by the armature volt- agee a .(The armature voltage is the output of the amplifier.) The differential equation for the armature circuit is or (3–46) The equation for torque equilibrium is (3–47) where J 0 is the inertia of the combination of the motor, load, and gear train referred to the motor shaft and b 0 is the viscous-friction coefficient of the combination of the motor, load, and gear train referred to the motor shaft. By eliminating i a from Equations (3–46) and (3–47), we obtain (3–48) We assume that the gear ratio of the gear train is such that the output shaft rotates ntimes for each revolution of the motor shaft. Thus, (3–49) The relationship among E v (s), R(s), andC(s) is (3–50) The block diagram of this system can be constructed from Equations (3–48), (3–49), and (3–50), as shown in Figure 3–29(b). The transfer function in the feedforward path of this system is When L a is small, it can be neglected, and the transfer function G(s) in the feedforward path becomes (3–51) The term indicates that the back emf of the motor effectively increases the viscous friction of the system. The inertia J 0 and viscous friction coefficient are b 0 +AK 2 K 3 /H20862R a BCb 0 +AK 2 K 3 /H20862R a BDs =K 0 K 1 K 2 n/H20862R a J 0 s 2 + a b 0 +K 2 K 3 R a b s G(s) =K 0 K 1 K 2 n sCR a AJ 0 s+b 0 B+K 2 K 3 DG(s) =C(s) Q (s)Q (s) E v (s)E v (s) E(s)=K 0 K 1 K 2 n sCAL a s+R a BAJ 0 s+b 0 B+K 2 K 3 DE v (s)=K 0 CR(s) -C(s)D=K 0 E(s)C(s) =nQ (s)Q (s) E v (s)=K 1 K 2 sAL a s+R a BAJ 0 s+b 0 B+K 2 K 3 sJ 0 d 2 u dt 2 +b 0 du dt=T=K 2 i a L a di a dt+R a i a +K 3 du dt=K 1 e v L a di a dt+R a i a +e b =e a e a =K 1 e v Openmirrors.comProblems 97referred to the motor shaft. When J0and are multiplied by 1/n2,the inertia and viscous-friction coefficient are expressed in terms of the output shaft. Introducing new parameters defined by moment of inertia referred to the output shaft viscous-friction coefficient referred to the output shaft the transfer function G(s) given by Equation (3–51) can be simplified, yielding or where The block diagram of the system shown in Figure 3–29(b) can thus be simplified as shown in Figure 3–29(c).Km=K B, Tm=J B=Ra J0 Ra b0+K2 K3 G(s) =Km sATm s+1B G(s) =K Js2+Bs K=K0 K1 K2/H20862nRa B=Cb0+AK2 K3/H20862RaBD/H20862n2= J=J0/H20862n2=b0+AK2 K3/H20862RaB PROBLEMS B–3–1. Obtain the equivalent viscous-friction coefficient beqof the system shown in Figure 3–30.B–3–2. Obtain mathematical models of the mechanical sys- tems shown in Figures 3–31(a) and (b). xb3 yb2 b1 mk (a)No frictionx (Output) u(t) (Input force) m (b)No frictionx (Output) u(t) (Input force)k1 k2 Figure 3–31 Mechanical systems.Figure 3–30 Damper system.98 Chapter 3 / Mathematical Modeling of Mechanical Systems and Electrical Systems y 1 y 2 u 1 m 2 b 1 u 2 k 2 k 1 m 1 Figure 3–32 Mechanical system.B–3–3. Obtain a state-space representation of the mechan- ical system shown in Figure 3–32, where u 1 and u 2 are the inputs and y 1 andy 2 are the outputs. B–3–4. Consider the spring-loaded pendulum system shown in Figure 3–33. Assume that the spring force acting on the pendulum is zero when the pendulum is vertical, or u=0. Assume also that the friction involved is negligible and the angle of oscillation uis small. Obtain a mathematical model of the system. kka /H5129 mgu Figure 3–33 Spring-loaded pendulum system. B–3–5. Referring to Examples 3–5 and 3–6, consider the inverted-pendulum system shown in Figure 3–34. Assume that the mass of the inverted pendulum is mand is evenly distributed along the length of the rod. (The center of gravity of the pendulum is located at the center of the rod.) Assuming that uis small, derive mathematical models for the system in the forms of differential equations, transfer functions, and state-space equations. M y x uG O/H5129 /H5129x/H11032y/H11032 xu Figure 3–34 Inverted-pendulum system. B–3–6. Obtain the transfer functions X 1 (s)/U(s) and X 2 (s)/U(s) of the mechanical system shown in Figure 3–35. m 1 m 2 k 3 k 1 x 1 x 2 u b 1 k 2 b 2 Figure 3–35 Mechanical system. B–3–7. Obtain the transfer function E o (s)/E i (s)of the elec- trical circuit shown in Figure 3–36. R 1 e o R 2 C L e i i 1 i 2 Figure 3–36 Electrical circuit. B–3–8. Consider the electrical circuit shown in Figure 3–37. Obtain the transfer function E o (s)/E i (s)by use of the block diagram approach. R 1 C 1 e o R 2 C 2 e i i 1 i 2 Figure 3–37 Electrical circuit. Openmirrors.comProblems 99B–3–9. Derive the transfer function of the electrical circuit shown in Figure 3–38. Draw a schematic diagram of ananalogous mechanical system. R1C1 R2 C2eo ei Figure 3–38 Electrical circuit. +–CAR1R2 eieo Figure 3–39 Operational-amplifier circuit.B–3–10. Obtain the transfer function of the op-amp circuit shown in Figure 3–39.Eo(s) /H20862Ei(s)+ –CA B R1R2 R3ei eo Figure 3–40 Operational-amplifier circuit. B–3–11. Obtain the transfer function of the op-amp circuit shown in Figure 3–40.Eo(s) /H20862Ei(s)B–3–12. Using the impedance approach, obtain the trans- fer function of the op-amp circuit shown in Figure 3–41.Eo(s) /H20862Ei(s) +– CA BR1R1 R2eieo Figure 3–41 Operational-amplifier circuit. B–3–13. Consider the system shown in Figure 3–42. An armature-controlled dc servomotor drives a load consistingof the moment of inertia J L. The torque developed by the motor is T. The moment of inertia of the motor rotor is Jm. The angular displacements of the motor rotor and the load element are umandu, respectively. The gear ratio is Obtain the transfer function Q (s) /H20862Ei(s). n=u/H20862um . L R T nei Jm JLum u Figure 3–42 Armature-controlled dc servomotor system.4 100 Mathematical Modeling of Fluid Systems and Thermal Systems 4–1 INTRODUCTION This chapter treats mathematical modeling of fluid systems and thermal systems.As the most versatile medium for transmitting signals and power, fluids—liquids and gases— have wide usage in industry. Liquids and gases can be distinguished basically by their rel- ative incompressibilities and the fact that a liquid may have a free surface, whereas a gas expands to fill its vessel. In the engineering field the term pneumatic describes fluid systems that use air or gases and hydraulic applies to those using oil. We first discuss liquid-level systems that are frequently used in process control. Here we introduce the concepts of resistance and capacitance to describe the dynamics of such systems. Then we treat pneumatic systems. Such systems are extensively used in the au- tomation of production machinery and in the field of automatic controllers. For instance, pneumatic circuits that convert the energy of compressed air into mechanical energy enjoy wide usage.Also, various types of pneumatic controllers are widely used in industry. Next, we present hydraulic servo systems.These are widely used in machine tool systems, aircraft control systems, etc. We discuss basic aspects of hydraulic servo systems and hydraulic controllers. Both pneumatic systems and hydraulic systems can be modeled easily by using the concepts of resistance and capacitance. Finally, we treat simple thermal systems. Such systems involve heat transfer from one substance to another. Mathematical models of such systems can be obtained by using thermal resistance and thermal capacitance. Outline of the Chapter. Section 4–1 has presented introductory material for the chapter. Section 4–2 discusses liquid-level systems. Section 4–3 treats pneumatic systems—in particular, the basic principles of pneumatic controllers. Section 4–4 first discusses hydraulic servo systems and then presents hydraulic controllers. Finally, Section 4–5 analyzes thermal systems and obtains mathematical models of such systems. Openmirrors.comSection 4–2 / Liquid-Level Systems 1014–2 LIQUID-LEVEL SYSTEMS In analyzing systems involving fluid flow, we find it necessary to divide flow regimes into laminar flow and turbulent flow, according to the magnitude of the Reynolds num-ber. If the Reynolds number is greater than about 3000 to 4000, then the flow is turbu-lent. The flow is laminar if the Reynolds number is less than about 2000. In the laminarcase, fluid flow occurs in streamlines with no turbulence. Systems involving laminar flowmay be represented by linear differential equations. Industrial processes often involve flow of liquids through connecting pipes and tanks. The flow in such processes is often turbulent and not laminar. Systems involving turbu-lent flow often have to be represented by nonlinear differential equations. If the regionof operation is limited, however, such nonlinear differential equations can be linearized.We shall discuss such linearized mathematical models of liquid-level systems in this sec-tion. Note that the introduction of concepts of resistance and capacitance for such liquid-level systems enables us to describe their dynamic characteristics in simple forms. Resistance and Capacitance of Liquid-Level Systems. Consider the flow through a short pipe connecting two tanks. The resistance Rfor liquid flow in such a pipe or restriction is defined as the change in the level difference (the difference of theliquid levels of the two tanks) necessary to cause a unit change in flow rate; that is, Since the relationship between the flow rate and level difference differs for the laminar flow and turbulent flow, we shall consider both cases in the following. Consider the liquid-level system shown in Figure 4–1(a). In this system the liquid spouts through the load valve in the side of the tank. If the flow through this restrictionis laminar, the relationship between the steady-state flow rate and steady-state head atthe level of the restriction is given by Q=KHR=change in level difference, m change in flow rate, m3/H20862sec Control valve Q+qoQ+qi H+hLoad valve Capacitance CResistance R (b) (a)Head H –H0h P q QFlow ratetan–1Rt Slope = =2H Qh qFigure 4–1 (a) Liquid-level system; (b) head-versus-flow-ratecurve.102 Chapter 4 / Mathematical Modeling of Fluid Systems and Thermal Systems where steady-state liquid flow rate, m 3 /H20862sec coefficient, m 2 /H20862sec steady-state head, m For laminar flow, the resistance R l is obtained as The laminar-flow resistance is constant and is analogous to the electrical resistance. If the flow through the restriction is turbulent, the steady-state flow rate is given by (4–1) where steady-state liquid flow rate, m 3 /H20862sec coefficient, m 2.5 /H20862sec steady-state head, m The resistance R t for turbulent flow is obtained from Since from Equation (4–1) we obtain we have Thus, The value of the turbulent-flow resistance R t depends on the flow rate and the head.The value of R t , however, may be considered constant if the changes in head and flow rate are small. By use of the turbulent-flow resistance, the relationship between Qand Hcan be given by Such linearization is valid, provided that changes in the head and flow rate from their respective steady-state values are small. In many practical cases, the value of the coefficient Kin Equation (4–1), which depends on the flow coefficient and the area of restriction, is not known. Then the resistance may be determined by plotting the head-versus-flow-rate curve based on experimental data and m easuring the slope of the curve at the operating condition.An example of such a plot is shown in Figure 4–1(b). In the figure, point Pis the steady-state operating point.The tan- gent line to the curve at point Pintersects the ordinate at point Thus, the slope of this tangent line is Since the resistance R t at the operating point Pis given by the resistance R t is the slope of the curve at the operating point. 2H–/H20862Q–,2H–/H20862Q–.A0,-H–B.Q=2H R t R t =2H QdH dQ=21H K=21H 1H Q=2H QdQ=K 21H dHR t =dH dQH=K=Q=Q=K1H R l =dH dQ=H Q H= K= Q= Openmirrors.comSection 4–2 / Liquid-Level Systems 103Consider the operating condition in the neighborhood of point P. Define a small deviation of the head from the steady-state value as hand the corresponding small change of the flow rate as q. Then the slope of the curve at point Pcan be given by The linear approximation is based on the fact that the actual curve does not differ much from its tangent line if the operating condition does not vary too much. The capacitance Cof a tank is defined to be the change in quantity of stored liquid necessary to cause a unit change in the potential (head). (The potential is the quantitythat indicates the energy level of the system.) It should be noted that the capacity (m 3) and the capacitance (m2) are different. The capacitance of the tank is equal to its cross-sectional area. If this is constant, the capac-itance is constant for any head. Liquid-Level Systems. Consider the system shown in Figure 4–1(a). The vari- ables are defined as follows: steady-state flow rate (before any change has occurred), m 3/H20862sec qi=small deviation of inflow rate from its steady-state value, m3/H20862sec qo=small deviation of outflow rate from its steady-state value, m3/H20862sec steady-state head (before any change has occurred), m h= small deviation of head from its steady-state value, m As stated previously, a system can be considered linear if the flow is laminar. Even if the flow is turbulent, the system can be linearized if changes in the variables are keptsmall. Based on the assumption that the system is either linear or linearized, the differentialequation of this system can be obtained as follows: Since the inflow minus outflow duringthe small time interval dtis equal to the additional amount stored in the tank, we see that From the definition of resistance, the relationship between q oandhis given by The differential equation for this system for a constant value of Rbecomes (4–2) Note that RCis the time constant of the system.Taking the Laplace transforms of both sides of Equation (4–2), assuming the zero initial condition, we obtain where and Qi(s)=lCqiD H(s) =l[h](RCs +1)H(s) =RQi(s)RCdh dt+h=Rqiqo=h RCdh=Aqi-qoBdtH–=Q–=C=change in liquid stored, m3 change in head, mSlope of curve at point P=h q=2H– Q–=Rt104 Chapter 4 / Mathematical Modeling of Fluid Systems and Thermal Systems Q+q Tank 1 Tank 2 H 1 +h 1 R 1 H 2 +h 2 R 2 Q+q 2 C 1 C 2 Q+q 1 Q: H 1 : H 2 : Steady-state flow rate Steady-state liquid level of tank 1 Steady-state liquid level of tank 2 Figure 4–2 Liquid-level system with interaction. Ifq i is considered the input and hthe output, the transfer function of the system is If, however, q o is taken as the output, the input being the same, then the transfer function is where we have used the relationship Liquid-Level Systems with Interaction. Consider the system shown in Figure 4–2. In this system, the two tanks interact.Thus the transfer function of the system is not the product of two first-order transfer functions. In the following, we shall assume only small variations of the variables from the steady-state values. Using the symbols as defined in Figure 4–2, we can obtain the following equations for this system: (4–3) (4–4) (4–5) (4–6) Ifqis considered the input and q 2 the output, the transfer function of the system is (4–7)Q 2 (s) Q(s)=1 R 1 C 1 R 2 C 2 s 2 +AR 1 C 1 +R 2 C 2 +R 2 C 1 Bs+1C 2 dh 2 dt=q 1 -q 2 h 2 R 2 =q 2 C 1 dh 1 dt=q-q 1 h 1 -h 2 R 1 =q 1 Q o (s)=1 RH(s)Q o (s) Q i (s)=1 RCs +1H(s) Q i (s)=R RCs +1 Openmirrors.comSection 4–2 / Liquid-Level Systems 105It is instructive to obtain Equation (4–7), the transfer function of the interacted system, by block diagram reduction. From Equations (4–3) through (4–6), we obtain theelements of the block diagram, as shown in Figure 4–3(a). By connecting signals prop-erly, we can construct a block diagram, as shown in Figure 4–3(b). This block diagramcan be simplified, as shown in Figure 4–3(c). Further simplifications result in Figures 4–3(d) and (e). Figure 4–3(e) is equivalent to Equation (4–7). (c) (d) (e)G3 (b)(a) Q(s) H1(s) H2(s)Q1(s) Q2(s) Q(s) Q1(s) Q2(s) Q(s) Q2(s) Q(s) Q2(s)1 R11 R1 1 R11 R21 R2 1 R21 C1s 1 C1s1 C2sG31 C2s G31 C2sR2C1s R2C1s1 R1C1s+ 11 R2C2s+ 1 1 R1C1R2C2s2+ (R1C1+R2C2+R2C1)s+ 1H1(s) Q1(s) H2(s) 1 C1sH2(s) Q2(s) Q(s) H1(s) Q1(s)Q1(s) H2(s) Q2(s) +–+–+–+– +–+–+– +–+–+– Figure 4–3 (a) Elements of theblock diagram of the system shown in Figure 4–2; (b) blockdiagram of thesystem; (c)–(e)successive reductions of the block diagram.106 Chapter 4 / Mathematical Modeling of Fluid Systems and Thermal Systems Notice the similarity and difference between the transfer function given by Equation (4–7) and that given by Equation (3–33). The term R 2 C 1 sthat appears in the denominator of Equation (4–7) exemplifies the interaction between the two tanks. Similarly, the term R 1 C 2 sin the denominator of Equation (3–33) represents the inter- action between the two RCcircuits shown in Figure 3–8. 4–3 PNEUMATIC SYSTEMS In industrial applications pneumatic systems and hydraulic systems are frequently compared.Therefore, before we discuss pneumatic systems in detail, we shall give a brief comparison of these two kinds of systems. Comparison Between Pneumatic Systems and Hydraulic Systems. The fluid generally found in pneumatic systems is air; in hydraulic systems it is oil. And it is pri- marily the different properties of the fluids involved that characterize the differences between the two systems. These differences can be listed as follows: 1.Air and gases are compressible, whereas oil is incompressible (except at high pressure). 2.Air lacks lubricating property and always contains water vapor. Oil functions as a hydraulic fluid as well as a lubricator. 3.The normal operating pressure of pneumatic systems is very much lower than that of hydraulic systems. 4.Output powers of pneumatic systems are considerably less than those of hydraulic systems. 5.Accuracy of pneumatic actuators is poor at low velocities, whereas accuracy of hydraulic actuators may be made satisfactory at all velocities. 6.In pneumatic systems, external leakage is permissible to a certain extent, but in- ternal leakage must be avoided because the effective pressure difference is rather small. In hydraulic systems internal leakage is permissible to a certain extent, but external leakage must be avoided. 7.No return pipes are required in pneumatic systems when air is used, whereas they are always needed in hydraulic systems. 8.Normal operating temperature for pneumatic systems is 5° to 60°C (41° to 140°F). The pneumatic system, however, can be operated in the 0° to 200°C (32° to 392°F) range. Pneumatic systems are insensitive to temperature changes, in contrast to hydraulic systems, in which fluid friction due to viscosity depends greatly on tem- perature. Normal operating temperature for hydraulic systems is 20° to 70°C (68° to 158°F). 9.Pneumatic systems are fire- and explosion-proof, whereas hydraulic systems are not, unless nonflammable liquid is used. In what follows we begin with a mathematical modeling of pneumatic systems.Then we shall present pneumatic proportional controllers. We shall first give detailed discussions of the principle by which proportional controllers operate.Then we shall treat methods for obtaining derivative and integral control actions. Throughout the discussions, we shall place emphasis on the Openmirrors.comSection 4–3 / Pneumatic Systems 107 Resistance R Capacitance C (a) (b)P+p i P+po 0 qqdqDP Slope =R d(DP) Figure 4–4 (a) Schematic diagram of a pressure system; (b) pressure- difference-versus- flow-rate curve. fundamental principles, rather than on the details of the operation of the actual mechanisms. Pneumatic Systems. The past decades have seen a great development in low- pressure pneumatic controllers for industrial control systems, and today they are used extensively in industrial processes. Reasons for their broad appeal include an explosion- proof character, simplicity, and ease of maintenance. Resistance and Capacitance of Pressure Systems. Many industrial processes and pneumatic controllers involve the flow of a gas or air through connected pipelines and pressure vessels. Consider the pressure system shown in Figure 4–4(a). The gas flow through the restriction is a function of the gas pressure difference p i -p o . Such a pressure system may be characterized in terms of a resistance and a capacitance. The gas flow resistance Rmay be defined as follows: or (4–8) where is a small change in the gas pressure difference and dqis a small change in the gas flow rate. Computation of the value of the gas flow resistance Rmay be quite time consuming. Experimentally, however, it can be easily determined from a plot of the pressure difference versus flow rate by calculating the slope of the curve at a given operating condition, as shown in Figure 4–4(b). The capacitance of the pressure vessel may be defined by or (4–9) C=dm dp=Vdr dpC=change in gas stored, lb change in gas pressure, lb f /H20862ft 2 d(¢P)R=d(¢P) dqR=change in gas pressure difference, lb f /H20862ft 2 change in gas flow rate, lb /H20862sec Openmirrors.com108 Chapter 4 / Mathematical Modeling of Fluid Systems and Thermal Systems where capacitance, lb-ft 2 /H20862lb f mass of gas in vessel, lb gas pressure, lb f /H20862ft 2 volume of vessel, ft 3 density, lb /H20862ft 3 The capacitance of the pressure system depends on the type of expansion process involved. The capacitance can be calculated by use of the ideal gas law. If the gas ex- pansion process is polytropic and the change of state of the gas is between isothermal and adiabatic, then (4–10) where n= polytropic exponent. For ideal gases, or where absolute pressure, lb f /H20862ft 2 volume occupied by 1 mole of a gas, ft 3 /H20862lb-mole universal gas constant, ft-lb f /H20862lb-mole °R absolute temperature, °R specific volume of gas, ft 3 /H20862lb molecular weight of gas per mole, lb /H20862lb-mole Thus (4–11) where R gas =gas constant, ft-lb f /H20862lb °R. The polytropic exponent nis unity for isothermal expansion. For adiabatic expansion, nis equal to the ratio of specific heats c p /H20862c v , where c p is the specific heat at constant pres- sure and c v is the specific heat at constant volume. In many practical cases, the value of nis approximately constant, and thus the capacitance may be considered constant. The value of dr/H20862dpis obtained from Equations (4–10) and (4–11). From Equation (4–10) we have or Substituting Equation (4–11) into this last equation, we get dr dp=1 nR gas Tdr dp=1 Knr n-1 =r n pnr n-1 =r pndp=Knr n-1 drpv=p r=R– MT=R gas TM=v=T=R–=v – =p=pv=R– MT pv – =R–Tp a V m b n =p r n =constant =Kr=V=p=m=C= Openmirrors.comSection 4–3 / Pneumatic Systems 109The capacitance Cis then obtained as (4–12) The capacitance of a given vessel is constant if the temperature stays constant. (In many practical cases, the polytropic exponent nis approximately 1.0 ~1.2 for gases in unin- sulated metal vessels.) Pressure Systems. Consider the system shown in Figure 4–4(a). If we assume only small deviations in the variables from their respective steady-state values, then thissystem may be considered linear. Let us define gas pressure in the vessel at steady state (before changes in pressure have occurred), lb f/H20862ft2 pi=small change in inflow gas pressure, lbf/H20862ft2 po=small change in gas pressure in the vessel, lbf/H20862ft2 V= volume of the vessel, ft3 m= mass of gas in the vessel, lb q= gas flow rate, lb /H20862sec r=density of gas, lb/ft3 For small values of piandpo, the resistance Rgiven by Equation (4–8) becomes constant and may be written as The capacitance Cis given by Equation (4–9), or Since the pressure change dpotimes the capacitance Cis equal to the gas added to the vessel during dtseconds, we obtain or which can be written as Ifpiandpoare considered the input and output, respectively, then the transfer function of the system is where RChas the dimension of time and is the time constant of the system.Po(s) Pi(s)=1 RCs +1RCdpo dt+po=piCdpo dt=pi-po RCdpo=q dtC=dm dpR=pi-po qP–=C=V nRgas T110 Chapter 4 / Mathematical Modeling of Fluid Systems and Thermal Systems Air supplyOrificeInput 0Nozzle (a) (b)Flapper To control valvePsPb PsPb Pa XX Figure 4–5 (a) Schematic diagram of a pneumatic nozzle– flapper amplifier; (b) characteristic curve relating nozzle back pressure and nozzle–flapper distance. Pneumatic Nozzle–Flapper Amplifiers. A schematic diagram of a pneumatic nozzle–flapper amplifier is shown in Figure 4–5(a). The power source for this amplifier is a supply of air at constant pressure. The nozzle–flapper amplifier converts small changes in the position of the flapper into large changes in the back pressure in the noz- zle. Thus a large power output can be controlled by the very little power that is needed to position the flapper. In Figure 4–5(a), pressurized air is fed through the orifice, and the air is ejected from the nozzle toward the flapper. Generally, the supply pressure for such a controller is 20 psig (1.4 kg f /H20862cm 2 gage). The diameter of the orifice is on the order of 0.01 in. (0.25 mm) and that of the nozzle is on the order of 0.016 in. (0.4 mm).To ensure prop- er functioning of the amplifier, the nozzle diameter must be larger than the orifice diameter. In operating this system, the flapper is positioned against the nozzle opening. The nozzle back pressure is controlled by the nozzle–flapper distance X. As the flapper approaches the nozzle, the opposition to the flow of air through the nozzle increases, with the result that the nozzle back pressure increases. If the nozzle is completely closed by the flapper, the nozzle back pressure becomes equal to the supply pressure If the flapper is moved away from the nozzle, so that the nozzle–flapper distance is wide (on the order of 0.01 in.), then there is practically no restriction to flow, and the nozzle back pressure takes on a minimum value that depends on the nozzle–flapper device. (The lowest possible pressure will be the ambient pressure ) Note that, because the air jet puts a force against the flapper, it is necessary to make the nozzle diameter as small as possible. A typical curve relating the nozzle back pressure to the nozzle–flapper distance Xis shown in Figure 4–5(b). The steep and almost linear part of the curve is utilized in the actual operation of the nozzle–flapper amplifier. Because the range of flapper dis- placements is restricted to a small value, the change in output pressure is also small, unless the curve is very steep. The nozzle–flapper amplifier converts displacement into a pressure signal. Since industrial process control systems require large output power to operate large pneu- matic actuating valves, the power amplification of the nozzle–flapper amplifier is usually insufficient. Consequently, a pneumatic relay is often needed as a power amplifier in connection with the nozzle–flapper amplifier.P b P a .P b P s . P b P b P b P s Openmirrors.comSection 4–3 / Pneumatic Systems 111To atmosphere PaNozzle back pressure Pb Air supply PsPcTo pneumatic valve (a) (b)To atmosphereNozzle back pressure Pb Air supply PsPcTo pneumatic valvePneumatic Relays. In practice, in a pneumatic controller, a nozzle–flapper amplifier acts as the first-stage amplifier and a pneumatic relay as the second-stage amplifier. The pneumatic relay is capable of handling a large quantity of airflow. A schematic diagram of a pneumatic relay is shown in Figure 4–6(a).As the nozzle back pressure increases, the diaphragm valve moves downward. The opening tothe atmosphere decreases and the opening to the pneumatic valve increases, therebyincreasing the control pressure When the diaphragm valve closes the opening tothe atmosphere, the control pressure becomes equal to the supply pressure When the nozzle back pressure decreases and the diaphragm valve moves upwardand shuts off the air supply, the control pressure drops to the ambient pressure The control pressure can thus be made to vary from 0 psig to full supply pressure,usually 20 psig. The total movement of the diaphragm valve is very small. In all positions of the valve, except at the position to shut off the air supply, air continues to bleed into the at-mosphere, even after the equilibrium condition is attained between the nozzle backpressure and the control pressure. Thus the relay shown in Figure 4–6(a) is called ableed-type relay. There is another type of relay, the nonbleed type. In this one the air bleed stops when the equilibrium condition is obtained and, therefore, there is no loss of pres-surized air at steady-state operation. Note, however, that the nonbleed-type relaymust have an atmospheric relief to release the control pressure from the pneu-matic actuating valve.A schematic diagram of a nonbleed-type relay is shown in Fig-ure 4–6(b). In either type of relay, the air supply is controlled by a valve, which is in turn controlled by the nozzle back pressure.Thus, the nozzle back pressure is converted intothe control pressure with power amplification. Since the control pressure changes almost instantaneously with changes in the nozzle back pressure the time constant of the pneumatic relay is negligiblecompared with the other larger time constants of the pneumatic controller andthe plant.P b ,PcPcPcPa . PcPbPs . PcPc .Pb Figure 4–6 (a) Schematic diagram of a bleed-type relay; (b) schematic diagram of a nonbleed-type relay.112 Chapter 4 / Mathematical Modeling of Fluid Systems and Thermal Systems To atmosphereNozzle back pressure Pb Air supply PsPcTo pneumatic valve Figure 4–7 Reverse-acting relay. It is noted that some pneumatic relays are reverse acting. For example, the relay shown in Figure 4–7 is a reverse-acting relay. Here, as the nozzle back pressure increases, the ball valve is forced toward the lower seat, thereby decreasing the control pressure Thus, this relay is a reverse-acting relay. Pneumatic Proportional Controllers (Force-Distance Type). Two types of pneu- matic controllers, one called the force-distance type and the other the force-balance type, are used extensively in industry. Regardless of how differently industrial pneumatic con- trollers may appear, careful study will show the close similarity in the functions of the pneumatic circuit. Here we shall consider the force-distance type of pneumatic controllers. Figure 4–8(a) shows a schematic diagram of such a proportional controller.The nozzle– flapper amplifier constitutes the first-stage amplifier, and the nozzle back pressure is controlled by the nozzle–flapper distance.The relay-type amplifier constitutes the second- stage amplifier.The nozzle back pressure determines the position of the diaphragm valve for the second-stage amplifier, which is capable of handling a large quantity of airflow. In most pneumatic controllers, some type of pneumatic feedback is employed. Feed- back of the pneumatic output reduces the amount of actual movement of the flapper. Instead of mounting the flapper on a fixed point, as shown in Figure 4–8(b), it is often pivoted on the feedback bellows, as shown in Figure 4–8(c).The amount of feedback can be regulated by introducing a variable linkage between the feedback bellows and the flapper connecting point. The flapper then becomes a floating link. It can be moved by both the error signal and the feedback signal. The operation of the controller shown in Figure 4–8(a) is as follows. The input sig- nal to the two-stage pneumatic amplifier is the actuating error signal. Increasing the actuating error signal moves the flapper to the left. This move will, in turn, increase the nozzle back pressure, and the diaphragm valve moves downward. This results in an in- crease of the control pressure. This increase will cause bellows Fto expand and move the flapper to the right, thus opening the nozzle. Because of this feedback, the nozzle– flapper displacement is very small, but the change in the control pressure can be large. It should be noted that proper operation of the controller requires that the feed- back bellows move the flapper less than that movement caused by the error signal alone. (If these two movements were equal, no control action would result.) Equations for this controller can be derived as follows. When the actuating error is zero, or e=0 , an equilibrium state exists with the nozzle–flapper distance equal to the X–,P c .P b Openmirrors.comSection 4–3 / Pneumatic Systems 113+–OrificeActuating error signal Flapper Nozzle Pneumatic relay (a) (b) (c)Pse a b FPb+pb X+x Z+zY+y Pc+pcError signal Error signal Feedback signal E(s) X(s) Pc(s) Y(s) (e)b a+b a a+bA ksE(s) (f)Pc(s) Kp Kb a+beee yyx aa bba a+by–= (d) displacement of bellows equal to the displacement of the diaphragm equal to the nozzle back pressure equal to and the control pressure equal to When an actuatingerror exists, the nozzle–flapper distance, the displacement of the bellows, the displacementof the diaphragm, the nozzle back pressure, and the control pressure deviate from their re-spective equilibrium values. Let these deviations be x, y, z, p b, and pc, respectively. (The pos- itive direction for each displacement variable is indicated by an arrowhead in the diagram.)P– c . P– b ,Z–, Y–,Figure 4–8 (a) Schematic diagram of a force-distance type of pneumatic proportional controller;(b) flapper mounted on a fixed point; (c) flapper mounted on a feedback bellows;(d) displacement xas a result of addition of two small displacements; (e) block diagram for the controller; (f) simplified block diagram for the controller.114 Chapter 4 / Mathematical Modeling of Fluid Systems and Thermal Systems Assuming that the relationship between the variation in the nozzle back pressure and the variation in the nozzle–flapper distance is linear, we have (4–13) where is a positive constant. For the diaphragm valve, (4–14) where K 2 is a positive constant. The position of the diaphragm valve determines the control pressure. If the diaphragm valve is such that the relationship between and z is linear, then (4–15) where K 3 is a positive constant. From Equations (4–13), (4–14), and (4–15), we obtain (4–16) where K=K 1 K 3 /K 2 is a positive constant. For the flapper, since there are two small movements ( eandy) in opposite directions, we can consider such movements separately and add up the results of two movements into one displacement x. See Figure 4–8(d). Thus, for the flapper movement, we have (4–17) The bellows acts like a spring, and the following equation holds true: (4–18) where Ais the effective area of the bellows and k s is the equivalent spring constant— that is, the stiffness due to the action of the corrugated side of the bellows. Assuming that all variations in the variables are within a linear range, we can obtain a block diagram for this system from Equations (4–16), (4–17), and (4–18) as shown in Figure 4–8(e). From Figure 4–8(e), it can be clearly seen that the pneumatic controller shown in Figure 4–8(a) itself is a feedback system.The transfer function between and eis given by (4–19) A simplified block diagram is shown in Figure 4–8(f). Since and eare proportional, the pneumatic controller shown in Figure 4–8(a) is a pneumatic proportional controller . As seen from Equation (4–19), the gain of the pneumatic proportional controller can be widely varied by adjusting the flapper connecting linkage. [The flapper connecting link- age is not shown in Figure 4–8(a).] In most commercial proportional controllers an ad- justing knob or other mechanism is provided for varying the gain by adjusting this linkage. As noted earlier, the actuating error signal moved the flapper in one direction, and the feedback bellows moved the flapper in the opposite direction, but to a smaller degree.p c P c (s) E(s)=b a+bK 1+Ka a+bA k s =K p p c Ap c =k s yx=b a+be-a a+byp c =K 3 K 2 p b =K 1 K 3 K 2 x=Kxp c =K 3 zp c p b =K 2 zK 1 p b =K 1 x Openmirrors.comSection 4–3 / Pneumatic Systems 115(a) (b)00 XX Ps PsPb XPsPb Pa PcPaPc The effect of the feedback bellows is thus to reduce the sensitivity of the controller. The principle of feedback is commonly used to obtain wide proportional-band controllers. Pneumatic controllers that do not have feedback mechanisms [which means that one end of the flapper is fixed, as shown in Figure 4–9(a)] have high sensitivity and arecalled pneumatic two-position controllers orpneumatic on–off controllers . In such a con- troller, only a small motion between the nozzle and the flapper is required to give acomplete change from the maximum to the minimum control pressure. The curves re-lating to Xand to Xare shown in Figure 4–9(b). Notice that a small change in X can cause a large change in which causes the diaphragm valve to be completely openor completely closed. Pneumatic Proportional Controllers (Force-Balance Type). Figure 4–10 shows a schematic diagram of a force-balance type pneumatic proportional controller. Force-balance type controllers are in extensive use in industry. Such controllers are called stackcontrollers.The basic principle of operation does not differ from that of the force-distancetype controller. The main advantage of the force-balance type controller is that it elimi-nates many mechanical linkages and pivot joints, thereby reducing the effects of friction. In what follows, we shall consider the principle of the force-balance type controller. In the controller shown in Figure 4–10, the reference input pressure and the outputpressure are fed to large diaphragm chambers. Note that a force-balance type pneu-matic controller operates only on pressure signals. Therefore, it is necessary to convertthe reference input and system output to corresponding pressure signals.P oPrPb ,Pc Pb Output pressurePr PoA1 A1A2Reference input pressure X + xPc + pcAtmosphere Air supplyControl pressureP1 = k(Pc + pc) Figure 4–10 Schematic diagramof a force-balance type pneumatic proportionalcontroller.Figure 4–9 (a) Pneumatic controller without a feedback mechanism; (b) curves versus Xand versus X. P c Pb116 Chapter 4 / Mathematical Modeling of Fluid Systems and Thermal Systems As in the case of the force-distance type controller, this controller employs a flapper, nozzle, and orifices. In Figure 4–10, the drilled opening in the bottom chamber is the nozzle. The diaphragm just above the nozzle acts as a flapper. The operation of the force-balance type controller shown in Figure 4–10 may be summarized as follows: 20-psig air from an air supply flows through an orifice, causing a reduced pressure in the bottom chamber. Air in this chamber escapes to the atmos- phere through the nozzle. The flow through the nozzle depends on the gap and the pressure drop across it. An increase in the reference input pressure while the out- put pressure remains the same, causes the valve stem to move down, decreasing the gap between the nozzle and the flapper diaphragm.This causes the control pressure to increase. Let (4–20) Ifp e =0, there is an equilibrium state with the nozzle–flapper distance equal to and the control pressure equal to At this equilibrium state, and (4–21) whereais a constant. Let us assume that p e Z0 and define small variations in the nozzle–flapper distance and control pressure as xandp c , respectively. Then we obtain the following equation: (4–22) From Equations (4–21) and (4–22), we obtain (4–23) At this point, we must examine the quantity x. In the design of pneumatic controllers, the nozzle–flapper distance is made quite small. In view of the fact that x/ais very much smaller than p c (1-k) A 1 orp e AA 2 -A 1 B—that is, for p e Z0 we may neglect the term xin our analysis. Equation (4–23) can then be rewritten to reflect this assumption as follows: and the transfer function between p c andp e becomes where p e is defined by Equation (4–20). The controller shown in Figure 4–10 is a proportional controller.The value of gain K p increases as kapproaches unity. Note that the value of kdepends on the diameters of the orifices in the inlet and outlet pipes of the feedback chamber. (The value of kapproaches unity as the resistance to flow in the orifice of the inlet pipe is made smaller.)P c (s) P e (s)=A 2 -A 1 A 1 1 1-k=K p p c (1-k)A 1 =p e AA 2 -A 1 Bx a/H11270p e AA 2 -A 1 Bx a/H11270p c (1-k)A 1 x=aCp c (1-k)A 1 -p e AA 2 -A 1 BDX–+x=aCAP– c +p c BA 1 -AP– c +p c BkA 1 -p e AA 2 -A 1 BDX–=aAP– c A 1 -P– c kA 1 BP 1 =P– c k (where k61) P– c .X–p e =P r -P o P c P o P r , Openmirrors.comSection 4–3 / Pneumatic Systems 117CPc+ p c A k X+xQ+ q i Figure 4–11 Schematic diagramof a pneumaticactuating valve.Pneumatic Actuating Valves. One characteristic of pneumatic controls is that they almost exclusively employ pneumatic actuating valves.A pneumatic actuating valvecan provide a large power output. (Since a pneumatic actuator requires a large powerinput to produce a large power output, it is necessary that a sufficient quantity of pres-surized air be available.) In practical pneumatic actuating valves, the valve characteris-tics may not be linear; that is, the flow may not be directly proportional to the valvestem position, and also there may be other nonlinear effects, such as hysteresis. Consider the schematic diagram of a pneumatic actuating valve shown in Figure 4–11. Assume that the area of the diaphragm is A. Assume also that when the actuating error is zero, the control pressure is equal to and the valve displacement is equal to In the following analysis, we shall consider small variations in the variables and lin- earize the pneumatic actuating valve. Let us define the small variation in the controlpressure and the corresponding valve displacement to be and x, respectively. Since a small change in the pneumatic pressure force applied to the diaphragm repositionsthe load, consisting of the spring, viscous friction, and mass, the force-balance equa-tion becomes where m= mass of the valve and valve stem b= viscous-friction coefficient k= spring constant If the force due to the mass and viscous friction are negligibly small, then this last equa- tion can be simplified to The transfer function between xand thus becomes X(s) Pc(s)=A k=KcpcApc=kxApc=mx$+bx#+kxpcX–. P– c118 Chapter 4 / Mathematical Modeling of Fluid Systems and Thermal Systems where X(s)= l[x]and If q i , the change in flow through the pneumatic actuating valve, is proportional to x, the change in the valve-stem displacement, then where Q i (s)=lCq i Dand K q is a constant. The transfer function between q i and becomes where K v is a constant. The standard control pressure for this kind of a pneumatic actuating valve is between 3 and 15 psig. The valve-stem displacement is limited by the allowable stroke of the diaphragm and is only a few inches. If a longer stroke is needed, a piston–spring combination may be employed. In pneumatic actuating valves, the static-friction force must be limited to a low value so that excessive hysteresis does not result. Because of the compressibility of air, the control action may not be positive; that is, an error may exist in the valve-stem position. The use of a valve positioner results in improvements in the performance of a pneu- matic actuating valve. Basic Principle for Obtaining Derivative Control Action. We shall now present methods for obtaining derivative control action. We shall again place the emphasis on the principle and not on the details of the actual mechanisms. The basic principle for generating a desired control action is to insert the inverse of the desired transfer function in the feedback path. For the system shown in Figure 4–12, the closed-loop transfer function is If@G(s)H(s)@/H112711, then C(s)/R(s) can be modified to Thus, if proportional-plus-derivative control action is desired, we insert an element having the transfer function 1/(Ts+1) in the feedback path.C(s) R(s)=1 H(s)C(s) R(s)=G(s) 1+G(s)H(s)Q i (s) P c (s)=K c K q =K v p c Q i (s) X(s)=K q P c (s)=lCp c D. R(s) C(s) G(s) H(s) +– Figure 4–12 Control system. Openmirrors.comSection 4–3 / Pneumatic Systems 119+–e a b (a) (b)Pc(s) E(s) X(s)b a+bK a a+bA ksX+x Pc+pcPs Figure 4–13 (a) Pneumatic proportional controller; (b) block diagram of the controller. (a) (b) (c)e ea bPs pcX + x Pc + pcRC Pc(s) E(s) X(s) Kx ttt a a+bA ksb a+b 1 RCs + 1+–Figure 4–14 (a) Pneumaticproportional-plus- derivative controller; (b) step change in e and the corre-sponding changes inxandp cplotted versus t; (c) block diagram of the controller.Consider the pneumatic controller shown in Figure 4–13(a). Considering small changes in the variables, we can draw a block diagram of this controller as shown in Figure 4–13(b).From the block diagram we see that the controller is of proportional type. We shall now show that the addition of a restriction in the negative feedback path will modify the proportional controller to a proportional-plus-derivative controller, ora PD controller. Consider the pneumatic controller shown in Figure 4–14(a).Assuming again small changes in the actuating error, nozzle–flapper distance, and control pressure, we can summarizethe operation of this controller as follows: Let us first assume a small step change in e.120 Chapter 4 / Mathematical Modeling of Fluid Systems and Thermal Systems Then the change in the control pressure will be instantaneous.The restriction Rwill mo- mentarily prevent the feedback bellows from sensing the pressure change p c .Thus the feed- back bellows will not respond momentarily, and the pneumatic actuating valve will feel the full effect of the movement of the flapper.As time goes on, the feedback bellows will expand. The change in the nozzle–flapper distance xand the change in the control pressure can be plotted against time t, as shown in Figure 4–14(b). At steady state, the feedback bellows acts like an ordinary feedback mechanism.The curve versus tclearly shows that this con- troller is of the proportional-plus-derivative type. A block diagram corresponding to this pneumatic controller is shown in Figure 4–14(c). In the block diagram, Kis a constant, Ais the area of the bellows, and k s is the equivalent spring constant of the bellows.The transfer function between and ecan be obtained from the block diagram as follows: In such a controller the loop gain is made much greater than unity. Thus the transfer function P c (s)/E(s) can be simplified to give where Thus, delayed negative feedback, or the transfer function 1/(RCs+1) in the feedback path, modifies the proportional controller to a proportional-plus-derivative controller. Note that if the feedback valve is fully opened, the control action becomes propor- tional. If the feedback valve is fully closed, the control action becomes narrow-band proportional (on–off). Obtaining Pneumatic Proportional-Plus-Integral Control Action. Consider the proportional controller shown in Figure 4–13(a). Considering small changes in the variables, we can show that the addition of delayed positive feedback will modify this proportional controller to a proportional-plus-integral controller, or a PI controller. Consider the pneumatic controller shown in Figure 4–15(a).The operation of this con- troller is as follows:The bellows denoted by I is connected to the control pressure source without any restriction. The bellows denoted by II is connected to the control pressure source through a restriction. Let us assume a small step change in the actuating error.This will cause the back pressure in the nozzle to change instantaneously.Thus a change in the control pressure also occurs instantaneously. Due to the restriction of the valve in the path to bellows II, there will be a pressure drop across the valve.As time goes on, air will flow across the valve in such a way that the change in pressure in bellows II attains the value p c . Thus bellows II will expand or contract as time elapses in such a way as to move the flapper an additional amount in the direction of the original displacement e.This will cause the back pressure in the nozzle to change continuously, as shown in Figure 4–15(b). p c p c K p =bk s aA, T d =RCP c (s) E(s)=K p A1+T d sB@KaA /H20862C(a+b)k s (RCs +1)D@P c (s) E(s)=b a+bK 1+Ka a+bA k s 1 RCs +1p c p c p c p c Openmirrors.comSection 4–3 / Pneumatic Systems 121(a) (b) (c) (d)e a bX+x Pc+pcPs R C pc K Kxe ttt E(s) X(s) Pc(s) E(s) X(s) Pc(s)a a+bb a+b b a+bA ks a a+bA ks a a+bA ks1 RCs + 1 1 RCs + 1II I +–++ +– +–Figure 4–15 (a) Pneumaticproportional-plus- integral controller; (b) step change in e and the corre-sponding changes inxandp cplotted versus t; (c) block diagram of the controller; (d) simplified blockdiagram. Note that the integral control action in the controller takes the form of slowly canceling the feedback that the proportional control originally provided. A block diagram of this controller under the assumption of small variations in the variables is shown in Figure 4–15(c). A simplification of this block diagram yields Figure 4–15(d). The transfer function of this controller is P c(s) E(s)=b a+bK 1+Ka a+bA ksa1-1 RCs +1b122 Chapter 4 / Mathematical Modeling of Fluid Systems and Thermal Systems +– (a) (b)e a bX+x P s R i R d CC P c +p c (R i /H11022/H11022 R d ) P c (s) E(s) X(s) Kb a+b a a+b A k s 1 R d Cs+ 1 1 R i Cs+ 1 –+ Figure 4–16 (a) Pneumatic proportional-plus- integral-plus- derivative controller; (b) block diagram of the controller. where Kis a constant, Ais the area of the bellows, and k s is the equivalent spring constant of the combined bellows. If which is usually the case, the transfer function can be simplified to where Obtaining Pneumatic Proportional-Plus-Integral-Plus-Derivative Control Action. A combination of the pneumatic controllers shown in Figures 4–14(a) and 4–15(a) yields a proportional-plus-integral-plus-derivative controller, or a PID con- troller. Figure 4–16(a) shows a schematic diagram of such a controller. Figure 4–16(b) shows a block diagram of this controller under the assumption of small variations in the variables.K p =bk s aA, T i =RCP c (s) E(s)=K p a 1+1 T i s b @KaARCs /H20862C(a+b)k s (RCs +1)D@/H112711, Openmirrors.comSection 4–4 / Hydraulic Systems 123The transfer function of this controller is By defining and noting that under normal operation and we obtain (4–24) where Equation (4–24) indicates that the controller shown in Figure 4–16(a) is a proportional- plus-integral-plus-derivative controller or a PID controller. 4–4 HYDRAULIC SYSTEMS Except for low-pressure pneumatic controllers, compressed air has seldom been used for the continuous control of the motion of devices having significant mass under externalload forces. For such a case, hydraulic controllers are generally preferred. Hydraulic Systems. The widespread use of hydraulic circuitry in machine tool applications, aircraft control systems, and similar operations occurs because of such fac-tors as positiveness, accuracy, flexibility, high horsepower-to-weight ratio, fast starting,stopping, and reversal with smoothness and precision, and simplicity of operations. The operating pressure in hydraulic systems is somewhere between 145 and 5000 lb f/H20862in.2 (between 1 and 35 MPa). In some special applications, the operating pressure may go up to 10,000 lbf/H20862in.2(70 MPa). For the same power requirement, the weight and size of the hydraulic unit can be made smaller by increasing the supply pressure. With high-pressure hydraulic systems, very large force can be obtained. Rapid-acting, accuratepositioning of heavy loads is possible with hydraulic systems. A combination of elec-tronic and hydraulic systems is widely used because it combines the advantages of bothelectronic control and hydraulic power.K p=bks aA =Kpa1+1 Ti s+Td sb /H11216bks aA Td Ti s2+Ti s+1 Ti s Pc(s) E(s)/H11216bks aA ATd s+1BATi s+1B ATi-TdBsTi/H11271Td ,/H112711 @KaAATi-TdBs/H20862C(a+b)ksATd s+1BATi s+1BD@Ti=Ri C, Td=Rd CPc(s) E(s)=bK a+b 1+Ka a+bA ksARi C-Rd CBs ARd Cs+1BARi Cs+1B124 Chapter 4 / Mathematical Modeling of Fluid Systems and Thermal Systems Advantages and Disadvantages of Hydraulic Systems. There are certain advantages and disadvantages in using hydraulic systems rather than other systems. Some of the advantages are the following: 1.Hydraulic fluid acts as a lubricant, in addition to carrying away heat generated in the system to a convenient heat exchanger. 2.Comparatively small-sized hydraulic actuators can develop large forces or torques. 3.Hydraulic actuators have a higher speed of response with fast starts, stops, and speed reversals. 4.Hydraulic actuators can be operated under continuous, intermittent, reversing, and stalled conditions without damage. 5.Availability of both linear and rotary actuators gives flexibility in design. 6.Because of low leakages in hydraulic actuators, speed drop when loads are applied is small. On the other hand, several disadvantages tend to limit their use. 1.Hydraulic power is not readily available compared to electric power. 2.Cost of a hydraulic system may be higher than that of a comparable electrical system performing a similar function. 3.Fire and explosion hazards exist unless fire-resistant fluids are used. 4.Because it is difficult to maintain a hydraulic system that is free from leaks, the system tends to be messy. 5.Contaminated oil may cause failure in the proper functioning of a hydraulic system. 6.As a result of the nonlinear and other complex characteristics involved, the design of sophisticated hydraulic systems is quite involved. 7.Hydraulic circuits have generally poor damping characteristics. If a hydraulic circuit is not designed properly, some unstable phenomena may occur or disappear, de- pending on the operating condition. Comments. Particular attention is necessary to ensure that the hydraulic system is stable and satisfactory under all operating conditions. Since the viscosity of hydraulic fluid can greatly affect damping and friction effects of the hydraulic circuits, stability tests must be carried out at the highest possible operating temperature. Note that most hydraulic systems are nonlinear. Sometimes, however, it is possible to linearize nonlinear systems so as to reduce their complexity and permit solutions that are sufficiently accurate for most purposes.A useful linearization technique for dealing with nonlinear systems was presented in Section 2–7. Hydraulic Servo System. Figure 4–17(a) shows a hydraulic servomotor. It is essentially a pilot-valve-controlled hydraulic power amplifier and actuator. The pilot valve is a balanced valve, in the sense that the pressure forces acting on it are all balanced. A very large power output can be controlled by a pilot valve, which can be positioned with very little power. In practice, the ports shown in Figure 4–17(a) are often made wider than the corre- sponding valves. In such a case, there is always leakage through the valves. Such leak- Openmirrors.comSection 4–4 / Hydraulic Systems 125x yqqp0 p0 ps p1 p223 41 (a) x (b)2 1ps x0 2+xx0 2–xLoad m b Figure 4–17 (a) Hydraulic servosystem; (b) enlarged diagram of the valve orifice area. age improves both the sensitivity and the linearity of the hydraulic servomotor. In the following analysis we shall make the assumption that the ports are made wider thanthe valves—that is, the valves are underlapped. [Note that sometimes a dither signal, ahigh-frequency signal of very small amplitude (with respect to the maximumdisplacement of the valve), is superimposed on the motion of the pilot valve. This alsoimproves the sensitivity and linearity. In this case also there is leakage through the valve.] We shall apply the linearization technique presented in Section 2–7 to obtain a lin- earized mathematical model of the hydraulic servomotor. We assume that the valve isunderlapped and symmetrical and admits hydraulic fluid under high pressure into apower cylinder that contains a large piston, so that a large hydraulic force is establishedto move a load. In Figure 4–17(b) we have an enlarged diagram of the valve orifice area. Let us define the valve orifice areas of ports 1, 2, 3, 4 as A 1,A2,A3,A4,respectively.Also, define the flow rates through ports 1, 2, 3, 4 as q1,q2,q3,q4,respectively. Note that, since the126 Chapter 4 / Mathematical Modeling of Fluid Systems and Thermal Systems valve is symmetrical, A 1 =A 3 andA 2 =A 4 . Assuming the displacement xto be small, we obtain where kis a constant. Furthermore, we shall assume that the return pressure p o in the return line is small and thus can be neglected. Then, referring to Figure 4–17(a), flow rates through valve orifices are where and and gis the specific weight and is given by g=rg, where ris mass density and gis the acceleration of gravity. The flow rate qto the left-hand side of the power piston is (4–25) The flow rate from the right-hand side of the power piston to the drain is the same as thisqand is given by In the present analysis we assume that the fluid is incompressible. Since the valve is symmetrical, we have q 1 =q 3 andq 2 =q 4 .By equating q 1 andq 3 ,we obtain or If we define the pressure difference across the power piston as or ¢p=p 1 -p 2 ¢pp s =p 1 +p 2 p s -p 1 =p 2 q=q 3 -q 2 =C 1 1p 2 a x 0 2+x b -C 2 1p s -p 2 a x 0 2-x b q=q 1 -q 4 =C 1 1p s -p 1 a x 0 2+x b -C 2 1p 1 a x 0 2-x b C 2 =c 2 k12g/H20862g , C 1 =c 1 k12g/H20862g q 4 =c 2 A 4 B2g gAp 1 -p 0 B =C 2 1p 1 -p 0 a x 0 2-x b =C 2 1p 1 a x 0 2-x b q 3 =c 1 A 3 B2g gAp 2 -p 0 B =C 1 1p 2 -p 0 a x 0 2+x b =C 1 1p 2 a x 0 2+x b q 2 =c 2 A 2 B2g gAp s -p 2 B =C 2 1p s -p 2 a x 0 2-x b q 1 =c 1 A 1 B2g gAp s -p 1 B =C 1 1p s -p 1 a x 0 2+x b A 2 =A 4 =k a x 0 2-x b A 1 =A 3 =k a x 0 2+x b Openmirrors.comSection 4–4 / Hydraulic Systems 127then For the symmetrical valve shown in Figure 4–17(a), the pressure in each side of the power piston is (1/2)pswhen no load is applied, or As the spool valve is dis- placed, the pressure in one line increases as the pressure in the other line decreases bythe same amount. In terms of p sand we can rewrite the flow rate qgiven by Equation (4–25) as Noting that the supply pressure psis constant. the flow rate qcan be written as a func- tion of the valve displacement xand pressure difference or By applying the linearization technique presented in Section 3–10 to this case, the lin- earized equation about point is (4–26) where Coefficients aand bhere are called valve coefficients . Equation (4–26) is a linearized mathematical model of the spool valve near an operating point The values of valve coefficients aandbvary with the operating point. Note that is negative and so bis negative. Since the normal operating point is the point where near the normal operating point Equation (4–26) becomes (4–27) where K 2=AC1+C2Bx0 4121ps70 K1=AC1+C2BAps 270q=K1 x-K2¢px–=0,¢p–=0, q–=0,0f/H208620¢px=x–,¢p=¢p–,q=q–.+C2 2121ps+¢p–ax0 2-x–bR60b=0f 0¢p2 x=x–,¢p=¢p–=-cC1 2121ps-¢p–ax0 2+x–ba=0f 0x2 x=x–,¢p=¢p–=C1Aps-¢p– 2+C2Aps+¢p– 2q–=f(x–,¢p–)q-q–=a(x -x–)+b(¢p-¢p–)x=x–,¢p=¢p–,q=q–q=C1Aps-¢p 2ax0 2+xb-C2Aps+¢p 2ax0 2-xb=f(x, ¢p)¢p,q=q1-q4=C1Aps-¢p 2ax0 2+xb-C2Aps+¢p 2ax0 2-xb¢p,¢p=0.p1=ps+¢p 2, p2=ps-¢p 2128 Chapter 4 / Mathematical Modeling of Fluid Systems and Thermal Systems x=2x 1 x= x 1 x=0 x=–x 1 0q /H9004Px=–2x 1 Figure 4–18 Characteristic curves of the linearized hydraulic servomotor. Equation (4–27) is a linearized mathematical model of the spool valve near the origin Note that the region near the origin is most important in this kind of system, because the system operation usually occurs near this point. Figure 4–18 shows this linearized relationship among q, x, and The straight lines shown are the characteristic curves of the linearized hydraulic servomotor. This family of curves consists of equidistant parallel straight lines, parametrized by x. In the present analysis we assume that the load reactive forces are small, so that the leakage flow rate and oil compressibility can be ignored. Referring to Figure 4–17(a), we see that the rate of flow of oil qtimes dtis equal to the power-piston displacement dytimes the piston area Atimes the density of oil r. Thus, we obtain Notice that for a given flow rate qthe larger the piston area Ais, the lower will be the velocity dy/H20862dt. Hence, if the piston area Ais made smaller, the other variables re- maining constant, the velocity dy/H20862dtwill become higher.Also, an increased flow rate q will cause an increased velocity of the power piston and will make the response time shorter. Equation (4–27) can now be written as The force developed by the power piston is equal to the pressure difference times the piston area Aor =A K 2 a K 1 x-Ar dy dt b Force developed by the power piston =A ¢P¢P¢P=1 K 2 a K 1 x-Ardy dt b Ar dy=q dt¢P.(x – =0,¢p – =0, q – =0.) Openmirrors.comSection 4–4 / Hydraulic Systems 129For a given maximum force, if the pressure difference is sufficiently high, the piston area, or the volume of oil in the cylinder, can be made small. Consequently, to minimizethe weight of the controller, we must make the supply pressure sufficiently high. Assume that the power piston moves a load consisting of a mass and viscous friction. Then the force developed by the power piston is applied to the load mass and friction,and we obtain or (4–28) where mis the mass of the load and bis the viscous-friction coefficient. Assuming that the pilot-valve displacement xis the input and the power-piston displacement yis the output, we find that the transfer function for the hydraulic servo- motor is, from Equation (4–28), (4–29) where and From Equation (4–29) we see that this transfer function is of the second order. If the ratio is negligibly small or the time constant Tis negligible, the transfer function Y(s)/X(s) can be simplified to give It is noted that a more detailed analysis shows that if oil leakage, compressibility (including the effects of dissolved air), expansion of pipelines, and the like are takeninto consideration, the transfer function becomes where and are time constants. As a matter of fact, these time constants depend on the volume of oil in the operating circuit. The smaller the volume, the smaller the timeconstants.T 2 T1Y(s) X(s)=K sAT1 s+1BAT2 s+1BY(s) X(s)=K smK2/H20862AbK2+A2rBT=mK2 bK2+A2rK=1 bK2 AK1+Ar K1 =K s(Ts +1) Y(s) X(s)=1 scamK2 AK1bs+bK2 AK1+Ar K1dmy$+ab+A2r K2by#=AK1 K2xmy$+by#=A K2AK1 x-Ary#B130 Chapter 4 / Mathematical Modeling of Fluid Systems and Thermal Systems x Port I Port II Power cylinder yPilot valveOil under pressure Figure 4–19 Hydraulic servomotor. Hydraulic Integral Controller. The hydraulic servomotor shown in Figure 4–19 is a pilot-valve-controlled hydraulic power amplifier and actuator. Similar to the hydraulic servo system shown in Figure 4–17, for negligibly small load mass the servomotor shown in Figure 4–19 acts as an integrator or an integral controller. Such a servomotor consti- tutes the basis of the hydraulic control circuit. In the hydraulic servomotor shown in Figure 4–19, the pilot valve (a four-way valve) has two lands on the spool. If the width of the land is smaller than the port in the valve sleeve, the valve is said to be underlapped .Overlapped valves have a land width greater than the port width.A zero-lapped valve has a land width that is identical to the port width. (If the pilot valve is a zero-lapped valve, analyses of hydraulic servomotors become simpler.) In the present analysis, we assume that hydraulic fluid is incompressible and that the inertia force of the power piston and load is negligible compared to the hydraulic force at the power piston. We also assume that the pilot valve is a zero-lapped valve, and the oil flow rate is proportional to the pilot valve displacement. Operation of this hydraulic servomotor is as follows. If input xmoves the pilot valve to the right, port II is uncovered, and so high-pressure oil enters the right-hand side of the power piston. Since port I is connected to the drain port, the oil in the left-hand side of the power piston is returned to the drain. The oil flowing into the power cylinder is at high pressure; the oil flowing out from the power cylinder into the drain is at low pressure. The resulting difference in pressure on both sides of the power piston will cause it to move to the left. Note that the rate of flow of oil q (kg/H20862sec)times dt(sec)is equal to the power-piston displacement dy(m)times the piston area A (m 2 )times the density of oil r(kg/H20862m 3 ). Therefore, (4–30) Because of the assumption that the oil flow rate qis proportional to the pilot-valve displacement x, we have (4–31) where K 1 is a positive constant. From Equations (4–30) and (4–31) we obtain Ar dy dt=K 1 xq=K 1 xAr dy=q dt Openmirrors.comSection 4–4 / Hydraulic Systems 131(a) (b)e ba x yII IA B COil under pressure E(s) X(s) Y(s) a a+bb a+bK s+– Figure 4–20 (a) Servomotor thatacts as a proportional controller; (b) block diagram of theservomotor.The Laplace transform of this last equation, assuming a zero initial condition, gives or where K= K1/(Ar). Thus the hydraulic servomotor shown in Figure 4–19 acts as an integral controller. Hydraulic Proportional Controller. It has been shown that the servomotor in Figure 4–19 acts as an integral controller. This servomotor can be modified to a pro-portional controller by means of a feedback link. Consider the hydraulic controllershown in Figure 4–20(a). The left-hand side of the pilot valve is joined to the left-handside of the power piston by a link ABC .This link is a floating link rather than one mov- ing about a fixed pivot. The controller here operates in the following way. If input emoves the pilot valve to the right, port II will be uncovered and high-pressure oil will flow through port II intothe right-hand side of the power piston and force this piston to the left. The power pis-ton, in moving to the left, will carry the feedback link ABC with it, thereby moving the pilot valve to the left.This action continues until the pilot piston again covers ports I andII.A block diagram of the system can be drawn as in Figure 4–20(b).The transfer func-tion between Y(s) andE(s) is given by Noting that under the normal operating conditions we have this last equation can be simplified to Y(s) E(s)=b a=Kp@Ka /H20862Cs(a+b)D@/H112711,Y(s) E(s)=b a+bK s 1+K sa a+bY(s) X(s)=K1 Ars=K sArsY(s) =K1 X(s)132 Chapter 4 / Mathematical Modeling of Fluid Systems and Thermal Systems +– (a) (b) (c) Rq P 2 P 1 Aky yz zt tY(s) Z(s) 1 Ts T=RA 2 r k The transfer function between yandebecomes a constant.Thus, the hydraulic controller shown in Figure 4–20(a) acts as a proportional controller, the gain of which is K p .This gain can be adjusted by effectively changing the lever ratio b/a. (The adjusting mechanism is not shown in the diagram.) We have thus seen that the addition of a feedback link will cause the hydraulic servomotor to act as a proportional controller. Dashpots. The dashpot (also called a damper) shown in Figure 4–21(a) acts as a differentiating element. Suppose that we introduce a step displacement to the piston po- sition y.Then the displacement zbecomes equal to ymomentarily. Because of the spring force, however, the oil will flow through the resistance Rand the cylinder will come back to the original position.The curves yversus tandzversus tare shown in Figure 4–21(b). Let us derive the transfer function between the displacement zand displacement y. Define the pressures existing on the right and left sides of the piston as and respectively. Suppose that the inertia force involved is negligible. Then the force acting on the piston must balance the spring force. Thus where A= piston area, in. 2 k= spring constant, lb f /H20862in. The flow rate qis given by where q= flow rate through the restriction, lb /H20862sec R= resistance to flow at the restriction, lb f -sec /H20862in. 2 -lb Since the flow through the restriction during dtseconds must equal the change in the mass of oil to the left of the piston during the same dtseconds, we obtain wherer=density, lb /H20862in. 3 . (We assume that the fluid is incompressible or r=constant.) This last equation can be rewritten as dy dt-dz dt=q Ar=P 1 -P 2 RAr=kz RA 2 rqdt=Ar(dy-dz)q=P 1 -P 2 RAAP 1 -P 2 B=kzP 2 (lb f /H20862in. 2 ),P 1 (lb f /H20862in. 2 ) Figure 4–21 (a) Dashpot; (b) step change in yand the corresponding change in zplotted versus t; (c) block diagram of the dashpot. Openmirrors.comSection 4–4 / Hydraulic Systems 133+– (a)( b)Area =A Spring constant =k Density of oil =rOil under pressure Resistance =Re xa b y zE(s) X(s) Y(s)b a+b a a+bK s Ts Ts+ 1Z(s)or Taking the Laplace transforms of both sides of this last equation, assuming zero initial conditions, we obtain The transfer function of this system thus becomes Let us define RA2r/H20862k=T. (Note that RA2r/H20862khas the dimension of time.) Then Clearly, the dashpot is a differentiating element. Figure 4–21(c) shows a block diagram representation for this system. Obtaining Hydraulic Proportional-Plus-Integral Control Action. Figure 4–22(a) shows a schematic diagram of a hydraulic proportional-plus-integral controller.A blockdiagram of this controller is shown in Figure 4–22(b). The transfer function Y(s)/E(s) is given by Y(s) E(s)=b a+bK s 1+Ka a+bT Ts+1Z(s) Y(s)=Ts Ts+1=1 1+1 TsZ(s) Y(s)=s s+k RA2rsY(s) =sZ(s) +k RA2rZ(s)dy dt=dz dt+kz RA2r Figure 4–22 (a) Schematic diagram of a hydraulic proportional-plus-integral controller; (b) block diagram of the controller.134 Chapter 4 / Mathematical Modeling of Fluid Systems and Thermal Systems +– (a) (b)e a bx y zR kq P 2 P 1 Area = A Density of oil = rX(s) Y(s) E(s) Z(s)b a+b a a+b K s 1 Ts+ 1 In such a controller, under normal operation with the result that where Thus the controller shown in Figure 4–22(a) is a proportional-plus-integral controller (PI controller). Obtaining Hydraulic Proportional-Plus-Derivative Control Action. Figure 4–23(a) shows a schematic diagram of a hydraulic proportional-plus-derivative controller. The cylinders are fixed in space and the pistons can move. For this system, notice that Hence or Z(s) Y(s)=1 Ts+1y=z+A kqR=z+RA 2 r kdz dt q dt=rA dz q=P 2 -P 1 R k(y -z)=AAP 2 -P 1 BK p =b a, T i =T=RA 2 r kY(s) E(s)=K p a 1+1 T i s b @KaT /H20862C(a+b)(Ts +1)D@/H112711, Figure 4–23 (a) Schematic diagram of a hydraulic proportional-plus-derivative controller; (b) block diagram of the controller. Openmirrors.comSection 4–4 / Hydraulic Systems 135e a bx yR R k2 k1 Area =AzFigure 4–24 Schematic diagramof a hydraulic proportional-plus- integral-plus-derivative controller.where A block diagram for this system is shown in Figure 4–23(b). From the block diagram the transfer function Y(s)/E(s) can be obtained as Under normal operation we have Hence where Thus the controller shown in Figure 4–23(a) is a proportional-plus-derivative controller (PD controller). Obtaining Hydraulic Proportional-Plus-Integral-Plus-Derivative Control Action. Figure 4–24 shows a schematic diagram of a hydraulic proportional-plus-integral-plus-derivative controller. It is a combination of the proportional-plus-integral controllerand proportional-plus derivative controller. If the two dashpots are identical except the piston shafts, the transfer function Z(s)/Y(s) can be obtained as follows: (For the derivation of this transfer function, refer to Problem A–4–9 .)Z(s) Y(s)=T1 s T1 T2 s2+AT1+2T2Bs+1Kp=b a, T=RA2r kY(s) E(s)=Kp(1+Ts)@aK /H20862C(a+b)s(Ts +1)D@/H112711.Y(s) E(s)=b a+bK s 1+a a+bK s1 Ts+1T=RA2r k136 Chapter 4 / Mathematical Modeling of Fluid Systems and Thermal Systems +– b a+b K s Y(s) E(s) X(s) Z(s)T 1 s T 1 T 2 s 2 + (T 1 + 2T 2 )s+ 1 a a+b Figure 4–25 Block diagram for the system shown in Figure 4–24. A block diagram for this system is shown in Figure 4–25. The transfer function Y(s)/E(s) can be obtained as Under normal circumstances we design the system such that then where Thus, the controller shown in Figure 4–24 is a proportional-plus-integral-plus-derivative controller (PID controller). 4–5 THERMAL SYSTEMS Thermal systems are those that involve the transfer of heat from one substance to another. Thermal systems may be analyzed in terms of resistance and capacitance, although the thermal capacitance and thermal resistance may not be represented accurately as lumped parameters, since they are usually distributed throughout the sub- stance. For precise analysis, distributed-parameter models must be used. Here, however, to simplify the analysis we shall assume that a thermal system can be represented by a lumped-parameter model, that substances that are characterized by resistance to heat flow have negligible heat capacitance, and that substances that are characterized by heat capacitance have negligible resistance to heat flow.K p =b aT 1 +2T 2 T 1 , K i =b a1 T 1 , K d =b aT 2 =K p +K i s+K d s Y(s) E(s)=b a T 1 T 2 s 2 +AT 1 +2T 2 Bs+1 T 1 s ` a a+bK sT 1 s T 1 T 2 s 2 +AT 1 +2T 2 Bs+1 ` /H112711Y(s) E(s)=b a+bK s 1+a a+bK sT 1 s T 1 T 2 s 2 +AT 1 +2T 2 Bs+1 Openmirrors.comSection 4–5 / Thermal Systems 137There are three different ways heat can flow from one substance to another: con- duction, convection, and radiation. Here we consider only conduction and convection.(Radiation heat transfer is appreciable only if the temperature of the emitter is veryhigh compared to that of the receiver. Most thermal processes in process control systemsdo not involve radiation heat transfer.) For conduction or convection heat transfer, where q= heat flow rate, kcal /H20862sec /H9004u=temperature difference, °C K= coefficient, kcal /H20862sec °C The coefficient Kis given by where k= thermal conductivity, kcal /H20862m sec °C A= area normal to heat flow, m 2 /H9004X= thickness of conductor, m H= convection coefficient, kcal /H20862m2sec °C Thermal Resistance and Thermal Capacitance. The thermal resistance Rfor heat transfer between two substances may be defined as follows: The thermal resistance for conduction or convection heat transfer is given by Since the thermal conductivity and convection coefficients are almost constant, the thermal resistance for either conduction or convection is constant. The thermal capacitance Cis defined by or where m= mass of substance considered, kg c= specific heat of substance, kcal /H20862kg °CC=mcC=change in heat stored, kcal change in temperature, °CR=d(¢u) dq=1 KR=change in temperature difference, °C change in heat flow rate, kcal /H20862sec=HA, for convectionK=kA ¢X, for conductionq=K¢u138 Chapter 4 / Mathematical Modeling of Fluid Systems and Thermal Systems Heater Cold liquidMixerHot liquid (a) (b)H i (s) R–1 RCs Q i (s) Q(s) ++ – Thermal System. Consider the system shown in Figure 4–26(a). It is assumed that the tank is insulated to eliminate heat loss to the surrounding air. It is also assumed that there is no heat storage in the insulation and that the liquid in the tank is perfectly mixed so that it is at a uniform temperature.Thus, a single temperature is used to describe the temperature of the liquid in the tank and of the outflowing liquid. Let us define steady-state temperature of inflowing liquid, °C steady-state temperature of outflowing liquid, °C steady-state liquid flow rate, kg /H20862sec mass of liquid in tank, kg specific heat of liquid, kcal /H20862kg °C thermal resistance, °C sec /H20862kcal thermal capacitance, kcal /H20862°C steady-state heat input rate, kcal /H20862sec Assume that the temperature of the inflowing liquid is kept constant and that the heat input rate to the system (heat supplied by the heater) is suddenly changed from to where h i represents a small change in the heat input rate.The heat outflow rate will then change gradually from to The temperature of the outflowing liq- uid will also be changed from to For this case, h o , C, and Rare obtained, respectively, as The heat-balance equation for this system is Cdu=Ah i -h o BdtR=u h o =1 GcC=Mch o =GcuQ– o +u. Q– o H–+h o . H–H–+h i ,H– H–= C= R= c= M= G=Q– o =Q– i = Figure 4–26 (a) Thermal system: (b) block diagram of the system. Openmirrors.comSection 4–5 / Thermal Systems 139or which may be rewritten asNote that the time constant of the system is equal to RCorM/G seconds. The transfer function relating uandh iis given by where and In practice, the temperature of the inflowing liquid may fluctuate and may act as a load disturbance. (If a constant outflow temperature is desired, an automatic controllermay be installed to adjust the heat inflow rate to compensate for the fluctuations in thetemperature of the inflowing liquid.) If the temperature of the inflowing liquid is sud-denly changed from to while the heat input rate Hand the liquid flow rate Gare kept constant, then the heat outflow rate will be changed from to and the temperature of the outflowing liquid will be changed from to The heat-balance equation for this case is or which may be rewritten The transfer function relating uandu iis given by where and If the present thermal system is subjected to changes in both the temperature of the inflowing liquid and the heat input rate, while the liquid flow rate is kept constant, thechange uin the temperature of the outflowing liquid can be given by the following equation: A block diagram corresponding to this case is shown in Figure 4–26(b). Notice that the system involves two inputs.RCdu dt+u=ui+RhiQi(s)=lCui(t)D. Q (s)=lCu(t)DQ (s) Q i(s)=1 RCs +1RCdu dt+u=uiCdu dt=Gcui-hoCdu=AGcui-hoBdtQ– o+u. Q– oH–+ho , H–Q– i+ui Q– iHi(s)=lChi(t)D. Q (s)=lCu(t)DQ (s) Hi(s)=R RCs +1RCdu dt+u=RhiCdu dt=hi-ho140 Chapter 4 / Mathematical Modeling of Fluid Systems and Thermal Systems QQ i H Capacitance C Figure 4–27 Liquid-level system. EXAMPLE PROBLEMS AND SOLUTIONS A–4–1. In the liquid-level system of Figure 4–27 assume that the outflow rate Qm 3 /H20862sec through the out- flow valve is related to the head Hm by Assume also that when the inflow rate Q i is 0.015 m 3 /H20862sec the head stays constant. For t<0 the system is at steady state AQ i =0.015 m 3 /H20862secB. At t=0 the inflow valve is closed and so there is no inflow for t/H113500. Find the time necessary to empty the tank to half the original head. The capacitance Cof the tank is 2 m 2 . Solution. When the head is stationary, the inflow rate equals the outflow rate. Thus head H o at t=0 is obtained from or The equation for the system for t>0 is or Hence Assume that, at t=t 1 , H=1.125 m. Integrating both sides of this last equation, we obtain It follows that or Thus, the head becomes half the original value (2.25 m) in 175.7 sec.t 1 =175.721H 2 1.125 2.25 =211.125 -212.25 =-0.005t 1 3 1.125 2.25 dH 1H = 3 t 1 0 (-0.005) dt=-0.005t 1 dH 1H =-0.005 dtdH dt=-Q C=-0.011H 2-CdH=Q dtH o =2.25 m0.015 =0.011H o Q=K1H =0.011H Openmirrors.comOpenmirrors.comExample Problems and Solutions 141A–4–2. Consider the liquid-level system shown in Figure 4–28. In the system, and are steady-state inflow rates and and are steady-state heads.The quantities qi1,qi2,h1,h2,q1, and qoare con- sidered small. Obtain a state-space representation for the system when h1andh2are the outputs andqi1andqi2are the inputs. Solution. The equations for the system are (4–32) (4–33) (4–34) (4–35) Elimination of q1from Equation (4–32) using Equation (4–33) results in (4–36) Eliminating q1andqofrom Equation (4–34) by using Equations (4–33) and (4–35) gives (4–37) Define state variables x1andx2by x1=h1 x2=h2 the input variables u1andu2by u1=qi1 u2=qi2 and the output variables y1andy2by y1=h1=x1 y2=h2=x2 Then Equations (4–36) and (4–37) can be written as x# 2=1 R1 C2 x1-a1 R1 C2+1 R2 C2bx2+1 C2 u2 x# 1=-1 R1 C1x1+1 R1 C1x2+1 C1u1dh2 dt=1 C2ah1-h2 R1+qi2-h2 R2bdh1 dt=1 C1aqi1-h1-h2 R1bh2 R2=qoC2dh2=Aq1+qi2-qoBdth1-h2 R1=q1C1dh1=Aqi1-q1BdtH– 2 H– 1Q– 2 Q– 1 C1 C2R1 R2 Q1+q1Q2+qi2 Q1+qi1 Q1+Q2+qoH1+h1 H2+h2 Figure 4–28 Liquid-level system.142 Chapter 4 / Mathematical Modeling of Fluid Systems and Thermal Systems In the form of the standard vector-matrix representation, we have which is the state equation, and which is the output equation. A–4–3. The value of the gas constant for any gas may be determined from accurate experimental obser- vations of simultaneous values of p, v, and T. Obtain the gas constant R air for air. Note that at 32°F and 14.7 psia the specific volume of air is 12.39 ft 3 /H20862lb.Then obtain the capacitance of a 20-ft 3 pressure vessel that contains air at 160°F.As- sume that the expansion process is isothermal. Solution. Referring to Equation (4–12), the capacitance of a 20-ft 3 pressure vessel is Note that in terms of SI units, R air is given by R air =287 N-m /H20862kg K A–4–4. In the pneumatic pressure system of Figure 4–29(a), assume that, for t<0 , the system is at steady state and that the pressure of the entire system is Also, assume that the two bellows are identi- cal. At t=0 , the input pressure is changed from to Then the pressures in bellows 1 and 2 will change from to and from to respectively.The capacity (volume) of each bellows is 5*10 –4 m 3 , and the operating-pressure difference (difference between p i andp 1 or difference between p i andp 2 ) is between –0.5*10 5 N/H20862m 2 and0.5*10 5 N/H20862m 2 .The corresponding mass flow rates (kg /H20862sec) through the valves are shown in Figure 4–29(b). Assume that the bellows expand or contract linearly with the air pressures applied to them, that the equivalent spring con- stant of the bellows system is k=1*10 5 N/H20862m, and that each bellows has area A=15*10 –4 m 2 .¢pP–+p 2 , P–P–+p 1 P–P–+p i . P–P–.C=V nR air T=20 1*53.3 *620=6.05 *10 -4 lb lb f /H20862ft 2 R air =pv T=14.7 *144 *12.39 460 +32=53.3 ft-lb f /H20862lb°R B y 1 y 2 R = B 1 00 1 RB x 1 x 2 RB x# 1 x# 2 R = D -1 R 1 C 1 1 R 1 C 2 1 R 1 C 1 a 1 R 1 C 2 +1 R 2 C 2 b TB x 1 x 2 R + D 1 C 1 00 1 C 2 TB u 1 u 2 R Bellows 1 Bellows 2 Valve 1 Valve 2 (a) (b)x Area ACCq 1 q 2 R 1 R 2 P+p 1 P+p 2 P+p i Valve 2 Valve 1 0.5/H11003 10 5 –3/H11003 10 –5 1.5/H11003 10 –5 – 0.5 /H11003 10 5 Dp(N/m 2 ) q(kg/sec) Figure 4–29 (a) Pneumatic pressure system; (b) pressure- difference-versus- mass-flow-rate curves. Openmirrors.comExample Problems and Solutions 143Defining the displacement of the midpoint of the rod that connects two bellows as x, find the transfer function Assume that the expansion process is isothermal and that thetemperature of the entire system stays at 30°C. Assume also that the polytropic exponent nis 1. Solution. Referring to Section 4–3, transfer function can be obtained as (4–38) Similarly, transfer function is (4–39) The force acting on bellows 1 in the xdirection is and the force acting on bellows 2 in the negative xdirection is The resultant force balances with kx, the equivalent spring force of the corrugated sides of the bellows. or (4–40) Referring to Equations (4–38) and (4–39), we see that By substituting this last equation into Equation (4–40) and rewriting, the transfer function is obtained as (4–41) The numerical values of average resistances R 1andR2are The numerical value of capacitance Cof each bellows is where Rair=287 N-m /H20862kg K. (See Problem A–4–3 .) Consequently, R1C=0.167*1010*5.75*10–9=9.60 sec R2C=0.333*1010*5.75*10–9=19.2 sec By substituting the numerical values for A, k ,R1C, and R2Cinto Equation (4–41), we obtain X(s) Pi(s)=1.44 *10-7s (9.6s +1)(19.2s +1)C=V nRair T=5*10-4 1*287 *(273 +30)=5.75 *10-9kg N/H20862m2R2=d¢p dq2=0.5*105 1.5*10-5=0.333 *1010N/H20862m2 kg/H20862secR1=d¢p dq1=0.5*105 3*10-5=0.167 *1010N/H20862m2 kg/H20862secX(s) Pi(s)=A kAR2 C-R1 CBs AR1 Cs+1BAR2 Cs+1BX(s) /H20862Pi(s) =R2 Cs-R1 Cs AR1 Cs+1BAR2 Cs+1B Pi(s) P1(s)-P2(s)=a1 R1 Cs+1-1 R2 Cs+1bPi(s)ACP1(s)-P2(s)D=kX(s)AAp1-p2B=kxAAP–+p2B.AAP–+p1B,P2(s) Pi(s)=1 R2 Cs+1P2(s) /H20862Pi(s)P1(s) Pi(s)=1 R1 Cs+1P1(s) /H20862Pi(s)X(s) /H20862Pi(s).144 Chapter 4 / Mathematical Modeling of Fluid Systems and Thermal Systems A–4–5. Draw a block diagram of the pneumatic controller shown in Figure 4–30.Then derive the transfer function of this controller. Assume that Assume also that the two bellows are identical. If the resistance R d is removed (replaced by the line-sized tubing), what control action do we get? If the resistance R i is removed (replaced by the line-sized tubing), what control action do we get? Solution. Let us assume that when e=0 the nozzle–flapper distance is equal to and the con- trol pressure is equal to In the present analysis, we shall assume small deviations from the respective reference values as follows: small error signal small change in the nozzle–flapper distance small change in the control pressure small pressure change in bellows I due to small change in the control pressure small pressure change in bellows II due to small change in the control pressure small displacement at the lower end of the flapper In this controller, is transmitted to bellows I through the resistance R d . Similarly, is trans- mitted to bellows II through the series of resistances R d andR i .The relationship between and is where derivative time. Similarly, p II andp I are related by the transfer function where integral time. The force-balance equation for the two bellows is where k s is the stiffness of the two connected bellows and Ais the cross-sectional area of the bellows. The relationship among the variables e, x, and yis The relationship between and xis p c =Kx (K>0)p c x=b a+be-a a+byAp I -p II BA=k s yT i =R i C=P II (s) P I (s)=1 R i Cs+1=1 T i s+1T d =R d C=P I (s) P c (s)=1 R d Cs+1=1 T d s+1p c p I p c p c y= p II = p I = p c = x=e =P– c .X–R d /H11270R i . e a b CCX+x P c +p I P c +p II P s II I R i R d P c +p c y Figure 4–30 Schematic diagram of a pneumatic controller. Openmirrors.comExample Problems and Solutions 145From the equations just derived, a block diagram of the controller can be drawn, as shown in Figure 4–31(a). Simplification of this block diagram results in Figure 4–31(b). The transfer function between Pc(s)andE(s) is For a practical controller, under normal operation is very much greater than unity and Therefore, the transfer function can be simplified as follows: where Thus the controller shown in Figure 4–30 is a proportional-plus-integral-plus-derivative one. If the resistance Rdis removed, or Rd=0 , the action becomes that of a proportional-plus- integral controller.Kp=bks aA /H11216Kpa1+1 Ti s+Td sb =bks aA aTi+Td Ti+1 Ti s+Td sb Pc(s) E(s)/H11216bksATi s+1BATd s+1B aATi sTi/H11271Td .@KaATi s/H20862C(a+b)ksATi s+1BATd s+1BD@Pc(s) E(s)=b a+bK 1+Ka a+bA ksaTi s Ti s+1ba1 Td s+1b +– +– +–E(s) X(s) Pc(s) K a a+bb a+b A ksPI(s) PII(s)1 Td s + 1 1 Ti s + 1 (a) (b)Kb a+bPc(s) E(s) X(s) aAT is (a+b)ks(Tis+ 1) (Tds+ 1) Figure 4–31 (a) Block diagram ofthe pneumaticcontroller shown in Figure 4–30; (b) simplified blockdiagram.146 Chapter 4 / Mathematical Modeling of Fluid Systems and Thermal Systems If the resistance R i is removed, or R i =0 , the action becomes that of a narrow-band propor- tional, or two-position, controller. (Note that the actions of two feedback bellows cancel each other, and there is no feedback.) A–4–6. Actual spool valves are either overlapped or underlapped because of manufacturing tolerances. Consider the overlapped and underlapped spool valves shown in Figures 4–32(a) and (b). Sketch curves relating the uncovered port area Aversus displacement x. Solution. For the overlapped valve, a dead zone exists between and or The curve for uncovered port area Aversus displacement xis shown in Figure 4–33(a). Such an overlapped valve is unfit as a control valve. For the underlapped valve, the curve for port area Aversus displacement xis shown in Figure 4–33(b). The effective curve for the underlapped region has a higher slope, meaning a higher sensitivity. Valves used for controls are usually underlapped. A–4–7. Figure 4–34 shows a hydraulic jet-pipe controller. Hydraulic fluid is ejected from the jet pipe. If the jet pipe is shifted to the right from the neutral position, the power piston moves to the left, and vice versa. The jet-pipe valve is not used as much as the flapper valve because of large null flow, slower response, and rather unpredictable characteristics. Its main advantage lies in its insensitivity to dirty fluids. Suppose that the power piston is connected to a light load so that the inertia force of the load element is negligible compared to the hydraulic force developed by the power piston. What type of control action does this controller produce? Solution. Define the displacement of the jet nozzle from the neutral position as xand the displacement of the power piston as y. If the jet nozzle is moved to the right by a small displace-- 1 2 x 0 6x6 1 2 x 0 . 1 2 x 0 , - 1 2 x 0 x 0 2 x 0 2 x 0 2 x 0 2 xx (a) (b)High pressureLow pressureHigh pressureLow pressure Figure 4–32 (a) Overlapped spool valve; (b) underlapped spool valve. (a) (b)Effective areaArea exposed to high pressure Area exposed to low pressureA x x 0 2 A x x 0 2 Figure 4–33 (a) Uncovered-port- area- A-versus displacement- xcurve for the overlapped valve; (b) uncovered- port-area- A-versus- displacement- xcurve for the underlapped valve. Openmirrors.comExample Problems and Solutions 147Oil under pressureA y x Figure 4–34 Hydraulic jet-pipecontroller. ment x, the oil flows to the right side of the power piston, and the oil in the left side of the power piston is returned to the drain. The oil flowing into the power cylinder is at high pressure; the oil flowing out from the power cylinder into the drain is at low pressure. The resulting pressure difference causes the power piston to move to the left. For a small jet-nozzle displacement x, the flow rate qto the power cylinder is proportional to x; that is, For the power cylinder, where Ais the power-piston area and ris the density of oil. Hence where constant. The transfer function Y(s)/X(s) is thus The controller produces the integral control action.Y(s) X(s)=K sK=K1/H20862(Ar)=dy dt=q Ar=K1 Arx=KxAr dy=q dtq=K1 x148 Chapter 4 / Mathematical Modeling of Fluid Systems and Thermal Systems EngineOil under pressurek b z e ya 1 a 2 v Figure 4–35 Speed control system. +– E(s) Y(s) Z(s)a 2 a 1 + a 2 K s a 1 a 1 + a 2 bs bs+ k Figure 4–36 Block diagram for the speed control system shown in Figure 4–35.A–4–8. Explain the operation of the speed control system shown in Figure 4–35. Solution. If the engine speed increases, the sleeve of the fly-ball governor moves upward. This movement acts as the input to the hydraulic controller.A positive error signal (upward motion of the sleeve) causes the power piston to move downward, reduces the fuel-valve opening, and decreases the engine speed. A block diagram for the system is shown in Figure 4–36. From the block diagram the transfer function Y(s)/E(s) can be obtained as If the following condition applies, the transfer function Y(s)/E(s) becomes The speed controller has proportional-plus-integral control action.Y(s) E(s)/H11216a 2 a 1 +a 2 a 1 +a 2 a 1 bs+k bs=a 2 a 1 a 1+k bs b 2 a 1 a 1 +a 2 bs bs+kK s 2 /H112711Y(s) E(s)=a 2 a 1 +a 2 K s 1+a 1 a 1 +a 2 bs bs+kK s Openmirrors.comExample Problems and Solutions 149A–4–9. Derive the transfer function Z(s)/Y(s) of the hydraulic system shown in Figure 4–37.Assume that the two dashpots in the system are identical ones except the piston shafts. Solution. In deriving the equations for the system, we assume that force Fis applied at the right end of the shaft causing displacement y. (All displacements y, w, and zare measured from re- spective equilibrium positions when no force is applied at the right end of the shaft.) When forceFis applied, pressure becomes higher than pressure Similarly, For the force balance, we have the following equation: (4–42) Since (4–43) and we have Also, since q 1dt=A( dw- dz)r we have or Define A2Rr=B. (Bis the viscous-friction coefficient.) Then (4–44) Also, for the right-hand-side dashpot we have Since or (4–45) Substituting Equations (4–43) and (4–45) into Equation (4–42), we have Taking the Laplace transform of this last equation, assuming zero initial condition, we obtain (4–46) k2 Y(s) =Ak2+BsBW(s) +k1 Z(s)k2 y-k2 w=k1 z+Bw#AAP2-Pœ 2B=Bw#w#=q2 Ar=AAP2-Pœ 2B A2Rrq2=AP2-Pœ 2B/H20862R, we obtainq2dt=Ardww#-z#=k1 Bzw#-z#=k1 z A2Rrq1=A(w#-z#)rk1 z=ARq1q1=P1-Pœ 1 Rk1 z=AAP1-Pœ 1Bk2(y-w)=AAP1-Pœ 1B+AAP2-Pœ 2BP27Pœ 2 . Pœ 1 , or P17Pœ 1 . P1 R FR k2 k1 P1q1 Area =Azq2 w w yP2 P29 P19 Figure 4–37 Hydraulic system.150 Chapter 4 / Mathematical Modeling of Fluid Systems and Thermal Systems Taking the Laplace transform of Equation (4–44), assuming zero initial condition, we obtain (4–47) By using Equation (4–47) to eliminate W(s) from Equation (4–46), we obtain from which we obtain the transfer function Z(s)/Y(s) to be Multiplying B/Ak 1 k 2 Bto both the numerator and denominator of this last equation, we get Define Then the transfer function Z(s)/Y(s) becomes as follows: A–4–10. Considering small deviations from steady-state operation, draw a block diagram of the air heat- ing system shown in Figure 4–38. Assume that the heat loss to the surroundings and the heat capacitance of the metal parts of the heater are negligible. Solution. Let us define steady-state temperature of inlet air, °C steady-state temperature of outlet air, °C G= mass flow rate of air through the heating chamber, kg /H20862sec M= mass of air contained in the heating chamber, kg c= specific heat of air, kcal /H20862kg °C R= thermal resistance, °C sec /H20862kcal C= thermal capacitance of air contained in the heating chamber =Mc , kcal /H20862°C steady-state heat input, kcal /H20862sec Let us assume that the heat input is suddenly changed from to and the inlet air temperature is suddenly changed from to Then the outlet air temperature will be changed from to The equation describing the system behavior is Cdu o =Ch+GcAu i -u o BDdtQ– o +u o . Q– o Q– i +u i . Q– i H–+h H–H–=Q– o =Q– i =Z(s) Y(s)=T 1 s T 1 T 2 s 2 +AT 1 +2T 2 Bs+1B/H20862k 1 =T 1 ,B/H20862k 2 =T 2 .Z(s) Y(s)=B k 1 s B 2 k 1 k 2 s 2 + a 2B k 2 +B k 1 b s+1Z(s) Y(s)=k 2 s Bs 2 +A2k 1 +k 2 Bs+k 1 k 2 Bk 2 Y(s) =Ak 2 +BsBk 1 +Bs BsZ(s) +k 1 Z(s)W(s) =k 1 +Bs BsZ(s) H+h HeaterQ i +u i Q o +u o Figure 4–38 Air heating system. Openmirrors.comExample Problems and Solutions 151or Noting that we obtainor Taking the Laplace transforms of both sides of this last equation and substituting the initial condition that u 0(0)=0 , we obtain The block diagram of the system corresponding to this equation is shown in Figure 4–39. A–4–11. Consider the thin, glass-wall, mercury thermometer system shown in Figure 4–40.Assume that the thermometer is at a uniform temperature (ambient temperature) and that at t=0 it is immersed in a bath of temperature where ubis the bath temperature (which may be con- stant or changing) measured from the ambient temperature Define the instantaneous ther- mometer temperature by so that uis the change in the thermometer temperature satisfying the condition that u(0)=0 . Obtain a mathematical model for the system.Also obtain an electri- cal analog of the thermometer system. Solution. A mathematical model for the system can be derived by considering heat balance as fol- lows:The heat entering the thermometer during dtsec is qdt, where qis the heat flow rate to the thermometer. This heat is stored in the thermal capacitance Cof the thermometer, thereby rais- ing its temperature by du. Thus the heat-balance equation is (4–48) Cdu=qdtQ–+u,Q–.Q–+ub ,Q–Qo(s)=R RCs +1H(s) +1 RCs +1Qi(s)RCduo dt+uo=Rh+uiCduo dt=h+1 RAui-uoBGc=1 RCduo dt=h+GcAui-uoBH(s)1 RCs + 1 R RCs + 1Qi(s) Qo(s) ++Figure 4–39 Block diagram of theair heating systemshown inFigure 4–38. Thermometer BathQ +u Q +ubFigure 4–40 Thin, glass-wall,mercury thermo-meter system.152 Chapter 4 / Mathematical Modeling of Fluid Systems and Thermal Systems Since thermal resistance Rmay be written as heat flow rate qmay be given, in terms of thermal resistance R,a s where is the bath temperature and is the thermometer temperature. Hence, we can rewrite Equation (4–48) as or (4–49) Equation (4–49) is a mathematical model of the thermometer system. Referring to Equation (4–49), an electrical analog for the thermometer system can be writ- ten as An electrical circuit represented by this last equation is shown in Figure 4–41.RCde o dt+e o =e i RCdu dt+u=u b Cdu dt=u b -u RQ–+u Q–+u b q=AQ–+u b B-AQ–+uB R=u b -u RR=d(¢u) dq=¢u q R Ce o e i Figure 4–41 Electrical analog of the thermometer system shown in Figure 4–40. PROBLEMS B–4–1. Consider the conical water-tank system shown in Figure 4–42. The flow through the valve is turbulent and is related to the head Hby where Qis the flow rate measured in m 3 /H20862sec and His in meters. Suppose that the head is 2 m at t=0 . What will be the head at t=60 sec?Q=0.0051H 2m 3m 2m Hr Figure 4–42 Conical water-tank system. Openmirrors.comProblems 153B–4–2. Consider the liquid-level control system shown in Figure 4–43. The controller is of the proportional type. Theset point of the controller is fixed. Draw a block diagram of the system, assuming that changes in the variables are small. Obtain the transfer func-tion between the level of the second tank and the distur-bance input q d. Obtain the steady-state error when the disturbance qdis a unit-step function. C2R1 C1 h2 R2Q+qi qd Q+q0HProportional controller Figure 4–43 Liquid-level control system. RC AX+x P+poP+pik Figure 4–44 Pneumatic system.B–4–3. For the pneumatic system shown in Figure 4–44, assume that steady-state values of the air pressure and the displacement of the bellows are and respectively.Assume also that the input pressure is changed from to where p iis a small change in the input pressure.This change will cause the displacement of the bellows to changea small amount x.Assuming that the capacitance of the bel- lows is Cand the resistance of the valve is R, obtain the transfer function relating xandp i.P–+pi,P–X–, P–154 Chapter 4 / Mathematical Modeling of Fluid Systems and Thermal Systems B–4–4. Figure 4–45 shows a pneumatic controller.The pneu- matic relay has the characteristic that p c =Kp b ,where K>0. What kind of control action does this controller produce? Derive the transfer function P c (s) /H20862E(s).B–4–5. Consider the pneumatic controller shown in Figure 4–46.Assuming that the pneumatic relay has the char- acteristics that (where K>0 ), determine the con- trol action of this controller. The input to the controller is e and the output is p c .p c =Kp b Actuating error signal Flapper Nozzlee a bX + x RI k Orifice P s P b + p b P c + p c Figure 4–46 Pneumatic controller. k OrificeActuating error signal Flapper Nozzle P s e a bP b +p b X+x Y+y P c +p c Figure 4–45 Pneumatic controller. Openmirrors.comProblems 155Actuating error signal Flapper Nozzlee a b kX + x RII I Orifice PsPb + pb Pc + pc Figure 4–47 Pneumatic controller. Actuating error signal Flapper Nozzlee a b kX + x R2II I R1Orifice PsPb + pb Pc + pc Figure 4–48 Pneumatic controller.B–4–6. Figure 4–47 shows a pneumatic controller. The sig- naleis the input and the change in the control pressure is the output. Obtain the transfer function .Assume that the pneumatic relay has the characteristics that where K>0 . p c=Kpb ,Pc(s) /H20862E(s)pcB–4–7. Consider the pneumatic controller shown in Figure 4–48. What control action does this controller pro- duce? Assume that the pneumatic relay has the character-istics that where K>0 . p c=Kpb ,156 Chapter 4 / Mathematical Modeling of Fluid Systems and Thermal Systems B–4–8. Figure 4–49 shows a flapper valve. It is placed between two opposing nozzles. If the flapper is moved slight- ly to the right, the pressure unbalance occurs in the nozzles and the power piston moves to the left, and vice versa. Such a device is frequently used in hydraulic servos as the first- stage valve in two-stage servovalves. This usage occurs because considerable force may be needed to stroke larger spool valves that result from the steady-state flow force. To reduce or compensate this force, two-stage valve configura- tion is often employed; a flapper valve or jet pipe is used as the first-stage valve to provide a necessary force to stroke the second-stage spool valve.diagram of the system of Figure 4–50 and then find the trans- fer function between yandx, where xis the air pressure and yis the displacement of the power piston. x y Oil under pressure Oil under pressure y Flapper x Figure 4–49 Flapper valve. u fl a b Oil under pressure Figure 4–51 Aircraft elevator control system.B–4–9. Figure 4–51 is a schematic diagram of an aircraft elevator control system. The input to the system is the de- flection angle uof the control lever, and the output is the el- evator angle f. Assume that angles uandfare relatively small. Show that for each angle uof the control lever there is a corresponding (steady-state) elevator angle f.Figure 4–50 Schematic diagram of a hydraulic servomotor. Figure 4–50 shows a schematic diagram of a hydraulic servomotor in which the error signal is amplified in two stages using a jet pipe and a pilot valve. Draw a block Openmirrors.comProblems 157B–4–10. Consider the liquid-level control system shown in Figure 4–52. The inlet valve is controlled by a hydraulicintegral controller.Assume that the steady-state inflow rateis and steady-state outflow rate is also the steady-statehead is steady-state pilot valve displacement is and steady-state valve position is We assume that the setpoint corresponds to the steady-state head The setpoint is fixed. Assume also that the disturbance inflow rate q d, which is a small quantity, is applied to the water tank at t=0 .This disturbance causes the head to change from to This change results in a change in the outflow rate byqo. Through the hydraulic controller, the change in head causes a change in the inflow rate from to (The integral controller tends to keep the head constant as muchas possible in the presence of disturbances.) We assume thatall changes are of small quantities.Q–+q i . Q–H–+h.H–H–. R–Y–.X–=0, H–,Q–, Q–We assume that the velocity of the power piston (valve) is proportional to pilot-valve displacement x,o r where K1is a positive constant. We also assume that the change in the inflow rate qiis negatively proportional to the change in the valve opening y,o r where Kvis a positive constant. Assuming the following numerical values for the system, C=2 m2, R=0.5 sec /H20862m2, Kv=1 m2/H20862sec a=0.25 m, b=0.75 m, K1=4 sec–1 obtain the transfer function H(s)/ Qd(s).qi=-Kv ydy dt=K1 x C(Capacitance) R (Resistance)a b h Y+yqd Q+qi H+h Q+qox Figure 4–52 Liquid-level control system.158 Chapter 4 / Mathematical Modeling of Fluid Systems and Thermal Systems B–4–11. Consider the controller shown in Figure 4–53.The input is the air pressure p i measured from some steady-state reference pressure and the output is the displacement yof the power piston. Obtain the transfer function Y(s) /H20862P i (s).P–B–4–12. A thermocouple has a time constant of 2 sec. A thermal well has a time constant of 30 sec. When the ther- mocouple is inserted into the well, this temperature- measuring device can be considered a two-capacitance system. Determine the time constants of the combined thermo- couple–thermal-well system.Assume that the weight of the thermocouple is 8 g and the weight of the thermal well is 40 g.Assume also that the specific heats of the thermocouple and thermal well are the same. aa bb Airp i (Input) y(Output)x kBellows Figure 4–53 Controller. Openmirrors.com5 159Transient and Steady-State Response Analyses 5–1 INTRODUCTION In early chapters it was stated that the first step in analyzing a control system was to de- rive a mathematical model of the system. Once such a model is obtained, various meth-ods are available for the analysis of system performance. In practice, the input signal to a control system is not known ahead of time but is random in nature, and the instantaneous input cannot be expressed analytically. Only insome special cases is the input signal known in advance and expressible analytically orby curves, such as in the case of the automatic control of cutting tools. In analyzing and designing control systems, we must have a basis of comparison of performance of various control systems.This basis may be set up by specifying particulartest input signals and by comparing the responses of various systems to these input signals. Many design criteria are based on the response to such test signals or on the re- sponse of systems to changes in initial conditions (without any test signals). The use oftest signals can be justified because of a correlation existing between the response char-acteristics of a system to a typical test input signal and the capability of the system to copewith actual input signals. Typical Test Signals. The commonly used test input signals are step functions, ramp functions, acceleration functions, impulse functions, sinusoidal functions, and whitenoise. In this chapter we use test signals such as step, ramp, acceleration and impulsesignals. With these test signals, mathematical and experimental analyses of control sys-tems can be carried out easily, since the signals are very simple functions of time.aaaa 160 Chapter 5 / Transient and Steady-State Response Analyses Which of these typical input signals to use for analyzing system characteristics may be determined by the form of the input that the system will be subjected to most frequently under normal operation. If the inputs to a control system are gradually changing functions of time, then a ramp function of time may be a good test signal. Sim- ilarly, if a system is subjected to sudden disturbances, a step function of time may be a good test signal; and for a system subjected to shock inputs, an impulse function may be best. Once a control system is designed on the basis of test signals, the performance of the system in response to actual inputs is generally satisfactory. The use of such test signals enables one to compare the performance of many systems on the same basis. Transient Response and Steady-State Response. The time response of a control system consists of two parts: the transient response and the steady-state response. By transient response, we mean that which goes from the initial state to the final state. By steady-state response, we mean the manner in which the system output behaves as tapproaches infinity. Thus the system response c(t) may be written as where the first term on the right-hand side of the equation is the transient response and the second term is the steady-state response. Absolute Stability, Relative Stability, and Steady-State Error. In designing a control system, we must be able to predict the dynamic behavior of the system from a knowledge of the components. The most important characteristic of the dynamic behavior of a control system is absolute stability—that is, whether the system is stable or unstable.A control system is in equilibrium if, in the absence of any disturbance or input, the output stays in the same state.A linear time-invariant control system is stable if the output eventually comes back to its equilibrium state when the system is subjected to an initial condition. A linear time-invariant control system is critically stable if oscilla- tions of the output continue forever. It is unstable if the output diverges without bound from its equilibrium state when the system is subjected to an initial condition.Actually, the output of a physical system may increase to a certain extent but may be limited by mechanical “stops,” or the system may break down or become nonlinear after the out- put exceeds a certain magnitude so that the linear differential equations no longer apply. Important system behavior (other than absolute stability) to which we must give careful consideration includes relative stability and steady-state error. Since a physical control system involves energy storage, the output of the system, when subjected to an input, cannot follow the input immediately but exhibits a transient response before a steady state can be reached. The transient response of a practical control system often exhibits damped oscillations before reaching a steady state. If the output of a system at steady state does not exactly agree with the input, the system is said to have steady- state error. This error is indicative of the accuracy of the system. In analyzing a control system, we must examine transient-response behavior and steady-state behavior. Outline of the Chapter. This chapter is concerned with system responses to aperiodic signals (such as step, ramp, acceleration, and impulse functions of time). The outline of the chapter is as follows: Section 5–1 has presented introductory material for the chapter. Section 5–2 treats the response of first-order systems to aperiodic inputs. Section 5–3 deals with the transient response of the second-order systems. Detailedc(t) =c tr (t)+c ss (t) Openmirrors.comaa Section 5–2 / First-Order Systems 161R(s) E(s) C(s) R(s) C(s) (a) (b)1 Ts1 Ts+ 1+–Figure 5–1 (a) Block diagram ofa first-order system; (b) simplified block diagram.analyses of the step response, ramp response, and impulse response of the second-order systems are presented. Section 5–4 discusses the transient-response analysis of higher-order systems. Section 5–5 gives an introduction to the MATLAB approach to the solutionof transient-response problems. Section 5–6 gives an example of a transient-responseproblem solved with MATLAB. Section 5–7 presents Routh’s stability criterion. Section5–8 discusses effects of integral and derivative control actions on system performance.Finally, Section 5–9 treats steady-state errors in unity-feedback control systems. 5–2 FIRST-ORDER SYSTEMS Consider the first-order system shown in Figure 5–1(a). Physically, this system may represent an RCcircuit, thermal system, or the like.A simplified block diagram is shown in Figure 5–1(b). The input-output relationship is given by (5–1) In the following, we shall analyze the system responses to such inputs as the unit-step, unit-ramp, and unit-impulse functions. The initial conditions are assumed to be zero. Note that all systems having the same transfer function will exhibit the same output in response to the same input. For any given physical system, the mathematical responsecan be given a physical interpretation. Unit-Step Response of First-Order Systems. Since the Laplace transform of the unit-step function is 1/s, substituting R(s)=1/s into Equation (5–1), we obtain Expanding C(s) into partial fractions gives (5–2) Taking the inverse Laplace transform of Equation (5–2), we obtain fort/H113500 (5–3) Equation (5–3) states that initially the output c(t) is zero and finally it becomes unity. One important characteristic of such an exponential response curve c(t)is that at t=T the value of c(t) is 0.632, or the response c(t) has reached 63.2 %of its total change.This may be easily seen by substituting t=T inc(t). That is, c(T) =1-e -1=0.632c(t) =1-e-t/H20862T,C(s) =1 s-T Ts+1=1 s-1 s+(1/H20862T)C(s) =1 Ts+11 sC(s) R(s)=1 Ts+1aa 162 Chapter 5 / Transient and Steady-State Response Analyses c(t) 1 00.632AB T 2T 3T 4T 5TtSlope =1 T c(t)= 1 –e – (t/T) 63.2% 86.5% 95% 98.2% 99.3% Figure 5–2 Exponential response curve. Note that the smaller the time constant T, the faster the system response. Another important characteristic of the exponential response curve is that the slope of the tangent line at t=0 is1/T, since (5–4) The output would reach the final value at t=T if it maintained its initial speed of response. From Equation (5–4) we see that the slope of the response curve c(t)decreases monotonically from 1/Tatt=0 to zero at t=q. The exponential response curve c(t)given by Equation (5–3) is shown in Figure 5–2. In one time constant, the exponential response curve has gone from 0 to 63.2 %of the final value. In two time constants, the response reaches 86.5 %of the final value.At t=3T ,4T, and5T, the response reaches 95 %, 98.2 %, and 99.3 %, respectively, of the final value.Thus, fort/H113504T, the response remains within 2 %of the final value. As seen from Equation (5–3), the steady state is reached mathematically only after an infinite time. In practice, however, a reasonable estimate of the response time is the length of time the response curve needs to reach and stay within the 2 %line of the final value, or four time constants. Unit-Ramp Response of First-Order Systems. Since the Laplace transform of the unit-ramp function is 1/s 2 , we obtain the output of the system of Figure 5–1(a) as Expanding C(s) into partial fractions gives (5–5) Taking the inverse Laplace transform of Equation (5–5), we obtain fort/H113500 (5–6) The error signal e(t) is then =TA1-e -t/H20862T B e(t) =r(t) -c(t)c(t) =t-T+Te -t/H20862T ,C(s) =1 s 2 -T s+T 2 Ts+1C(s) =1 Ts+11 s 2 dc dt 2 t=0 =1 Te -t/H20862T 2 t=0 =1 T Openmirrors.comaa Section 5–2 / First-Order Systems 163r(t) c(t) 6T 4T 2T 02 T 4T 6TtT T r(t)=t c(t)Steady-state error Figure 5–3 Unit-ramp responseof the system shown in Figure 5–1(a). c(t) 02 T T 4T 3Tt1 T c(t)=e– (t/T) 1 TFigure 5–4 Unit-impulseresponse of the system shown in Figure 5–1(a).Astapproaches infinity, e–t/Tapproaches zero, and thus the error signal e(t)approaches Tor The unit-ramp input and the system output are shown in Figure 5–3. The error in following the unit-ramp input is equal to Tfor sufficiently large t. The smaller the time constant T, the smaller the steady-state error in following the ramp input. Unit-Impulse Response of First-Order Systems. For the unit-impulse input, R(s)=1 and the output of the system of Figure 5–1(a) can be obtained as (5–7) The inverse Laplace transform of Equation (5–7) gives fort/H113500 (5–8) The response curve given by Equation (5–8) is shown in Figure 5–4.c(t) =1 Te-t/H20862T,C(s) =1 Ts+1e(q)=Taa 164 Chapter 5 / Transient and Steady-State Response Analyses An Important Property of Linear Time-Invariant Systems. In the analysis above, it has been shown that for the unit-ramp input the output c(t) is fort/H113500 [See Equation (5–6).] For the unit-step input, which is the derivative of unit-ramp input, the output c(t) is fort/H113500 [See Equation (5–3).] Finally, for the unit-impulse input, which is the derivative of unit-step input, the output c(t) is fort/H113500 [See Equation (5–8).] Comparing the system responses to these three inputs clearly indicates that the response to the derivative of an input signal can be obtained by differentiating the re sponse of the system to the original signal. It can also be seen that the response to the integral of the original signal can be obtained by integrating the response of the system to the original signal and by determining the integration constant from the zero-output initial condi- tion.This is a property of linear time-invariant systems. Linear time-varying systems and nonlinear systems do not possess this property. 5–3 SECOND-ORDER SYSTEMS In this section, we shall obtain the response of a typical second-order control system to a step input, ramp input, and impulse input. Here we consider a servo system as an example of a second-order system. Servo System. The servo system shown in Figure 5–5(a) consists of a proportional controller and load elements (inertia and viscous-friction elements). Suppose that we wish to control the output position cin accordance with the input position r. The equation for the load elements is where Tis the torque produced by the proportional controller whose gain is K.B y taking Laplace transforms of both sides of this last equation, assuming the zero initial conditions, we obtain So the transfer function between C(s) andT(s) is By using this transfer function, Figure 5–5(a) can be redrawn as in Figure 5–5(b), which can be modified to that shown in Figure 5–5(c).The closed-loop transfer function is then obtained as Such a system where the closed-loop transfer function possesses two poles is called a second-order system. (Some second-order systems may involve one or two zeros.)C(s) R(s)=K Js 2 +Bs+K=K/H20862J s 2 +(B/H20862J)s +(K /H20862J)C(s) T(s)=1 s(Js +B)Js 2 C(s) +BsC(s) =T(s)Jc$+Bc#=T c(t) =1 Te -t/H20862T , c(t) =1-e -t/H20862T , c(t) =t-T+Te -t/H20862T , Openmirrors.comaa Section 5–3 / Second-Order Systems 165+–r K 1 s(Js+B)ec T JB (a) +–R(s) R(s)C(s) C(s)T(s) (b)K K s(Js+B)+– (c)Figure 5–5 (a) Servo system;(b) block diagram; (c) simplified block diagram. Step Response of Second-Order System. The closed-loop transfer function of the system shown in Figure 5–5(c) is (5–9) which can be rewritten as The closed-loop poles are complex conjugates if B2-4JK<0 and they are real if B2-4JK /H113500. In the transient-response analysis, it is convenient to write wheresis called the attenuation ;vn, the undamped natural frequency ; and z, the damp- ing ratio of the system. The damping ratio zis the ratio of the actual damping Bto the critical damping or z=B Bc=B 21JKBc=21JKK J=v2 n , B J=2zvn=2sC(s) R(s)=K J cs+B 2J+BaB 2Jb2 -K Jdcs+B 2J-BaB 2Jb2 -K JdC(s) R(s)=K Js2+Bs+Kaa 166 Chapter 5 / Transient and Steady-State Response Analyses R(s) E(s) C(s)v n s(s+ 2zv n ) 2 +– Figure 5–6 Second-order system. In terms of zandv n , the system shown in Figure 5–5(c) can be modified to that shown in Figure 5–6, and the closed-loop transfer function C(s)/R(s) given by Equation (5–9) can be written (5–10) This form is called the standard form of the second-order system. The dynamic behavior of the second-order system can then be described in terms of two parameters zandv n . If 0<z<1 , the closed-loop poles are complex conjugates and lie in the left-half splane. The system is then called underdamped, and the tran- sient response is oscillatory. If z=0 , the transient response does not die out. If z=1 , the system is called critically damped. Overdamped systems correspond to z>1 . We shall now solve for the response of the system shown in Figure 5–6 to a unit-step input. We shall consider three different cases: the underdamped (0<z<1) , critically damped (z=1) , and overdamped (z>1) cases. (1)Underdamped case (0<z<1) : In this case, C(s)/R(s) can be written where The frequency v d is called the damped natural frequency .F o r a unit-step input, C(s) can be written (5–11) The inverse Laplace transform of Equation (5–11) can be obtained easily if C(s) is writ- ten in the following form: Referring to the Laplace transform table in Appendix A, it can be shown that l -1 c v d As+zv n B 2 +v 2 d d =e -zv n t sinv d t l -1 c s+zv n As+zv n B 2 +v 2 d d =e -zv n t cosv d t =1 s-s+zv n As+zv n B 2 +v 2 d -zv n As+zv n B 2 +v 2 d C(s) =1 s-s+2zv n s 2 +2zv n s+v 2 n C(s) =v 2 n As 2 +2zv n s+v 2 n Bsv d =v n 21-z 2 .C(s) R(s)=v 2 n As+zv n +jv d BAs+zv n -jv d BC(s) R(s)=v 2 n s 2 +2zv n s+v 2 n Openmirrors.comaa Section 5–3 / Second-Order Systems 167Hence the inverse Laplace transform of Equation (5–11) is obtained as fort/H113500 (5–12) From Equation (5–12), it can be seen that the frequency of transient oscillation is the damped natural frequency vdand thus varies with the damping ratio z.The error signal for this system is the difference between the input and output and is fort/H113500 This error signal exhibits a damped sinusoidal oscillation. At steady state, or at t=q, no error exists between the input and output. If the damping ratio zis equal to zero, the response becomes undamped and oscillations continue indefinitely. The response c(t) for the zero damping case may be obtained by substituting z=0 in Equation (5–12), yielding fort/H113500 (5–13) Thus, from Equation (5–13), we see that vnrepresents the undamped natural frequen- cy of the system.That is, vnis that frequency at which the system output would oscillate if the damping were decreased to zero. If the linear system has any amount of damping,the undamped natural frequency cannot be observed experimentally. The frequency that may be observed is the damped natural frequency v d, which is equal to This frequency is always lower than the undamped natural frequency. An increase in z would reduce the damped natural frequency vd.I f zis increased beyond unity, the response becomes overdamped and will not oscillate. (2)Critically damped case (z=1) : If the two poles of C(s)/R(s) are equal, the system is said to be a critically damped one. For a unit-step input, R(s)=1/s andC(s) can be written (5–14) The inverse Laplace transform of Equation (5–14) may be found as fort/H113500 (5–15) This result can also be obtained by letting zapproach unity in Equation (5–12) and by using the following limit: lim zS1sinvd t 21-z2=lim zS1sinvn21-z2t 21-z2=vn tc(t) =1-e-vn tA1+vn tB,C(s) =v2 n As+vnB2svn21-z2.c(t) =1-cosvn t, =e-zvn tacosvd t+z 21-z2sinvd tb, e(t) =r(t) -c(t) =1-e-zvn t 21-z2sin avd t+tan-1 21-z2 zb, =1-e-zvn tacosvd t+z 21-z2sinvd tb l-1CC(s)D=c(t)aa 168 Chapter 5 / Transient and Steady-State Response Analyses (3)Overdamped case (z>1) : In this case, the two poles of C(s)/R(s) are negative real and unequal. For a unit-step input, R(s)=1/s andC(s) can be written (5–16) The inverse Laplace transform of Equation (5–16) is fort/H113500 (5–17) where and Thus, the response c(t) includes two decaying exponential terms. When zis appreciably greater than unity, one of the two decaying exponentials decreases much faster than the other, so the faster-decaying exponential term (which corresponds to a smaller time constant) may be neglected. That is, if –s 2 is located very much closer to the jvaxis than –s 1 Awhich means @s 2 @/H11270@s 1 @B, then for an approximate solution we may neglect –s 1 .This is permissible because the effect of –s 1 on the response is much smaller than that of –s 2 , since the term involving s 1 in Equation (5–17) decays much faster than the term involving s 2 . Once the faster-decaying exponential term has disappeared, the response is similar to that of a first-order system, and C(s)/R(s) may be approximated by This approximate form is a direct consequence of the fact that the initial values and final values of both the original C(s)/R(s) and the approximate one agree with each other. With the approximate transfer function C(s)/R(s) , the unit-step response can be obtained as The time response c(t) is then fort/H113500 This gives an approximate unit-step response when one of the poles of C(s)/R(s) can be neglected.c(t) =1-e -Az-2z 2 -1 Bv n t ,C(s) =zv n -v n 2z 2 -1 As+zv n -v n 2z 2 -1 BsC(s) R(s)=zv n -v n 2z 2 -1 s+zv n -v n 2z 2 -1 =s 2 s+s 2 s 2 =Az-2z 2 -1 Bv n . s 1 =Az+2z 2 -1 Bv n =1+v n 22z 2 -1 a e -s 1 t s 1 -e -s 2 t s 2 b ,-1 22z 2 -1 Az-2z 2 -1 Be -Az-2z 2 -1 Bv n t c(t) =1+1 22z 2 -1 Az+2z 2 -1 Be -Az+2z 2 -1 Bv n t C(s) =v 2 n As+zv n +v n 2z 2 -1 BAs+zv n -v n 2z 2 -1 Bs Openmirrors.comaa Section 5–3 / Second-Order Systems 1692.0 1.8 1.6 1.4 1.2 1.0 0.8 0.6 0.4 0.2 0 123456789 1 0 1 1 1 20.8 vntc(t)z = 0 0.1 0.2 0.3 0.40.5 0.6 0.7 1.0 2.0 Figure 5–7 Unit-step responsecurves of the system shown in Figure 5–6. A family of unit-step response curves c(t) with various values of zis shown in Fig- ure 5–7, where the abscissa is the dimensionless variable vnt. The curves are functions only of z. These curves are obtained from Equations (5–12), (5–15), and (5–17). The system described by these equations was initially at rest. Note that two second-order systems having the same zbut different vnwill exhibit the same overshoot and the same oscillatory pattern. Such systems are said to have thesame relative stability. From Figure 5–7, we see that an underdamped system with zbetween 0.5 and 0.8 gets close to the final value more rapidly than a critically damped or overdamped system.Among the systems responding without oscillation, a critically damped system exhibitsthe fastest response.An overdamped system is always sluggish in responding to any inputs. It is important to note that, for second-order systems whose closed-loop transfer functions are different from that given by Equation (5–10), the step-response curvesmay look quite different from those shown in Figure 5–7. Definitions of Transient-Response Specifications. Frequently, the perform- ance characteristics of a control system are specified in terms of the transient response toa unit-step input, since it is easy to generate and is sufficiently drastic. (If the response toa step input is known, it is mathematically possible to compute the response to any input.) The transient response of a system to a unit-step input depends on the initial condi- tions. For convenience in comparing transient responses of various systems, it is a com-mon practice to use the standard initial condition that the system is at rest initially withthe output and all time derivatives thereof zero. Then the response characteristics ofmany systems can be easily compared. The transient response of a practical control system often exhibits damped oscilla- tions before reaching steady state. In specifying the transient-response characteristics ofa control system to a unit-step input, it is common to specify the following: 1.Delay time, t d 2.Rise time, traa 170 Chapter 5 / Transient and Steady-State Response Analyses c(t) 0.51 0Allowable tolerance M p t d t0.05 or 0.02 t r t p t s Figure 5–8 Unit-step response curve showing t d , t r , t p ,M p , and t s . 3.Peak time, t p 4.Maximum overshoot, M p 5.Settling time, t s These specifications are defined in what follows and are shown graphically in Figure 5–8. 1.Delay time, t d : The delay time is the time required for the response to reach half the final value the very first time. 2.Rise time, t r : The rise time is the time required for the response to rise from 10 % to 90 %,5%to 95 %, or 0 %to 100 %of its final value. For underdamped second- order systems, the 0 %to 100 %rise time is normally used. For overdamped systems, the 10 %to 90 %rise time is commonly used. 3.Peak time, t p :The peak time is the time required for the response to reach the first peak of the overshoot. 4.Maximum (percent) overshoot, M p : The maximum overshoot is the maximum peak value of the response curve measured from unity. If the final steady-state value of the response differs from unity, then it is common to use the maximum percent overshoot. It is defined by The amount of the maximum (percent) overshoot directly indicates the relative stability of the system. 5.Settling time, t s : The settling time is the time required for the response curve to reach and stay within a range about the final value of size specified by absolute per- centage of the final value (usually 2 %or 5%). The settling time is related to the largest time constant of the control system.Which percentage error criterion to use may be determined from the objectives of the system design in question. The time-domain specifications just given are quite important, since most control systems are time-domain systems; that is, they must exhibit acceptable time responses. (This means that, the control system must be modified until the transient response is satisfactory.)Maximum percent overshoot =cAt p B-c(q) c(q)*100% Openmirrors.comaa Section 5–3 / Second-Order Systems 171 jv jv d v n sb zv n –s v n 1–z 2 0 Figure 5–9 Definition of the angleb. Note that not all these specifications necessarily apply to any given case. For exam- ple, for an overdamped system, the terms peak time and maximum overshoot do not apply. (For systems that yield steady-state errors for step inputs, this error must be kept within a specified percentage level. Detailed discussions of steady-state errors are post- poned until Section 5–8.) A Few Comments on Transient-Response Specifications. Except for certain applications where oscillations cannot be tolerated, it is desirable that the transient re- sponse be sufficiently fast and be sufficiently damped.Thus, for a desirable transient re- sponse of a second-order system, the damping ratio must be between 0.4 and 0.8. Small values of z(that is, z<0.4) yield excessive overshoot in the transient response, and a system with a large value of z(that is,z>0.8) responds sluggishly. We shall see later that the maximum overshoot and the rise time conflict with each other. In other words, both the maximum overshoot and the rise time cannot be made smaller simultaneously. If one of them is made smaller, the other necessarily becomes larger. Second-Order Systems and Transient-Response Specifications. In the fol- lowing, we shall obtain the rise time, peak time, maximum overshoot, and settling time of the second-order system given by Equation (5–10). These values will be obtained in terms of zandv n . The system is assumed to be underdamped. Rise time t r : Referring to Equation (5–12), we obtain the rise time t r by letting cAt r B=1. (5–18) Since we obtain from Equation (5–18) the following equation: Since and , we have Thus, the rise time t r is (5–19) where angle bis defined in Figure 5–9. Clearly, for a small value of t r ,v d must be large.t r =1 v d tan -1 a v d -s b =p-b v d tanv d t r =- 21-z 2 z=- v d szv n =s v n 21-z 2 =v d cosv d t r +z 21-z 2 sinv d t r =0e -zv n t r Z0,cAt r B=1=1-e -zv n t r a cosv d t r +z 21-z 2 sinv d t r b Openmirrors.comaa 172 Chapter 5 / Transient and Steady-State Response Analyses Peak time t p : Referring to Equation (5–12), we may obtain the peak time by differen- tiating c(t) with respect to time and letting this derivative equal zero. Since and the cosine terms in this last equation cancel each other, dc/H20862dt, evaluated at t=t p , can be simplified to This last equation yields the following equation: or Since the peak time corresponds to the first peak overshoot, Hence (5–20) The peak time t p corresponds to one-half cycle of the frequency of damped oscillation. Maximum overshoot M p : The maximum overshoot occurs at the peak time or at t=t p =p/H20862v d .Assuming that the final value of the output is unity, M p is obtained from Equation (5–12) as (5–21) The maximum percent overshoot is If the final value c(q)of the output is not unity, then we need to use the following equation: Settling time t s : For an underdamped second-order system, the transient response is obtained from Equation (5–12) as fort/H113500 c(t) =1-e -zv n t 21-z 2 sin a v d t+tan -1 21-z 2 z b ,M p =cAt p B-c(q) c(q)e -As/H20862v d Bp *100%. =e -As/H20862v d Bp =e -Az/H2086221-z 2 Bp =-e -zv n Ap/H20862v d B a cosp+z 21-z 2 sinp b M p =cAt p B-1t p =p v d v d t p =p.v d t p =0, p, 2p, 3p,psinv d t p =0dc dt 2 t=t p =Asinv d t p B v n 21-z 2 e -zv n t p =0 +e -zv n t a v d sinv d t-zv d 21-z 2 cosv d t b dc dt=zv n e -zv n t a cosv d t+z 21-z 2 sinv d t b Openmirrors.comaa Section 5–3 / Second-Order Systems 1731c(t) 1+1 1–z2 1+e–zvnt 1–z2 T=1 zvn 1 –e–zvnt 1–z2 0 1–1 1–z23T 4Tt T 2TFigure 5–10 Pair of envelopecurves for the unit- step response curve of the system shownin Figure 5–6. The curves are the envelope curves of the transient response to a unit-step input. The response curve c(t) always remains within a pair of the envelope curves, as shown in Figure 5–10. The time constant of these envelope curves is 1 /H20862zvn. The speed of decay of the transient response depends on the value of the time constant 1/H20862zvn. For a given vn, the settling time tsis a function of the damping ratio z. From Figure 5–7, we see that for the same vnand for a range of zbetween 0 and 1 the settling time tsfor a very lightly damped system is larger than that for a properly damped system. For an overdamped system, the settling time tsbecomes large because of the sluggish response. The settling time corresponding to a ;2%or;5%tolerance band may be measured in terms of the time constant T=1 /H20862zvnfrom the curves of Figure 5–7 for different values of z.The results are shown in Figure 5–11. For 0<z<0.9 , if the 2 %criterion is used, tsis approximately four times the time constant of the system. If the 5 %criterion is used, then tsis approximately three times the time constant. Note that the settling time reaches a minimum value around z=0.76 (for the 2 %criterion) or z=0.68 (for the 5 %criterion) and then increases almost linearly for large values of z. The discontinuities in the curves of Figure 5–11 arise because an infinitesimal changein the value of zcan cause a finite change in the settling time. For convenience in comparing the responses of systems, we commonly define the settling time t sto be (2%criterion) (5–22) or (5%criterion) (5–23) Note that the settling time is inversely proportional to the product of the damping ratio and the undamped natural frequency of the system. Since the value of zis usually determined from the requirement of permissible maximum overshoot, the settling timets=3T=3 s=3 zvnts=4T=4 s=4 zvn1;Ae-zvn t/H2086221-z2Baa 174 Chapter 5 / Transient and Steady-State Response Analyses z% 100 90 80 70 60 50 40 30 20 10 0 0.5 1.0 1.5M p M p : Maximum overshootC(s) R(s)=v n s 2 + 2zv n s+v n2 2 Figure 5–12 M p versuszcurve. 2T3T4T T5T6T 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1.0 z Settling time, t s 5% Tolerance band 2% Tolerance band Figure 5–11 Settling time t s versuszcurves. is determined primarily by the undamped natural frequency v n . This means that the duration of the transient period may be varied, without changing the maximum over- shoot, by adjusting the undamped natural frequency v n . From the preceding analysis, it is evident that for rapid response v n must be large.To limit the maximum overshoot M p and to make the settling time small, the damping ratio zshould not be too small. The relationship between the maximum percent overshoot M p and the damping ratio zis presented in Figure 5–12. Note that if the damping ratio is between 0.4 and 0.7, then the maximum percent overshoot for step response is between 25 %and 4 %. Openmirrors.comaa Section 5–3 / Second-Order Systems 175It is important to note that the equations for obtaining the rise time, peak time, max- imum overshoot, and settling time are valid only for the standard second-order systemdefined by Equation (5–10). If the second-order system involves a zero or two zeros,the shape of the unit-step response curve will be quite different from those shown inFigure 5–7. EXAMPLE 5–1 Consider the system shown in Figure 5–6, where z=0.6 andvn=5 rad /H20862sec. Let us obtain the rise time tr, peak time tp, maximum overshoot Mp, and settling time tswhen the system is subjected to a unit-step input. From the given values of zandvn, we obtain and s=zvn=3 . Rise time tr: The rise time is wherebis given by The rise time tris thus Peak time tp: The peak time is Maximum overshoot Mp: The maximum overshoot is The maximum percent overshoot is thus 9.5 %. Settling time ts: For the 2 %criterion, the settling time is For the 5 %criterion, Servo System with Velocity Feedback. The derivative of the output signal can be used to improve system performance. In obtaining the derivative of the outputposition signal, it is desirable to use a tachometer instead of physically differentiating theoutput signal. (Note that the differentiation amplifies noise effects. In fact, ifdiscontinuous noises are present, differentiation amplifies the discontinuous noises morethan the useful signal. For example, the output of a potentiometer is a discontinuousvoltage signal because, as the potentiometer brush is moving on the windings, voltagesare induced in the switchover turns and thus generate transients. The output of the po-tentiometer therefore should not be followed by a differentiating element.)ts=3 s=3 3=1 sects=4 s=4 3=1.33 secMp=e-As/H20862vdBp=e-(3/H208624)*3.14=0.095tp=p vd=3.14 4=0.785 sectr=3.14 -0.93 4=0.55 secb=tan-1vd s=tan-14 3=0.93 radtr=p-b vd=3.14 -b 4vd=vn21-z2=4aa 176 Chapter 5 / Transient and Steady-State Response Analyses R(s) C(s) (a)1 s K Js+B K h R(s) C(s) (b)K s(Js+B+KK h ) +– +– +– Figure 5–13 (a) Block diagram of a servo system; (b) simplified block diagram. The tachometer, a special dc generator, is frequently used to measure velocity with- out differentiation process. The output of a tachometer is proportional to the angular velocity of the motor. Consider the servo system shown in Figure 5–13(a). In this device, the velocity signal, together with the positional signal, is fed back to the input to produce the actuating error signal. In any servo system, such a velocity signal can be easily generated by a tachometer. The block diagram shown in Figure 5–13(a) can be simplified, as shown in Figure 5–13(b), giving (5–24) Comparing Equation (5–24) with Equation (5–9), notice that the velocity feedback has the effect of increasing damping. The damping ratio zbecomes (5–25) The undamped natural frequency is not affected by velocity feedback. Not- ing that the maximum overshoot for a unit-step input can be controlled by controlling the value of the damping ratio z, we can reduce the maximum overshoot by adjusting the velocity-feedback constant K h so that zis between 0.4 and 0.7. It is important to remember that velocity feedback has the effect of increasing the damping ratio without affecting the undamped natural frequency of the system. EXAMPLE 5–2 For the system shown in Figure 5–13(a), determine the values of gain Kand velocity-feedback constant K h so that the maximum overshoot in the unit-step response is 0.2 and the peak time is 1 sec. With these values of KandK h , obtain the rise time and settling time.Assume that J=1 kg-m 2 and B=1 N-m /H20862rad /H20862sec. Determination of the values of K and K h : The maximum overshoot M p is given by Equation (5–21) as M p =e -Az/H2086221-z 2 Bp v n =1K/H20862J z=B+KK h 21KJ C(s) R(s)=K Js 2 +AB+KK h Bs+K Openmirrors.comaa Section 5–3 / Second-Order Systems 177This value must be 0.2. Thus, or which yields The peak time tpis specified as 1 sec; therefore, from Equation (5–20), or Sincezis 0.456, vnis Since the natural frequency vnis equal to Then Khis, from Equation (5–25), Rise time tr: From Equation (5–19), the rise time tris where Thus, tris Settling time ts: For the 2 %criterion, For the 5 %criterion, ts=3 s=1.86 sects=4 s=2.48 sectr=0.65 secb=tan-1vd s=tan-11.95 =1.10tr=p-b vdKh=21KJz-B K=21Kz-1 K=0.178 secK=Jv2 n=v2 n=12.5 N-m1K/H20862J,vn=vd 21-z2=3.53vd=3.14tp=p vd=1z=0.456zp 21-z2=1.61e-Az/H2086221-z2Bp=0.2aa 178 Chapter 5 / Transient and Steady-State Response Analyses 1.0 0.8 0.6 0.4 0.2 0 –0.2 –0.4 –0.6 –0.8 –1.0 0 2468 1 0 12 v n tc(t) v n z = 0.1 z = 0.3 z = 0.5 z = 0.7 z = 1.0 Figure 5–14 Unit-impulse response curves of the system shown in Figure 5–6. Impulse Response of Second-Order Systems. For a unit-impulse input r(t), the corresponding Laplace transform is unity, or R(s)=1 .The unit-impulse response C(s) of the second-order system shown in Figure 5-6 is The inverse Laplace transform of this equation yields the time solution for the response c(t) as follows: For 0 /H11349z<1 , fort/H113500 (5–26) For z=1 , fort/H113500 (5–27) For z>1 , fort/H113500 (5–28) Note that without taking the inverse Laplace transform of C(s) we can also obtain the time response c(t) by differentiating the corresponding unit-step response, since the unit-impulse function is the time derivative of the unit-step function. A family of unit-impulse response curves given by Equations (5–26) and (5–27) with various val- ues of zis shown in Figure 5–14. The curves c(t)/v n are plotted against the dimen- sionless variable v n t, and thus they are functions only of z. For the critically damped and overdamped cases, the unit-impulse response is always positive or zero; that is, c(t) /H113500. This can be seen from Equations (5–27) and (5–28). For the underdamped case, the unit-impulse response c(t) oscillates about zero and takes both positive and negative values.c(t) =v n 22z 2 -1 e -Az-2z 2 -1 Bv n t -v n 22z 2 -1 e -Az+2z 2 -1 Bv n t ,c(t) =v 2 n te -v n t ,c(t) =v n 21-z 2 e -zv n t sinv n 21-z 2 t,C(s) =v 2 n s 2 +2zv n s+v 2 n Openmirrors.comaa Section 5–4 / Higher-Order Systems 179c(t) 0Unit-impulse response 1+Mp tptFigure 5–15 Unit-impulseresponse curve of the system shown in Figure 5–6. From the foregoing analysis, we may conclude that if the impulse response c(t)does not change sign, the system is either critically damped or overdamped, in which casethe corresponding step response does not overshoot but increases or decreases monot-onically and approaches a constant value. The maximum overshoot for the unit-impulse response of the underdamped system occurs at where 0<z<1 (5–29) [Equation (5–29) can be obtained by equating dc/H20862dtto zero and solving for t.] The max- imum overshoot is where 0<z<1 (5–30) [Equation (5–30) can be obtained by substituting Equation (5–29) into Equation (5–26).] Since the unit-impulse response function is the time derivative of the unit-step response function, the maximum overshoot M pfor the unit-step response can be found from the corresponding unit-impulse response.That is, the area under the unit-impulse response curve from t=0 to the time of the first zero, as shown in Figure 5–15, is 1+ M p, where Mpis the maximum overshoot (for the unit-step response) given by Equation (5–21). The peak time tp(for the unit-step response) given by Equation (5–20) corresponds to the time that the unit-impulse response first crossesthe time axis. 5–4 HIGHER-ORDER SYSTEMS In this section we shall present a transient-response analysis of higher-order systems in general terms. It will be seen that the response of a higher-order system is the sum of theresponses of first-order and second-order systems.c(t) max=vn expa-z 21-z2tan-121-z2 zb,t=tan-121-z2 z vn21-z2,aa 180 Chapter 5 / Transient and Steady-State Response Analyses +– R(s) C(s) G(s) H(s) Figure 5–16 Control system. Transient Response of Higher-Order Systems. Consider the system shown in Figure 5–16. The closed-loop transfer function is (5–31) In general, G(s) andH(s) are given as ratios of polynomials in s,o r and where p(s), q(s), n(s) , and d(s) are polynomials in s.The closed-loop transfer function given by Equation (5–31) may then be written The transient response of this system to any given input can be obtained by a computer simulation. (See Section 5–5.) If an analytical expression for the transient response is de- sired, then it is necessary to factor the denominator polynomial. [MATLAB may be used for finding the roots of the denominator polynomial. Use the command roots(den) .] Once the numerator and the denominator have been factored, C(s)/R(s) can be writ- ten in the form (5–32) Let us examine the response behavior of this system to a unit-step input. Consider first the case where the closed-loop poles are all real and distinct. For a unit-step input, Equation (5–32) can be written (5–33) where a i is the residue of the pole at s=–p i . (If the system involves multiple poles, then C(s) will have multiple-pole terms.) [The partial-fraction expansion of C(s) ,a s given by Equation (5–33), can be obtained easily with MATLAB. Use the residue command. (See Appendix B.)] If all closed-loop poles lie in the left-half splane, the relative magnitudes of the residues determine the relative importance of the components in the expanded form ofC(s) =a s+a n i=1 a i s+p i C(s) R(s)=KAs+z 1 BAs+z 2 BpAs+z m B As+p 1 BAs+p 2 BpAs+p n B =b 0 s m +b 1 s m-1 +p+b m-1 s+b m a 0 s n +a 1 s n-1 +p+a n-1 s+a n (m/H11349n) C(s) R(s)=p(s)d(s) q(s)d(s) +p(s)n(s)H(s) =n(s) d(s)G(s) =p(s) q(s)C(s) R(s)=G(s) 1+G(s)H(s) Openmirrors.comaa Section 5–4 / Higher-Order Systems 181C(s) . If there is a closed-loop zero close to a closed-loop pole, then the residue at this pole is small and the coefficient of the transient-response term corresponding to this polebecomes small. A pair of closely located poles and zeros will effectively cancel eachother. If a pole is located very far from the origin, the residue at this pole may be small.The transients corresponding to such a remote pole are small and last a short time.Termsin the expanded form of C(s) having very small residues contribute little to the transient response, and these terms may be neglected. If this is done, the higher-order system maybe approximated by a lower-order one. (Such an approximation often enables us to es-timate the response characteristics of a higher-order system from those of a simplifiedone.) Next, consider the case where the poles of C(s) consist of real poles and pairs of complex-conjugate poles.A pair of complex-conjugate poles yields a second-order termins. Since the factored form of the higher-order characteristic equation consists of first- and second-order terms, Equation (5–33) can be rewritten where we assumed all closed-loop poles are distinct. [If the closed-loop poles involve multiple poles, C(s) must have multiple-pole terms.] From this last equation, we see that the response of a higher-order system is composed of a number of terms involving thesimple functions found in the responses of first- and second-order systems. The unit-step response c(t), the inverse Laplace transform of C(s) , is then fort/H113500 (5–34) Thus the response curve of a stable higher-order system is the sum of a number of exponential curves and damped sinusoidal curves. If all closed-loop poles lie in the left-half splane, then the exponential terms and the damped exponential terms in Equation (5–34) will approach zero as time tincreases. The steady-state output is then c(q)=a . Let us assume that the system considered is a stable one.Then the closed-loop poles that are located far from the jvaxis have large negative real parts. The exponential terms that correspond to these poles decay very rapidly to zero. (Note that the hori-zontal distance from a closed-loop pole to the jvaxis determines the settling time of tran- sients due to that pole. The smaller the distance is, the longer the settling time.) Remember that the type of transient response is determined by the closed-loop poles, while the shape of the transient response is primarily determined by the closed-loop zeros. As we have seen earlier, the poles of the input R(s) yield the steady-state response terms in the solution, while the poles of C(s)/R(s) enter into the exponential transient-response terms and/or damped sinusoidal transient-response terms.The zerosofC(s)/R(s) do not affect the exponents in the exponential terms, but they do affect the magnitudes and signs of the residues.+a r k=1ck e-zk vk tsinvk21-z2 kt,c(t) =a+aq j=1aj e-pj t+ar k=1bk e-zk vk tcosvk21-z2 ktC(s) =a s+aq j=1aj s+pj+ar k=1bkAs+zk vkB+ck vk21-z2 k s2+2zk vk s+v2 k (q+2r=n)aa 182 Chapter 5 / Transient and Steady-State Response Analyses Dominant Closed-Loop Poles. The relative dominance of closed-loop poles is determined by the ratio of the real parts of the closed-loop poles, as well as by the rel- ative magnitudes of the residues evaluated at the closed-loop poles. The magnitudes of the residues depend on both the closed-loop poles and zeros. If the ratios of the real parts of the closed-loop poles exceed 5 and there are no zeros nearby, then the closed-loop poles nearest the jvaxis will dominate in the transient- response behavior because these poles correspond to transient-response terms that decay slowly. Those closed-loop poles that have dominant effects on the transient- response behavior are called dominant closed-loop poles. Quite often the dominant closed-loop poles occur in the form of a complex-conjugate pair. The dominant closed- loop poles are most important among all closed-loop poles. Note that the gain of a higher-order system is often adjusted so that there will exist a pair of dominant complex-conjugate closed-loop poles. The presence of such poles in a stable system reduces the effects of such nonlinearities as dead zone, backlash, and coulomb-friction. Stability Analysis in the Complex Plane. The stability of a linear closed-loop system can be determined from the location of the closed-loop poles in the splane. If any of these poles lie in the right-half splane, then with increasing time they give rise to the dominant mode, and the transient response increases monotonically or oscillates with increasing amplitude. This represents an unstable system. For such a system, as soon as the power is turned on, the output may increase with time. If no saturation takes place in the system and no mechanical stop is provided, then the system may eventually be subjected to damage and fail, since the response of a real physical sys- tem cannot increase indefinitely.Therefore, closed-loop poles in the right-half splane are not permissible in the usual linear control system. If all closed-loop poles lie to the left of the jvaxis, any transient response eventually reaches equilibrium. This repre- sents a stable system. Whether a linear system is stable or unstable is a property of the system itself and does not depend on the input or driving function of the system. The poles of the input, or driving function, do not affect the property of stability of the system, but they con- tribute only to steady-state response terms in the solution.Thus, the problem of absolute stability can be solved readily by choosing no closed-loop poles in the right-half splane, including the jvaxis. (Mathematically, closed-loop poles on the jvaxis will yield oscil- lations, the amplitude of which is neither decaying nor growing with time. In practical cases, where noise is present, however, the amplitude of oscillations may increase at a rate determined by the noise power level. Therefore, a control system should not have closed-loop poles on the jvaxis.) Note that the mere fact that all closed-loop poles lie in the left-half splane does not guarantee satisfactory transient-response characteristics. If dominant complex-conjugate closed-loop poles lie close to the jvaxis, the transient response may exhibit excessive oscillations or may be very slow.Therefore, to guarantee fast, yet well-damped, transient- response characteristics, it is necessary that the closed-loop poles of the system lie in a particular region in the complex plane, such as the region bounded by the shaded area in Figure 5–17. Since the relative stability and transient-response performance of a closed-loop con- trol system are directly related to the closed-loop pole-zero configuration in the splane, Openmirrors.comaa Section 5–5 / Transient-Response Analysis with MATLAB 1830 ssjv In this region z/H11022 0.4 s4ts/H11021 Figure 5–17 Region in thecomplex planesatisfying theconditions z>0.4 andt s<4/s. it is frequently necessary to adjust one or more system parameters in order to obtain suit- able configurations. The effects of varying system parameters on the closed-loop poleswill be discussed in detail in Chapter 6. 5–5 TRANSIENT-RESPONSE ANALYSIS WITH MATLAB Introduction. The practical procedure for plotting time response curves of systems higher than second order is through computer simulation. In this section we present thecomputational approach to the transient-response analysis with MATLAB. In particular,we discuss step response, impulse response, ramp response, and responses to other simpleinputs. MATLAB Representation of Linear Systems. The transfer function of a system is represented by two arrays of numbers. Consider the system (5–35) This system can be represented as two arrays, each containing the coefficients of the polynomials in decreasing powers of sas follows: num = [2 25] den = [1 4 25] An alternative representation is num = [0 2 25] den = [1 4 25]C(s) R(s)=2s+25 s2+4s+25aa 184 Chapter 5 / Transient and Steady-State Response Analyses In this expression a zero is padded. Note that if zeros are padded, the dimensions of “num ” vector and “ den” vector become the same.An advantage of padding zeros is that the “num ” vector and “ den” vector can be directly added. For example, num + den = [0 2 25] + [1 4 25] = [1 6 50] Ifnum andden(the numerator and denominator of the closed-loop transfer function) are known, commands such as step(num,den), step(num,den,t) will generate plots of unit-step responses ( tin the step command is the user-specified time.) For a control system defined in a state-space form, where state matrix A, control matrix B, output matrix C, and direct transmission matrix Dof state-space equations are known, the command step(A,B,C,D), step(A,B,C,D,t) will generate plots of unit-step responses. When tis not explicitly included in the step commands, the time vector is automatically determined. Note that the command step(sys) may be used to obtain the unit-step response of a system. First, define the system by sys = tf(num,den) or sys = ss(A,B,C,D) Then, to obtain, for example, the unit-step response, enter step(sys) into the computer. When step commands have left-hand arguments such as [y,x,t] = step(num,den,t) [y,x,t] = step(A,B,C,D,iu) [y,x,t] = step(A,B,C,D,iu,t) (5–36) no plot is shown on the screen. Hence it is necessary to use a plot command to see the response curves. The matrices yandxcontain the output and state response of the sys- tem, respectively, evaluated at the computation time points t.(yhas as many columns as outputs and one row for each element in t. xhas as many columns as states and one row for each element in t.) Note in Equation (5–36) that the scalar iuis an index into the inputs of the system and specifies which input is to be used for the response, and tis the user-specified time. If the system involves multiple inputs and multiple outputs, the step command, such as given by Equation (5–36), produces a series of step-response plots, one for each input and output combination of (For details, see Example 5–3.)y=Cx+Dux#=Ax+Bu Openmirrors.comaa Section 5–5 / Transient-Response Analysis with MATLAB 185EXAMPLE 5–3 Consider the following system: Obtain the unit-step response curves. Although it is not necessary to obtain the transfer-matrix expression for the system to obtain the unit-step response curves with MATLAB, we shall derive such an expression for reference.For the system defined by the transfer matrix G(s)is a matrix that relates Y(s)andU(s)as follows: Taking Laplace transforms of the state-space equations, we obtain (5–37)(5–38) In deriving the transfer matrix, we assume that Then, from Equation (5–37), we get (5–39) Substituting Equation (5–39) into Equation (5–38), we obtain Thus the transfer matrix G(s)is given by The transfer matrix G(s)for the given system becomes Hence Since this system involves two inputs and two outputs, four transfer functions may be defined, depending on which signals are considered as input and output. Note that, when considering theBY1(s) Y2(s)R=≥s-1 s2+s+6.5 s+7.5 s2+s+6.5s s2+s+6.5 6.5 s2+s+6.5¥BU1(s) U2(s)R =1 s2+s+6.5Bs-1 s+7.5s 6.5R =1 s2+s+6.5Bs 6.5-1 s+1RB1 11 0R =B1 00 1RBs+1 -6.51 sR-1 B1 11 0R G(s)=C(s I-A)-1 BG(s)=C(s I-A)-1 B+DY(s)=CC(s I-A)-1 B+DD U(s)X(s)=(s I-A)-1 BU(s)x(0)=0. Y(s)=CX(s)+DU(s) s X(s)-x(0)=AX(s)+BU(s)Y(s)=G(s) U(s)y=Cx+Dux#=Ax+BuBy1 y2R=B1 00 1RBx1 x2R+B000 0RBu1 u2RBx# 1 x# 2R=B-1 6.5-1 0RBx1 x2R+B111 0RBu1 u2Raa 186 Chapter 5 / Transient and Steady-State Response Analyses To: Y2 1.52 1 0.5 0 048 1 2 Time (sec) 1.52 1 0.5 0 048 1 2 To: Y1 0.40.6 0.2 −0.200 −0.40.40.6 0.2 −0.2 −0.4 048 1 2 048 1 2 From: U1 From: U2Step Response Amplitude Figure 5–18 Unit-step response curves. MATLAB Program 5–1 A = [–1 –1;6.5 0]; B = [1 1;1 0]; C = [1 0;0 1]; D = [0 0;0 0]; step(A,B,C,D) signal u 1 as the input, we assume that signal u 2 is zero, and vice versa.The four transfer functions are Assume that u 1 andu 2 are unit-step functions. The four individual step-response curves can then be plotted by use of the command step(A,B,C,D) MATLAB Program 5–1 produces four such step-response curves.The curves are shown in Figure 5–18. (Note that the time vector tis automatically determined, since the command does not include t.)Y 2 (s) U 2 (s)=6.5 s 2 +s+6.5Y 2 (s) U 1 (s)=s+7.5 s 2 +s+6.5,Y 1 (s) U 2 (s)=s s 2 +s+6.5Y 1 (s) U 1 (s)=s-1 s 2 +s+6.5, Openmirrors.comaa Section 5–5 / Transient-Response Analysis with MATLAB 187MATLAB Program 5–2 % ***** In this program we plot step-response curves of a system % having two inputs (u1 and u2) and two outputs (y1 and y2) ***** % ***** We shall first plot step-response curves when the input is % u1. Then we shall plot step-response curves when the input is% u2 ***** % ***** Enter matrices A, B, C, and D *****A = [-1 -1;6.5 0]; B = [1 1;1 0];C = [1 0;0 1];D = [0 0;0 0]; % ***** To plot step-response curves when the input is u1, enter % the command 'step(A,B,C,D,1)' ***** step(A,B,C,D,1) gridtitle ('Step-Response Plots: Input = u1 (u2 = 0)')text(3.4, -0.06,'Y1')text(3.4, 1.4,'Y2') % ***** Next, we shall plot step-response curves when the input % is u2. Enter the command 'step(A,B,C,D,2)' ***** step(A,B,C,D,2) gridtitle ('Step-Response Plots: Input = u2 (u1 = 0)')text(3,0.14,'Y1')text(2.8,1.1,'Y2')To plot two step-response curves for the input u1in one diagram and two step-response curves for the input u2in another diagram, we may use the commands step(A,B,C,D,1) and step(A,B,C,D,2) respectively. MATLAB Program 5–2 is a program to plot two step-response curves for the input u1in one diagram and two step-response curves for the input u2in another diagram. Figure 5–19 shows the two diagrams, each consisting of two step-response curves. (ThisMATLAB program uses text commands. For such commands, refer to the paragraph followingthis example.)aa 188 Chapter 5 / Transient and Steady-State Response Analyses Step-Response Plots: Input =u2 (u1= 0) Time (sec) Amplitude 0123456789 1 01.6 1.2 0.8 0.4 0 –0.21.4 1 0.6 0.2 Y2 Y1 (b) Step-Response Plots: Input =u1 (u2= 0) 2 1.5 1 0.5 0 –0.5 0123456789 1 0 Time (sec) Amplitude Y2 Y1 (a) Figure 5–19 Unit-step response curves. (a) u 1 is the inputAu 2 =0B; (b) u 2 is the input Au 1 =0B. Writing Text on the Graphics Screen. To write text on the graphics screen, enter, for example, the following statements: text(3.4, -0.06,'Y1') and text(3.4,1.4,'Y2') The first statement tells the computer to write ‘Y1’ beginning at the coordinates x=3.4, y=–0.06 . Similarly, the second statement tells the computer to write ‘Y2’ beginning at the coordinates x=3.4, y=1.4 . [See MATLAB Program 5–2 and Figure 5–19(a).] Openmirrors.comaa Section 5–5 / Transient-Response Analysis with MATLAB 189MATLAB Program 5–3 wn = 5; damping_ratio = 0.4;[num0,den] = ord2(wn,damping_ratio);num = 5^2*num0;printsys(num,den,'s')num/den = 25 S^2 +4s+25Another way to write a text or texts in the plot is to use the gtext command. The syntax is gtext('text') When gtext is executed, the computer waits until the cursor is positioned (using a mouse) at the desired position in the screen. When the left mouse button is pressed,the text enclosed in simple quotes is written on the plot at the cursor’s position. Anynumber of gtext commands can be used in a plot. (See, for example, MATLAB Program 5–15.) MATLAB Description of Standard Second-Order System. As noted earlier, the second-order system (5–40) is called the standard second-order system. Given v nandz, the command printsys(num,den) or printsys(num,den,s) prints num/den as a ratio of polynomials in s. Consider, for example, the case where vn=5 rad /H20862sec and z=0.4 . MATLAB Program 5–3 generates the standard second-order system, where vn=5 rad /H20862sec and z=0.4 . Note that in MATLAB Program 5–3, “num 0” is 1.G(s) =v2 n s2+2zvn s+v2 n Obtaining the Unit-Step Response of the Transfer-Function System. Let us consider the unit-step response of the system given by G(s) =25 s2+4s+25aa 190 Chapter 5 / Transient and Steady-State Response Analyses MATLAB Program 5–4 % ------------- Unit-step response ------------- % ***** Enter the numerator and denominator of the transfer % function ***** num = [25]; den = [1 4 25]; % ***** Enter the following step-response command ***** step(num,den) % ***** Enter grid and title of the plot ***** grid title (' Unit-Step Response of G(s) = 25/(s^2+4s+25)') 1.4 1.2 1 0.8 0.6 0.4 0.2 0 0 0.5 1 1.5 2 2.5 3 Time (sec)Unit-Step Response of G(s)= 25/(s 2 +4s+25) Amplitude Figure 5–20 Unit-step response curve. Notice in Figure 5–20 (and many others) that the x-axis and y-axis labels are auto- matically determined. If it is desired to label the xaxis and yaxis differently, we need to modify the step command. For example, if it is desired to label the xaxis as 't Sec' and the yaxis as ‘Output,’ then use step-response commands with left-hand arguments, such as c = step(num,den,t) or, more generally, [y,x,t] = step(num,den,t) and use plot( t,y) command. See, for example, MATLAB Program 5–5 and Figure 5–21.MATLAB Program 5–4 will yield a plot of the unit-step response of this system.A plot of the unit-step response curve is shown in Figure 5–20. Openmirrors.comaa Section 5–5 / Transient-Response Analysis with MATLAB 191MATLAB Program 5–5 % ------------- Unit-step response -------------num = [25]; den = [1 4 25];t = 0:0.01:3;[y,x,t] = step(num,den,t);plot(t,y)gridtitle('Unit-Step Response of G(s)=25/(sˆ2+4s+25)')xlabel('t Sec')ylabel('Output') 1.4 1.2 1 0.8 0.6 0.4 0.2 0 0 0.5 1 1.5 2 2.5 3 t SecUnit-Step Response of G(s)= 25/(s2+4s+25)Output Figure 5–21 Unit-step responsecurve. Obtaining Three-Dimensional Plot of Unit-Step Response Curves with MATLAB. MATLAB enables us to plot three-dimensional plots easily.The commands to obtain three-dimensional plots are “mesh” and “surf.” The difference between the“mesh” plot and “surf” plot is that in the former only the lines are drawn and in the lat-ter the spaces between the lines are filled in by colors. In this book we use only the“mesh” command. EXAMPLE 5–4 Consider the closed-loop system defined by (The undamped natural frequency vnis normalized to 1.) Plot unit-step response curves c(t)when zassumes the following values: z=0, 0.2, 0.4, 0.6. 0.8, 1.0 Also plot a three-dimensional plot.C(s) R(s)=1 s2+2zs+1aa 192 Chapter 5 / Transient and Steady-State Response Analyses MATLAB Program 5–6 % ------- Two-dimensional plot and three-dimensional plot of unit-step % response curves for the standard second-order system with wn = 1 % and zeta = 0, 0.2, 0.4, 0.6, 0.8, and 1. ------- t = 0:0.2:10; zeta = [0 0.2 0.4 0.6 0.8 1]; for n = 1:6; num = [1]; den = [1 2*zeta(n) 1]; [y(1:51,n),x,t] = step(num,den,t); end % To plot a two-dimensional diagram, enter the command plot(t,y). plot(t,y) grid title('Plot of Unit-Step Response Curves with \omega_n = 1 and \zeta = 0, 0.2, 0.4, 0.6, 0.8, 1') xlabel('t (sec)') ylabel('Response') text(4.1,1.86,'\zeta = 0') text(3.5,1.5,'0.2') text(3 .5,1.24,'0.4') text(3.5,1.08,'0.6') text(3.5,0.95,'0.8') text(3.5,0.86,'1.0') % To plot a three-dimensional diagram, enter the command mesh(t,zeta,y'). mesh(t,zeta,y') title('Three-Dimensional Plot of Unit-Step Response Curves') xlabel('t Sec') ylabel('\zeta') zlabel('Response') An illustrative MATLAB Program for plotting a two-dimensional diagram and a three- dimensional diagram of unit-step response curves of this second-order system is given in MATLAB Program 5–6. The resulting plots are shown in Figures 5–22(a) and (b), respectively. Notice that we used the command mesh(t,zeta,y') to plot the three-dimensional plot.We may use a command mesh(y') to get the same result. [Note that command mesh(t,zeta,y) ormesh(y) will produce a three-dimensional plot the same as Figure 5–22(b), except that xaxis and yaxis are interchanged. See Problem A–5–15 .] When we want to solve a problem using MATLAB and if the solution process involves many repetitive computations, various approaches may be conceived to simplify the MATLAB pro- gram.A frequently used approach to simplify the computation is to use “for loops.” MATLAB Pro- gram 5–6 uses such a “for loop.” In this book many MATLAB programs using “for loops” are presented for solving a variety of problems. Readers are advised to study all those problems care- fully to familiarize themselves with the approach. Openmirrors.comaa Section 5–5 / Transient-Response Analysis with MATLAB 193Plot of Unit-Step Response Curves with /H9275n = 1 and /H9256 = 0, 0.2, 0.4, 0.6, 0.8, 1Response 0.20.40.60.811.21.41.61.82 0 t (sec)0123456789 1 0/H9256 = 0/H9256 = 0 0.20.2 0.40.4 0.60.6 0.80.8 1.01.0 (a) 01 0.8 0.6 0.4 0.2 002468100.511.52Response /H9256 t Sec (b)Three-Dimensional Plot of Unit-Step Response Curves Figure 5–22 (a) Two-dimensionalplot of unit-step response curves for z=0, 0.2, 0.4, 0.6, 0.8, and 1.0; (b) three-dimensional plot ofunit-step response curves. Obtaining Rise Time, Peak Time, Maximum Overshoot, and Settling Time with MATLAB. MATLAB can conveniently be used to obtain the rise time, peak time, maximum overshoot, and settling time. Consider the system defined by MATLAB Program 5–7 yields the rise time, peak time, maximum overshoot, and settling time. A unit-step response curve for this system is given in Figure 5–23 to verify theC(s) R(s)=25 s2+6s+25aa 194 Chapter 5 / Transient and Steady-State Response Analyses MATLAB Program 5–7 % ------- This is a MATLAB program to find the rise time, peak time, % maximum overshoot, and settling time of the second-order system % and higher-order system ------- % ------- In this example, we assume zeta = 0.6 and wn = 5 ------- num = [25]; den = [1 6 25]; t = 0:0.005:5; [y,x,t] = step(num,den,t); r = 1; while y(r) < 1.0001; r = r + 1; end; rise_time = (r - 1)*0.005 rise_time = 0.5550 [ymax,tp] = max(y); peak_time = (tp - 1)*0.005 peak_time = 0.7850 max_overshoot = ymax-1 max_overshoot = 0.0948 s = 1001; while y(s) > 0.98 & y(s) < 1.02; s = s - 1; end; settling_time = (s - 1)*0.005 settling_time = 1.1850 Amplitude Time (sec)Step Response 0.6 0.4 0.20.811.21.4 0 0 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5 Figure 5–23 Unit-step response curve. results obtained with MATLAB Program 5–7. (Note that this program can also be applied to higher-order systems. See Problem A–5–10 .) Openmirrors.comaa Section 5–5 / Transient-Response Analysis with MATLAB 195Impulse Response. The unit-impulse response of a control system may be obtained by using any of the impulse commands such as impulse(num,den) impulse(A,B,C,D)[y,x,t] = impulse(num,den)[y,x,t] = impulse(num,den,t) (5–41) [y,x,t] = impulse(A,B,C,D)[y,x,t] = impulse(A,B,C,D,iu) (5–42) [y,x,t] = impulse(A,B,C,D,iu,t) (5–43) The command impulse(num,den) plots the unit-impulse response on the screen. The command impulse(A,B,C,D) produces a series of unit-impulse-response plots, one for each input and output combination of the system Note that in Equations (5–42) and (5–43) the scalar iuis an index into the inputs of the system and specifies which input to be used for the impulse response. Note also that if the command used does not include “ t” explicitly, the time vector is automatically determined. If the command includes the user-supplied time vector “ t”, as do the commands given by Equations (5–41) and (5–43)], this vector specifies thetimes at which the impulse response is to be computed. If MATLAB is invoked with the left-hand argument [y,x,t] , such as in the case of [y,x,t] = impulse(A,B,C,D) , the command returns the output and state responses of the system and the time vector t. No plot is drawn on the screen. The matrices yandxcon- tain the output and state responses of the system evaluated at the time points t.(yhas as many columns as outputs and one row for each element in t.xhas as many columns as state variables and one row for each element in t.) To plot the response curve, we must include a plot command, such as plot(t,y).y=Cx+Dux#=Ax+Bu EXAMPLE 5–5 Obtain the unit-impulse response of the following system: C(s) R(s)=G(s) =1 s2+0.2s +1196 Chapter 5 / Transient and Steady-State Response Analyses aa Unit-Impulse Response of G(s)= 1/(s 2 +0.2s+1) Time (sec) Amplitude 0 5 10 15 20 25 30 35 40 45 501 0.8 0.2 –0.6 –0.80.6 0.4 0 –0.2 –0.4 Figure 5–24 Unit-impulse- response curve. MATLAB Program 5–8 will produce the unit-impulse response. The resulting plot is shown in Figure 5–24. MATLAB Program 5–8 num = [1]; den = [1 0.2 1]; impulse(num,den); grid title(‘Unit-Impulse Response of G(s) = 1/(s^2 + 0.2s + 1)‘) Alternative Approach to Obtain Impulse Response. Note that when the initial conditions are zero, the unit-impulse response of G(s) is the same as the unit-step response of sG(s) . Consider the unit-impulse response of the system considered in Example 5–5. Since R(s)=1 for the unit-impulse input, we have We can thus convert the unit-impulse response of G(s) to the unit-step response of sG(s) . If we enter the following num anddeninto MATLAB, num = [0 1 0] den = [1 0.2 1] =s s 2 +0.2s +1 1 s C(s) R(s)=C(s) =G(s) =1 s 2 +0.2s +1 Openmirrors.comSection 5–5 / Transient-Response Analysis with MATLAB 197aa Unit-Step Response of sG(s)=s/(s2+0.2s+1) Time (sec)Amplitude 0 5 10 15 20 25 30 35 40 45 501 0.8 0.2 –0.6 –0.80.6 0.4 0 –0.2 –0.4Figure 5–25 Unit-impulse- response curveobtained as the unit-step response ofsG(s)= s/As 2+0.2s+1B.MATLAB Program 5–9 num = [1 0]; den = [1 0.2 1];step(num,den);gridtitle(‘Unit-Step Response of sG(s) = s/(s^2 + 0.2s + 1)‘)and use the step-response command; as given in MATLAB Program 5–9, we obtain aplot of the unit-impulse response of the system as shown in Figure 5–25. Ramp Response. There is no ramp command in MATLAB. Therefore, we need to use the step command or the lsim command (presented later) to obtain the ramp re-sponse. Specifically, to obtain the ramp response of the transfer-function system G(s) , divide G(s) bysand use the step-response command. For example, consider the closed- loop system For a unit-ramp input, R(s)=1/s Hence To obtain the unit-ramp response of this system, enter the following numerator and de- nominator into the MATLAB program: num = [2 1]; den = [1 1 1 0];C(s) =2s+1 s2+s+11 s2=2s+1 (s2+s+1)s1 sC(s) R(s)=2s+1 s2+s+1aa 198 Chapter 5 / Transient and Steady-State Response Analyses MATLAB Program 5–10 % --------------- Unit-ramp response --------------- % ***** The unit-ramp response is obtained as the unit-step % response of G(s)/s ***** % ***** Enter the numerator and denominator of G(s)/s ***** num = [2 1]; den = [1 1 1 0]; % ***** Specify the computing time points (such as t = 0:0.1:10) % and then enter step-response command: c = step(num,den,t) ***** t = 0:0.1:10; c = step(num,den,t); % ***** In plotting the ramp-response curve, add the reference % input to the plot. The reference input is t. Add to the % argument of the plot command with the following: t,t,'-'. Thus % the plot command becomes as follows: plot(t,c,'o',t,t,'-') ***** plot(t,c,'o',t,t,'-') % ***** Add grid, title, xlabel, and ylabel ***** grid title('Unit-Ramp Response Curve for System G(s) = (2s + 1)/(s^2 + s + 1)') xlabel('t Sec') ylabel('Input and Output') and use the step-response command. See MATLAB Program 5–10. The plot obtained by using this program is shown in Figure 5–26. Unit-Ramp Response Curve for System G(s) = (2 s + 1)/( s 2 + s + 1) t Sec0123456789 1 0 Input and Output 12 04 26810 Figure 5–26 Unit-ramp response curve. Openmirrors.comaa Section 5–5 / Transient-Response Analysis with MATLAB 199Unit-Ramp Response of a System Defined in State Space. Next, we shall treat the unit-ramp response of the system in state-space form. Consider the system described by where uis the unit-ramp function. In what follows, we shall consider a simple example to explain the method. Consider the case where When the initial conditions are zeros, the unit-ramp response is the integral of the unit- step response. Hence the unit-ramp response can be given by (5–44) From Equation (5–44), we obtain (5–45) Let us define Then Equation (5–45) becomes (5–46) Combining Equation (5–46) with the original state-space equation, we obtain (5–47) (5–48) where uappearing in Equation (5–47) is the unit-step function.These equations can be written as where Note that x3is the third element of x. A plot of the unit-ramp response curve z(t) can be obtained by entering MATLAB Program 5–11 into the computer.A plot of the unit-ramp response curve obtained from this MATLAB program is shown in Figure 5–27.BB = C0 10S=BB 0R, CC =[0 0 1], DD =[0]AA =C0 1 11 1 00 00S=CA C 0 0 0Sz=CCx +DDux#=AAx +BBu z=[0 0 1]Cx1 x2 x3S Cx# 1 x# 2 x# 3S=C0 -1 11 -1 00 00SCx1 x2 x3S+C010 Sux# 3=x1z=x3z#=y=x1z= 3t 0ydtD=[0] C=[1 0],x(0)=0 B=B0 1R, A=B0 11 1R,y=Cx+Dux#=Ax+Buaa 200 Chapter 5 / Transient and Steady-State Response Analyses MATLAB Program 5–11 % --------------- Unit-ramp response --------------- % ***** The unit-ramp response is obtained by adding a new % state variable x3. The dimension of the state equation % is enlarged by one ***** % ***** Enter matrices A, B, C, and D of the original state % equation and output equation ***** A = [0 1;-1 -1]; B = [0; 1]; C = [1 0]; D = [0]; % ***** Enter matrices AA, BB, CC, and DD of the new, % enlarged state equation and output equation ***** AA = [A zeros(2,1);C 0]; BB = [B;0]; CC = [0 0 1]; DD = [0]; % ***** Enter step-response command: [z,x,t] = step(AA,BB,CC,DD) ***** [z,x,t] = step(AA,BB,CC,DD); % ***** In plotting x3 add the unit-ramp input t in the plot % by entering the following command: plot(t,x3,'o',t,t,'-') ***** x3 = [0 0 1]*x'; plot(t,x3,'o',t,t,'-') grid title('Unit-Ramp Response') xlabel('t Sec') ylabel('Input and Output') Unit-Ramp Response t Sec Input and Output 0123456789 1 09 5 1 08 6 3 2 4710 Figure 5–27 Unit-ramp response curve. Openmirrors.comaa Section 5–5 / Transient-Response Analysis with MATLAB 201Obtaining Response to Arbitrary Input. To obtain the response to an arbitrary input, the command lsim may be used. The commands like lsim(num,den,r,t) lsim(A,B,C,D,u,t)y = lsim(num,den,r,t)y = lsim(A,B,C,D,u,t) will generate the response to input time function roru. See the following two examples. (Also, see Problems A–5–14 through A–5–16 .) EXAMPLE 5–6 Using the lsim command, obtain the unit-ramp response of the following system: We may enter MATLAB Program 5–12 into the computer to obtain the unit-ramp response.The resulting plot is shown in Figure 5–28.C(s) R(s)=2s+1 s2+s+1 MATLAB Program 5–12 % ------- Ramp Response ------- num = [2 1]; den = [1 1 1]; t = 0:0.1:10;r = t;y = lsim(num,den,r,t);plot(t,r,'-',t,y,'o')gridtitle('Unit-Ramp Response Obtained by Use of Command "lsim"')xlabel('t Sec')ylabel('Unit-Ramp Input and System Output')text(6.3,4.6,'Unit-Ramp Input')text(4.75,9.0,'Output') Un it-Ramp Response Obta ined by use of Command “Is im” t Sec0123456789 1 0Un it-Ramp Input and System Output12 04 26810 Output Un it-Ramp Input Figure 5–28 Unit-ramp response.aa 202 Chapter 5 / Transient and Steady-State Response Analyses EXAMPLE 5–7 Consider the system Using MATLAB, obtain the response curves y(t) when the input uis given by 1.u= unit-step input 2.u=e –t Assume that the initial state is x(0)= 0. A possible MATLAB program to produce the responses of this system to the unit-step input Cu=1(t)Dand the exponential input Cu=e –t Dis shown in MATLAB Program 5–13. The result- ing response curves are shown in Figures 5–29(a) and (b), respectively. y=[1 0] B x 1 x 2 R B x# 1 x# 2 R = B -1 -10.5 0 RB x 1 x 2 R + B 0 1 R u MATLAB Program 5–13 t = 0:0.1:12; A = [-1 0.5;-1 0]; B = [0;1]; C = [1 0]; D = [0]; % For the unit-step input u = 1(t), use the command "y = step(A,B,C,D,1,t)". y = step(A,B,C,D,1,t); plot(t,y) grid title('Unit-Step Response') xlabel('t Sec') ylabel('Output') % For the response to exponential input u = exp(-t), use the command % "z = lsim(A,B,C,D,u,t)". u = exp(-t); z = lsim(A,B,C,D,u,t); plot(t,u,'-',t,z,'o') grid title('Response to Exponential Input u = exp(-t)') xlabel('t Sec') ylabel('Exponential Input and System Output') text(2.3,0.49,'Exponential input') text(6.4,0.28,'Output') Openmirrors.comaa Section 5–5 / Transient-Response Analysis with MATLAB 203Unit-Step Response t Sec02468 1 0 1 2Output1 0.2 01.2 0.6 0.40.81.4 (a) Response to Exponential Input u = e−t t Sec02468 1 0 1 2−0.2 (b)Exponential Input and System Output0.8 01 0.4 0.20.61.2 Exponential Input Ouput Figure 5–29 (a) Unit-stepresponse; (b) response to input u=e –t. Response to Initial Condition. In what follows we shall present a few methods for obtaining the response to an initial condition. Commands that we may use are “step”or “initial”. We shall first present a method to obtain the response to the initial condi-tion using a simple example. Then we shall discuss the response to the initial conditionwhen the system is given in state-space form. Finally, we shall present a command initial to obtain the response of a system given in a state-space form.aa 204 Chapter 5 / Transient and Steady-State Response Analyses EXAMPLE 5–8 Consider the mechanical system shown in Figure 5–30, where m=1 kg,b=3 N-sec /H20862m, and k=2 N/H20862m. Assume that at t=0 the mass mis pulled downward such that x(0)=0.1 m and (0)=0.05 m/H20862sec. The displacement x(t) is measured from the equilibrium position before the mass is pulled down. Obtain the motion of the mass subjected to the initial condition. (Assume no external forcing function.) The system equation is with the initial conditions x(0)=0.1 m and ( xis measured from the equilib- rium position.) The Laplace transform of the system equation gives or Solving this last equation for X(s) and substituting the given numerical values, we obtain This equation can be written as Hence the motion of the mass mmay be obtained as the unit-step response of the following system: MATLAB Program 5–14 will give a plot of the motion of the mass.The plot is shown in Figure 5–31.G(s) =0.1s 2 +0.35s s 2 +3s+2X(s) =0.1s 2 +0.35s s 2 +3s+21 s =0.1s +0.35 s 2 +3s+2 X(s) =mx(0)s +mx#(0)+bx(0) ms 2 +bs+kAms 2 +bs+kBX(s) =mx(0)s +mx#(0)+bx(0)mCs 2 X(s) -sx(0) -x#(0)D+bCsX(s) -x(0)D+kX(s) =0x#(0)=0.05 m/H20862sec.mx$+bx#+kx=0x# MATLAB Program 5–14 % --------------- Response to initial condition --------------- % ***** System response to initial condition is converted to % a unit-step response by modifying the numerator polynomial ***** % ***** Enter the numerator and denominator of the transfer % function G(s) ***** num = [0.1 0.35 0]; den = [1 3 2]; % ***** Enter the following step-response command ***** step(num,den) % ***** Enter grid and title of the plot ***** grid title('Response of Spring-Mass-Damper System to Initial Condition') m k bx Figure 5–30 Mechanical system. Openmirrors.comaa Section 5–5 / Transient-Response Analysis with MATLAB 205Response of Spring-Mass-Damper System to Initial ConditionAmplitude0.12 0.02 00.08 0.040.060.1 Time (sec)0 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5Figure 5–31 Response of themechanical system considered in Example 5–8. Response to Initial Condition (State-Space Approach, Case 1). Consider the system defined by (5–49) Let us obtain the response x(t)when the initial condition x(0)is specified.Assume that there is no external input function acting on this system. Assume also that xis an n-vector. First, take Laplace transforms of both sides of Equation (5–49). This equation can be rewritten as (5–50) Taking the inverse Laplace transform of Equation (5–50), we obtain (5–51) (Notice that by taking the Laplace transform of a differential equation and then by taking the inverse Laplace transform of the Laplace-transformed equation we generatea differential equation that involves the initial condition.) Now define (5–52) Then Equation (5–51) can be written as (5–53) By integrating Equation (5–53) with respect to t, we obtain (5–54) where B=x(0), u=1(t)z#=Az+x(0)1(t)=Az+Buz$=Az#+x(0)d(t)z#=xx#=Ax+x(0)d(t)s X(s)=AX(s)+x(0)s X(s)-x(0)=AX(s)x#=Ax, x(0)=x0aa 206 Chapter 5 / Transient and Steady-State Response Analyses Referring to Equation (5–52), the state x(t)is given by Thus, (5–55) The solution of Equations (5–54) and (5–55) gives the response to the initial condition. Summarizing, the response of Equation (5–49) to the initial condition x(0)is obtained by solving the following state-space equations: where MATLAB commands to obtain the response curves, where we do not specify the time vector t(that is, we let the time vector be determined automatically by MATLAB), are given next. % Specify matrices A and B [x,z,t] = step(A,B,A,B); x1 = [1 0 0 ... 0]*x'; x2 = [0 1 0 ... 0]*x'; /H11080 /H11080 /H11080 xn = [0 0 0 ... 1]*x'; plot(t,x1,t,x2, ... ,t,xn) If we choose the time vector t(for example, let the computation time duration be from t= 0 to t = tp with the computing time increment of ), then we use the following MATLAB commands: t = 0: Δt: tp; % Specify matrices A and B [x,z,t] = step(A,B,A,B,1,t); x1 = [1 0 0 ... 0]*x'; x2 = [0 1 0 ... 0]*x'; /H11080 /H11080 /H11080 xn = [0 0 0 ... 1]*x'; plot(t,x1,t,x2, ... ,t,xn) (See, for example, Example 5–9.) ¢tB=x(0), u=1(t)x=Az+Buz#=Az+Bux=z#=Az+Buz#(t). Openmirrors.comaa Section 5–5 / Transient-Response Analysis with MATLAB 207Response to Initial Condition (State-Space Approach, Case 2). Consider the system defined by (5–56) (5–57) (Assume that xis an n-vector and yis an m-vector.) Similar to case 1, by defining we can obtain the following equation: (5–58) where Noting that Equation (5–57) can be written as (5–59) By substituting Equation (5–58) into Equation (5–59), we obtain (5–60) The solution of Equations (5–58) and (5–60), rewritten here where gives the response of the system to a given initial condi- tion. MATLAB commands to obtain the response curves (output curves y1versus t, y2 versus t, ... , ym versus t) are shown next for two cases: Case A. When the time vector t is not specified (that is, the time vector tis to be de- termined automatically by MATLAB): % Specify matrices A, B, and C [y,z,t] = step(A,B,C*A,C*B);y1 = [1 0 0 ... 0]*y';y2 = [0 1 0 ... 0]*y'; /H11080/H11080/H11080 ym = [0 0 0 ... 1]*y';plot(t,y1,t,y2, ... ,t,ym)B=x(0) and u=1(t),y=CAz +CBuz#=Az+Buy=C(Az+Bu)=CAz +CBuy=Cz#x=z#,B=x(0), u=1(t)z#=Az+x(0)1(t) =Az+Buz#=xy=Cxx#=Ax, x(0)=x0aa 208 Chapter 5 / Transient and Steady-State Response Analyses MATLAB Program 5–15 t = 0:0.01:3; A = [0 1;-10 -5]; B = [2;1]; [x,z,t] = step(A,B,A,B,1,t); x1 = [1 0]*x'; x2 = [0 1]*x'; plot(t,x1,'x',t,x2,'-') grid title('Response to Initial Condition') xlabel('t Sec') ylabel('State Variables x1 and x2') gtext('x1') gtext('x2') Case B . When the time vector t is specified: t = 0: Δt: tp; % Specify matrices A, B, and C [y,z,t] = step(A,B,C*A,C*B,1,t) y1 = [1 0 0 ... 0]*y'; y2 = [0 1 0 ... 0]*y'; /H11080 /H11080 /H11080 ym = [0 0 0 ... 1]*y'; plot(t,y1,t,y2, ... ,t,ym) EXAMPLE 5–9 Obtain the response of the system subjected to the given initial condition. or Obtaining the response of the system to the given initial condition resolves to solving the unit-step response of the following system: where Hence a possible MATLAB program for obtaining the response may be given as shown in MATLAB Program 5–15. The resulting response curves are shown in Figure 5–32.B=x(0), u=1(t)x=Az+Buz#=Az+Bux#=Ax, x(0)=x 0 B x# 1 x# 2 R = B 0 -101 -5 RB x 1 x 2 R , B x 1 (0) x 2 (0) R = B 2 1 R Openmirrors.comaa Section 5–5 / Transient-Response Analysis with MATLAB 209Response to Initial Condition t Sec0 0.5 1 1.5 2 2.5 3State Variables x1 and x23 −2 −31 −102 x1 x2 Figure 5–32 Response of systemin Example 5–9 to initial condition. For an illustrative example of how to use Equations (5–58) and (5–60) to find the re- sponse to the initial condition, see Problem A–5–16 . Obtaining Response to Initial Condition by Use of Command Initial .If the system is given in the state-space form, then the following command initial(A,B,C,D,[initial condition],t) will produce the response to the initial condition. Suppose that we have the system defined by where x0=B2 1RA=B0 -101 -5R, B=B0 0R, C=[0 0], D=0y=Cx+Dux#=Ax+Bu, x(0)=x0aa 210 Chapter 5 / Transient and Steady-State Response Analyses MATLAB Program 5–16 t = 0:0.05:3; A = [0 1;-10 -5]; B = [0;0]; C = [0 0]; D = [0]; [y,x] = initial(A,B,C,D,[2;1],t); x1 = [1 0]*x'; x2 = [0 1]*x'; plot(t,x1,'o',t,x1,t,x2,'x',t,x2) grid title('Response to Initial Condition') xlabel('t Sec') ylabel('State Variables x1 and x2') gtext('x1') gtext('x2') Response to Initial Condition t Sec0 0.5 1 1.5 2 2.5 3 State Variables x 1 and x 2 3 −3−2−1012 x 1 x 2 Figure 5–33 Response curves to initial condition. EXAMPLE 5–10 Consider the following system that is subjected to the initial condition. (No external forcing function is present.) Obtain the response y(t) to the given initial condition. y(0) =2, y#(0)=1, y$(0)=0.5 y%+8y$+17y#+10y =0 Then the command “initial” can be used as shown in MATLAB Program 5–16 to obtain the response to the initial condition. The response curves x 1 (t)and x 2 (t)are shown in Figure 5–33. They are the same as those shown in Figure 5–32. Openmirrors.comOpenmirrors.comaa Section 5–5 / Transient-Response Analysis with MATLAB 211MATLAB Program 5–17 t = 0:0.05:10; A = [0 1 0;0 0 1;-10 -17 -8];B = [0;0;0];C = [1 0 0];D = [0]; y = initial(A,B,C,D,[2;1;0.5],t);plot(t,y)gridtitle('Response to Initial Condition')xlabel('t (sec)')ylabel('Output y')Output y t (sec)Response to Initial Condition 0.511.522.5 0 0123456789 1 0Figure 5–34 Response y(t) to initial condition.By defining the state variables as we obtain the following state-space representation for the system: A possible MATLAB program to obtain the response y(t) is given in MATLAB Program 5–17. The resulting response curve is shown in Figure 5–34.y=[1 0 0]Cx1 x2 x3SCx# 1 x# 2 x# 3S=C0 0 101 0 170 1 8SCx1 x2 x3S, Cx1(0) x2(0) x3(0)S=C2 1 0.5Sx3=y$x2=y#x1=yaa 212 Chapter 5 / Transient and Steady-State Response Analyses 5–6 ROUTH’S STABILITY CRITERION The most important problem in linear control systems concerns stability. That is, under what conditions will a system become unstable? If it is unstable, how should we stabi- lize the system? In Section 5–4 it was stated that a control system is stable if and only if all closed-loop poles lie in the left-half splane. Most linear closed-loop systems have closed-loop transfer functions of the form where the a’s and b’s are constants and m/H11349n. A simple criterion, known as Routh’s stability criterion, enables us to determine the number of closed-loop poles that lie in the right-half splane without having to factor the denominator polynomial. (The polynomial may include parameters that MATLAB cannot handle.) Routh’s Stability Criterion. Routh’s stability criterion tells us whether or not there are unstable roots in a polynomial equation without actually solving for them. This stability criterion applies to polynomials with only a finite number of terms.When the criterion is applied to a control system, information about absolute stability can be obtained directly from the coefficients of the characteristic equation. The procedure in Routh’s stability criterion is as follows: 1.Write the polynomial in sin the following form: (5–61) where the coefficients are real quantities. We assume that a n Z0; that is, any zero root has been removed. 2.If any of the coefficients are zero or negative in the presence of at least one posi- tive coefficient, a root or roots exist that are imaginary or that have positive real parts.Therefore, in such a case, the system is not stable. If we are interested in only the absolute stability, there is no need to follow the procedure further. Note that all the coefficients must be positive. This is a necessary condition, as may be seen from the following argument: A polynomial in shaving real coefficients can al- ways be factored into linear and quadratic factors, such as (s+a) and As 2 +bs+cB, where a, b, and care real. The linear factors yield real roots and the quadratic factors yield complex-conjugate roots of the polynomial.The factor As 2 +bs+cByields roots having negative real parts only if bandcare both pos- itive. For all roots to have negative real parts, the constants a, b, c , and so on, in all factors must be positive.The product of any number of linear and quadratic factors containing only positive coefficients always yields a polynomial with positive coefficients. It is important to note that the condition that all the coefficients be positive is not sufficient to assure stability. The necessary but not sufficient condition for stability is that the coefficients of Equation (5–61) all be present and all have a positive sign. (If all a’s are negative, they can be made positive by multiplying both sides of the equation by –1.)a 0 s n +a 1 s n-1 +p+a n-1 s+a n =0C(s) R(s)=b 0 s m +b 1 s m-1 +p+b m-1 s+b m a 0 s n +a 1 s n-1 +p+a n-1 s+a n =B(s) A(s) Openmirrors.comaa Section 5–6 / Routh’s Stability Criterion 2133.If all coefficients are positive, arrange the coefficients of the polynomial in rows and columns according to the following pattern: The process of forming rows continues until we run out of elements. (The total number of rows is n+1 .) The coefficients b1,b2,b3, and so on, are evaluated as follows: The evaluation of the b’s is continued until the remaining ones are all zero. The same pattern of cross-multiplying the coefficients of the two previous rows is followed inevaluating the c’s,d’s,e’s, and so on. That is, /H11080 /H11080 /H11080 c 3=b1 a7-a1 b4 b1 c2=b1 a5-a1 b3 b1 c1=b1 a3-a1 b2 b1 /H11080 /H11080 /H11080 b3=a1 a6-a0 a7 a1 b2=a1 a4-a0 a5 a1 b1=a1 a2-a0 a3 a1sn sn-1 sn-2 sn-3 sn-4 /H11080 /H11080/H11080 s 2 s1 s0a0 a1 b1 c1 d1 /H11080/H11080/H11080 e 1 f1 g1a2 a3 b2 c2 d2 /H11080/H11080/H11080 e 2a4 a5 b3 c3 d3a6 a7 b4 c4 d4pppppaa 214 Chapter 5 / Transient and Steady-State Response Analyses and This process is continued until the nth row has been completed. The complete array of coefficients is triangular. Note that in developing the array an entire row may be divid- ed or multiplied by a positive number in order to simplify the subsequent numerical calculation without altering the stability conclusion. Routh’s stability criterion states that the number of roots of Equation (5–61) with positive real parts is equal to the number of changes in sign of the coefficients of the first column of the array. It should be noted that the exact values of the terms in the first col- umn need not be known; instead, only the signs are needed. The necessary and suffi- cient condition that all roots of Equation (5–61) lie in the left-half splane is that all the coefficients of Equation (5–61) be positive and all terms in the first column of the array have positive signs. EXAMPLE 5–11 Let us apply Routh’s stability criterion to the following third-order polynomial: where all the coefficients are positive numbers. The array of coefficients becomes The condition that all roots have negative real parts is given by EXAMPLE 5–12 Consider the following polynomial: Let us follow the procedure just presented and construct the array of coefficients. (The first two rows can be obtained directly from the given polynomial. The remaining terms are s 4 +2s 3 +3s 2 +4s+5=0a 1 a 2 7a 0 a 3 s 3 s 2 s 1 s 0 a 0 a 1 a 1 a 2 -a 0 a 3 a 1 a 3 a 2 a 3 a 0 s 3 +a 1 s 2 +a 2 s+a 3 =0 /H11080 /H11080 /H11080 d 2 =c 1 b 3 -b 1 c 3 c 1 d 1 =c 1 b 2 -b 1 c 2 c 1 Openmirrors.comaa Section 5–6 / Routh’s Stability Criterion 215obtained from these. If any coefficients are missing, they may be replaced by zeros in the array.) In this example, the number of changes in sign of the coefficients in the first column is 2. This means that there are two roots with positive real parts. Note that the result is unchanged when thecoefficients of any row are multiplied or divided by a positive number in order to simplify thecomputation. Special Cases. If a first-column term in any row is zero, but the remaining terms are not zero or there is no remaining term, then the zero term is replaced by a very smallpositive number /H9280and the rest of the array is evaluated. For example, consider the following equation: (5–62) The array of coefficients is If the sign of the coefficient above the zero ( /H9280) is the same as that below it, it indicates that there are a pair of imaginary roots. Actually, Equation (5–62) has two roots ats= ;j. If, however, the sign of the coefficient above the zero ( /H9280) is opposite that below it, it indicates that there is one sign change. For example, for the equation the array of coefficients is One sign change: One sign change: There are two sign changes of the coefficients in the first column. So there are two roots in the right-half splane. This agrees with the correct result indicated by the factored form of the polynomial equation.s 1 s0- 3-2 /H9280 2s3 s21 0L/H9280- 3 2s3-3s+2=(s-1)2(s+2)=0s3 s2 s1 s01 2 0L/H9280 21 2s3+2s2+s+2=0The second row is divided by 2.6 s4 s3 s2 s1 s0 1 2 1 1 3 53 4 2 55 0 0s4 s3 s2 s1 s0 1 2 1 6 53 4 55 0 6 ⁄⁄⁄⁄aa 216 Chapter 5 / Transient and Steady-State Response Analyses If all the coefficients in any derived row are zero, it indicates that there are roots of equal magnitude lying radially opposite in the splane—that is, two real roots with equal magnitudes and opposite signs and/or two conjugate imaginary roots. In such a case, the evaluation of the rest of the array can be continued by forming an auxiliary polynomi- al with the coefficients of the last row and by using the coefficients of the derivative of this polynomial in the next row. Such roots with equal magnitudes and lying radially op- posite in the splane can be found by solving the auxiliary polynomial, which is always even. For a 2n-degree auxiliary polynomial, there are npairs of equal and opposite roots. For example, consider the following equation: The array of coefficients is The terms in the s 3 row are all zero. (Note that such a case occurs only in an odd- numbered row.) The auxiliary polynomial is then formed from the coefficients of the s 4 row. The auxiliary polynomial P(s) is which indicates that there are two pairs of roots of equal magnitude and opposite sign (that is, two real roots with the same magnitude but opposite signs or two complex- conjugate roots on the imaginary axis).These pairs are obtained by solving the auxiliary polynomial equation P(s)=0 . The derivative of P(s) with respect to sis The terms in the s 3 row are replaced by the coefficients of the last equation—that is, 8 and 96. The array of coefficients then becomes We see that there is one change in sign in the first column of the new array.Thus, the orig- inal equation has one root with a positive real part. By solving for roots of the auxiliary polynomial equation, we obtain or s=;j5 s=;1, s 2 =-25 s 2 =1,2s 4 +48s 2 -50=0s 5 s 4 s 3 s 2 s 1 s 0 1 2 8 24 112.7 5024 48 96 50 0- 25 50 dCoefficients of dP(s) /H20862dsdP(s) ds=8s 3 +96sP(s) =2s 4 +48s 2 -50s 5 s 4 s 3 1 2 024 48 0- 25 50 dAuxiliary polynomial P(s)s 5 +2s 4 +24s 3 +48s 2 -25s -50=0 Openmirrors.comaa Section 5–6 / Routh’s Stability Criterion 217These two pairs of roots of P(s) are a part of the roots of the original equation. As a matter of fact, the original equation can be written in factored form as follows: Clearly, the original equation has one root with a positive real part. Relative Stability Analysis. Routh’s stability criterion provides the answer to the question of absolute stability.This, in many practical cases, is not sufficient.We usu-ally require information about the relative stability of the system. A useful approachfor examining relative stability is to shift the s-plane axis and apply Routh’s stability criterion. That is, we substitute into the characteristic equation of the system, write the polynomial in terms of and apply Routh’s stability criterion to the new polynomial in The number of changes ofsign in the first column of the array developed for the polynomial in is equal to the num-ber of roots that are located to the right of the vertical line s=–s.Thus, this test reveals the number of roots that lie to the right of the vertical line s=–s. Application of Routh’s Stability Criterion to Control-System Analysis. Routh’s stability criterion is of limited usefulness in linear control-system analysis, mainly becauseit does not suggest how to improve relative stability or how to stabilize an unstablesystem. It is possible, however, to determine the effects of changing one or twoparameters of a system by examining the values that cause instability. In the following,we shall consider the problem of determining the stability range of a parameter value. Consider the system shown in Figure 5–35. Let us determine the range of Kfor stability. The closed-loop transfer function is The characteristic equation is The array of coefficients becomes s 4 s3 s2 s1 s0 1 3 7 3 2-9 7K K3 2 KK 0s4+3s3+3s2+2s+K=0C(s) R(s)=K sAs2+s+1B(s+2)+Ksˆsˆ.sˆ;s=sˆ-s (s=constant )(s+1)(s -1)(s +j5)(s -j5)(s +2)=0 +–R(s) C(s)K s(s2+s+ 1) (s+ 2) Figure 5–35 Control system.aa 218 Chapter 5 / Transient and Steady-State Response Analyses For stability, Kmust be positive, and all coefficients in the first column must be positive. Therefore, When the system becomes oscillatory and, mathematically, the oscillation is sustained at constant amplitude. Note that the ranges of design parameters that lead to stability may be determined by use of Routh’s stability criterion. 5–7 EFFECTS OF INTEGRAL AND DERIVATIVE CONTROL ACTIONS ON SYSTEM PERFORMANCE In this section, we shall investigate the effects of integral and derivative control actions on the system performance. Here we shall consider only simple systems, so that the effects of integral and derivative control actions on system performance can be clearly seen. Integral Control Action. In the proportional control of a plant whose transfer function does not possess an integrator 1 /H20862s, there is a steady-state error, or offset, in the response to a step input. Such an offset can be eliminated if the integral control action is included in the controller. In the integral control of a plant, the control signal—the output signal from the controller—at any instant is the area under the actuating-error-signal curve up to that instant.The control signal u(t) can have a nonzero value when the actuating error signal e(t)is zero, as shown in Figure 5–36(a).This is impossible in the case of the proportional controller, since a nonzero control signal requires a nonzero actuating error signal. (A nonzero actuating error signal at steady state means that there is an offset.) Figure 5–36(b) shows the curve e(t)versus tand the corresponding curve u(t) versus twhen the controller is of the proportional type. Note that integral control action, while removing offset or steady-state error, may lead to oscillatory response of slowly decreasing amplitude or even increasing amplitude, both of which are usually undesirable.K= 14 9 ,14 97K70 e(t) u(t)0 0t te(t) u(t)0 0t t (a) (b) Figure 5–36 (a) Plots of e(t) and u(t) curves showing nonzero control signal when the actuating error signal is zero (integral control); (b) plots of e(t) andu(t) curves showing zero control signal when the actuating error signal is zero (proportional control). Openmirrors.comaa Section 5–7 / Effects of Integral and Derivative Control Actions on System Performance 219Proportional Control of Systems. We shall show that the proportional control of a system without an integrator will result in a steady-state error with a step input.Weshall then show that such an error can be eliminated if integral control action is includedin the controller. Consider the system shown in Figure 5–37. Let us obtain the steady-state error in the unit-step response of the system. Define Sincethe error E(s) is given by For the unit-step input R(s)=1/s , we have The steady-state error isSuch a system without an integrator in the feedforward path always has a steady-state error in the step response. Such a steady-state error is called an offset. Figure 5–38 showsthe unit-step response and the offset.e ss=lim tSqe(t) =lim sS0sE(s) =lim sS0 Ts+1 Ts+1+K=1 K+1E(s) =Ts+1 Ts+1+K1 sE(s) =1 1+G(s)R(s) =1 1+K Ts+1R(s)E(s) R(s)=R(s) -C(s) R(s)=1-C(s) R(s)=1 1+G(s)G(s) =K Ts+11 Ts+ 1+–R(s) E(s) C(s) K Proportional controllerPlant Figure 5–37 Proportional controlsystem. c(t) 1 0 tOffset Figure 5–38 Unit-step responseand offset.aa 220 Chapter 5 / Transient and Steady-State Response Analyses Integral Control of Systems. Consider the system shown in Figure 5–39. The controller is an integral controller. The closed-loop transfer function of the system is Hence Since the system is stable, the steady-state error for the unit-step response can be obtained by applying the final-value theorem, as follows: Integral control of the system thus eliminates the steady-state error in the response to the step input. This is an important improvement over the proportional control alone, which gives offset. Response to Torque Disturbances (Proportional Control). Let us investigate the effect of a torque disturbance occurring at the load element. Consider the system shown in Figure 5–40.The proportional controller delivers torque Tto position the load element, which consists of moment of inertia and viscous friction.Torque disturbance is denoted by D. Assuming that the reference input is zero or R(s)=0 , the transfer function between C(s) andD(s) is given by C(s) D(s)=1 Js 2 +bs+K p =0 =lim sS0 s 2 (Ts +1) Ts 2 +s+K 1 s e ss =lim sS0 sE(s)E(s) R(s)=R(s) -C(s) R(s)=s(Ts +1) s(Ts +1)+KC(s) R(s)=K s(Ts +1)+K 1 Ts+ 1 +– R(s) C(s) E(s) K s Figure 5–39 Integral control system. +– ++ RD C ET K p 1 s(Js+b) Figure 5–40 Control system with a torque disturbance. Openmirrors.comaa Section 5–7 / Effects of Integral and Derivative Control Actions on System Performance 221Hence The steady-state error due to a step disturbance torque of magnitude is given by At steady state, the proportional controller provides the torque which is equal in magnitude but opposite in sign to the disturbance torque The steady-state output dueto the step disturbance torque is The steady-state error can be reduced by increasing the value of the gain K p. Increasing this value, however, will cause the system response to be more oscillatory. Response to Torque Disturbances (Proportional-Plus-Integral Control). To eliminate offset due to torque disturbance, the proportional controller may be replacedby a proportional-plus-integral controller. If integral control action is added to the controller, then, as long as there is an error signal, a torque is developed by the controller to reduce this error, provided the controlsystem is a stable one. Figure 5–41 shows the proportional-plus-integral control of the load element, consisting of moment of inertia and viscous friction. The closed-loop transfer function between C(s) andD(s) is In the absence of the reference input, or r(t)=0 , the error signal is obtained from E(s) =-s Js3+bs2+Kp s+Kp TiD(s)C(s) D(s)=s Js3+bs2+Kp s+Kp Ticss=-ess=Td KpTd .-Td , =- Td Kp =lim sS0 -s Js2+bs+Kp Td s ess=lim sS0sE(s)TdE(s) D(s)=-C(s) D(s)=-1 Js2+bs+Kp ++ C ED R= 0 TKp(1+1 Tis)1 s(Js+b)+–Figure 5–41 Proportional-plus-integral control of aload element consisting of moment of inertia and viscousfriction.aa 222 Chapter 5 / Transient and Steady-State Response Analyses If this control system is stable—that is, if the roots of the characteristic equation have negative real parts—then the steady-state error in the response to a unit-step disturbance torque can be obtained by applying the final-value theorem as follows: Thus steady-state error to the step disturbance torque can be eliminated if the controller is of the proportional-plus-integral type. Note that the integral control action added to the proportional controller has converted the originally second-order system to a third-order one. Hence the control system may become unstable for a large value of K p , since the roots of the characteristic equation may have positive real parts. (The second-order system is always stable if the coefficients in the system differential equation are all positive.) It is important to point out that if the controller were an integral controller, as in Figure 5–42, then the system always becomes unstable, because the characteristic equation will have roots with positive real parts. Such an unstable system cannot be used in practice. Note that in the system of Figure 5–41 the proportional control action tends to stabilize the system, while the integral control action tends to eliminate or reduce steady- state error in response to various inputs. Derivative Control Action. Derivative control action, when added to a proportional controller, provides a means of obtaining a controller with high sensitivity. An advantage of using derivative control action is that it responds to the rate of change of the actuating error and can produce a significant correction before the magnitude of the actuating error becomes too large. Derivative control thus anticipates the actuating error, initiates an early corrective action, and tends to increase the stability of the system.Js 3 +bs 2 +K=0 =0 =lim sS0 -s 2 Js 3 +bs 2 +K p s+K p T i 1 s e ss =lim sS0 sE(s)Js 3 +bs 2 +K p s+K p T i =0 +– ++ C ED R= 0 T K s 1 s(Js+b) Figure 5–42 Integral control of a load element consisting of moment of inertia and viscous friction. Openmirrors.comaa Section 5–7 / Effects of Integral and Derivative Control Actions on System Performance 223+–R(s) C(s) (a) (b)Kp1 Js2 c(t) 1 0 tFigure 5–43 (a) Proportionalcontrol of a system with inertia load; (b) response to aunit-step input. Although derivative control does not affect the steady-state error directly, it adds damping to the system and thus permits the use of a larger value of the gain K, which will result in an improvement in the steady-state accuracy. Because derivative control operates on the rate of change of the actuating error and not the actuating error itself, this mode is never used alone. It is always used in combi-nation with proportional or proportional-plus-integral control action. Proportional Control of Systems with Inertia Load. Before we discuss further the effect of derivative control action on system performance, we shall consider theproportional control of an inertia load. Consider the system shown in Figure 5–43(a). The closed-loop transfer function is obtained as Since the roots of the characteristic equation are imaginary, the response to a unit-step input continues to oscillate indefinitely, as shown in Figure 5–43(b). Control systems exhibiting such response characteristics are not desirable. We shall see that the addition of derivative control will stabilize the system. Proportional-Plus-Derivative Control of a System with Inertia Load. Let us modify the proportional controller to a proportional-plus-derivative controller whosetransfer function is The torque developed by the controller is proportionalto Derivative control is essentially anticipatory, measures the instantaneouserror velocity, and predicts the large overshoot ahead of time and produces anappropriate counteraction before too large an overshoot occurs.K pAe+Td e#B.KpA1+Td sB.Js2+Kp=0C(s) R(s)=Kp Js2+Kpaa 224 Chapter 5 / Transient and Steady-State Response Analyses Consider the system shown in Figure 5–44(a). The closed-loop transfer function is given by The characteristic equation now has two roots with negative real parts for positive values of J,K p , and Thus derivative control introduces a damping effect. A typical response curve c(t) to a unit- step input is shown in Figure 5–44(b). Clearly, the response curve shows a marked improvement over the original response curve shown in Figure 5–46(b). Proportional-Plus-Derivative Control of Second-Order Systems. A compromise between acceptable transient-response behavior and acceptable steady-state behavior may be achieved by use of proportional-plus-derivative control action. Consider the system shown in Figure 5–45. The closed-loop transfer function is The steady-state error for a unit-ramp input is The characteristic equation is Js 2 +AB+K d Bs+K p =0e ss =B K p C(s) R(s)=K p +K d s Js 2 +AB+K d Bs+K p T d .Js 2 +K p T d s+K p =0C(s) R(s)=K p A1+T d sB Js 2 +K p T d s+K p +– R(s) C(s) K p +K d s1 s(Js+B) Figure 5–44 (a) Proportional-plus-derivative control of a system with inertia load; (b) response to a unit-step input. R(s) C(s) (a) (b)K p (1+T d s)c(t) 1 0 t1 Js 2 +– Figure 5–45 Control system. Openmirrors.comaa Section 5–8 / Steady-State Errors in Unity-Feedback Control Systems 225The effective damping coefficient of this system is thus B+ Kdrather than B. Since the damping ratio zof this system is it is possible to make both the steady-state error essfor a ramp input and the maximum overshoot for a step input small by making Bsmall, Kplarge, and Kdlarge enough so that zis between 0.4 and 0.7. 5–8 STEADY-STATE ERRORS IN UNITY-FEEDBACK CONTROL SYSTEMS Errors in a control system can be attributed to many factors. Changes in the reference input will cause unavoidable errors during transient periods and may also cause steady-state errors. Imperfections in the system components, such as static friction, backlash, andamplifier drift, as well as aging or deterioration, will cause errors at steady state. In thissection, however, we shall not discuss errors due to imperfections in the system com-ponents. Rather, we shall investigate a type of steady-state error that is caused by theincapability of a system to follow particular types of inputs. Any physical control system inherently suffers steady-state error in response to certain types of inputs.A system may have no steady-state error to a step input, but thesame system may exhibit nonzero steady-state error to a ramp input. (The only way wemay be able to eliminate this error is to modify the system structure.) Whether a givensystem will exhibit steady-state error for a given type of input depends on the type ofopen-loop transfer function of the system, to be discussed in what follows. Classification of Control Systems. Control systems may be classified according to their ability to follow step inputs, ramp inputs, parabolic inputs, and so on. This is areasonable classification scheme, because actual inputs may frequently be consideredcombinations of such inputs. The magnitudes of the steady-state errors due to theseindividual inputs are indicative of the goodness of the system. Consider the unity-feedback control system with the following open-loop transfer function G(s) : It involves the term s Nin the denominator, representing a pole of multiplicity Nat the origin.The present classification scheme is based on the number of integrations indicatedby the open-loop transfer function.A system is called type 0, type 1, type 2, p, if N=0, N=1, N=2, p, respectively. Note that this classification is different from that of the order of a system. As the type number is increased, accuracy is improved; however,increasing the type number aggravates the stability problem. A compromise betweensteady-state accuracy and relative stability is always necessary. We shall see later that, if G(s) is written so that each term in the numerator and denominator, except the term s N, approaches unity as sapproaches zero, then the open- loop gain Kis directly related to the steady-state error.G(s) =KATa s+1BATb s+1BpATm s+1B sNAT1 s+1BAT2 s+1BpATp s+1Bz=B+Kd 22Kp Jaa 226 Chapter 5 / Transient and Steady-State Response Analyses Steady-State Errors. Consider the system shown in Figure 5–46.The closed-loop transfer function is The transfer function between the error signal e(t) and the input signal r(t) is where the error e(t) is the difference between the input signal and the output signal. The final-value theorem provides a convenient way to find the steady-state performance of a stable system. Since E(s) is the steady-state error is The static error constants defined in the following are figures of merit of control systems. The higher the constants, the smaller the steady-state error. In a given system, the out- put may be the position, velocity, pressure, temperature, or the like. The physical form of the output, however, is immaterial to the present analysis.Therefore, in what follows, we shall call the output “position,” the rate of change of the output “velocity,” and so on. This means that in a temperature control system “position” represents the output tem- perature,“velocity” represents the rate of change of the output temperature, and so on. Static Position Error Constant K p .The steady-state error of the system for a unit-step input is The static position error constant K p is defined by Thus, the steady-state error in terms of the static position error constant K p is given by e ss =1 1+K p K p =lim sS0 G(s) =G(0) =1 1+G(0) e ss =lim sS0 s 1+G(s)1 se ss =lim tSq e(t) =lim sS0 sE(s) =lim sS0 sR(s) 1+G(s)E(s) =1 1+G(s)R(s)E(s) R(s)=1-C(s) R(s)=1 1+G(s)C(s) R(s)=G(s) 1+G(s) +– R(s) C(s) E(s) G(s) Figure 5–46 Control system. Openmirrors.comaa Section 5–8 / Steady-State Errors in Unity-Feedback Control Systems 227For a type 0 system, For a type 1 or higher system, forN/H113501 Hence, for a type 0 system, the static position error constant Kpis finite, while for a type 1 or higher system, Kpis infinite. For a unit-step input, the steady-state error essmay be summarized as follows: for type 0 systems for type 1 or higher systems From the foregoing analysis, it is seen that the response of a feedback control system to a step input involves a steady-state error if there is no integration in the feedforwardpath. (If small errors for step inputs can be tolerated, then a type 0 system may bepermissible, provided that the gain Kis sufficiently large. If the gain Kis too large, how- ever, it is difficult to obtain reasonable relative stability.) If zero steady-state error fora step input is desired, the type of the system must be one or higher. Static Velocity Error Constant K v.The steady-state error of the system with a unit-ramp input is given by The static velocity error constant Kvis defined by Thus, the steady-state error in terms of the static velocity error constant Kvis given by The term velocity error is used here to express the steady-state error for a ramp input.The dimension of the velocity error is the same as the system error.That is, velocityerror is not an error in velocity, but it is an error in position due to a ramp input.For a type 0 system, K v=lim sS0sKATa s+1BATb s+1Bp AT1 s+1BAT2 s+1Bp=0ess=1 KvKv=lim sS0sG(s) =lim sS0 1 sG(s) ess=lim sS0s 1+G(s)1 s2ess=0,ess=1 1+K,Kp=lim sS0KATa s+1BATb s+1Bp sNAT1 s+1BAT2 s+1Bp=q ,Kp=lim sS0KATa s+1BATb s+1Bp AT1 s+1BAT2 s+1Bp=Kaa 228 Chapter 5 / Transient and Steady-State Response Analyses For a type 1 system, For a type 2 or higher system, forN/H113502 The steady-state error e ss for the unit-ramp input can be summarized as follows: for type 0 systems for type 1 systems for type 2 or higher systems The foregoing analysis indicates that a type 0 system is incapable of following a ramp input in the steady state.The type 1 system with unity feedback can follow the ramp input with a finite error. In steady-state operation, the output velocity is exactly the same as the input velocity, but there is a positional error. This error is proportional to the velocity of the input and is inversely proportional to the gain K. Figure 5–47 shows an example of the response of a type 1 system with unity feedback to a ramp input. The type 2 or higher system can follow a ramp input with zero error at steady state. Static Acceleration Error Constant K a .The steady-state error of the system with a unit-parabolic input (acceleration input), which is defined by fort/H113500 fort<0 =0, r(t) =t 2 2,e ss =1 K v =0,e ss =1 K v =1 K,e ss =1 K v =q ,K v =lim sS0 sKAT a s+1BAT b s+1Bp s N AT 1 s+1BAT 2 s+1Bp=q ,K v =lim sS0 sKAT a s+1BAT b s+1Bp sAT 1 s+1BAT 2 s+1Bp=K r(t) c(t) 0 tr(t) c(t) Figure 5–47 Response of a type 1 unity-feedback system to a ramp input. Openmirrors.comaa Section 5–8 / Steady-State Errors in Unity-Feedback Control Systems 229is given by The static acceleration error constant Kais defined by the equation The steady-state error is then Note that the acceleration error, the steady-state error due to a parabolic input, is an error in position. The values of Kaare obtained as follows: For a type 0 system, For a type 1 system,For a type 2 system,For a type 3 or higher system, forN/H113503 Thus, the steady-state error for the unit parabolic input is for type 0 and type 1 systems for type 2 systems for type 3 or higher systems e ss=0,ess=1 K,ess=q ,Ka=lim sS0s2KATa s+1BATb s+1Bp sNAT1 s+1BAT2 s+1Bp=q ,Ka=lim sS0s2KATa s+1BATb s+1Bp s2AT1 s+1BAT2 s+1Bp=KKa=lim sS0s2KATa s+1BATb s+1Bp sAT1 s+1BAT2 s+1Bp=0Ka=lim sS0s2KATa s+1BATb s+1Bp AT1 s+1BAT2 s+1Bp=0ess=1 KaKa=lim sS0s2G(s) =1 lim sS0s2G(s) ess=lim sS0s 1+G(s)1 s3aa 230 Chapter 5 / Transient and Steady-State Response Analyses Note that both type 0 and type 1 systems are incapable of following a parabolic input in the steady state. The type 2 system with unity feedback can follow a parabolic input with a finite error signal. Figure 5–48 shows an example of the response of a type 2 sys- tem with unity feedback to a parabolic input. The type 3 or higher system with unity feedback follows a parabolic input with zero error at steady state. Summary. Table 5–1 summarizes the steady-state errors for type 0, type 1, and type 2 systems when they are subjected to various inputs. The finite values for steady- state errors appear on the diagonal line.Above the diagonal, the steady-state errors are infinity; below the diagonal, they are zero. r(t) c(t) 0 tr(t) c(t) Figure 5–48 Response of a type 2 unity-feedback system to a parabolic input. Step Input Ramp Input Acceleration Input r(t)=1 r(t)=t Type 0 system qq Type 1 system 0 q Type 2 system 0 01 K1 K1 1+Kr(t) = 1 2 t 2 Table 5–1 Steady-State Error in Terms of Gain K Remember that the terms position error, velocity error , and acceleration error mean steady-state deviations in the output position. A finite velocity error implies that after transients have died out, the input and output move at the same velocity but have a finite position difference. The error constants K p ,K v , and K a describe the ability of a unity-feedback system to reduce or eliminate steady-state error.Therefore, they are indicative of the steady-state performance. It is generally desirable to increase the error constants, while maintaining the transient response within an acceptable range. It is noted that to improve the steady- state performance we can increase the type of the system by adding an integrator or integrators to the feedforward path. This, however, introduces an additional stability problem.The design of a satisfactory system with more than two integrators in series in the feedforward path is generally not easy. Openmirrors.comaa Example Problems and Solutions 231EXAMPLE PROBLEMS AND SOLUTIONS A–5–1. In the system of Figure 5–49, x(t) is the input displacement and u(t)is the output angular displacement. Assume that the masses involved are negligibly small and that all motions are restricted to be small; therefore, the system can be considered linear. The initial conditions for x anduare zeros, or x(0–)=0 andu(0–)=0 . Show that this system is a differentiating element. Then obtain the response u(t)when x(t) is a unit-step input. Solution. The equation for the system is or The Laplace transform of this last equation, using zero initial conditions, gives And so Thus the system is a differentiating system. For the unit-step input X(s)=1 /H20862s, the output becomes The inverse Laplace transform of gives u(t)=1 L e-(k/H20862b)tQ(s)Q(s)=1 L1 s+(k/H20862b)Q(s)Q(s) X(s)=1 Ls s+(k/H20862b)aLs+k bLbQ(s)=sX(s)Lu#+k bLu=x#bAx#-Lu# B=kLu No frictionx b kuL Figure 5–49 Mechanical system.aa 232 Chapter 5 / Transient and Steady-State Response Analyses Note that if the value of k/H20862bis large, the response u(t)approaches a pulse signal, as shown in Figure 5–50. A–5–2. Gear trains are often used in servo systems to reduce speed, to magnify torque, or to obtain the most efficient power transfer by matching the driving member to the given load. Consider the gear-train system shown in Figure 5–51. In this system, a load is driven by a motor through the gear train. Assuming that the stiffness of the shafts of the gear train is infinite (there is neither backlash nor elastic deformation) and that the number of teeth on each gear is proportional to the radius of the gear, obtain the equivalent moment of inertia and equivalent viscous-friction coefficient referred to the motor shaft and referred to the load shaft. In Figure 5–51 the numbers of teeth on gears 1, 2, 3, and 4 are N 1 ,N 2 ,N 3 , and N 4 , respectively. The angular displacements of shafts, 1, 2, and 3 are u 1 ,u 2 , and u 3 , respectively.Thus, and The moment of inertia and viscous-friction coefficient of each gear-train component are denoted by J 1 ,b 1 ;J 2 ,b 2 ; and J 3 ,b 3 ; respectively. ( J 3 andb 3 include the moment of inertia and friction of the load.)u 3 /H20862u 2 =N 3 /H20862N 4 .u 2 /H20862u 1 =N 1 /H20862N 2 x(t) t t1 0 0u(t) 1 L Figure 5–50 Unit-step input and the response of the mechanical system shown in Figure 5–49. Shaft 1 Gear 2Gear 1 Gear 3 Gear 4Shaft 2 Shaft 3J 1, b 1 N 1 Input torque from motor Tm(t)u 1 N 2 N 3 N 4 u 2 u 3 Load torque T L (t)J 2, b 2 J 3, b 3 Figure 5–51 Gear-train system. Openmirrors.comaa Example Problems and Solutions 233Solution. For this gear-train system, we can obtain the following equations: For shaft 1, (5–63) where is the torque developed by the motor and is the load torque on gear 1 due to the rest of the gear train. For shaft 2, (5–64) where is the torque transmitted to gear 2 and is the load torque on gear 3 due to the rest of the gear train. Since the work done by gear 1 is equal to that of gear 2, or If the gear ratio reduces the speed as well as magnifies the torque. For shaft 3, (5–65) where is the load torque and is the torque transmitted to gear 4. and are related by andu3andu1are related by Eliminating and from Equations (5–63), (5–64), and (5–65) yields Eliminating u2andu3from this last equation and writing the resulting equation in terms of u1and its time derivatives, we obtain (5–66) Thus, the equivalent moment of inertia and viscous-friction coefficient of the gear train referred to shaft 1 are given, respectively, by Similarly, the equivalent moment of inertia and viscous-friction coefficient of the gear train referred to the load shaft (shaft 3) are given, respectively, by b3eq=b3+aN4 N3b2 b2+aN2 N1b2 aN4 N3b2 b1J3eq=J3+aN4 N3b2 J2+aN2 N1b2 aN4 N3b2 J1b1eq=b1+aN1 N2b2 b2+aN1 N2b2 aN3 N4b2 b3J1eq=J1+aN1 N2b2 J2+aN1 N2b2 aN3 N4b2 J3+cb1+aN1 N2b2 b2+aN1 N2b2 aN3 N4b2 b3du# 1+aN1 N2baN3 N4bTL=TmcJ1+aN1 N2b2 J2+aN1 N2b2 aN3 N4b2 J3du$ 1J1 u$ 1+b1 u# 1+N1 N2 AJ2 u$ 2+b2 u# 2B+N1 N3 N2 N4 AJ3 u$ 3+b3 u# 3+TLB=TmT4 T1 ,T2 ,T3 ,u3=u2N3 N4=u1N1 N2N3 N4T4=T3N4 N3T4 T3 T4 TLJ3 u$ 3+b3 u# 3+TL=T4N1 /H20862N261,T2=T1N2 N1T1 u1=T2 u2T3 T2J2 u$ 2+b2 u# 2+T3=T2T1 TmJ1 u$ 1+b1 u# 1+T1=Tmaa 234 Chapter 5 / Transient and Steady-State Response Analyses The relationship between J 1eq andJ 3eq is thus and that between b 1eq andb 3eq is The effect of J 2 andJ 3 on an equivalent moment of inertia is determined by the gear ratios and For speed-reducing gear trains, the ratios, and are usually less than unity. If and then the effect of J 2 andJ 3 on the equivalent moment of inertia J 1eq is negligible. Similar comments apply to the equivalent viscous-friction coefficient b 1eq of the gear train. In terms of the equivalent moment of inertia J 1eq and equivalent viscous-friction coefficient b 1eq , Equation (5–66) can be simplified to give where A–5–3. When the system shown in Figure 5–52(a) is subjected to a unit-step input, the system output responds as shown in Figure 5–52(b). Determine the values of KandTfrom the response curve. Solution. The maximum overshoot of 25.4 %corresponds to z=0.4 . From the response curve we have Consequently, t p =p v d =p v n 21-z 2 =p v n 21-0.4 2 =3t p =3n=N 1 N 2 N 3 N 4 J 1eq u$ 1 +b 1eq u# 1 +nT L =T m N 3 /H20862N 4 /H112701, N 1 /H20862N 2 /H112701N 3 /H20862N 4 N 1 /H20862N 2 N 3 /H20862N 4 .N 1 /H20862N 2 b 1eq = a N 1 N 2 b 2 a N 3 N 4 b 2 b 3eq J 1eq = a N 1 N 2 b 2 a N 3 N 4 b 2 J 3eq +– R(s) C(s) (a) (b)c(t) 1 03 t0.254K s(Ts+ 1) Figure 5–52 (a) Closed-loop system; (b) unit-step response curve. Openmirrors.comaa Example Problems and Solutions 235It follows that From the block diagram we have from which Therefore, the values of TandKare determined as A–5–4. Determine the values of Kandkof the closed-loop system shown in Figure 5–53 so that the maximum overshoot in unit-step response is 25 %and the peak time is 2 sec. Assume that J=1 kg-m2. Solution. The closed-loop transfer function is By substituting J=1 kg-m2into this last equation, we have Note that in this problem The maximum overshoot Mpis which is specified as 25 %. Hence from which zp 21-z2=1.386e-zp/H2086221-z2=0.25Mp=e-zp/H2086221-z2vn=1K, 2zvn=KkC(s) R(s)=K s2+Kks +KC(s) R(s)=K Js2+Kks +K K=v2 n T=1.142*1.09 =1.42 T=1 2zvn=1 2*0.4*1.14=1.09vn=AK T, 2zvn=1 TC(s) R(s)=K Ts2+s+Kvn=1.14 +–+–R(s) C(s) k1 sK Js Figure 5–53 Closed-loop system.aa 236 Chapter 5 / Transient and Steady-State Response Analyses or The peak time t p is specified as 2 sec. And so or Then the undamped natural frequency v n is Therefore, we obtain A–5–5. Figure 5–54(a) shows a mechanical vibratory system.When 2 lb of force (step input) is applied to the system, the mass oscillates, as shown in Figure 5–54(b). Determine m, b , and kof the system from this response curve. The displacement xis measured from the equilibrium position. Solution. The transfer function of this system is Since we obtain It follows that the steady-state value of xis x(q)=lim sS0 sX(s) =2 k=0.1 ftX(s) =2 sAms 2 +bs+kBP(s) =2 sX(s) P(s)=1 ms 2 +bs+k k=2zv n K=2*0.404 *1.72 2.95=0.471 sec K=v 2 n =1.72 2 =2.95 N-mv n =v d 21-z 2 =1.57 21-0.404 2 =1.72v d =1.57t p =p v d =2z=0.404 k bx (a) (b)P(2-lb force)x(t) ft0.1 012345 t0.0095 ft m Figure 5–54 (a) Mechanical vibratory system; (b) step-response curve. Openmirrors.comaa Example Problems and Solutions 237Hence Note that Mp=9.5%corresponds to z=0.6 . The peak time tpis given by The experimental curve shows that tp=2 sec. Therefore, Sincev2 n=k /H20862m=20 /H20862m, we obtain (Note that 1 slug =1 lbf-sec2/H20862ft.) Then bis determined from or A–5–6. Consider the unit-step response of the second-order system The amplitude of the exponentially damped sinusoid changes as a geometric series. At time t=tp=p/H20862vd, the amplitude is equal to After one oscillation, or at t=tp+2p/H20862/H9275d=3p/H20862vd, the amplitude is equal to after another cycle of oscillation, the amplitude is The logarithm of the ratio of successive amplitudes is called the logarithmic decrement . Determine the logarithmic decrement for this second-order system. Describe a method for experimental determination of the damping ratio from the rate of decay of the oscillation. Solution. Let us define the amplitude of the output oscillation at t=tito be xi, where ti=tp+(i-1)T(T= period of oscillation ). The amplitude ratio per one period of damped oscillation is Thus, the logarithmic decrement dis It is a function only of the damping ratio z. Thus, the damping ratio zcan be determined by use of the logarithmic. decrement. In the experimental determination of the damping ratio zfrom the rate of decay of the oscil- lation, we measure the amplitude x1att=tpand amplitude xnatt=tp+(n-1)T . Note that it is necessary to choose nlarge enough so that the ratio x1/xnis not near unity. Then x1 xn=e(n-1)2zp/H2086221-z2d=lnx1 x2=2zp 21-z2x1 x2=e-As/H20862vdBp e-As/H20862vdB3p=e2As/H20862vdBp=e2zp/H2086221-z2e-As/H20862vdB5p.e-As/H20862vdB3p;e-As/H20862vdBp.C(s) R(s)=v2 n s2+2zvn s+v2 nb=2zvn m=2*0.6*1.96 *5.2=12.2 lbf/H20862ft/H20862sec2zvn=b mm=20 v2 n=20 1.962=5.2 slugs =167 lbvn=3.14 2*0.8=1.96 rad /H20862sectp=p vd=p vn21-z2=p 0.8vnk=20 lbf/H20862ftaa 238 Chapter 5 / Transient and Steady-State Response Analyses or Hence A–5–7. In the system shown in Figure 5–55, the numerical values of m, b , and kare given as m=1 kg, b=2 N-sec /H20862m, and k=100 N/H20862m. The mass is displaced 0.05 m and released without initial ve- locity. Find the frequency observed in the vibration. In addition, find the amplitude four cycles later. The displacement xis measured from the equilibrium position. Solution. The equation of motion for the system is Substituting the numerical values for m, b, and kinto this equation gives where the initial conditions are x(0) =0.05 and From this last equation the undamped natural frequency v n and the damping ratio zare found to be The frequency actually observed in the vibration is the damped natural frequency v d . In the present analysis, is given as zero. Thus, solution x(t) can be written as It follows that at t=nT , where T=2p/H20862v d , Consequently, the amplitude four cycles later becomes A–5–8. Obtain both analytically and computationally the unit-step response of tbe following higher-order system: [Obtain the partial-fraction expansion of C(s) with MATLAB when R(s) is a unit-step function.]C(s) R(s)=3s 3 +25s 2 +72s +80 s 4 +8s 3 +40s 2 +96s +80 =0.05e -2.526 =0.05 *0.07998 =0.004 m x(4T) =x(0)e -zv n 4T =x(0)e -(0.1)(10)(4)(0.6315) x(nT) =x(0)e -zv n nT x(t) =x(0)e -zv n t a cosv d t+z 21-z 2 sinv d t b x#(0)v d =v n 21-z 2 =1011-0.01 =9.95 rad /H20862secv n =10, z=0.1x#(0)=0.x$+2x#+100x =0mx$+bx#+kx=0z=1 n-1 a lnx 1 x n b B4p 2 + c 1 n-1 a lnx 1 x n b d 2 lnx 1 x n =(n-1) 2zp 21-z 2 k mb x Figure 5–55 Spring-mass-damper system. Openmirrors.comaa Example Problems and Solutions 239Solution. MATLAB Program 5–18 yields the unit-step response curve shown in Figure 5–56. It also yields the partial-fraction expansion of C(s) as follows: -0.4375 s+2-0.375 (s+2)2+1 s =-0.5626(s +2) (s+2)2+42+(0.3438) *4 (s+2)2+42 +-0.4375 s+2+-0.375 (s+2)2+1 s =-0.2813 -j0.1719 s+2-j4+-0.2813 +j0.1719 s+2+j4 C(s) =3s3+25s2+72s +80 s4+8s3+40s2+96s +80 1 s MATLAB Program 5–18 % ------- Unit-Step Response of C(s)/R(s) and Partial-Fraction Expansion of C(s) -------num = [3 25 72 80]; den = [1 8 40 96 80];step(num,den);v = [0 3 0 1.2]; axis(v), grid % To obtain the partial-fraction expansion of C(s), enter commands % num1 = [3 25 72 80]; % den1 = [1 8 40 96 80 0];% [r,p,k] = residue(num1,den1) num1 = [25 72 80]; den1 = [1 8 40 96 80 0];[r,p,k] = residue(num1,den1) r = -0.2813- 0.1719i -0.2813+ 0.1719i-0.4375-0.3750-1.0000 p = -2.0000+ 4.0000i -2.0000- 4.0000i-2.0000-2.0000-0 k = []aa 240 Chapter 5 / Transient and Steady-State Response Analyses Hence, the time response c(t) can be given by The fact that the response curve is an exponential curve superimposed by damped sinusoidal curves can be seen from Figure 5–56. A–5–9. When the closed-loop system involves a numerator dynamics, the unit-step response curve may exhibit a large overshoot. Obtain the unit-step response of the following system with MATLAB: Obtain also the unit-ramp response with MATLAB. Solution. MATLAB Program 5–19 produces the unit-step response as well as the unit-ramp response of the system.The unit-step response curve and unit-ramp response curve, together with the unit-ramp input, are shown in Figures 5–57(a) and (b), respectively. Notice that the unit-step response curve exhibits over 215 %of overshoot. The unit-ramp response curve leads the input curve.These phenomena occurred because of the presence of a large derivative term in the numerator.C(s) R(s)=10s +4 s 2 +4s+4 -0.4375e -2t -0.375te -2t +1 c(t) =-0.5626e -2t cos4t+0.3438e -2t sin4t Amplitude Time (sec)Step Response 0.6 0.4 0.20.811.2 0 0 0.5 1 1.5 2 2.5 3 Figure 5–56 Unit-step response curve. Openmirrors.comaa Example Problems and Solutions 241Output t (sec)Unit-Step Response (a)0.511.522.5 0 0123456789 1 0 Unit-Ramp Input and Output t (sec)Unit-Ramp Response (b)12345678910 0 0123456789 1 0Unit-Ramp InputOutput Figure 5–57 (a) Unit-step response curve; (b) unit-ramp response curve plotted with unit-ramp input.MATLAB Program 5–19 num = [10 4]; den = [1 4 4];t = 0:0.02:10;y = step(num,den,t);plot(t,y)gridtitle('Unit-Step Response')xlabel('t (sec)')ylabel('Output') num1 = [10 4]; den1 = [1 4 4 0];y1 = step(num1,den1,t);plot(t,t,'--',t,y1)v = [0 10 0 10]; axis(v); gridtitle('Unit-Ramp Response')xlabel('t (sec)')ylabel('Unit-Ramp Input and Output')text(6.1,5.0,'Unit-Ramp Input')text(3.5,7.1,'Output')aa A–5–10. Consider a higher-order system defined by Using MATLAB, plot the unit-step response curve of this system. Using MATLAB, obtain the rise time, peak time, maximum overshoot, and settling time. Solution. MATLAB Program 5–20 plots the unit-step response curve as well as giving the rise time, peak time, maximum overshoot, and settling time. The unit-step response curve is shown in Figure 5–58.C(s) R(s)=6.3223s 2 +18s +12.811 s 4 +6s 3 +11.3223s 2 +18s +12.811 242 Chapter 5 / Transient and Steady-State Response Analyses MATLAB Program 5–20 % ------- This program is to plot the unit-step response curve, as well as to % find the rise time, peak time, maximum overshoot, and settling time. % In this program the rise time is calculated as the time required for the % response to rise from 10 %to 90 %of its final value. ------- num = [6.3223 18 12.811]; den = [1 6 11.3223 18 12.811]; t = 0:0.02:20; [y,x,t] = step(num,den,t); plot(t,y) grid title('Unit-Step Response') xlabel('t (sec)') ylabel('Output y(t)') r1 = 1; while y(r1) < 0.1, r1 = r1+1; end; r2 = 1; while y(r2) < 0.9, r2 = r2+1; end; rise_time = (r2-r1)*0. 02 rise_time = 0.5800 [ymax,tp] = max(y); peak_time = (tp-1)*0.02 peak_time = 1.6600 max_overshoot = ymax-1 max_overshoot = 0.6182 s = 1001; while y(s) > 0.98 & y(s) < 1.02; s = s-1; end; settling_time = (s-1)*0.02 settling_time = 10.0200 Openmirrors.comOpenmirrors.comaa Example Problems and Solutions 243A–5–11. Consider the closed-loop system defined by Using a “for loop,” write a MATLAB program to obtain unit-step response of this system for the following four cases: Solution. Define v2 n=a and 2zvn=b . Then, aandbeach have four elements as follows: a=[1 41 63 6 ] b=[ 0.6 2 5.6 9.6 ]Case 4: z=0.8, vn=6Case 3: z=0.7, vn=4Case 2: z=0.5, vn=2Case 1: z=0.3, vn=1C(s) R(s)=v2 n s2+2zvn s+v2 nOutput y(t) t(sec)Unit-Step Response 0.6 0.4 0.20.811.21.41.61.8 0 0 2 4 6 8 10 12 14 16 18 20Figure 5–58 Unit-step responsecurve.aa 244 Chapter 5 / Transient and Steady-State Response Analyses Using vectors aandb, MATLAB Program 5–21 will produce the unit-step response curves as shown in Figure 5–59. Unit-Step Response Curves for Four Cases t Sec012345678 Outputs 1.4 00.4 0.20.60.811.2 1 2 34 Figure 5–59 Unit-step response curves for four cases. MATLAB Program 5–21 a = [1 4 16 36]; b = [0.6 2 5.6 9.6]; t = 0:0.1:8; y = zeros(81,4); for i = 1:4; num = [a(i)]; den = [1 b(i) a(i)]; y(:,i) = step(num,den,t); end plot(t,y(:,1),'o',t,y(:,2),'x',t,y(:,3),'-',t,y(:,4),'-.') grid title('Unit-Step Response Curves for Four Cases') xlabel('t Sec') ylabel('Outputs') gtext('1') gtext('2') gtext('3') gtext('4') Openmirrors.comaa Example Problems and Solutions 245A–5–12. Using MATLAB, obtain the unit-ramp response of the closed-loop control system whose closed- loop transfer function is Also, obtain the response of this system when the input is given by Solution. MATLAB Program 5–22 produces the unit-ramp response and the response to the exponential input r=e–0.5t. The resulting response curves are shown in Figures 5–60(a) and (b), respectively.r=e-0.5tC(s) R(s)=s+10 s3+6s2+9s+10 MATLAB Program 5–22 % --------- Unit-Ramp Response --------- num = [1 10]; den = [1 6 9 10];t = 0:0.1:10;r = t;y = lsim(num,den,r,t);plot(t,r,'-',t,y,'o')gridtitle('Unit-Ramp Response by Use of Command "lsim"')xlabel('t Sec')ylabel('Output')text(3.2,6.5,'Unit-Ramp Input')text(6.0,3.1,'Output') % --------- Response to Input r1 = exp(-0.5t). ---------num = [0 0 1 10]; den = [1 6 9 10];t = 0:0.1:12;r1 = exp(-0.5*t);y1 = lsim(num,den,r1,t);plot(t,r1,'-',t,y1,'o')gridtitle('Response to Input r1 = exp(-0.5t)')xlabel('t Sec')ylabel('Input and Output')text(1.4,0.75,'Input r1 = exp(-0.5t)')text(6.2,0.34,'Output')aa 246 Chapter 5 / Transient and Steady-State Response Analyses Unit-Ramp Response by Use of Command “lsim ” t Sec Output 9 5 18 6 3 2 4710 Unit-Ramp Input (a) 00123456789 1 0 Output Response to Input r 1 = e −0.5t Input r 1 = e −0.5t Output t Sec02468 1 0 1 2 (b) Input and Output 1 0.1 00.4 0.20.30.50.60.70.80.9 Figure 5–60 (a) Unit-ramp response curve; (b) response to exponential input r 1 =e –0.5t . A–5–13. Obtain the response of the closed-loop system defined by when the input r(t) is given by r(t)=2+t [The input r(t) is a step input of magnitude 2 plus unit-ramp input.]C(s) R(s)=5 s 2 +s+5 Openmirrors.comaa Example Problems and Solutions 247MATLAB Program 5–23 num = [5]; den = [1 1 5];t = 0:0.05:10;r = 2+t;c = lsim(num,den,r,t);plot(t,r,'-',t,c,'o')gridtitle('Response to Input r(t) = 2 + t')xlabel('t Sec')ylabel('Output c(t) and Input r(t) = 2 + t') Response to Input r(t) = 2 + t t Sec0123456789 1 0Output c(t) and Input r(t) = 2 + t12 04 26810 Figure 5–61 Response to inputr(t)=2+t . 2 s(s + 1)R(s) C(s) +− Figure 5–62 Control system.Solution. A possible MATLAB program is shown in MATLAB Program 5–23. The resulting response curve, together with a plot of the input function, is shown in Figure 5–61. A–5–14. Obtain the response of the system shown in Figure 5–62 when the input r(t) is given by [The input r(t) is the unit-acceleration input.]r(t) =1 2t2aa 248 Chapter 5 / Transient and Steady-State Response Analyses Solution. The closed-loop transfer function is MATLAB Program 5–24 produces the unit-acceleration response.The resulting response, together with the unit-acceleration input, is shown in Figure 5–63.C(s) R(s)=2 s 2 +s+2 MATLAB Program 5–24 num = [2]; den = [1 1 2]; t = 0:0.2:10; r = 0.5*t.^2; y = lsim(num,den,r,t); plot(t,r,'-',t,y,'o',t,y,'-') grid title('Unit-Acceleration Response') xlabel('t Sec') ylabel('Input and Output') text(2.1,27.5,'Unit-Acceleration Input') text(7.2,7.5,'Output') Unit-Acceleration Response t Sec0123456789 1 0 Input and Output 50 010 515202530354045 Unit-Acceleration Input Ouput Figure 5–63 Response to unit- acceleration input. A–5–15. Consider the system defined by C(s) R(s)=1 s 2 +2zs+1 Openmirrors.comaa Example Problems and Solutions 249MATLAB Program 5–25 t = 0:0.2:12; for n = 1:6;num = [1];den = [1 2*(n-1)*0.2 1];[y(1:61,n),x,t] = step(num,den,t);end plot(t,y)gridtitle('Unit-Step Response Curves')xlabel('t Sec')ylabel('Outputs')gtext('\zeta = 0'),gtext('0.2')gtext('0.4')gtext('0.6')gtext('0.8')gtext('1.0') % To draw a three-dimensional plot, enter the following command: mesh(y) or mesh(y'). % We shall show two three-dimensional plots, one using “mesh(y)” and the other using% "mesh(y')". These two plots are the same, except that the x axis and y axis are% interchanged. mesh(y) title('Three-Dimensional Plot of Unit-Step Response Curves using Command "mesh(y)"')xlabel('n, where n = 1,2,3,4,5,6')ylabel('Computation Time Points')zlabel('Outputs') mesh(y') title('Three-Dimensional Plot of Unit-Step Response Curves using Command "mesh(y transpose)"')xlabel('Computation Time Points')ylabel('n, where n = 1,2,3,4,5,6')zlabel('Outputs')wherez=0, 0.2, 0.4, 0.6, 0.8, and 1.0. Write a MATLAB program using a “for loop” to obtain the two-dimensional and three-dimensional plots of the system output. The input is the unit-step function. Solution. MATLAB Program 5–25 is a possible program to obtain two-dimensional and three- dimensional plots. Figure 5–64(a) is the two-dimensional plot of the unit-step response curves forvarious values of z. Figure 5–64(b) is the three-dimensional plot obtained by use of the command “mesh(y)” and Figure 5–64(c) is obtained by use of the command “mesh(y ¿)”. (These two three-dimensional plots are basically the same.The only difference is that xaxis and yaxis are in- terchanged.)aa 250 Chapter 5 / Transient and Steady-State Response Analyses A–5–16. Consider the system subjected to the initial condition as given below. (There is no input or forcing function in this system.) Obtain the response y(t) versus t to the given initial condition by use of Equations (5–58) and (5–60). y=[1 0 0 ] C x 1 x 2 x 3 SC x# 1 x# 2 x# 3 S = C 0 1 0 0 0 1 -10 -17 -8 SC x 1 x 2 x 3 S , C x 1 (0) x 2 (0) x 3 (0) S = C 2 1 0.5 S (a) 000.20.40.60.811.21.41.61.82 2 4 6 8 10 12 Outputs t Sec/H9256 = 0/H9256 = 0 0.20.2 0.40.4 0.60.6 0.80.8 1.01.0Unit-Step Response Curves Three-Dimensional Plot of Unit-Step Response Curves using Command “mesh( y)” 080 60 40 20 01234560.511.52 Outputs Computation Time Points n, where n = 1, 2, 3, 4, 5, 6 (b) 06 5 4 3 2 10102030405060700.511.52 Outputs Three-Dimensional Plot of Unit-Step Response Curves using Command “mesh(y transpose) ” n, where n = 1, 2, 3, 4, 5, 6 Computation Time Points (c) Figure 5–64 (a) Two-dimensional plot of unit-step response curves; (b) three-dimensional plot of unit-step response curves using command “mesh(y)”; (c) three-dimensional plot of unit-step response curves using command “mesh(y ¿)”. Openmirrors.comaa Example Problems and Solutions 251Solution. A possible MATLAB program based on Equations (5–58) and (5–60) is given by MAT- LAB program 5–26. The response curve obtained here is shown in Figure 5–65. (Notice that thisproblem was solved by use of the command “initial” in Example 5–16.The response curve obtainedhere is exactly the same as that shown in Figure 5–34.) MATLAB Program 5–26 t = 0:0.05:10; A = [0 1 0;0 0 1;-10 -17 -8];B = [2;1;0.5];C=[1 0 0];[y,x,t] = step(A,B,C*A,C*B,1,t);plot(t,y)grid;title('Response to Initial Condition')xlabel('t (sec)')ylabel('Output y') A–5–17. Consider the following characteristic equation: Determine the range of Kfor stability. Solution. The Routh array of coefficients is s4 s3 s2 s1 s01 K K-1 K 1-K2 K-1 11 1 11 0s4+Ks3+s2+s+1=0Figure 5–65 Response y(t) to the given initial condition. Output y t (sec)Response to Initial Condition 0.511.522.5 0 0123456789 1 0aa 252 Chapter 5 / Transient and Steady-State Response Analyses For stability, we require that From the first and second conditions, Kmust be greater than 1. For K>1 , notice that the term 1-CK 2 /(K-1)Dis always negative, since Thus, the three conditions cannot be fulfilled simultaneously.Therefore, there is no value of Kthat allows stability of the system. A–5–18. Consider the characteristic equation given by (5–67) The Hurwitz stability criterion, given next, gives conditions for all the roots to have negative real parts in terms of the coefficients of the polynomial.As stated in the discussions of Routh’s stability criterion in Section 5–6, for all the roots to have negative real parts, all the coefficients a’s must be positive.This is a necessary condition but not a sufficient condition. If this condition is not sat- isfied, it indicates that some of the roots have positive real parts or are imaginary or zero. A suf- ficient condition for all the roots to have negative real parts is given in the following Hurwitz stability criterion: If all the coefficients of the polynomial are positive, arrange these coefficients in the following determinant: where we substituted zero for a s ifs>n . For all the roots to have negative real parts, it is neces- sary and sufficient that successive principal minors of be positive. The successive principal minors are the following determinants: where a s =0 ifs>n . (It is noted that some of the conditions for the lower-order determinants are included in the conditions for the higher-order determinants.) If all these determinants are positive, and a 0 >0 as already assumed, the equilibrium state of the system whose characteristic¢ i = 5 a 1 a 0 0 /H11080 0a 3 a 2 a 1 /H11080 0p p p pa 2i-1 a 2i-2 a 2i-3 /H11080 a i 5 (i=1, 2, p,n-1)¢ n ¢ n = 7 a 1 a 0 0 0 /H11080 /H11080 0a 3 a 2 a 1 a 0 /H11080 /H11080 0a 5 a 4 a 3 a 2 /H11080 /H11080 0p p p p p0 /H11080 a n a n-1 a n-2 a n-3 a n-4 0 /H11080 0 0 a n a n-1 a n-2 0 /H11080 0 0 0 0 a n 7 a 0 s n +a 1 s n-1 +a 2 s n-2 +p+a n-1 s+a n =0K-1-K 2 K-1=-1+K(1 -K) K-160K70 K-1 K70 1-K 2 K-170 Openmirrors.comaa Example Problems and Solutions 253equation is given by Equation (5–67) is asymptotically stable. Note that exact values of determi- nants are not needed; instead, only signs of these determinants are needed for the stability criterion. Now consider the following characteristic equation: Obtain the conditions for stability using the Hurwitz stability criterion. Solution. The conditions for stability are that all the a’s be positive and that It is clear that, if all the a’s are positive and if the condition is satisfied, the condition is also satisfied.Therefore, for all the roots of the given characteristic equation to have neg- ative real parts, it is necessary and sufficient that all the coefficients a’s are positive and A–5–19. Show that the first column of the Routh array of is given by where Solution. The Routh array of coefficients has the form 1 a1 b1 c1 /H11080/H11080/H11080a 2 a3 b2 c2 /H11080 /H11080/H11080a 4 a5 b3 /H11080 /H11080/H11080/H11080a 6 p ppanak=0 if k7n¢r=7a1 a3 a5 /H11080 /H11080/H11080 a 2r-11 a2 a4 /H11080 /H11080/H11080/H110800 a 1 a3 /H11080 /H11080/H11080/H110800 1 a 2 /H11080/H11080/H11080/H11080/H11080 /H11080 /H11080 /H110800 0 0 /H11080/H11080/H11080 a r7, (n/H11350r/H113501)1, ¢1 , ¢2 ¢1, ¢3 ¢2,p, ¢n ¢n-1sn+a1 sn-1+a2 sn-2+p+an-1 s+an=0¢370.¢270¢370=a3Aa1 a2-a0 a3B-a2 1 a470=a1Aa2 a3-a1 a4B-a0 a2 3¢3=3a1 a0 0a3 a2 a10 a4 a33¢2=2a1 a0a3 a22=a1 a2-a0 a370a0 s4+a1 s3+a2 s2+a3 s+a4=0aa 254 Chapter 5 / Transient and Steady-State Response Analyses The first term in the first column of the Routh array is 1. The next term in the first column is a 1 , which is equal to The next term is b 1 , which is equal to The next term in the first column is c 1 , which is equal to In a similar manner the remaining terms in the first column of the Routh array can be found. The Routh array has the property that the last nonzero terms of any columns are the same; that is, if the array is given by then and if the array is given by then In any case, the last term of the first column is equal to a n ,o r a n =¢ n-1 a n ¢ n-1 =¢ n ¢ n-1 a 6 =b 3 =d 2 =f 1 a 0 a 1 b 1 c 1 d 1 e 1 f 1 a 2 a 3 b 2 c 2 d 2 0a 4 a 5 b 3 0a 6 0a 7 =c 3 =e 2 =g 1 a 0 a 1 b 1 c 1 d 1 e 1 f 1 g 1 a 2 a 3 b 2 c 2 d 2 e 2 a 4 a 5 b 3 c 3 a 6 a 7 =¢ 3 ¢ 2 =a 1 a 2 a 3 -a 2 3 -a 2 1 a 4 +a 1 a 5 a 1 a 2 -a 3 b 1 a 3 -a 1 b 2 b 1 = c a 1 a 2 -a 3 a 1 d a 3 -a 1 c a 1 a 4 -a 5 a 1 d c a 1 a 2 -a 3 a 1 d a 1 a 2 -a 3 a 1 =¢ 2 ¢ 1 ¢ 1 . Openmirrors.comaa Example Problems and Solutions 255For example, if n=4 , then Thus it has been shown that the first column of the Routh array is given by A–5–20. Show that the Routh’s stability criterion and Hurwitz stability criterion are equivalent. Solution. If we write Hurwitz determinants in the triangular form where the elements below the diagonal line are all zeros and the elements above the diagonal line any numbers, then the Hurwitz conditions for asymptotic stability become which are equivalent to the conditionsWe shall show that these conditions are equivalent to where a 1,b1,c1,p, are the elements of the first column in the Routh array. Consider, for example, the following Hurwitz determinant, which corresponds to i=4 : The determinant is unchanged if we subtract from the ith row ktimes the jth row. By subtracting from the second row a0/a1times the first row, we obtain ¢4=4a11 0 00a 3 a22 a1 a0a5 a23 a3 a2a7 a24 a5 a44¢4=4a1 a0 0 0a3 a2 a1 a0a5 a4 a3 a2a7 a6 a5 a44a170, b170, c170, pa1170, a2270, p, ann70¢i=a11 a22paii70, (i=1, 2, p,n)¢i=6a11 * a22 /H11554 /H11554 /H11554 0 aii6, (i=1, 2, p,n)1, ¢1 , ¢2 ¢1, ¢3 ¢2, p, ¢n ¢n-1¢4=4a1 a3 a5 a71 a2 a4 a60a 1 a3 a501a 2 a44=4a1 a3 001 a 2 a4 00 a1 a3 00 1a 2 a44=¢3 a4aa 256 Chapter 5 / Transient and Steady-State Response Analyses where Similarly, subtracting from the fourth row a 0 /a 1 times the third row yields where Next, subtracting from the third row a 1 /a 22 times the second row yields where Finally, subtracting from the last row times the third row yields where a 44 =a ˆ 44 -a ˆ 43 a 33 a 34 ¢ 4 = 4 a 11 0 0 0a 3 a 22 0 0a 5 a 23 a 33 0a 7 a 24 a 34 a 44 4 a ˆ 43 /H20862a 33 a 34 =a 5 -a 1 a 22 a 24 a 33 =a 3 -a 1 a 22 a 23 ¢ 4 = 4 a 11 0 0 0a 3 a 22 0 0a 5 a 23 a 33 a ˆ 43 a 7 a 24 a 34 a ˆ 44 4 a ˆ 44 =a 4 -a 0 a 1 a 5 a ˆ 43 =a 2 -a 0 a 1 a 3 ¢ 4 = 4 a 11 0 0 0a 3 a 22 a 1 0a 5 a 23 a 3 a ˆ 43 a 7 a 24 a 5 a ˆ 44 4 a 24 =a 6 -a 0 a 1 a 7 a 23 =a 4 -a 0 a 1 a 5 a 22 =a 2 -a 0 a 1 a 3 a 11 =a 1 Openmirrors.comaa Example Problems and Solutions 257From this analysis, we see that The Hurwitz conditions for asymptotic stability reduce to the conditionsThe Routh array for the polynomialwhere a 0>0 andn=4 , is given by From this Routh array, we see that (The last equation is obtained using the fact that ) Hence the Hurwitz conditions for asymptotic stability become Thus we have demonstrated that Hurwitz conditions for asymptotic stability can be reduced to Routh’s conditions for asymptotic stability. The same argument can be extended to Hurwitzdeterminants of any order, and the equivalence of Routh’s stability criterion and Hurwitz stabil-ity criterion can be established. A–5–21. Consider the characteristic equation Using the Hurwitz stability criterion, determine the range of Kfor stability. Solution. Comparing the given characteristic equation s 4+2s3+(4+K)s2+9s+25=0s4+2s3+(4+K)s2+9s+25=0a170, b170, c170, d170a34=0, aˆ44=a4 , and a4=b2=d1 .a44=aˆ44-aˆ43 a33 a34=a4=d1a33=a3-a1 a22a23=a3 b1-a1 b2 b1=c1a22=a2-a0 a1a3=b1a11=a1a0 a1 b1 c1 d1a2 a3 b2a4a0 s4+a1 s3+a2 s2+a3 s+a4=0a1170, a2270, a3370, a4470, p¢170, ¢270, ¢370, ¢470, p¢1=a11¢2=a11 a22¢3=a11 a22 a33¢4=a11 a22 a33 a44aa 258 Chapter 5 / Transient and Steady-State Response Analyses with the following standard fourth-order characteristic equation: we find The Hurwitz stability criterion states that is given by For all the roots to have negative real parts, it is necessary and sufficient that succesive principal minors of be positive. The successive principal minors are For all principal minors to be positive, we require that be positive.Thus, we require from which we obtain the region of Kfor stability to be A–5–22. Explain why the proportional control of a plant that does not possess an integrating property (which means that the plant transfer function does not include the factor 1/s) suffers offset in response to step inputs. Solution. Consider, for example, the system shown in Figure 5–66.At steady state, if cwere equal to a nonzero constant r, then e=0 and u=Ke=0 , resulting in c=0 , which contradicts the assumption that c=r= nonzero constant. A nonzero offset must exist for proper operation of such a control system. In other words, at steady state, if ewere equal to r/(1+K) , then u=Kr/(1+K) and c=Kr/(1+K) , which results in the assumed error signal e=r/(1+K) .Thus the offset of r/(1+K) must exist in such a system.K7109 18 18K -109 70 2K-170¢ i (i=1, 2, 3)¢ 3 = 3 a 1 a 0 0a 3 a 2 a 1 0 a 4 a 3 3 = 3 2 1 09 4+K 20 25 9 3 =18K -109¢ 2 = 2 a 1 a 0 a 3 a 2 2 = 2 2 19 4+K 2 =2K-1¢ 1 =@a 1 @=2¢ 4 ¢ 4 = 4 a 1 a 0 0 0a 3 a 2 a 1 a 0 0 a 4 a 3 a 2 0 0 0 a 4 4 ¢ 4 a 0 =1, a 1 =2, a 2 =4+K, a 3 =9, a 4 =25a 0 s 4 +a 1 s 3 +a 2 s 2 +a 3 s+a 4 =0 +– rc euK1 Ts+ 1 Figure 5–66 Control system. Openmirrors.comaa Example Problems and Solutions 259A–5–23. The block diagram of Figure 5–67 shows a speed control system in which the output member of the system is subject to a torque disturbance. In the diagram, and D(s) are the Laplace transforms of the reference speed, output speed, driving torque, and disturbance torque,respectively. In the absence of a disturbance torque, the output speed is equal to the reference speed.V r(s),V(s),T(s) , +–++D(s) E(s) T(s) V(s) Vr(s) K1 Js Figure 5–67 Block diagram of a speed control system. +– K1 JsVD(s) D(s) Figure 5–68 Block diagram of thespeed control systemof Figure 5–67 whenV r(s)=0.Investigate the response of this system to a unit-step disturbance torque. Assume that the reference input is zero, or Solution. Figure 5–68 is a modified block diagram convenient for the present analysis.The closed- loop transfer function is where is the Laplace transform of the output speed due to the disturbance torque. For a unit- step disturbance torque, the steady-state output velocity is From this analysis, we conclude that, if a step disturbance torque is applied to the output member of the system, an error speed will result so that the ensuing motor torque will exactly can-cel the disturbance torque. To develop this motor torque, it is necessary that there be an error inspeed so that nonzero torque will result. (Discussions continue to Problem A–5–24 .)=1 K=lim sS0s Js+K1 svD(q)=lim sS0sVD(s)VD(s)VD(s) D(s)=1 Js+KVr(s)=0.aa 260 Chapter 5 / Transient and Steady-State Response Analyses A–5–24. In the system considered in Problem A–5–23 , it is desired to eliminate as much as possible the speed errors due to torque disturbances. Is it possible to cancel the effect of a disturbance torque at steady state so that a constant disturbance torque applied to the output member will cause no speed change at steady state? Solution. Suppose that we choose a suitable controller whose transfer function is G c (s), as shown in Figure 5–69. Then in the absence of the reference input the closed-loop transfer function between the output velocity and the disturbance torque D(s) is The steady-state output speed due to a unit-step disturbance torque is To satisfy the requirement that we must choose G c (0)= q. This can be realized if we choose Integral control action will continue to correct until the error is zero. This controller, however, presents a stability problem, because the characteristic equation will have two imaginary roots. One method of stabilizing such a system is to add a proportional mode to the controller or choose G c (s)=K p +K sG c (s)=K sv D (q)=0=1 G c (0)=lim sS0 s Js+G c (s)1 sv D (q)=lim sS0 sV D (s)=1 Js+G c (s)V D (s) D(s)=1 Js 1+1 JsG c (s)V D (s) +– ++ D(s) E(s) T(s) V(s) V r (s) G c (s)1 Js Figure 5–69 Block diagram of a speed control system. Openmirrors.comaa Example Problems and Solutions 261With this controller, the block diagram of Figure 5–69 in the absence of the reference input can be modified to that of Figure 5–70. The closed-loop transfer function becomes For a unit-step disturbance torque, the steady-state output speed is Thus, we see that the proportional-plus-integral controller eliminates speed error at steady state. The use of integral control action has increased the order of the system by 1. (This tends to produce an oscillatory response.) In the present system, a step disturbance torque will cause a transient error in the output speed, but the error will become zero at steady state. The integrator provides a nonzero outputwith zero error. (The nonzero output of the integrator produces a motor torque that exactly cancels the disturbance torque.) Note that even if the system may have an integrator in the plant (such as an integrator in the transfer function of the plant), this does not eliminate the steady-state error due to a step distur-bance torque.To eliminate this, we must have an integrator before the point where the disturbance torque enters. A–5–25. Consider the system shown in Figure 5–71(a). The steady-state error to a unit-ramp input is e ss=2z/H20862vn. Show that the steady-state error for following a ramp input may be eliminated if the input is introduced to the system through a proportional-plus-derivative filter, as shown in Figure 5–71(b), and the value of kis properly set. Note that the error e(t) is given by r(t)-c(t) . Solution. The closed-loop transfer function of the system shown in Figure 5–71(b) is Then R(s) -C(s) =as2+2zvn s-v2 n ks s2+2zvn s+v2 nbR(s)C(s) R(s)=(1+ks)v2 n s2+2zvn s+v2 nvD(q)=lim sS0sVD(s)=lim sS0s2 Js2+Kp s+K1 s=0VD(s) D(s)=s Js2+Kp s+KVD(s) /H20862D(s)1 Js Kps+K sVD(s) D(s) +–Figure 5–70 Block diagram of thespeed control systemof Figure 5–69 whenG c(s)= Kp+(K/s) andVr(s)=0. +–+–R(s) C(s) (a) (b)1+ksvn s(s+ 2zvn)2vn s(s+ 2zvn)2 Figure 5–71 (a) Control system;(b) control systemwith input filter.aa 262 Chapter 5 / Transient and Steady-State Response Analyses If the input is a unit ramp, then the steady-state error is Therefore, if kis chosen as then the steady-state error for following a ramp input can be made equal to zero. Note that, if there are any variations in the values of zand/or v n due to environmental changes or aging, then a nonzero steady-state error for a ramp response may result. A–5–26. Consider the stable unity-feedback control system with feedforward transfer function G(s) . Suppose that the closed-loop transfer function can be written Show that where e(t) =r(t)-c(t) is the error in the unit-step response. Show also that Solution. Let us define and Then and For a unit-step input, R(s)=1/s and E(s) =Q(s) -P(s) sQ(s)E(s) =Q(s) -P(s) Q(s)R(s)C(s) R(s)=P(s) Q(s)AT 1 s+1BAT 2 s+1BpAT n s+1B=Q(s)AT a s+1BAT b s+1B p AT m s+1B=P(s)1 K v =1 lim sS0 sG(s)=AT 1 +T 2 +p+T n B-AT a +T b +p+T m B3 q 0 e(t)dt=AT 1 +T 2 +p+T n B-AT a +T b +p+T m BC(s) R(s)=G(s) 1+G(s)=AT a s+1BAT b s+1BpAT m s+1B AT 1 s+1BAT 2 s+1BpAT n s+1B (m/H11349n)k=2z v n =2zv n -v 2 n k v 2 n =lim sS0 s a s 2 +2zv n s-v 2 n ks s 2 +2zv n s+v 2 n b 1 s 2 e(q)=r(q)-c(q) Openmirrors.comaa Problems 263Since the system is stable, converges to a constant value. Noting that we have Since we have For a unit-step input r(t), since we have Note that zeros in the left half-plane (that is, positive ) will improve Kv. Poles close to the origin cause low velocity-error constants unless there are zeros nearby. PROBLEMSTa ,Tb ,p,Tm1 Kv=1 lim sS0sG(s)=AT1+T2+p+TnB-ATa+Tb+p+TmB=lim sS01 1+G(s)1 s=1 lim sS0sG(s)=1 Kv 3q 0e(t)dt=lim sS0E(s) =lim sS01 1+G(s)R(s)3q 0e(t)dt=AT1+T2+p+TnB-ATa+Tb+p+TmBlim sS0Q¿(s)=T1+T2+p+Tnlim sS0P¿(s)=Ta+Tb+p+Tm =lim sS0CQ¿(s)-P¿(s)D =lim sS0 Q¿(s)-P¿(s) Q(s) +sQ¿(s) 3q 0e(t)dt=lim sS0Q(s) -P(s) sQ(s)3q 0e(t)dt=lim sS0sE(s) s=lim sS0E(s)1q 0e(t)dt B–5–1. A thermometer requires 1 min to indicate 98 %of the response to a step input. Assuming the thermometer to be a first-order system, find the time constant. If the thermometer is placed in a bath, the temperature of which is changing linearly at a rate of 10° /H20862min, how much error does the thermometer show? B–5–2. Consider the unit-step response of a unity-feedback control system whose open-loop transfer function is G(s) =1 s(s+1)Obtain the rise time, peak time, maximum overshoot, and settling time. B–5–3. Consider the closed-loop system given by Determine the values of zandvnso that the system responds to a step input with approximately 5 %overshoot and with a settling time of 2 sec. (Use the 2 %criterion.)C(s) R(s)=v2 n s2+2zvn s+v2 naa 264 Chapter 5 / Transient and Steady-State Response Analyses x mkImpulsive force d(t) Figure 5–72 Mechanical system. x 1 Tt t 1 x n t n Figure 5–73 Decaying oscillation. +– +– R(s) C(s) R(s) C(s)(a) (b)10 s(s+ 1) K h 10 s+ 1 1 s +– Figure 5–74 (a) Control system; (b) control system with tachometer feedback.B–5–4. Consider the system shown in Figure 5–72.The sys- tem is initially at rest. Suppose that the cart is set into mo- tion by an impulsive force whose strength is unity. Can it be stopped by another such impulsive force? B–5–5. Obtain the unit-impulse response and the unit- step response of a unity-feedback system whose open-loop transfer function is B–5–6. An oscillatory system is known to have a transfer function of the following form: G(s) =v 2 n s 2 +2zv n s+v 2 n G(s) =2s+1 s 2 B–5–7. Consider the system shown in Figure 5–74(a). The damping ratio of this system is 0.158 and the undamped nat- ural frequency is 3.16 rad /H20862sec. To improve the relative sta- bility, we employ tachometer feedback. Figure 5–74(b) shows such a tachometer-feedback system. Determine the value of K h so that the damping ratio of the system is 0.5. Draw unit-step response curves of both the original and tachometer-feedback systems. Also draw the error-versus-time curves for the unit-ramp response of both systems.Assume that a record of a damped oscillation is available as shown in Figure 5–73. Determine the damping ratio zof the system from the graph. Openmirrors.comaa Problems 265+–+–R(s) C(s)1 s16 s+ 0.8 kR(s) C(s)1 sK s+ 2 k+–+– Figure 5–75 Closed-loop system. Figure 5–76 Block diagram of a system.B–5–8. Referring to the system shown in Figure 5–75, de- termine the values of Kand ksuch that the system has a damping ratio zof 0.7 and an undamped natural frequency vnof 4 rad /H20862sec. B–5–9. Consider the system shown in Figure 5–76. Deter- mine the value of ksuch that the damping ratio zis 0.5.Then obtain the rise time tr, peak time tp, maximum overshoot Mp, and settling time tsin the unit-step response. B–5–10. Using MATLAB, obtain the unit-step response, unit-ramp response, and unit-impulse response of the fol-lowing system: where R(s) and C(s) are Laplace transforms of the input r(t) and output c(t), respectively.C(s) R(s)=10 s2+2s+10B–5–11. Using MATLAB, obtain the unit-step response, unit-ramp response, and unit-impulse response of the fol-lowing system: where uis the input and yis the output. B–5–12. Obtain both analytically and computationally the rise time, peak time, maximum overshoot, and settling time in the unit-step response of a closed-loop system given by C(s) R(s)=36 s2+2s+36 y=[1 0]Bx1 x2R Bx# 1 x# 2R=B-1-0.5 10RBx1 x2R+B0.50Ruaa 266 Chapter 5 / Transient and Steady-State Response Analyses B–5–13. Figure 5–77 shows three systems. System I is a po- sitional servo system. System II is a positional servo system with PD control action. System III is a positional servo sys- tem with velocity feedback. Compare the unit-step, unit- impulse, and unit-ramp responses of the three systems. Which system is best with respect to the speed of response and maximum overshoot in the step response?B–5–14. Consider the position control system shown in Fig- ure 5–78. Write a MATLAB program to obtain a unit-step response and a unit-ramp response of the system. Plot curves x 1 (t)versus t, x 2 (t)versus t, x 3 (t)versus t, and e(t) versus t Cwhere e(t)=r(t)-x 1 (t)Dfor both the unit-step response and the unit-ramp response. 0.8 5 5 C III (s) R(s) System III1 5s+ 1 1 s C II (s) R(s) System II5(1+ 0.8s)1 s(5s+ 1) C(s) R(s) System I1 s(5s+ 1) +– +– +– +– Figure 5–77 Positional servo system (System I), positional servo system with PD control action (System II), and positional servo system with velocity feedback (System III). 5 4 x 1 x 2 x 3 re 1 s 1 s 2 0.1s+ 1 +– +– Figure 5–78 Position control system. Openmirrors.comProblems 267aa B–5–15. Using MATLAB, obtain the unit-step response curve for the unity-feedback control system whose open-loop transfer function is Using MATLAB, obtain also the rise time, peak time, max- imum overshoot, and settling time in the unit-step response curve. B–5–16. Consider the closed-loop system defined by wherez=0.2, 0.4, 0.6, 0.8, and 1.0. Using MATLAB, plot a two-dimensional diagram of unit-impulse response curves.Also plot a three-dimensional plot of the response curves. B–5–17. Consider the second-order system defined by wherez=0.2, 0.4, 0.6, 0.8, 1.0. Plot a three-dimensional diagram of the unit-step response curves. B–5–18. Obtain the unit-ramp response of the system defined by where uis the unit-ramp input. Use the lsim command to obtain the response. y=[1 0]Bx1 x2R Bx# 1 x# 2R=B0 -11 -1RBx1 x2R+B0 1RuC(s) R(s)=s+1 s2+2zs+1C(s) R(s)=2zs+1 s2+2zs+1G(s) =10 s(s+2)(s +4)B–5–19. Consider the differential equation system given by Using MATLAB, obtain the response y(t), subject to the given initial condition. B–5–20. Determine the range of Kfor stability of a unity- feedback control system whose open-loop transfer function is B–5–21. Consider the following characteristic equation: Using the Routh stability criterion, determine the range of Kfor stability. B–5–22. Consider the closed-loop system shown in Figure 5–79. Determine the range of Kfor stability. Assume that K>0 .s4+2s3+(4+K)s2+9s+25=0G(s) =K s(s+1)(s +2)y$+3y#+2y=0, y(0) =0.1, y#(0)=0.05 +–R(s) C(s) Ks–2 (s+ 1)(s2+ 6s+ 25) Figure 5–79 Closed-loop system. B–5–23. Consider the satellite attitude control system shown in Figure 5–80(a). The output of this system exhibitscontinued oscillations and is not desirable. This system canbe stabilized by use of tachometer feedback, as shown in Figure 5–80(b). If K/J=4 , what value of K hwill yield the damping ratio to be 0.6? +–+–R(s) C(s) (b)KhK Js1 s+–R(s) C(s) (a)K1 Js2 Figure 5–80 (a) Unstable satellite attitude control system;(b) stabilized system.aa 268 Chapter 5 / Transient and Steady-State Response Analyses K h K C(s) R(s)20 (s+ 1) (s+ 4) 1 s +– +– Figure 5–81 Servo system with tachometer feedback.B–5–24. Consider the servo system with tachometer feedback shown in Figure 5–81. Determine the ranges of stability for KandK h . (Note that K h must be positive.) B–5–25. Consider the system where matrix Ais given by (Ais called Schwarz matrix.) Show that the first column of the Routh’s array of the characteristic equation |sI-A|=0 consists of 1, b 1 ,b 2 , and b 1 b 3 . B–5–26. Consider a unity-feedback control system with the closed-loop transfer function Determine the open-loop transfer function G(s) . Show that the steady-state error in the unit-ramp response is given by e ss =1 K v =a-K bC(s) R(s)=Ks+b s 2 +as+bA= C 0 -b 3 01 0 -b 2 0 1 -b 1 S x#=AxB–5–27. Consider a unity-feedback control system whose open-loop transfer function is Discuss the effects that varying the values of Kand Bhas on the steady-state error in unit-ramp response. Sketch typical unit-ramp response curves for a small value, medium value, and large value of K, assuming that Bis constant. B–5–28. If the feedforward path of a control system contains at least one integrating element, then the output continues to change as long as an error is present.The out- put stops when the error is precisely zero. If an external dis- turbance enters the system, it is desirable to have an integrating element between the error-measuring element and the point where the disturbance enters, so that the ef- fect of the external disturbance may be made zero at steady state. Show that, if the disturbance is a ramp function, then the steady-state error due to this ramp disturbance may be eliminated only if two integrators precede the point where the disturbance enters.G(s) =K s(Js +B) Openmirrors.com6 269Control Systems Analysis and Design by the Root-Locus Method 6–1 INTRODUCTION The basic characteristic of the transient response of a closed-loop system is closely related to the location of the closed-loop poles. If the system has a variable loop gain,then the location of the closed-loop poles depends on the value of the loop gain chosen.It is important, therefore, that the designer know how the closed-loop poles move inthesplane as the loop gain is varied. From the design viewpoint, in some systems simple gain adjustment may move the closed-loop poles to desired locations.Then the design problem may become the selec-tion of an appropriate gain value. If the gain adjustment alone does not yield a desiredresult, addition of a compensator to the system will become necessary. (This subject isdiscussed in detail in Sections 6–6 through 6–9.) The closed-loop poles are the roots of the characteristic equation. Finding the roots of the characteristic equation of degree higher than 3 is laborious and will need computersolution. (MATLAB provides a simple solution to this problem.) However, just findingthe roots of the characteristic equation may be of limited value, because as the gain ofthe open-loop transfer function varies, the characteristic equation changes and thecomputations must be repeated. A simple method for finding the roots of the characteristic equation has been developed by W. R. Evans and used extensively in control engineering. This method,called the root-locus method, is one in which the roots of the characteristic equation270 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method H(s) G(s)C(s) R(s) +– Figure 6–1 Control system. are plotted for all values of a system parameter. The roots corresponding to a par- ticular value of this parameter can then be located on the resulting graph. Note that the parameter is usually the gain, but any other variable of the open-loop transfer function may be used. Unless otherwise stated, we shall assume that the gain of the open-loop transfer function is the parameter to be varied through all values, from zero to infinity. By using the root-locus method the designer can predict the effects on the location of the closed-loop poles of varying the gain value or adding open-loop poles and/or open-loop zeros.Therefore, it is desired that the designer have a good understanding of the method for generating the root loci of the closed-loop system, both by hand and by use of a computer software program like MATLAB. In designing a linear control system, we find that the root-locus method proves to be quite useful, since it indicates the manner in which the open-loop poles and zeros should be modified so that the response meets system performance specifications.This method is particularly suited to obtaining approximate results very quickly. Because generating the root loci by use of MATLAB is very simple, one may think sketching the root loci by hand is a waste of time and effort. However, experience in sketching the root loci by hand is invaluable for interpreting computer-generated root loci, as well as for getting a rough idea of the root loci very quickly. Outline of the Chapter. The outline of the chapter is as follows: Section 6–1 has presented an introduction to the root-locus method. Section 6–2 details the concepts underlying the root-locus method and presents the general procedure for sketching root loci using illustrative examples. Section 6–3 discusses generating root-locus plots with MATLAB. Section 6–4 treats a special case when the closed-loop system has positive feedback. Section 6–5 presents general aspects of the root-locus approach to the design of closed-loop systems. Section 6–6 discusses the control systems design by lead com- pensation. Section 6–7 treats the lag compensation technique. Section 6–8 deals with the lag–lead compensation technique. Finally, Section 6–9 discusses the parallel com- pensation technique. 6–2 ROOT-LOCUS PLOTS Angle and Magnitude Conditions. Consider the negative feedback system shown in Figure 6–1. The closed-loop transfer function is (6–1)C(s) R(s)=G(s) 1+G(s)H(s) Openmirrors.comSection 6–2 / Root-Locus Plots 271The characteristic equation for this closed-loop system is obtained by setting the denominator of the right-hand side of Equation (6–1) equal to zero. That is, or (6–2) Here we assume that G(s)H(s) is a ratio of polynomials in s.[It is noted that we can extend the analysis to the case when G(s)H(s) involves the transport lag e–Ts.] Since G(s)H(s) is a complex quantity, Equation (6–2) can be split into two equations by equating the angles and magnitudes of both sides, respectively, to obtain thefollowing: Angle condition: (6–3) Magnitude condition: (6–4) The values of sthat fulfill both the angle and magnitude conditions are the roots of the characteristic equation, or the closed-loop poles. A locus of the points in thecomplex plane satisfying the angle condition alone is the root locus. The roots ofthe characteristic equation (the closed-loop poles) corresponding to a given valueof the gain can be determined from the magnitude condition. The details of applyingthe angle and magnitude conditions to obtain the closed-loop poles are presentedlater in this section. In many cases, G(s)H(s) involves a gain parameter K,and the characteristic equa- tion may be written as Then the root loci for the system are the loci of the closed-loop poles as the gain Kis varied from zero to infinity. Note that to begin sketching the root loci of a system by the root-locus method we must know the location of the poles and zeros of G(s)H(s). Remember that the angles of the complex quantities originating from the open-loop poles and open-loop zeros tothe test point sare measured in the counterclockwise direction. For example, if G(s)H(s) is given by G(s)H(s) =KAs+z 1B As+p1BAs+p2BAs+p3BAs+p4B1+KAs+z1BAs+z2BpAs+zmB As+p1BAs+p2BpAs+pnB=0∑G(s)H(s)∑ =1/G(s)H(s) =;180°(2k +1) (k=0, 1, 2, p)G(s)H(s) =-11+G(s)H(s) =0272 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method Test pointTest point –p 4 –p 3 –p 2 –p 1 ss –z 1 f 1 f 1 jv u 4 u 2 u 3 u 4 u 1 u 3 u 1 u 2 /H9268 0 –p 4 –p 2 A 4 B 1 A 3 A 2 A 1 –p 1 –p 3 –z 1 jv /H9268 0 (b) (a) where –p 2 and–p 3 are complex-conjugate poles, then the angle of G(s)H(s) is wheref 1 ,u 1 ,u 2 ,u 3 ,andu 4 are measured counterclockwise as shown in Figures 6–2(a) and (b). The magnitude of G(s)H(s) for this system is where A 1 ,A 2 ,A 3 ,A 4 , and B 1 are the magnitudes of the complex quantities s+p 1 , s+p 2 , s+p 3 , s+p 4 ,ands+z 1 ,respectively, as shown in Figure 6–2(a). Note that, because the open-loop complex-conjugate poles and complex-conjugate zeros, if any, are always located symmetrically about the real axis, the root loci are always symmetrical with respect to this axis.Therefore, we only need to construct the upper half of the root loci and draw the mirror image of the upper half in the lower-half splane. Illustrative Examples. In what follows, two illustrative examples for constructing root-locus plots will be presented. Although computer approaches to the construction of the root loci are easily available, here we shall use graphical computation, combined with inspection, to determine the root loci upon which the roots of the characteristic equation of the closed-loop system must lie. Such a graphical approach will enhance understanding of how the closed-loop poles move in the complex plane as the open- loop poles and zeros are moved.Although we employ only simple systems for illustrative purposes, the procedure for finding the root loci is no more complicated for higher- order systems. Because graphical measurements of angles and magnitudes are involved in the analy- sis, we find it necessary to use the same divisions on the abscissa as on the ordinate axis when sketching the root locus on graph paper.∑G(s)H(s)∑ =KB 1 A 1 A 2 A 3 A 4 / G(s)H(s) =f 1 -u 1 -u 2 -u 3 -u 4 Figure 6–2 (a) and (b) Diagrams showing angle measurements from open-loop poles and open-loop zero to test point s. Openmirrors.comSection 6–2 / Root-Locus Plots 273 R(s) C(s) K s(s+ 1) (s+ 2) +– Figure 6–3 Control system. EXAMPLE 6–1 Consider the negative feedback system shown in Figure 6–3. (We assume that the value of gain Kis nonnegative.) For this system, Let us sketch the root-locus plot and then determine the value of Ksuch that the damping ratio zof a pair of dominant complex-conjugate closed-loop poles is 0.5. For the given system, the angle condition becomes The magnitude condition is A typical procedure for sketching the root-locus plot is as follows: 1.Determine the root loci on the real axis. The first step in constructing a root-locus plot is to locate the open-loop poles, s=0, s=–1, ands=–2, in the complex plane. (There are no open- loop zeros in this system.) The locations of the open-loop poles are indicated by crosses. (The lo- cations of the open-loop zeros in this book will be indicated by small circles.) Note that the starting points of the root loci (the points corresponding to K=0 ) are open-loop poles. The number of individual root loci for this system is three, which is the same as the number of open-loop poles. To determine the root loci on the real axis, we select a test point, s.If the test point is on the positive real axis, then This shows that the angle condition cannot be satisfied. Hence, there is no root locus on the positive real axis. Next, select a test point on the negative real axis between 0 and –1.Then Thus and the angle condition is satisfied.Therefore, the portion of the negative real axis between 0 and –1forms a portion of the root locus. If a test point is selected between –1and–2,then and / s / s+1 / s+2 =-360° / s = / s+1 =180°, / s+2 =0°- / s / s+1 / s+2 =-180° / s =180°, / s+1 = / s+2 =0° / s = / s+1 = / s+2 =0°∑G(s)∑ = 2 K s(s+1)(s +2) 2 =1 =;180°(2k +1) (k=0, 1, 2, p) =- / s / s+1 / s+2 / G(s) = n K s(s+1)(s +2) G(s) =K s(s+1)(s +2), H(s) =1 Openmirrors.com274 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method It can be seen that the angle condition is not satisfied. Therefore, the negative real axis from –1 to–2is not a part of the root locus. Similarly, if a test point is located on the negative real axis from –2to–q, the angle condition is satisfied. Thus, root loci exist on the negative real axis between 0 and –1and between –2and–q. 2.Determine the asymptotes of the root loci. The asymptotes of the root loci as sapproaches infinity can be determined as follows: If a test point sis selected very far from the origin, then and the angle condition becomes or Since the angle repeats itself as kis varied, the distinct angles for the asymptotes are determined as 60°, –60°, and 180°. Thus, there are three asymptotes. The one having the angle of 180° is the negative real axis. Before we can draw these asymptotes in the complex plane, we must find the point where they intersect the real axis. Since if a test point is located very far from the origin, then G(s) may be written as For large values of s, this last equation may be approximated by (6–5) A root-locus diagram of G(s) given by Equation (6–5) consists of three straight lines.This can be seen as follows: The equation of the root locus is or which can be written as / s+1 =;60°(2k +1) -3 / s+1 =;180°(2k +1) n K (s+1) 3 =;180°(2k +1)G(s)/H11216K (s+1) 3 G(s) =K s 3 +3s 2 +pG(s) =K s(s+1)(s +2)Angles of asymptotes =;180°(2k +1) 3 (k=0, 1, 2, p)-3 / s =;180°(2k +1) (k=0, 1, 2, p)lim sSq G(s) =lim sSq K s(s+1)(s +2)=lim sSq K s 3 Openmirrors.comSection 6–2 / Root-Locus Plots 275jv sv= 0 –1 –j3j3 s + 1 – 3v=0 s + 1 + 3v=00 Figure 6–4 Three asymptotes.By substituting s=s+jvinto this last equation, we obtain or Taking the tangent of both sides of this last equation, which can be written as These three equations represent three straight lines, as shown in Figure 6–4.The three straight lines shown are the asymptotes. They meet at point s=–1. Thus, the abscissa of the intersection of the asymptotes and the real axis is obtained by setting the denominator of the right-hand side of Equation (6–5) equal to zero and solving for s.The asymptotes are almost parts of the root loci in regions very far from the origin. 3.Determine the breakaway point. To plot root loci accurately, we must find the breakaway point, where the root-locus branches originating from the poles at 0 and –1break away (as Kis increased) from the real axis and move into the complex plane.The breakaway point corresponds to a point in the splane where multiple roots of the characteristic equation occur. A simple method for finding the breakaway point is available. We shall present this method in the following: Let us write the characteristic equation as (6–6) f(s) =B(s) +KA(s) =0 s+1-v 13=0, s+1+v 13=0, v=0 v s+1=13, -13, 0 tan-1v s+1=60°, -60°, 0° /s+jv+1=;60°(2k +1)276 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method where A(s) andB(s) do not contain K. Note that f(s)=0 has multiple roots at points where This can be seen as follows: Suppose that f(s) has multiple roots of order r, where .Then f(s) may be written as Now we differentiate this equation with respect to sand evaluate df(s)/ds ats=s 1 .Then we get (6–7) This means that multiple roots of f(s) will satisfy Equation (6–7). From Equation (6–6), we obtain (6–8) where The particular value of Kthat will yield multiple roots of the characteristic equation is obtained from Equation (6–8) as If we substitute this value of Kinto Equation (6–6), we get or (6–9) If Equation (6–9) is solved for s, the points where multiple roots occur can be obtained. On the other hand, from Equation (6–6) we obtain and IfdK/dsis set equal to zero, we get the same equation as Equation (6–9). Therefore, the break- away points can be simply determined from the roots of It should be noted that not all the solutions of Equation (6–9) or of dK/ds=0 correspond to actual breakaway points. If a point at which dK/ds=0 is on a root locus, it is an actual breakaway or break-in point. Stated differently, if at a point at which dK/ds=0 the value of Ktakes a real positive value, then that point is an actual breakaway or break-in point.dK ds=0dK ds=-B¿(s)A(s) -B(s)A ¿(s) A 2 (s)K=-B(s) A(s)B(s)A ¿(s)-B¿(s)A(s) =0f(s) =B(s) -B¿(s) A¿(s)A(s) =0K=-B¿(s) A¿(s)A¿(s)=dA(s) ds, B¿(s)=dB(s) dsdf(s) ds=B¿(s)+KA¿(s)=0df(s) ds 2 s=s 1 =0f(s) =As-s 1 B r As-s 2 BpAs-s n Br/H113502df(s) ds=0 Openmirrors.comSection 6–2 / Root-Locus Plots 277For the present example, the characteristic equation G(s)+1=0 is given by or By setting dK/ds=0, we obtain or Since the breakaway point must lie on a root locus between 0 and –1,it is clear that s=–0.4226 corresponds to the actual breakaway point. Point s=–1.5774 is not on the root locus. Hence, this point is not an actual breakaway or break-in point. In fact, evaluation of the values of Kcorre- sponding to s=–0.4226 ands=–1.5774 yields 4.Determine the points where the root loci cross the imaginary axis. These points can be found by use of Routh’s stability criterion as follows: Since the characteristic equation for the present system is the Routh array becomes The value of Kthat makes the s1term in the first column equal zero is K=6. The crossing points on the imaginary axis can then be found by solving the auxiliary equation obtained from the s2 row; that is, which yields The frequencies at the crossing points on the imaginary axis are thus The gain value corresponding to the crossing points is K=6. An alternative approach is to let s=jvin the characteristic equation, equate both the real part and the imaginary part to zero, and then solve for vandK. For the present system, the char- acteristic equation, with s=jv,i s or Equating both the real and imaginary parts of this last equation to zero, respectively, we obtain K-3v2=0, 2v-v3=0AK-3v2B+jA2v-v3B=0(jv)3+3(jv)2+2(jv)+K=0v=;12 .s=;j123s2+K=3s2+6=0s3 s2 s1 s01 3 6-K 3 K2 Ks3+3s2+2s+K=0 K=-0.3849, for s=-1.5774 K=0.3849, for s=-0.4226s=-0.4226, s=-1.5774dK ds=-A3s2+6s+2B=0K=-As3+3s2+2sBK s(s+1)(s +2)+1=0278 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method jv j1 – j1 –1 –2s+ 1 s+ 2 u 2 u 1 u 3 0s s Figure 6–5 Construction of root locus. jv j1 – j1 1 –2 –30 s K= 6K= 6 K= 1.0383 K= 1.0383 K ` K` j2 – j260° –1 Figure 6–6 Root-locus plot.from which Thus, root loci cross the imaginary axis at and the value of Kat the crossing points is 6. Also, a root-locus branch on the real axis touches the imaginary axis at v=0 . The value of Kis zero at this point. 5.Choose a test point in the broad neighborhood of the jvaxis and the origin, as shown in Figure 6–5, and apply the angle condition. If a test point is on the root loci, then the sum of the three angles, u 1 +u 2 +u 3 , must be 180°. If the test point does not satisfy the angle condition, select another test point until it satisfies the condition. (The sum of the angles at the test point will indicate the direction in which the test point should be moved.) Continue this process and locate a sufficient number of points satisfying the angle condition. 6.Draw the root loci, based on the information obtained in the foregoing steps, as shown in Figure 6–6.v=;12 ,v=;12 , K=6 or v=0, K=0 Openmirrors.comSection 6–2 / Root-Locus Plots 2797.Determine a pair of dominant complex-conjugate closed-loop poles such that the damping ratiozis 0.5. Closed-loop poles with z=0.5 lie on lines passing through the origin and making the angles with the negative real axis. From Figure 6–6, such closed-loop poles having z=0.5 are obtained as follows: The value of Kthat yields such poles is found from the magnitude condition as follows: Using this value of K, the third pole is found at s=–2.3326. Note that, from step 4, it can be seen that for K=6 the dominant closed-loop poles lie on the imaginary axis at With this value of K, the system will exhibit sustained oscillations. For K>6, the dominant closed-loop poles lie in the right-half splane, resulting in an unstable system. Finally, note that, if necessary, the root loci can be easily graduated in terms of Kby use of the magnitude condition. We simply pick out a point on a root locus, measure the magnitudes of thethree complex quantities s, s+1, ands+2, and multiply these magnitudes; the product is equal to the gain value Kat that point, or Graduation of the root loci can be done easily by use of MATLAB. (See Section 6–3.) EXAMPLE 6–2 In this example, we shall sketch the root-locus plot of a system with complex-conjugate open- loop poles. Consider the negative feedback system shown in Figure 6–7. For this system, where K/H113500. It is seen that G(s) has a pair of complex-conjugate poles at A typical procedure for sketching the root-locus plot is as follows: 1.Determine the root loci on the real axis. For any test point son the real axis, the sum of the angular contributions of the complex-conjugate poles is 360°, as shown in Figure 6–8.Thus the neteffect of the complex-conjugate poles is zero on the real axis.The location of the root locus on the real axis is determined from the open-loop zero on the negative real axis.A simple test reveals that a section of the negative real axis, that between –2and–q, is a part of the root locus. It is noted that, since this locus lies between two zeros (at s=–2 and s=– q), it is actually a part of two root loci, each of which starts from one of the two complex-conjugate poles. In other words, tworoot loci break in the part of the negative real axis between –2and–q.s=-1+j12 , s=-1-j12G(s) =K(s +2) s2+2s+3, H(s) =1∑s∑/H11554∑s+1∑/H11554∑s+2∑=Ks=;j12 . =1.0383 K=∑s(s +1)(s +2)∑s=-0.3337 +j0.5780s1=-0.3337 +j0.5780, s2=-0.3337 -j0.5780;cos-1z=;cos-10.5=;60° R(s) C(s) K(s+ 2) s2+ 2s+ 3+– Figure 6–7 Control system.280 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method jv 0 s u9 2 s –p 2 f 1 f9 1 –z 1 –p 1 u 2 u 1 Figure 6–9 Determination of the angle of departure.Since there are two open-loop poles and one zero, there is one asymptote, which coincides with the negative real axis. 2.Determine the angle of departure from the complex-conjugate open-loop poles. The pres- ence of a pair of complex-conjugate open-loop poles requires the determination of the angle of departure from these poles. Knowledge of this angle is important, since the root locus near a com- plex pole yields information as to whether the locus originating from the complex pole migrates toward the real axis or extends toward the asymptote. Referring to Figure 6–9, if we choose a test point and move it in the very vicinity of the com- plex open-loop pole at s=–p 1 ,we find that the sum of the angular contributions from the pole ats=p 2 and zero at s=–z 1 to the test point can be considered remaining the same. If the test point is to be on the root locus, then the sum of –u 1 , and must be where k=0 ,1 ,2 , p. Thus, in the example, or The angle of departure is then u 1 =180°-u 2 +f 1 =180°-90°+55°=145°u 1 =180°-u œ 2 +f œ 1 =180°-u 2 +f 1 f œ 1 -Au 1 +u œ 2 B=;180°(2k +1);180°(2k +1), -u œ 2 f œ 1 , jv –10 –2 s j2 –j2 Test pointu 2 u 1 Figure 6–8 Determination of the root locus on the real axis. Openmirrors.comSection 6–2 / Root-Locus Plots 281jv j1 – j11 –2 –3 –4 0 sz= 0.7 line j2 – j2145° –1 Figure 6–10 Root-locus plot.Since the root locus is symmetric about the real axis, the angle of departure from the pole at s=–p2is–145°. 3.Determine the break-in point. A break-in point exists where a pair of root-locus branches coalesces as Kis increased. For this problem, the break-in point can be found as follows: Since we have which gives or Notice that point s=–3.7320 is on the root locus. Hence this point is an actual break-in point. (Note that at point s=–3.7320 the corresponding gain value is K=5.4641. ) Since point s=–0.2680 is not on the root locus, it cannot be a break-in point. (For point s=–0.2680, the cor- responding gain value is K=–1.4641. ) 4.Sketch a root-locus plot, based on the information obtained in the foregoing steps .T o determine accurate root loci, several points must be found by trial and error between the break- in point and the complex open-loop poles. (To facilitate sketching the root-locus plot, we should find the direction in which the test point should be moved by mentally summing up the changeson the angles of the poles and zeros.) Figure 6–10 shows a complete root-locus plot for the systemconsidered.s=-3.7320 or s=-0.2680s2+4s+1=0dK ds=-(2s+2)(s +2)-As2+2s+3B (s+2)2=0K=-s2+2s+3 s+2282 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method The value of the gain Kat any point on root locus can be found by applying the magnitude condition or by use of MATLAB (see Section 6–3). For example, the value of Kat which the complex-conjugate closed-loop poles have the damping ratio z=0.7 can be found by locating the roots, as shown in Figure 6–10, and computing the value of Kas follows: Or use MATLAB to find the value of K. (See Section 6–4.) It is noted that in this system the root locus in the complex plane is a part of a circle. Such a circular root locus will not occur in most systems. Circular root loci may occur in systems that in- volve two poles and one zero, two poles and two zeros, or one pole and two zeros. Even in such systems, whether circular root loci occur depends on the locations of poles and zeros involved. To show the occurrence of a circular root locus in the present system, we need to derive the equation for the root locus. For the present system, the angle condition is Ifs=s+jvis substituted into this last equation, we obtain which can be written as or Taking tangents of both sides of this last equation using the relationship (6–10) we obtain or which can be simplified to or This last equation is equivalent to or (s+2) 2 +v 2 =A13 B 2 v=0vC(s+2) 2 +v 2 -3D=02v(s+1) (s+1) 2 -Av 2 -2B=v s+2v-12 s+1+v+12 s+1 1- a v-12 s+1 ba v+12 s+1 b =v s+2;0 1<v s+2*0tan c tan -1 a v-12 s+1 b +tan -1 a v+12 s+1 b d =tan c tan -1 a v s+2 b ;180°(2k +1) d tan (x;y)=tanx;tany 1<tanxtanytan -1 a v-12 s+1 b +tan -1 a v+12 s+1 b =tan -1 a v s+2 b ;180°(2k +1)tan -1 a v s+2 b -tan -1 a v-12 s+1 b -tan -1 a v+12 s+1 b =;180°(2k +1) / s+2+jv / s+1+jv-j12 / s+1+jv+j12 =;180°(2k +1) / s+2 / s+1-j12 / s+1+j12 =;180°(2k +1)K= 2 As+1-j12 BAs+1+j12 B s+2 2 s=-1.67+j1.70 =1.34 Openmirrors.comSection 6–2 / Root-Locus Plots 283These two equations are the equations for the root loci for the present system. Notice that the first equation, v=0, is the equation for the real axis. The real axis from s=–2 tos=– qcorre- sponds to a root locus for K/H113500. The remaining part of the real axis corresponds to a root locus when Kis negative. (In the present system, Kis nonnegative.) (Note that K< 0 corresponds to the positive-feedback case.) The second equation for the root locus is an equation of a circle withcenter at s=–2, v=0 and the radius equal to That part of the circle to the left of the complex-conjugate poles corresponds to a root locus for K/H113500. The remaining part of the circle corresponds to a root locus when Kis negative. It is important to note that easily interpretable equations for the root locus can be derived for simple systems only. For complicated systems having many poles and zeros, any attempt to deriveequations for the root loci is discouraged. Such derived equations are very complicated and theirconfiguration in the complex plane is difficult to visualize. General Rules for Constructing Root Loci. For a complicated system with many open-loop poles and zeros, constructing a root-locus plot may seem complicated, butactually it is not difficult if the rules for constructing the root loci are applied. By locat-ing particular points and asymptotes and by computing angles of departure from com-plex poles and angles of arrival at complex zeros, we can construct the general form ofthe root loci without difficulty. We shall now summarize the general rules and procedure for constructing the root loci of the negative feedback control system shown in Figure 6–11. First, obtain the characteristic equation Then rearrange this equation so that the parameter of interest appears as the multiply- ing factor in the form (6–11) In the present discussions, we assume that the parameter of interest is the gain K, where K>0. (IfK<0, which corresponds to the positive-feedback case, the angle condi- tion must be modified. See Section 6–4.) Note, however, that the method is still appli-cable to systems with parameters of interest other than gain. (See Section 6–6.) 1.Locate the poles and zeros of G(s)H(s) on the splane.The root-locus branches start from open-loop poles and terminate at zeros (finite zeros or zeros at infinity). From the factored form of the open-loop transfer function, locate the open-loop poles and zerosin the splane.CNote that the open-loop zeros are the zeros of G(s)H(s), while the closed-loop zeros consist of the zeros of G(s) and the poles of H(s) .D1+KAs+z 1BAs+z2BpAs+zmB As+p1BAs+p2BpAs+pnB=01+G(s)H(s) =013. H(s)G(s)C(s) R(s) +– Figure 6–11 Control system.284 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method Note that the root loci are symmetrical about the real axis of the splane, because the complex poles and complex zeros occur only in conjugate pairs. A root-locus plot will have just as many branches as there are roots of the character- istic equation. Since the number of open-loop poles generally exceeds that of zeros, the number of branches equals that of poles. If the number of closed-loop poles is the same as the number of open-loop poles, then the number of individual root-locus branches terminating at finite open-loop zeros is equal to the number mof the open-loop zeros. The remaining n-m branches terminate at infinity ( n-m implicit zeros at infinity) along asymptotes. If we include poles and zeros at infinity, the number of open-loop poles is equal to that of open-loop zeros. Hence we can always state that the root loci start at the poles of G(s)H(s) and end at the zeros of G(s)H(s), asKincreases from zero to in- finity, where the poles and zeros include both those in the finite splane and those at infinity. 2.Determine the root loci on the real axis. Root loci on the real axis are determined by open-loop poles and zeros lying on it. The complex-conjugate poles and complex- conjugate zeros of the open-loop transfer function have no effect on the location of the root loci on the real axis because the angle contribution of a pair of complex-conjugate poles or complex-conjugate zeros is 360° on the real axis. Each portion of the root locus on the real axis extends over a range from a pole or zero to another pole or zero. In constructing the root loci on the real axis, choose a test point on it. If the total num- ber of real poles and real zeros to the right of this test point is odd, then this point lies on a root locus. If the open-loop poles and open-loop zeros are simple poles and sim- ple zeros, then the root locus and its complement form alternate segments along the real axis. 3.Determine the asymptotes of root loci. If the test point sis located far from the ori- gin, then the angle of each complex quantity may be considered the same. One open-loop zero and one open-loop pole then cancel the effects of the other. Therefore, the root loci for very large values of smust be asymptotic to straight lines whose angles (slopes) are given by where number of finite poles of G(s)H(s) number of finite zeros of G(s)H(s) Here, k=0 corresponds to the asymptotes with the smallest angle with the real axis.Al- though kassumes an infinite number of values, as kis increased the angle repeats itself, and the number of distinct asymptotes is n-m. All the asymptotes intersect at a point on the real axis. The point at which they do so is obtained as follows: If both the numerator and denominator of the open-loop trans- fer function are expanded, the result is G(s)H(s) =KCs m +Az 1 +z 2 +p+z m Bs m-1 +p+z 1 z 2 pz m D s n +Ap 1 +p 2 +p+p n Bs n-1 +p+p 1 p 2 pp n m= n=Angles of asymptotes =;180°(2k +1) n-m (k=0, 1, 2, p) Openmirrors.comSection 6–2 / Root-Locus Plots 285If a test point is located very far from the origin, then by dividing the denominator by the numerator, it is possible to write G(s)H(s) as or (6–12) The abscissa of the intersection of the asymptotes and the real axis is then obtained by setting the denominator of the right-hand side of Equation (6–12) equal to zero andsolving for s,or (6–13) [Example 6–1 shows why Equation (6–13) gives the intersection.] Once this intersection is determined, the asymptotes can be readily drawn in the complex plane. It is important to note that the asymptotes show the behavior of the root loci for A root-locus branch may lie on one side of the corresponding asymptote or may cross the corresponding asymptote from one side to the other side. 4.Find the breakaway and break-in points. Because of the conjugate symmetry of the root loci, the breakaway points and break-in points either lie on the real axis oroccur in complex-conjugate pairs. If a root locus lies between two adjacent open-loop poles on the real axis, then there exists at least one breakaway point between the two poles. Similarly, if the root locus liesbetween two adjacent zeros (one zero may be located at –q) on the real axis, then there always exists at least one break-in point between the two zeros. If the root locus lies be-tween an open-loop pole and a zero (finite or infinite) on the real axis, then there mayexist no breakaway or break-in points or there may exist both breakaway and break-inpoints. Suppose that the characteristic equation is given by The breakaway points and break-in points correspond to multiple roots of the charac- teristic equation. Hence, as discussed in Example 6–1, the breakaway and break-in pointscan be determined from the roots of (6–14) where the prime indicates differentiation with respect to s. It is important to note that the breakaway points and break-in points must be the roots of Equation (6–14), but notall roots of Equation (6–14) are breakaway or break-in points. If a real root of Equation(6–14) lies on the root-locus portion of the real axis, then it is an actual breakaway orbreak-in point. If a real root of Equation (6–14) is not on the root-locus portion of thereal axis, then this root corresponds to neither a breakaway point nor a break-in point.dK ds=-B¿(s)A(s) -B(s)A ¿(s) A2(s)=0B(s) +KA(s) =0∑s∑/H112711.s=-Ap1+p2+p+pnB-Az1+z2+p+zmB n-mG(s)H(s) =K cs+Ap1+p2+p+pnB-Az1+z2+p+zmB n-mdn-mG(s)H(s) =K sn-m+CAp1+p2+p+pnB-Az1+z2+p+zmBDsn-m-1+p286 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method jv s Angle of departure u 2 u 1 f 0 Figure 6–12 Construction of the root locus. [Angle of departure =180° - ( u 1 +u 2 ) +f.] If two roots s=s 1 ands=–s 1 of Equation (6–14) are a complex-conjugate pair and if it is not certain whether they are on root loci, then it is necessary to check the corre- sponding Kvalue. If the value of Kcorresponding to a root s=s 1 of is pos- itive, point s=s 1 is an actual breakaway or break-in point. (Since Kis assumed to be nonnegative, if the value of Kthus obtained is negative, or a complex quantity, then point s=s 1 is neither a breakaway nor a break-in point.) 5.Determine the angle of departure (angle of arrival) of the root locus from a com- plex pole (at a complex zero). To sketch the root loci with reasonable accuracy, we must find the directions of the root loci near the complex poles and zeros. If a test point is cho- sen and moved in the very vicinity of a complex pole (or complex zero), the sum of the angular contributions from all other poles and zeros can be considered to remain the same. Therefore, the angle of departure (or angle of arrival) of the root locus from a complex pole (or at a complex zero) can be found by subtracting from 180° the sum of all the angles of vectors from all other poles and zeros to the complex pole (or complex zero) in question, with appropriate signs included. Angle of departure from a complex pole =180° –(sum of the angles of vectors to a complex pole in question from other poles) ±(sum of the angles of vectors to a complex pole in question from zeros) Angle of arrival at a complex zero =180° –(sum of the angles of vectors to a complex zero in question from other zeros) ±(sum of the angles of vectors to a complex zero in question from poles) The angle of departure is shown in Figure 6–12. 6.Find the points where the root loci may cross the imaginary axis. The points where the root loci intersect the jvaxis can be found easily by (a) use of Routh’s stability cri- terion or (b) letting s=jvin the characteristic equation, equating both the real part and the imaginary part to zero, and solving for vandK.The values of vthus found give the frequencies at which root loci cross the imaginary axis. The Kvalue corresponding to each crossing frequency gives the gain at the crossing point. 7.Taking a series of test points in the broad neighborhood of the origin of the splane, sketch the root loci. Determine the root loci in the broad neighborhood of the jvaxis and the origin. The most important part of the root loci is on neither the real axis nor the asymptotes but is in the broad neighborhood of the jvaxis and the origin.The shapedK /H20862ds=0 Openmirrors.comSection 6–2 / Root-Locus Plots 287of the root loci in this important region in the splane must be obtained with reasonable accuracy. (If accurate shape of the root loci is needed, MATLAB may be used rather thanhand calculations of the exact shape of the root loci.) 8.Determine closed-loop poles. A particular point on each root-locus branch will be a closed-loop pole if the value of Kat that point satisfies the magnitude condition. Con- versely, the magnitude condition enables us to determine the value of the gain Kat any specific root location on the locus. (If necessary, the root loci may be graduated in termsofK. The root loci are continuous with K.) The value of Kcorresponding to any point son a root locus can be obtained using the magnitude condition, or This value can be evaluated either graphically or analytically. (MATLAB can be used for graduating the root loci with K. See Section 6–3.) If the gain Kof the open-loop transfer function is given in the problem, then by ap- plying the magnitude condition, we can find the correct locations of the closed-looppoles for a given Kon each branch of the root loci by a trial-and-error approach or by use of MATLAB, which will be presented in Section 6–3. Comments on the Root-Locus Plots. It is noted that the characteristic equa- tion of the negative feedback control system whose open-loop transfer function is is an nth-degree algebraic equation in s. If the order of the numerator of G(s)H(s) is lower than that of the denominator by two or more (which means that there are two ormore zeros at infinity), then the coefficient a 1is the negative sum of the roots of the equation and is independent of K. In such a case, if some of the roots move on the locus toward the left as Kis increased, then the other roots must move toward the right as K is increased. This information is helpful in finding the general shape of the root loci. It is also noted that a slight change in the pole–zero configuration may cause signif- icant changes in the root-locus configurations. Figure 6–13 demonstrates the fact that aslight change in the location of a zero or pole will make the root-locus configurationlook quite different.G(s)H(s) =KAs m+b1 sm-1+p+bmB sn+a1 sn-1+p+an (n/H11350m)K=product of lengths between point s to poles product of lengths between point s to zeros jv sjv s Figure 6–13 Root-locus plots.288 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method C(s) R(s) (a)1 s K (s+ 1) (s+ 2) C(s) R(s) (c)1 s+ 1 K s(s+ 1) (s+ 2) K s(s+ 2) s+ 1 H(s) C(s) R(s) (b) +– +– +– G(s) +– Figure 6–14 (a) Control system with velocity feedback; (b) and (c) modified block diagrams. Cancellation of Poles of G(s) with Zeros of H(s).It is important to note that if the denominator of G(s) and the numerator of H(s) involve common factors, then the corresponding open-loop poles and zeros will cancel each other, reducing the degree of the characteristic equation by one or more. For example, consider the system shown in Figure 6–14(a). (This system has velocity feedback.) By modifying the block diagram of Figure 6–14(a) to that shown in Figure 6–14(b), it is clearly seen that G(s) and H(s) have a common factor s+1. The closed-loop transfer function C(s)/R(s) is The characteristic equation is Because of the cancellation of the terms (s+1) appearing in G(s) andH(s), however, we have The reduced characteristic equation is The root-locus plot of G(s)H(s) does not show all the roots of the characteristic equa- tion, only the roots of the reduced equation. To obtain the complete set of closed-loop poles, we must add the canceled pole of G(s)H(s) to those closed-loop poles obtained from the root-locus plot of G(s)H(s). The important thing to remember is that the canceled pole of G(s)H(s) is a closed-loop pole of the system, as seen from Figure 6–14(c).s(s+2)+K=0 =s(s+2)+K s(s+2) 1+G(s)H(s) =1+K(s +1) s(s+1)(s +2)Cs(s+2)+KD(s+1)=0C(s) R(s)=K s(s+1)(s +2)+K(s +1) Openmirrors.comSection 6–2 / Root-Locus Plots 289Typical Pole–Zero Configurations and Corresponding Root Loci. In summa- rizing, we show several open-loop pole–zero configurations and their correspondingroot loci in Table 6–1. The pattern of the root loci depends only on the relative separa-tion of the open-loop poles and zeros. If the number of open-loop poles exceeds thenumber of finite zeros by three or more, there is a value of the gain Kbeyond which root loci enter the right-half splane, and thus the system can become unstable.A stable sys- tem must have all its closed-loop poles in the left-half splane. Table 6–1 Open-Loop Pole–Zero Configurations and the Corresponding Root Loci jv sjv sjv s jv sjv sjv s jv sjv sjv s jv sjv sjv s290 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method Note that once we have some experience with the method, we can easily evaluate the changes in the root loci due to the changes in the number and location of the open-loop poles and zeros by visualizing the root-locus plots resulting from various pole–zero configurations. Summary. From the preceding discussions, it should be clear that it is possible to sketch a reasonably accurate root-locus diagram for a given system by following simple rules. (The reader should study the various root-locus diagrams shown in the solved problems at the end of the chapter.) At preliminary design stages, we may not need the precise locations of the closed-loop poles. Often their approximate locations are all that is needed to make an estimate of system performance. Thus, it is important that the designer have the capability of quickly sketching the root loci for a given system. 6–3 PLOTTING ROOT LOCI WITH MATLAB In this section we present the MATLAB approach to the generation of root-locus plots and finding relevant information from the root-locus plots. Plotting Root Loci with MATLAB. In plotting root loci with MATLAB we deal with the system equation given in the form of Equation (6–11), which may be written as where num is the numerator polynomial and den is the denominator polynomial. That is, Note that both vectors num and den must be written in descending powers of s. A MATLAB command commonly used for plotting root loci is rlocus(num,den) Using this command, the root-locus plot is drawn on the screen.The gain vector Kis au- tomatically determined. (The vector Kcontains all the gain values for which the closed- loop poles are to be computed.) For the systems defined in state space, rlocus(A,B,C,D) plots the root locus of the system with the gain vector automatically determined. Note that commands rlocus(num,den,K) and rlocus(A,B,C,D,K) use the user-supplied gain vector K. =s n +Ap 1 +p 2 +p+p n Bs n-1 +p+p 1 p 2 p p n den =As+p 1 BAs+p 2 BpAs+p n B =s m +Az 1 +z 2 +p+z m Bs m-1 +p+z 1 z 2 p z m num =As+z 1 BAs+z 2 BpAs+z m B1+Knum den=0 Openmirrors.comSection 6–3 / Plotting Root Loci with MATLAB 291K(s+ 3) s(s+ 1)(s2+ 4s+ 16)+– Figure 6–15 Control system.If it is desired to plot the root loci with marks 'o'or'x', it is necessary to use the fol- lowing command: r = rlocus(num,den) plot(r,'o') or plot(r,'x') Plotting root loci using marks oorxis instructive, since each calculated closed-loop pole is graphically shown; in some portion of the root loci those marks are densely placed andin another portion of the root loci they are sparsely placed. MATLAB supplies its own setof gain values used to calculate a root-locus plot. It does so by an internal adaptive step-size routine.Also, MATLAB uses the automatic axis-scaling feature of the plotcommand. EXAMPLE 6–3 Consider the system shown in Figure 6–15. Plot root loci with a square aspect ratio so that a line with slope 1 is a true 45° line. Choose the region of root-locus plot to be where xandyare the real-axis coordinate and imaginary-axis coordinate, respectively. To set the given plot region on the screen to be square, enter the command v = [-6 6 -6 6]; axis (v); axis('square') With this command, the region of the plot is as specified and a line with slope 1 is at a true 45°,not skewed by the irregular shape of the screen. For this problem, the denominator is given as a product of first- and second-order terms. So we must multiply these terms to get a polynomial in s.The multiplication of these terms can be done easily by use of the convolution command, as shown next. Define a = s (s + 1): a = [1 1 0] b = s2+ 4s + 16: b = [1 4 16] Then we use the following command: c = conv(a, b) Note that conv(a, b) gives the product of two polynomials aandb. See the following computer output:-6/H11349x/H113496, -6/H11349y/H113496 a = [1 1 0]; b = [1 4 16];c = conv (a,b) c = 1 5 20 16 0 The denominator polynomial is thus found to be den = [1 5 20 16 0]292 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method 0 −2 Real Axis Imag Axis 6 4 2 −4 −60 −26 4 2 −4 −6Root-Locus Plot of G(s) = K(s+ 3)/[s(s+ 1)(s 2 + 4s + 16)] Figure 6–16 Root-locus plot. MATLAB Program 6–1 % --------- Root-locus plot --------- num = [1 3]; den = [1 5 20 16 0]; rlocus(num,den) v = [-6 6 -6 6]; axis(v); axis('square') grid; title ('Root-Locus Plot of G(s) = K(s + 3)/[s(s + 1)(s^2 + 4s + 16)]') To find the complex-conjugate open-loop poles (the roots of s 2 +4s+16=0 ), we may enter theroots command as follows: Note that in MATLAB Program 6–1, instead of den = [1 5 20 16 0] we may enter den = conv ([1 1 0], [1 4 16]) The results are the same. r = roots(b) r = –2.0000 + 3.464li –2.0000 - 3.464li Thus, the system has the following open-loop zero and open-loop poles: Open-loop zero: s=–3 Open-loop poles: s=0, s=–1, s=–2 ;j3.4641 MATLAB Program 6–1 will plot the root-locus diagram for this system. The plot is shown in Figure 6–16. Openmirrors.comSection 6–3 / Plotting Root Loci with MATLAB 293EXAMPLE 6–4 Consider the negative feedback system whose open-loop transfer function G(s)H(s) is There are no open-loop zeros. Open-loop poles are located at s=–0.3+j3.1480, s=–0.3-j3.1480, s=–0.5, ands=0. Entering MATLAB Program 6–2 into the computer, we obtain the root-locus plot shown in Figure 6–17. =K s4+1.1s3+10.3s2+5s G(s)H(s) =K s(s+0.5)As2+0.6s +10B MATLAB Program 6–2 % --------- Root-locus plot ---------num = [1]; den = [1 1.1 10.3 5 0];r = rlocus(num,den);plot(r,'o')v = [-6 6 -6 6]; axis(v)gridtitle('Root-Locus Plot of G(s) = K/[s(s + 0.5)(s^2 + 0.6s + 10)]')xlabel('Real Axis')ylabel('Imag Axis') Real Axis–6 –4 6 4 2 –2 0Imag Axis6 –24 –62 0 –4Root-Locus Plot of G(s)=K/[s(s+0.5)( s2+0.6s+10)] Figure 6–17 Root-locus plot.Notice that in the regions near x=–0.3, y=2.3 andx=–0.3, y=–2.3 two loci approach each other. We may wonder if these two branches should touch or not. To explore this situation,we may plot the root loci using smaller increments of Kin the critical region.294 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method Real Axis–4 –2 –3 4 2 1 3 –1 0 Imag Axis 4 –1 3 –3 –4 2 0 1 –2 Root-Locus Plot of G(s)= K/[s(s+0.5)( s 2 +0.6s+10)] Figure 6–18 Root-locus plot. MATLAB Program 6–3 % --------- Root-locus plot --------- num = [1]; den = [1 1.1 10.3 5 0]; K1 = 0:0.2:20; K2 = 20:0.1:30; K3 = 30:5:1000; K = [K1 K2 K3]; r = rlocus(num,den,K); plot(r, 'o') v = [-4 4 -4 4]; axis(v) grid title('Root-Locus Plot of G(s) = K/[s(s + 0.5)(s^2 + 0.6s + 10)]') xlabel('Real Axis') ylabel('Imag Axis') By a conventional trial-and-error approach or using the command rlocfind to be presented later in this section, we find the particular region of interest to be 20 /H11349K/H1134930. By entering MATLAB Program 6–3, we obtain the root-locus plot shown in Figure 6–18. From this plot, it is clear that the two branches that approach in the upper half-plane (or in the lower half-plane) do not touch. EXAMPLE 6–5 Consider the system shown in Figure 6–19. The system equations are u=r-y y=Cx+Du x#=Ax+Bu Openmirrors.comSection 6–3 / Plotting Root Loci with MATLAB 295ru By ACD xx• /H20848 +–++++ Figure 6–19 Closed-loop controlsystem. In this example problem we shall obtain the root-locus diagram of the system defined in state space. As an example let us consider the case where matrices A,B,C, and Dare (6–15) The root-locus plot for this system can be obtained with MATLAB by use of the following command: rlocus(A,B,C,D) This command will produce the same root-locus plot as can be obtained by use of the rlocus (num,den) command, where num and den are obtained from [num,den] = ss2tf(A,B,C,D) as follows: num = [0 0 1 0] den = [1 14 56 160] MATLAB Program 6–4 is a program that will generate the root-locus plot as shown in Figure 6–20. C=[1 0 0], D=[0] A=C0 0 -1601 0 -560 1 -14S, B=C0 1 -14S MATLAB Program 6–4 % --------- Root-locus plot ---------A = [0 1 0;0 0 1;-160 -56 -14]; B = [0;1;-14];C = [1 0 0];D = [0];K = 0:0.1:400;rlocus(A,B,C,D,K);v = [-20 20 -20 20]; axis(v)gridtitle('Root-Locus Plot of System Defined in State Space')296 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method 0jv jv v n v d f s 0 s0.2 0.20.5 0.50.7 0.70.8 0.8z = 0.9 z = 0.9 z = 0z /H11021 0 z /H11021 0z /H11091 1 (a) (b) Figure 6–21 (a) Complex poles; (b) lines of constant damping ratio z. Real Axis–20 –15 20 01 5 –10 –5 5 10 Imag Axis 20 –5 –20–1015 0 –15 10 5Root-Locus Plot of System Defined in State Space Figure 6–20 Root-locus plot of system defined in state space, where A, B,C, and Dare as given by Equation (6–15). Constant ZLoci and Constant V n Loci. Recall that in the complex plane the damping ratio zof a pair of complex-conjugate poles can be expressed in terms of the anglef, which is measured from the negative real axis, as shown in Figure 6–21(a) with In other words, lines of constant damping ratio zare radial lines passing through the origin as shown in Figure 6–21(b). For example, a damping ratio of 0.5 requires that the complex-conjugate poles lie on the lines drawn through the origin making angles of;60° with the negative real axis. (If the real part of a pair of complex-conjugate poles is positive, which means that the system is unstable, the corresponding zis negative.) The damping ratio determines the angular location of the poles, while thez=cosf Openmirrors.comSection 6–3 / Plotting Root Loci with MATLAB 297distance of the pole from the origin is determined by the undamped natural frequen- cy vn. The constant vnloci are circles. To draw constant zlines and constant vncircles on the root-locus diagram with MATLAB, use the command sgrid . Plotting Polar Grids in the Root-Locus Diagram. The command sgrid overlays lines of constant damping ratio ( z=0 ~ 1 with 0.1 increment) and circles of constant vnon the root-locus plot. See MATLAB Program 6–5 and the resulting diagram shown in Figure 6–22. MATLAB Program 6–5 sgrid v = [-3 3 -3 3]; axis(v); axis('square')title('Constant \zeta Lines and Constant \omega_n Circles')xlabel('Real Axis')ylabel('Imag Axis') If only particular constant zlines (such as the z=0.5 line and z=0.707 line) and particular constant vncircles (such as the vn=0.5 circle,vn=1 circle, and vn=2 cir- cle) are desired, use the following command: sgrid([0.5, 0.707], [0.5, 1, 2]) If we wish to overlay lines of constant zand circles of constant vnas given above to a root-locus plot of a negative feedback system with num = [0 0 0 1] den = [1 4 5 0] 3 2 1 0 −3 −2 −1013 2 −1 −3−2 Real AxisConstant z Lines and Constant vn CirclesImag Axis2 1 210.16 0.34 0.5 0.64 0.16 0.34 0.5 0.640.76 0.86 0.94 0.985 0.760.860.940.985 Figure 6–22 Constant zlines and constant vncircles.298 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method 0.5 0.707 0.50.707ω n = 1 ω n = 0.5 ω n = 2 −1−0.5 0 0.5 1 −1.5 −2 −2.5 −300.511.52 −0.5 −1 −1.5 −2 Real AxisRoot-Locus Plot with ζ = 0.5 and 0.707 Lines andω n = 0.5, 1, and 2 Circles Imag Axis 0.5 1 2 Figure 6–23 Constant zlines and constant v n circles superimposed on a root-locus plot. MATLAB Program 6–6 num = [1]; den = [1 4 5 0]; K = 0:0.01:1000; r = rlocus(num,den,K); plot(r,'-'); v = [-3 1 -2 2]; axis(v); axis('square') sgrid([0.5,0.707], [0.5,1,2]) grid title('Root-Locus Plot with \zeta = 0.5 and 0.707 Lines and \omega_n = 0.5,1, and 2 Circles') xlabel('Real Axis'); ylabel('Imag Axis') gtext('\omega_n = 2') gtext('\omega_n = 1') gtext('\omega_n = 0.5') % Place 'x' mark at each of 3 open-loop poles. gtext('x') gtext('x') gtext('x') then enter MATLAB Program 6–6 into the computer. The resulting root-locus plot is shown in Figure 6–23. If we want to omit either the entire constant zlines or entire constant v n circles, we may use empty brackets [ ] in the arguments of the sgrid command. For example, if we want to overlay only the constant damping ratio line corresponding to z=0.5 and no constant v n circles on the root-locus plot, then we may use the command sgrid(0.5, []) Openmirrors.comSection 6–3 / Plotting Root Loci with MATLAB 299Conditionally Stable Systems. Consider the negative feedback system shown in Figure 6–24.We can plot the root loci for this system by applying the general rules andprocedure for constructing root loci, or use MATLAB to get root-locus plots. MAT-LAB Program 6–7 will plot the root-locus diagram for the system. The plot is shown inFigure 6–25.R(s) C(s)K(s2+ 2s+4) s(s+ 4) (s+ 6)(s2+ 1.4s+ 1)+– Figure 6–24 Control system. MATLAB Program 6–7 num = [1 2 4]; den = conv(conv([1 4 0],[1 6]), [1 1.4 1]);rlocus(num, den)v = [-7 3 -5 5]; axis(v); axis('square')gridtitle('Root-Locus Plot of G(s) = K(s^2 + 2s + 4)/[s(s + 4)(s + 6)(s^2 + 1.4s + 1)]')text(1.0, 0.55,'K = 12')text(1.0,3.0,'K = 73')text(1.0,4.15,'K = 154') Real Axis−5−4−3−2−1 −6 −73 02 1Imag Axis −55 43 2 −3−2−1 −401Root-Locus Plot of G(s) = K(s 2+ 2s+ 4)/[ s(s + 4)( s + 6)( s2 + 1.4 s + 1)] K= 12K= 73K= 154 Figure 6–25 Root-locus plot ofconditionally stable system.It can be seen from the root-locus plot of Figure 6–25 that this system is stable only for limited ranges of the value of K—that is, 0<K<12 and73<K<154. The sys- tem becomes unstable for 12<K<73 and 154<K. (IfKassumes a value corre- sponding to unstable operation, the system may break down or may become nonlineardue to a saturation nonlinearity that may exist.) Such a system is called conditionallystable.300 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method In practice, conditionally stable systems are not desirable. Conditional stability is dangerous but does occur in certain systems—in particular, a system that has an unsta- ble feedforward path. Such an unstable feedforward path may occur if the system has a minor loop. It is advisable to avoid such conditional stability since, if the gain drops be- yond the critical value for any reason, the system becomes unstable. Note that the ad- dition of a proper compensating network will eliminate conditional stability. [An addition of a zero will cause the root loci to bend to the left. (See Section 6–5.) Hence condi- tional stability may be eliminated by adding proper compensation.] Nonminimum-Phase Systems. If all the poles and zeros of a system lie in the left- half splane, then the system is called minimum phase. If a system has at least one pole or zero in the right-half splane, then the system is called nonminimum phase. The term nonminimum phase comes from the phase-shift characteristics of such a system when subjected to sinusoidal inputs. Consider the system shown in Figure 6–26(a). For this system This is a nonminimum-phase system, since there is one zero in the right-half splane. For this system, the angle condition becomes or (6–16) The root loci can be obtained from Equation (6–16). Figure 6–26(b) shows a root-locus plot for this system. From the diagram, we see that the system is stable if the gain Kis less than 1/ T a . n KAT a s-1B s(Ts +1) =0°=;180°(2k+1) (k=0, 1, 2, p)= n KAT a s-1B s(Ts +1) +180° / G(s) = n -KAT a s-1B s(Ts +1) G(s) =KA1-T a sB s(Ts +1) AT a 70B, H(s) =1 (a) (b)R(s) C(s) jv K= 0 K= 0K=` K ` 1 T a K=1 T a K= 1 T a 1 T –sK(1–T a s) s(Ts+ 1) +– Figure 6–26 (a) Nonminimum- phase system; (b) root-locus plot. Openmirrors.comSection 6–3 / Plotting Root Loci with MATLAB 301To obtain a root-locus plot with MATLAB, enter the numerator and denominator as usual. For example, if T=1 sec and enter the following num andden in the program: num = [-0.5 1] den = [1 1 0] MATLAB Program 6–8 gives the plot of the root loci shown in Figure 6–27.Ta=0.5 sec, MATLAB Program 6–8 num = [-0.5 1]; den = [1 1 0];k1 = 0:0.01:30;k2 = 30:1:100;K3 = 100:5:500;K = [k1 k2 k3];rlocus(num,den,K)v = [-2 6 -4 4]; axis(v); axis('square')gridtitle('Root-Locus Plot of G(s) = K(1 - 0.5s)/[s(s + 1)]')% Place 'x' mark at each of 2 open-loop poles.% Place 'o' mark at open-loop zero.gtext('x')gtext('x')gtext('o')Root-Locus Plot of G(s) = K(1− 0.5s)/[s(s + 1)] Real AxisImag Axis1 −3 −4−2 −1 01234562 −1 −2034 Figure 6–27 Root-locus plot of G(s) =K(1 -0.5s) s(s+1). Orthogonality of Root Loci and Constant-Gain Loci. Consider the negative feedback system whose open-loop transfer function is G(s)H(s). In the G(s)H(s) plane, the loci of constant are circles centered at the origin, and the loci corre-sponding to ( k=0, 1, 2, p) lie on the negative real axis /G(s)H(s) =;180°(2k +1)∑G(s)H(s)∑ =302 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method of the G(s)H(s) plane, as shown in Figure 6–28. [Note that the complex plane employed here is not the splane, but the G(s)H(s) plane.] The root loci and constant-gain loci in the splane are conformal mappings of the loci of and of constant in the G(s)H(s) plane. Since the constant-phase and constant-gain loci in the G(s)H(s) plane are orthog- onal, the root loci and constant-gain loci in the splane are orthogonal. Figure 6–29(a) shows the root loci and constant-gain loci for the following system: G(s) =K(s +2) s 2 +2s+3, H(s) =1∑G(s)H(s)∑ = / G(s)H(s) =;180°(2k +1) ReIm 0G(s)H(s) Plane ReIm 0G(s)H(s) Plane |G(s)H(s)|= constantG(s)H(s) =/H11006180° (2k+ 1) Figure 6–28 Plots of constant- gain and constant- phase loci in the G(s)H(s) plane. (a) (b)sjv 0K= 6 K= 6j4j6 –j4K= 1 K= 2 K= 1–6 –42 4 6K= 10 K= 0.3 j2 –j2 –j6 K= 0.3K= 0.3 –2 sjv 0j2j3 –j2–3 –21 2j1 –j1 –j3–1 B CA Figure 6–29 Plots of root loci and constant-gain loci. (a) System with G(s)=K(s+2)/ As 2 +2s+3B, H(s)=1; (b) system with G(s)=K/Cs(s+1)(s+2)D,H(s)=1. Openmirrors.comSection 6–4 / Root-Locus Plots of Positive Feedback Systems 303Notice that since the pole–zero configuration is symmetrical about the real axis, the constant-gain loci are also symmetrical about the real axis. Figure 6–29(b) shows the root loci and constant-gain loci for the system: Notice that since the configuration of the poles in the splane is symmetrical about the real axis and the line parallel to the imaginary axis passing through point (s=–1, v=0), the constant-gain loci are symmetrical about the v=0 line (real axis) and the s=–1 line. From Figures 6–29(a) and (b), notice that every point in the splane has the corre- sponding Kvalue. If we use a command rlocfind (presented next), MATLAB will give theKvalue of the specified point as well as the nearest closed-loop poles corresponding to this Kvalue. Finding the Gain Value Kat an Arbitrary Point on the Root Loci. In MAT- LAB analysis of closed-loop systems, it is frequently desired to find the gain value Kat an arbitrary point on the root locus. This can be accomplished by using the followingrlocfind command: [K, r] = rlocfind(num, den) The rlocfind command, which must follow an rlocus command, overlays movable x-yco- ordinates on the screen. Using the mouse, we position the origin of the x-ycoordinates over the desired point on the root locus and press the mouse button. Then MATLABdisplays on the screen the coordinates of that point, the gain value at that point, and theclosed-loop poles corresponding to this gain value. If the selected point is not on the root locus, such as point A in Figure 6–29(a), the rlocfind command gives the coordinates of this selected point, the gain value of thispoint, such as K = 2, and the locations of the closed-loop poles, such as points B and C corresponding to this Kvalue. [Note that every point on the splane has a gain value. See, for example, Figures 6–29 (a) and (b).] 6–4 ROOT-LOCUS PLOTS OF POSITIVE FEEDBACK SYSTEMS Root Loci for Positive-Feedback Systems.* In a complex control system, there may be a positive-feedback inner loop as shown in Figure 6–30. Such a loop is usuallystabilized by the outer loop. In what follows, we shall be concerned only with the positive-feedback inner loop. The closed-loop transfer function of the inner loop is The characteristic equation is (6–17) 1-G(s)H(s) =0C(s) R(s)=G(s) 1-G(s)H(s)G(s) =K s(s+1)(s +2), H(s) =1 * Reference W-4304 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method C(s) G 1 (s) H 1 (s)R(s) H(s)G(s) +– ++ Figure 6–30 Control system. This equation can be solved in a manner similar to the development of the root-locus method for negative-feedback systems presented in Section 6–2. The angle condition, however, must be altered. Equation (6–17) can be rewritten as which is equivalent to the following two equations: For the positive-feedback case, the total sum of all angles from the open-loop poles and zeros must be equal to Thus the root locus follows a 0° locus in contrast to the 180° locus considered previously. The magnitude condition remains unaltered. To illustrate the root-locus plot for the positive-feedback system, we shall use the fol- lowing transfer functions G(s) andH(s) as an example. The gain Kis assumed to be positive. The general rules for constructing root loci for negative-feedback systems given in Section 6–2 must be modified in the following way: Rule 2 is Modified as Follows: If the total number of real poles and real zeros to the right of a test point on the real axis is even, then this test point lies on the root locus. Rule 3 is Modified as Follows: where number of finite poles of G(s)H(s) number of finite zeros of G(s)H(s) Rule 5 is Modified as Follows: When calculating the angle of departure (or angle of ar- rival) from a complex open-loop pole (or at a complex zero), subtract from 0° the sum of all angles of the vectors from all the other poles and zeros to the complex pole (or com- plex zero) in question, with appropriate signs included. m= n=Angles of asymptotes =;k360 ° n-m (k=0, 1, 2, p)G(s) =K(s +2) (s+3)As 2 +2s+2B , H(s) =10°;k360 °. ∑G(s)H(s)∑ =1 / G(s)H(s) =0°;k360 ° (k=0, 1, 2, p)G(s)H(s) =1 Openmirrors.comSection 6–4 / Root-Locus Plots of Positive Feedback Systems 305Other rules for constructing the root-locus plot remain the same.We shall now apply the modified rules to construct the root-locus plot. 1.Plot the open-loop poles (s=–1+j, s=–1-j, s=–3) and zero (s=–2) in the complex plane.As Kis increased from 0 to q, the closed-loop poles start at the open-loop poles and terminate at the open-loop zeros (finite or infinite), just as inthe case of negative-feedback systems. 2.Determine the root loci on the real axis. Root loci exist on the real axis between –2and±qand between –3and–q. 3.Determine the asymptotes of the root loci. For the present system, This simply means that asymptotes are on the real axis. 4.Determine the breakaway and break-in points. Since the characteristic equation is we obtain By differentiating Kwith respect to s,we obtain Note that Point s=–0.8 is on the root locus. Since this point lies between two zeros (a finite zero and an infinite zero), it is an actual break-in point. Points do not satisfy the angle condition and, therefore, they are neither breakaway norbreak-in points. 5.Find the angle of departure of the root locus from a complex pole. For the com- plex pole at s=–1+j, the angle of departure uis or(The angle of departure from the complex pole at s=–1-j is 72°.) 6.Choose a test point in the broad neighborhood of the jvaxis and the origin and apply the angle condition. Locate a sufficient number of points that satisfy theangle condition. Figure 6–31 shows the root loci for the given positive-feedback system.The root loci are shown with dashed lines and a curve. Note that if K7(s+3)As 2+2s+2B s+22 s=0=3u=-72°u=0°-27°-90°+45°s=-2.35 ;j0.77 =2(s+0.8)(s +2.35 +j0.77)(s +2.35 -j0.77) 2s3+11s2+20s +10=2(s+0.8)As2+4.7s +6.24BdK ds=2s3+11s2+20s +10 (s+2)2K=(s+3)As2+2s+2B s+2(s+3)As2+2s+2B-K(s +2)=0Angles of asymptote =;k360 ° 3-1=;180°306 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method –5 –4 –3 –2 –11 2 sjv 0j1j2 –j1 –j2 Figure 6–31 Root-locus plot for the positive-feedback system with G(s)=K(s+2)/ C(s+3)As 2 +2s+2BD, H(s)=1. one real root enters the right-half splane. Hence, for values of Kgreater than 3, the sys- tem becomes unstable. (For K>3, the system must be stabilized with an outer loop.) Note that the closed-loop transfer function for the positive-feedback system is given by To compare this root-locus plot with that of the corresponding negative-feedback sys- tem, we show in Figure 6–32 the root loci for the negative-feedback system whose closed- loop transfer function is Table 6–2 shows various root-locus plots of negative-feedback and positive-feedback systems. The closed-loop transfer functions are given by for negative-feedback systems for positive-feedback systemsC R=G 1-GH,C R=G 1+GH,C(s) R(s)=K(s +2) (s+3)As 2 +2s+2B+K(s +2) =K(s +2) (s+3)As 2 +2s+2B-K(s +2) C(s) R(s)=G(s) 1-G(s)H(s) –5 –4 –3 –2 –11 2 sjv 0j1j2 j3 –j1 –j3–j2 Figure 6–32 Root-locus plot for the negative-feedback system with G(s)=K(s+2)/ C(s+3)As 2 +2s+2BD, H(s)=1. Openmirrors.comSection 6–4 / Root-Locus Plots of Positive Feedback Systems 307 where GH is the open-loop transfer function. In Table 6–2, the root loci for negative- feedback systems are drawn with heavy lines and curves, and those for positive-feedback systems are drawn with dashed lines and curves. jv sjv s jv sjv s jv sjv s jv sjv s jv sjv s Table 6–2 Root-Locus Plots of Negative-Feedback and Positive- Feedback Systems Heavy lines and curves correspond to negative-feedback systems; dashed lines and curves correspond to positive-feedback systems. Openmirrors.com308 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method 6–5 ROOT-LOCUS APPROACH TO CONTROL-SYSTEMS DESIGN Preliminary Design Consideration. In building a control system, we know that proper modification of the plant dynamics may be a simple way to meet the performance specifications.This, however, may not be possible in many practical situations because the plant may be fixed and not modifiable.Then we must adjust parameters other than those in the fixed plant. In this book, we assume that the plant is given and unalterable. In practice, the root-locus plot of a system may indicate that the desired performance cannot be achieved just by the adjustment of gain (or some other adjustable parameter). In fact, in some cases, the system may not be stable for all values of gain (or other ad- justable parameter). Then it is necessary to reshape the root loci to meet the perform- ance specifications. The design problems, therefore, become those of improving system performance by insertion of a compensator. Compensation of a control system is reduced to the design of a filter whose characteristics tend to compensate for the undesirable and unalterable characteristics of the plant. Design by Root-Locus Method. The design by the root-locus method is based on re- shaping the root locus of the system by adding poles and zeros to the system’s open-loop transfer function and forcing the root loci to pass through desired closed-loop poles in the splane.The characteristic of the root-locus design is its being based on the assumption that the closed-loop system has a pair of dominant closed-loop poles.This means that the effects of zeros and additional poles do not affect the response characteristics very much. In designing a control system, if other than a gain adjustment (or other parameter adjustment) is required, we must modify the original root loci by inserting a suitable com- pensator. Once the effects on the root locus of the addition of poles and/or zeros are fully understood, we can readily determine the locations of the pole(s) and zero(s) of the com- pensator that will reshape the root locus as desired. In essence, in the design by the root- locus method, the root loci of the system are reshaped through the use of a compensator so that a pair of dominant closed-loop poles can be placed at the desired location. Series Compensation and Parallel (or Feedback) Compensation. Figures 6–33(a) and (b) show compensation schemes commonly used for feedback control sys- tems. Figure 6–33(a) shows the configuration where the compensator G c (s)is placed in series with the plant. This scheme is called series compensation. An alternative to series compensation is to feed back the signal(s) from some ele- ment(s) and place a compensator in the resulting inner feedback path, as shown in Figure 6–33(b). Such compensation is called parallel compensation orfeedback compensation . In compensating control systems, we see that the problem usually boils down to a suitable design of a series or parallel compensator. The choice between series compen- sation and parallel compensation depends on the nature of the signals in the system, the power levels at various points, available components, the designer’s experience, eco- nomic considerations, and so on. In general, series compensation may be simpler than parallel compensation; however, series compensation frequently requires additional amplifiers to increase the gain and/or to provide isolation. (To avoid power dissipation, the series compensator is inserted at the lowest energy point in the feedforward path.) Note that, in general, the number of com- ponents required in parallel compensation will be less than the number of components Openmirrors.comSection 6–5 / Root-Locus Approach to Control Systems Design 309G1(s) G2(s) H(s)Gc(s) (b)+–+–Gc(s) G(s) H(s) (a)+– Figure 6–33 (a) Seriescompensation;(b) parallel or feed-back compensation. in series compensation, provided a suitable signal is available, because the energy trans- fer is from a higher power level to a lower level. (This means that additional amplifiersmay not be necessary.) In Sections 6–6 through 6–9 we first discuss series compensation techniques and then present a parallel compensation technique using a design of a velocity-feedback controlsystem. Commonly Used Compensators. If a compensator is needed to meet the per- formance specifications, the designer must realize a physical device that has the pre-scribed transfer function of the compensator. Numerous physical devices have been used for such purposes. In fact, many noble and useful ideas for physically constructing compensators may be found in the literature. If a sinusoidal input is applied to the input of a network, and the steady-state output (which is also sinusoidal) has a phase lead, then the network is called a lead network.(The amount of phase lead angle is a function of the input frequency.) If the steady-stateoutput has a phase lag, then the network is called a lag network. In a lag–lead network,both phase lag and phase lead occur in the output but in different frequency regions;phase lag occurs in the low-frequency region and phase lead occurs in the high-frequencyregion.A compensator having a characteristic of a lead network, lag network, or lag–leadnetwork is called a lead compensator, lag compensator, or lag–lead compensator. Among the many kinds of compensators, widely employed compensators are the lead compensators, lag compensators, lag–lead compensators, and velocity-feedback(tachometer) compensators. In this chapter we shall limit our discussions mostly to thesetypes. Lead, lag, and lag–lead compensators may be electronic devices (such as circuitsusing operational amplifiers) or RC networks (electrical, mechanical, pneumatic, hydraulic, or combinations thereof) and amplifiers. Frequently used series compensators in control systems are lead, lag, and lag–lead compensators. PID controllers which are frequently used in industrial control systemsare discussed in Chapter 8.310 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method It is noted that in designing control systems by the root-locus or frequency-response methods the final result is not unique, because the best or optimal solution may not be pre- cisely defined if the time-domain specifications or frequency-domain specifications are given. Effects of the Addition of Poles. The addition of a pole to the open-loop transfer function has the effect of pulling the root locus to the right, tending to lower the system’s relative stability and to slow down the settling of the response. (Remember that the ad- dition of integral control adds a pole at the origin, thus making the system less stable.) Figure 6–34 shows examples of root loci illustrating the effects of the addition of a pole to a single-pole system and the addition of two poles to a single-pole system. Effects of the Addition of Zeros. The addition of a zero to the open-loop trans- fer function has the effect of pulling the root locus to the left, tending to make the system more stable and to speed up the settling of the response. (Physically, the addition of a zero in the feedforward transfer function means the addition of derivative control to the system.The effect of such control is to introduce a degree of anticipation into the sys- tem and speed up the transient response.) Figure 6–35(a) shows the root loci for a system (a)jv s (b)jv s (c)jv s Figure 6–34 (a) Root-locus plot of a single-pole system; (b) root-locus plot of a two-pole system; (c) root-locus plot of a three-pole system. (a)jv s (b)jv s (c)jv s (d)jv s Figure 6–35 (a) Root-locus plot of a three-pole system; (b), (c), and (d) root-locus plots showing effects of addition of a zero to the three-pole system. Openmirrors.comSection 6–6 / Lead Compensation 311that is stable for small gain but unstable for large gain. Figures 6–35(b), (c), and (d) show root-locus plots for the system when a zero is added to the open-loop transfer function.Notice that when a zero is added to the system of Figure 6–35(a), it becomes stable forall values of gain. 6–6 LEAD COMPENSATION In Section 6–5 we presented an introduction to compensation of control systems and dis- cussed preliminary materials for the root-locus approach to control-systems design andcompensation. In this section we shall present control-systems design by use of the leadcompensation technique. In carrying out a control-system design, we place a compen-sator in series with the unalterable transfer function G(s) to obtain desirable behavior. The main problem then involves the judicious choice of the pole(s) and zero(s) of thecompensator G c(s)to have the dominant closed-loop poles at the desired location in the splane so that the performance specifications will be met. Lead Compensators and Lag Compensators. There are many ways to realize lead compensators and lag compensators, such as electronic networks using operationalamplifiers, electrical RCnetworks, and mechanical spring-dashpot systems. Figure 6–36 shows an electronic circuit using operational amplifiers. The transfer function for this circuit was obtained in Chapter 3 as follows [see Equation (3–36)]: (6–18) where T=R 1 C1 , aT=R2 C2 , Kc=R4 C1 R3 C2 =Kc a Ts+1 aTs+1=Kcs+1 T s+1 aT Eo(s) Ei(s)=R2 R4 R1 R3R1 C1 s+1 R2 C2 s+1=R4 C1 R3 C2s+1 R1 C1 s+1 R2 C2 – +– +C1C2 R1R2R3R4 Ei(s) Eo(s)E(s)Figure 6–36 Electronic circuitthat is a lead network if and a lag network ifR 1 C16R2 C2 .R1 C17R2 C2312 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method Notice that This network has a dc gain of From Equation (6–18), we see that this network is a lead network if or It is a lag network if The pole-zero configurations of this net- work when and are shown in Figure 6–37(a) and (b), respectively. Lead Compensation Techniques Based on the Root-Locus Approach. The root-locus approach to design is very powerful when the specifications are given in terms of time-domain quantities, such as the damping ratio and undamped natural frequency of the desired dominant closed-loop poles, maximum overshoot, rise time, and settling time. Consider a design problem in which the original system either is unstable for all val- ues of gain or is stable but has undesirable transient-response characteristics. In such a case, the reshaping of the root locus is necessary in the broad neighborhood of the jv axis and the origin in order that the dominant closed-loop poles be at desired locations in the complex plane.This problem may be solved by inserting an appropriate lead com- pensator in cascade with the feedforward transfer function. The procedures for designing a lead compensator for the system shown in Figure 6–38 by the root-locus method may be stated as follows: 1.From the performance specifications, determine the desired location for the dom- inant closed-loop poles.R 1 C 1 6R 2 C 2 R 1 C 1 7R 2 C 2 R 1 C 1 6R 2 C 2 . a61.R 1 C 1 7R 2 C 2 ,K c a=R 2 R 4 /H20862AR 1 R 3 B.K c a=R 4 C 1 R 3 C 2 R 2 C 2 R 1 C 1 =R 2 R 4 R 1 R 3 , a=R 2 C 2 R 1 C 1 jv s (a)1 R 2 C 2 –1 R 1 C 1 – jv s (b)1 R 2 C 2 –1 R 1 C 1 –00 Figure 6–37 Pole-zero configurations: (a) lead network; (b) lag network. G c (s) G(s) +– Figure 6–38 Control system. Openmirrors.comSection 6–6 / Lead Compensation 3132.By drawing the root-locus plot of the uncompensated system (original system), ascertain whether or not the gain adjustment alone can yield the desired closed-loop poles. If not, calculate the angle deficiency f.This angle must be contributed by the lead compensator if the new root locus is to pass through the desired loca-tions for the dominant closed-loop poles. 3.Assume the lead compensator G c(s)to be whereaand Tare determined from the angle deficiency. Kcis determined from the requirement of the open-loop gain. 4.If static error constants are not specified, determine the location of the pole and zero of the lead compensator so that the lead compensator will contribute the nec-essary angle f. If no other requirements are imposed on the system, try to make the value of aas large as possible. A larger value of agenerally results in a larger value of K v,which is desirable. Note that 5.Determine the value of Kc of the lead compensator from the magnitude condition. Once a compensator has been designed, check to see whether all performance spec- ifications have been met. If the compensated system does not meet the performancespecifications, then repeat the design procedure by adjusting the compensator pole andzero until all such specifications are met. If a large static error constant is required, cas-cade a lag network or alter the lead compensator to a lag–lead compensator. Note that if the selected dominant closed-loop poles are not really dominant, or if the selected dominant closed-loop poles do not yield the desired result, it will be nec-essary to modify the location of the pair of such selected dominant closed-loop poles.(The closed-loop poles other than dominant ones modify the response obtained from thedominant closed-loop poles alone.The amount of modification depends on the locationof these remaining closed-loop poles.) Also, the closed-loop zeros affect the response ifthey are located near the origin. EXAMPLE 6–6 Consider the position control system shown in Figure 6–39(a). The feedforward transfer function is The root-locus plot for this system is shown in Figure 6–39(b). The closed-loop transfer function for the system is =10 (s+0.5+j3.1225 )(s+0.5-j3.1225 )C(s) R(s)=10 s2+s+10G(s) =10 s(s+1)Kv=lim sS0sGc(s)G(s) =Kca lim sS0sGc(s)Gc(s)=Kc a Ts+1 aTs+1=Kcs+1 T s+1 aT, (06a61)314 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method The closed-loop poles are located at The damping ratio of the closed-loop poles is .The undamped natural fre- quency of the closed-loop poles is 3.1623 rad /H20862sec. Because the damping ratio is small, this system will have a large overshoot in the step response and is not desirable. It is desired to design a lead compensator G c (s)as shown in Figure 6–40(a) so that the dom- inant closed-loop poles have the damping ratio and the undamped natural frequency The desired location of the dominant closed-loop poles can be determined from as follows: s=-1.5;j2.5981=(s+1.5+j2.5981)(s +1.5-j 2.5981)s 2 +2zv n s+v n2 =s 2 +3s+9v n =3 rad /H20862sec.z=0.5v n =210 =z=(1/H208622)/H20862210 =0.1581s=-0.5;j3.1225 R(s) C(s) (a) (b)10 s(s+ 1) G(s) Closed-loop polejv 1 −3−2−1j3 j2 j1 −j3−j2−j1 +– s Figure 6–39 (a) Control system; (b) root-locus plot. (a)10 s(s+ 1) G(s) R(s) C(s) G c (s) (b) Desired closed-loop polejv 1 –3 –1.5j2.5981 j2 j1 –j3–j2–j1s 60°v n = 3 +– Figure 6–40 (a) Compensated system; (b) desired closed-loop pole location. Openmirrors.comSection 6–6 / Lead Compensation 315[See Figure 6–40 (b).] In some cases, after the root loci of the original system have been obtained, the dominant closed- loop poles may be moved to the desired location by simple gain adjustment. This is, however, not the case for the present system. Therefore, we shall insert a lead compensatorin the feedforward path. A general procedure for determining the lead compensator is as follows: First, find the sum of the angles at the desired location of one of the dominant closed-loop poles with the open-looppoles and zeros of the original system, and determine the necessary angle fto be added so that the total sum of the angles is equal to The lead compensator must contribute this anglef. (If the angle fis quite large, then two or more lead networks may be needed rather than a single one.) Assume that the lead compensator G c(s)has the transfer function as follows: The angle from the pole at the origin to the desired dominant closed-loop pole at s=–1.5+j 2.5981 is 120°. The angle from the pole at s=– 1 to the desired closed-loop pole is 100.894°. Hence, the angle deficiency is Angle deficiency =180 °– 120 °– 100.894° =– 40.894° Deficit angle 40.894° must be contributed by a lead compensator. Note that the solution to such a problem is not unique. There are infinitely many solutions. We shall present two solutions to the problem in what follows. Method 1. There are many ways to determine the locations of the zero and pole of the lead compensator. In what follows we shall introduce a procedure to obtain a largest possible value fora. (Note that a larger value of awill produce a larger value of K v.In most cases, the larger the Kvis, the better the system performance.) First, draw a horizontal line passing through point P, the desired location for one of the dominant closed-loop poles. This is shown as line PAin Figure 6–41. Draw also a line connecting point Pand the origin. Bisect the angle between the lines PAand PO,a s shown in Figure 6–41. Draw two lines PCandPDthat make angles with the bisector PB.T he intersections of PCandPDwith the negative real axis give the necessary locations for the pole and zero of the lead network.The compensator thus designed will make point Pa point on the root locus of the compensated system. The open-loop gain is determined by use of the magnitude condition. In the present system, the angle of G(s) at the desired closed-loop pole is n10 s(s+1)2 s=-1.5+j2.5981=-220.894 °;f/H208622Gc(s)=Kc a Ts+1 aTs+1=Kcs+1 T s+1 aT, (06a61);180°(2k +1). jv s OAP CB D1 aT–1 T–f 2 f 2 Figure 6–41 Determination of thepole and zero of alead network.316 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method Thus, if we need to force the root locus to go through the desired closed-loop pole, the lead com- pensator must contribute f=40.894° at this point. By following the foregoing design procedure, we can determine the zero and pole of the lead compensator. Referring to Figure 6–42, if we bisect angle APO and take 40.894°/2 each side, then the loca- tions of the zero and pole are found as follows: zero at s=–1.9432 pole at s=–4.6458 Thus, G c (s)can be given as (For this compensator the value of aisa= 1.9432/4.6458 = 0.418.) The value of K c can be determined by use of the magnitude condition. or Hence, the lead compensator G c (s)just designed is given by Then, the open-loop transfer function of the designed system becomes and the closed-loop transfer function becomes =12.287 s+23.876 s 3 +5.646 s 2 +16.933 s+23.876C(s) R(s)=12.287 (s+1.9432 ) s(s+1)(s+4.6458 )+12.287 (s+1.9432 )G c (s)G(s) =1.2287 a s+1.9432 s+4.6458 b 10 s(s+1)G c (s)=1.2287s+1.9432 s+4.6458K c = 2 (s+4.6458 )s(s +1) 10(s+1.9432 ) 2 s=-1.5+j2.5981 =1.2287 2 K c s+1.9432 s+4.645810 s(s+1) 2 s=-1.5+j2.5981 =1G c (s)=K c s+1 T s+1 /H9251T=K c s+1.9432 s+4.6458 jv 1 02 −1.9432 −4.6458APj3 j2 j1 −j2−j1s 20.447° 20.447° −3 Figure 6–42 Determination of the pole and zero of the lead compensator. Openmirrors.comSection 6–6 / Lead Compensation 317Figure 6–43 shows the root-locus plot for the designed system. It is worthwhile to check the static velocity error constant Kvfor the system just designed. Note that the third closed-loop pole of the designed system is found by dividing the charac- teristic equation by the known factors as follows: The foregoing compensation method enables us to place the dominant closed-loop poles at the desired points in the complex plane. The third pole at s =/H110022.65 is fairly close to the added zero at /H110021.9432. Therefore, the effect of this pole on the transient response is relatively small. Since no restriction has been imposed on the nondominant pole and no specification has been given concerning the value of the static velocity error coefficient, we conclude that the present de- sign is satisfactory. Method 2. If we choose the zero of the lead compensator at s =/H110021 so that it will cancel the plant pole at s =/H110021, then the compensator pole must be located at s =/H110023. (See Figure 6–44.) Hence the lead compensator becomes The value of Kccan be determined by use of the magnitude condition. 2Kcs+1 s+310 s(s+1)2 s=-1.5+j2.5981=1Gc(s)=Kcs+1 s+3s3+5.646 s2+16.933 s+23.875 =(s+1.5+j2.5981 )(s+1.5-j2.5981 )(s+2.65)=5.139=lim sS0sc1.2287s+1.9432 s+4.645810 s(s+1)dKv=lim sS0sGc(s)G(s)jv 1 –3 –1 –2 –4 –5j2 j1j3 –j3–j2–j1s Figure 6–43 Root-locus plot of the designed system.318 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method or Hence The open-loop transfer function of the designed system then becomes The closed-loop transfer function of the compensated system becomes Note that in the present case the zero of the lead compensator will cancel a pole of the plant, re- sulting in the second-order system, rather than the third-order system as we designed using Method 1. The static velocity error constant for the present case is obtained as follows: Notice that the system designed by Method 1 gives a larger value of the static velocity error con- stant.This means that the system designed by Method 1 will give smaller steady-state errors in fol- lowing ramp inputs than the system designed by Method 2. For different combinations of a zero and pole of the compensator that contributes 40.894°, the value of K v will be different. Although a certain change in the value of K v can be made by alter- ing the pole-zero location of the lead compensator, if a large increase in the value of K v is desired, then we must alter the lead compensator to a lag–lead compensator. Comparison of step and ramp responses of the compensated and uncompensated systems. In what follows we shall compare the unit-step and unit-ramp responses of the three systems: the original uncompensated system, the system designed by Method 1, and the system designed by Method 2. The MATLAB program used to obtain unit-step response curves is given in=lim sS0 s c 9 s(s+3) d =3K v =lim sS0 sG c (s)G(s)C(s) R(s)=9 s 2 +3s+9G c (s)G(s) =0.9s+1 s+310 s(s+1)=9 s(s+3)G c (s)=0.9s+1 s+3K c = 2 s(s+3) 10 2 s=-1.5+j2.5981 =0.9 jv 1 –3 –1 –2 –4j2 j1j3 –j2–j1s Desired closed-loop pole Compensator pole Compensator zero 60° 120° Figure 6–44 Compensator pole and zero. Openmirrors.comSection 6–6 / Lead Compensation 319MATLAB Program 6–9, where num1 and den1 denote the numerator and denominator of the system designed by Method 1 and num2 and den2 denote that designed by Method 2. Also, numand den are used for the original uncompensated system.The resulting unit-step response curvesare shown in Figure 6–45.The MATLAB program to obtain the unit-ramp response curves of the MATLAB Program 6–9 % ***** Unit-Step Response of Compensated and Uncompensated Systems *****num1 = [12.287 23.876]; den1 = [1 5.646 16.933 23.876];num2 = [9];den2 = [1 3 9];num = [10];den = [1 1 10];t = 0:0.05:5;c1 = step(num1,den1,t);c2 = step(num2,den2,t);c = step(num,den,t);plot(t,c1,'-',t,c2,'.',t,c,'x')gridtitle('Unit-Step Responses of Compensated Systems and Uncompensated System')xlabel('t Sec')ylabel('Outputs c1, c2, and c')text(1.51,1.48,'Compensated System (Method 1)')text(0.9,0.48,'Compensated System (Method 2)')text(2.51,0.67,'Uncompensated System') Outputs c1,c2, and c 0.40.81.8 0 1 0.5 1.5 0 2 2.5 t Sec3 3.5 4 4.5 51.2 0.61 0.21.41.6Unit-Step Responses of Compensated Systems and Uncompensated System Compensated System (Method 1) Compensated System (Method 2)Uncompensated System Figure 6–45 Unit-step responsecurves of designedsystems and originaluncompensatedsystem.320 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method designed systems is given in MATLAB Program 6–10, where we used the step command to ob- tain unit-ramp responses by using the numerators and denominators for the systems designed by Method 1 and Method 2 as follows: num1 = [12.287 23.876] den1 = [1 5.646 16.933 23.876 0] num2 = [9] den2 = [1 3 9 0] The resulting unit-ramp response curves are shown in Figure 6–46. MATLAB Program 6–10 % ***** Unit-Ramp Responses of Compensated Systems ***** num1 = [12.287 23.876]; den1 = [1 5.646 16.933 23.876 0]; num2 = [9]; den2 = [1 3 9 0]; t = 0:0.05:5; c1 = step(num1,den1,t); c2 = step(num2,den2,t); plot(t,c1,'-',t,c2,'.',t,t,'-') grid title('Unit-Ramp Responses of Compensated Systems') xlabel('t Sec') ylabel('Unit-Ramp Input and Outputs c1 and c2') text(2.55,3.8,'Input') text(0.55,2.8,'Compensated System (Method 1)') text(2.35,1.75,'Compensated System (Method 2)') Unit-Ramp Input and Outputs c1 and c2 Unit-Ramp Responses of Compensated Systems Compensated System (Method 1) Input Compensated System (Method 2) 1 0.5 1.5 0 2 2.5 3 3.5 4 4.5 5 t Sec5 2 0 3 4.5 1 0.5 4 2.5 3.5 1.5 Figure 6–46 Unit-ramp response curves of designed systems. Openmirrors.comSection 6–7 / Lag Compensation 321In examining these response curves notice that the compensated system designed by Method 1 exhibits a little bit larger overshoot in the step response than the compensated system designedby Method 2. However, the former has better response characteristics for the ramp input than thelatter. So it is difficult to say which one is better. The decision on which one to choose should bemade by the response requirements (such as smaller overshoots for step type inputs or smallersteady-state errors in following ramp or changing inputs) expected in the designed system. If bothsmaller overshoots in step inputs and smaller steady-state errors in following changing inputs arerequired, then we might use a lag–lead compensator. (See Section 6–8 for the lag–lead compen- sation techniques.) 6–7 LAG COMPENSATION Electronic Lag Compensator Using Operational Amplifiers. The configuration of the electronic lag compensator using operational amplifiers is the same as that for thelead compensator shown in Figure 6–36. If we choose in the circuit shownin Figure 6–36, it becomes a lag compensator. Referring to Figure 6–36, the transferfunction of the lag compensator is given by where Note that we use binstead of ain the above expressions. [In the lead compensator we usedato indicate the ratio which was less than 1, or 0 <a<1. ] In this book we always assume that 0 <a<1 andb>1. Lag Compensation Techniques Based on the Root-Locus Approach. Consider the problem of finding a suitable compensation network for the case where the systemexhibits satisfactory transient-response characteristics but unsatisfactory steady-statecharacteristics. Compensation in this case essentially consists of increasing the open-loop gain without appreciably changing the transient-response characteristics.This meansthat the root locus in the neighborhood of the dominant closed-loop poles should notbe changed appreciably, but the open-loop gain should be increased as much as needed.This can be accomplished if a lag compensator is put in cascade with the givenfeedforward transfer function. To avoid an appreciable change in the root loci, the angle contribution of the lag network should be limited to a small amount, say less than 5°. To assure this, we placethe pole and zero of the lag network relatively close together and near the origin of thesplane.Then the closed-loop poles of the compensated system will be shifted only slight- ly from their original locations. Hence, the transient-response characteristics will bechanged only slightly.R 2 C2/H20862AR1 C1B,T=R1 C1 , bT=R2 C2 , b=R2 C2 R1 C171, Kˆc=R4 C1 R3 C2Eo(s) Ei(s)=Kˆc bTs+1 bTs+1=Kˆcs+1 T s+1 bTR2 C27R1 C1322 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method Consider a lag compensator where (6–19) If we place the zero and pole of the lag compensator very close to each other, then at where s 1 is one of the dominant closed-loop poles, the magnitudes and are almost equal, or To make the angle contribution of the lag portion of the compensator small, we require This implies that if gain of the lag compensator is set equal to 1, the alteration in the transient-response characteristics will be very small, despite the fact that the overall gain of the open-loop transfer function is increased by a factor of b, where b>1. If the pole and zero are placed very close to the origin, then the value of bcan be made large. (A large value of bmay be used, provided physical realization of the lag compensator is possible.) It is noted that the value of Tmust be large, but its exact value is not critical. However, it should not be too large in order to avoid difficulties in realizing the phase-lag com- pensator by physical components. An increase in the gain means an increase in the static error constants. If the open- loop transfer function of the uncompensated system is G(s), then the static velocity error constant K v of the uncompensated system is If the compensator is chosen as given by Equation (6–19), then for the compensated system with the open-loop transfer function the static velocity error constant where K v is the static velocity error constant of the uncompensated system. Thus if the compensator is given by Equation (6–19), then the static velocity error constant is increased by a factor of where is approximately unity. K ˆ c K ˆ c b,=K ˆ c bK v =lim sS0 G c (s)K v K ˆ v =lim sS0 sG c (s)G(s)K ˆ v becomesG c (s)G(s)K v =lim sS0 sG(s)K ˆ c -5°6 n s 1 +1 T s 1 +1 bT 60°∑G c As 1 B∑= 4 K ˆ c s 1 +1 T s 1 +1 bT 4 /H11216K ˆ c s 1 +C1/H20862(bT)Ds 1 +(1/H20862T) s=s 1 ,G c (s)=K ˆ c bTs+1 bTs+1=K ˆ c s+1 T s+1 bTG c (s), Openmirrors.comSection 6–7 / Lag Compensation 323The main negative effect of the lag compensation is that the compensator zero that will be generated near the origin creates a closed-loop pole near the origin.This closed-loop pole and compensator zero will generate a long tail of small amplitude in the stepresponse, thus increasing the settling time. Design Procedures for Lag Compensation by the Root-Locus Method. The procedure for designing lag compensators for the system shown in Figure 6–47 by theroot-locus method may be stated as follows (we assume that the uncompensated systemmeets the transient-response specifications by simple gain adjustment; if this is not thecase, refer to Section 6–8): 1.Draw the root-locus plot for the uncompensated system whose open-loop trans- fer function is G(s). Based on the transient-response specifications, locate the dominant closed-loop poles on the root locus. 2.Assume the transfer function of the lag compensator to be given by Equation (6–19): Then the open-loop transfer function of the compensated system becomes 3.Evaluate the particular static error constant specified in the problem. 4.Determine the amount of increase in the static error constant necessary to satis- fy the specifications. 5.Determine the pole and zero of the lag compensator that produce the necessary increase in the particular static error constant without appreciably altering theoriginal root loci. (Note that the ratio of the value of gain required in the spec-ifications and the gain found in the uncompensated system is the required ratiobetween the distance of the zero from the origin and that of the pole from theorigin.) 6.Draw a new root-locus plot for the compensated system. Locate the desired dom- inant closed-loop poles on the root locus. (If the angle contribution of the lag net-work is very small—that is, a few degrees—then the original and new root loci arealmost identical. Otherwise, there will be a slight discrepancy between them.Thenlocate, on the new root locus, the desired dominant closed-loop poles based onthe transient-response specifications.) 7.Adjust gain of the compensator from the magnitude condition so that the dom- inant closed-loop poles lie at the desired location. Awill be approximately 1. B K ˆcKˆcGc(s)G(s).Gc(s)=Kˆc bTs+1 bTs+1=Kˆcs+1 T s+1 bT Gc(s) G(s) +– Figure 6–47 Control system.324 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method EXAMPLE 6–7 Consider the system shown in Figure 6–48(a). The feedforward transfer function is The root-locus plot for the system is shown in Figure 6–48(b). The closed-loop transfer function becomes The dominant closed-loop poles are The damping ratio of the dominant closed-loop poles is The undamped natural frequency of the dominant closed-loop poles is 0.673 rad /H20862sec.The static velocity error constant is 0.53 sec –1 . It is desired to increase the static velocity error constant K v to about 5 sec –1 without appreciably changing the location of the dominant closed-loop poles. To meet this specification, let us insert a lag compensator as given by Equation (6–19) in cascade with the given feedforward transfer function.To increase the static velocity error con- stant by a factor of about 10, let us choose b=10 and place the zero and pole of the lag com- pensator at s=–0.05 ands=–0.005 , respectively.The transfer function of the lag compensator becomes G c (s)=K ˆ c s+0.05 s+0.005z=0.491.s=-0.3307 ;j0.5864 =1.06 (s+0.3307 -j0.5864)(s +0.3307 +j0.5864)(s +2.3386) C(s) R(s)=1.06 s(s+1)(s +2)+1.06G(s) =1.06 s(s+1)(s +2) 1.06 s(s+ 1) (s+ 2) Closed-loop poles j1 –j2–j10 –1 –2 –31jv s (a) (b)j2 +– Figure 6–48 (a) Control system; (b) root-locus plot. Openmirrors.comSection 6–7 / Lag Compensation 325The angle contribution of this lag network near a dominant closed-loop pole is about 4°. Because this angle contribution is not very small, there is a small change in the new root locus near thedesired dominant closed-loop poles. The open-loop transfer function of the compensated system then becomes where The block diagram of the compensated system is shown in Figure 6–49.The root-locus plot for the compensated system near the dominant closed-loop poles is shown in Figure 6–50(a), together withthe original root-locus plot. Figure 6–50(b) shows the root-locus plot of the compensated systemK=1.06K ˆc =K(s +0.05) s(s+0.005)(s +1)(s +2) Gc(s)G(s) =Kˆc s+0.05 s+0.005 1.06 s(s+1)(s +2)Kcs+ 0.05 s+ 0.005 Kc= 0.9661.06 s(s+ 1) (s+ 2)+–^ ^Figure 6–49 Compensatedsystem. Figure 6–50 (a) Root-locus plots of the compensated system and uncompensated system; (b) root-locus plot of compensated system near the origin.Real Axis−2.5 −3 0 1 −0.5 0.5 −1.5 −2 −1 (a)Imag Axis2 −21.5 −1 −1.51 00.5 −0.5Root-Locus Plots of Compensated and Uncompensated Systems Uncompensated system Original closed-loop pole Compensated systemNew closed- loop pole 0.4 0.6 0.2 −0.2 −0.4 0Root-Locus Plot of Compensated System near the Origin Real AxisImag Axis−0.10.10.5 −0.3 −0.40.3 00.2 −0.20.4 −0.5 (b)326 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method near the origin.The MATLAB program to generate the root-locus plots shown in Figures 6–50(a) and (b) is given in MATLAB Program 6–11. If the damping ratio of the new dominant closed-loop poles is kept the same, then these poles are obtained from the new root-locus plot as follows: The open-loop gain Kis determined from the magnitude condition as follows: =1.0235 K= 2 s(s+0.005)(s +1)(s +2) s+0.05 2 s=-0.31+j0.55 s 1 =-0.31 +j0.55, s 2 =-0.31 -j0.55 MATLAB Program 6–11 % ***** Root-locus plots of the compensated system and % uncompensated system ***** % ***** Enter the numerators and denominators of the % compensated and uncompensated systems ***** numc = [1 0.05]; denc = [1 3.005 2.015 0.01 0]; num = [1.06]; den = [1 3 2 0]; % ***** Enter rlocus command. Plot the root loci of both % systems ***** rlocus(numc,denc) hold Current plot held rlocus(num,den) v = [-3 1 -2 2]; axis(v); axis('square') grid text(-2.8,0.2,'Compensated system') text(-2.8,1.2,'Uncompensated system') text(-2.8,0.58,'Original closed-loop pole') text(-0.1,0.85,'New closed-') text(-0.1,0.62,'loop pole') title('Root-Locus Plots of Compensated and Uncompensated Systems') hold Current plot released % ***** Plot root loci of the compensated system near the origin ***** rlocus(numc,denc) v = [-0.6 0.6 -0.6 0.6]; axis(v); axis('square') grid title('Root-Locus Plot of Compensated System near the Origin') Openmirrors.comSection 6–7 / Lag Compensation 327Then the lag compensator gain is determined as Thus the transfer function of the lag compensator designed is (6–20) Then the compensated system has the following open-loop transfer function: The static velocity error constant Kvis In the compensated system, the static velocity error constant has increased to 5.12 sec–1,or 5.12/0.53=9.66 times the original value. (The steady-state error with ramp inputs has decreased to about 10 %of that of the original system.) We have essentially accomplished the design objective of increasing the static velocity error constant to 5 sec–1. Note that, since the pole and zero of the lag compensator are placed close together and are lo- cated very near the origin, their effect on the shape of the original root loci has been small. Except for the presence of a small closed root locus near the origin, the root loci of the compensated and theuncompensated systems are very similar to each other. However, the value of the static velocity errorconstant of the compensated system is 9.66 times greater than that of the uncompensated system. The two other closed-loop poles for the compensated system are found as follows: The addition of the lag compensator increases the order of the system from 3 to 4, adding one ad- ditional closed-loop pole close to the zero of the lag compensator. (The added closed-loop poleats=–0.0549 is close to the zero at s=–0.05 .) Such a pair of a zero and pole creates a long tail of small amplitude in the transient response, as we will see later in the unit-step response. Since the pole at s=–2.326 is very far from the jvaxis compared with the dominant closed-loop poles, the effect of this pole on the transient response is also small. Therefore, we may consider theclosed-loop poles at to be the dominant closed-loop poles. The undamped natural frequency of the dominant closed-loop poles of the compensated sys- tem is 0.631 rad /H20862sec.This value is about 6 %less than the original value, 0.673 rad /H20862sec.This implies that the transient response of the compensated system is slower than that of the original system. The response will take a longer time to settle down.The maximum overshoot in the step responsewill increase in the compensated system. If such adverse effects can be tolerated, the lag com-pensation as discussed here presents a satisfactory solution to the given design problem. Next, we shall compare the unit-ramp responses of the compensated system against the uncompensated system and verify that the steady-state performance is much better in the compensated system than the uncompensated system. To obtain the unit-ramp response with MATLAB, we use the step command for the system Since for the compensated system is =1.0235s +0.0512 s5+3.005s4+2.015s3+1.0335s2+0.0512s C(s) sR(s)=1.0235(s +0.05) sCs(s+0.005)(s +1)(s +2)+1.0235(s +0.05)DC(s) /H20862CsR(s)D C(s) /H20862CsR(s)D.s=-0.31 ;j0.55s3=-2.326, s4=-0.0549Kv=lim sS0sG1(s)=5.12 sec-1 =5.12(20s +1) s(200s +1)(s +1)(0.5s +1) G1(s)=1.0235(s +0.05) s(s+0.005)(s +1)(s +2)Gc(s)=0.9656s+0.05 s+0.005=9.65620s +1 200s +1Kˆc=K 1.06=1.0235 1.06=0.9656Kˆc328 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method we have numc = [1.0235 0.0512] denc = [1 3.005 2.015 1.0335 0.0512 0] Also, for the uncompensated system is Hence, num = [1.06] den = [1 3 2 1.06 0] MATLAB Program 6–12 produces the plot of the unit-ramp response curves. Figure 6–51 shows the result. Clearly, the compensated system shows much smaller steady-state error (one-tenth of the original steady-state error) in following the unit-ramp input. =1.06 s 4 +3s 3 +2s 2 +1.06s C(s) sR(s)=1.06 sCs(s+1)(s +2)+1.06DC(s) /H20862CsR(s)D MATLAB Program 6–12 % ***** Unit-ramp responses of compensated system and % uncompensated system ***** % ***** Unit-ramp response will be obtained as the unit-step % response of C(s)/[sR(s)] ***** % ***** Enter the numerators and denominators of C1(s)/[sR(s)] % and C2(s)/[sR(s)], where C1(s) and C2(s) are Laplace % transforms of the outputs of the compensated and un- % compensated systems, respectively. ***** numc = [1.0235 0.0512]; denc = [1 3.005 2.015 1.0335 0.0512 0]; num = [1.06]; den = [1 3 2 1.06 0]; % ***** Specify the time range (such as t= 0:0.1:50) and enter % step command and plot command. ***** t = 0:0.1:50; c1 = step(numc,denc,t); c2 = step(num,den,t); plot(t,c1,'-',t,c2,'.',t,t,'--') grid text(2.2,27,'Compensated system'); text(26,21.3,'Uncompensated system'); title('Unit-Ramp Responses of Compensated and Uncompensated Systems') xlabel('t Sec'); ylabel('Outputs c1 and c2') Openmirrors.comSection 6–7 / Lag Compensation 329t Sec10 05 35 50 30 40 45 20 15 25Outputs c1 and c250 015 535 2530 2045 40 10Unit-Ramp Responses of Compensated and Uncompensated Systems Uncompensated systemCompensated system Figure 6–51 Unit-ramp responsesof compensated and uncompensated systems. [Thecompensator is givenby Equation (6–20).] MATLAB Program 6–13 gives the unit-step response curves of the compensated and un- compensated systems. The unit-step response curves are shown in Figure 6–52. Notice that the lag-compensated system exhibits a larger maximum overshoot and slower response than the original uncompensated system. Notice that a pair of the pole at s=–0.0549 and zero at MATLAB Program 6–13 % ***** Unit-step responses of compensated system and % uncompensated system ***** % ***** Enter the numerators and denominators of the % compensated and uncompensated systems ***** numc = [1.0235 0.0512]; denc = [1 3.005 2.015 1.0335 0.0512];num = [1.06];den = [1 3 2 1.06]; % ***** Specify the time range (such as t = 0:0.1:40) and enter % step command and plot command. ***** t = 0:0.1:40; c1 = step(numc,denc,t);c2 = step(num,den,t);plot(t,c1,'-',t,c2,'.')gridtext(13,1.12,'Compensated system')text(13.6,0.88,'Uncompensated system')title('Unit-Step Responses of Compensated and Uncompensated Systems')xlabel('t Sec')ylabel('Outputs c1 and c2')330 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method Unit-Step Responses of Compensated and Uncompensated Systems Outputs c1 and c2 Uncompensated systemCompensated system t Sec5 0 30 40 25 35 15 10 20 1.4 0.4 0 1.2 0.8 1 0.6 0.2 Figure 6–52 Unit-step responses of compensated and uncompensated systems. [The compensator is given by Equation (6–20).] s=–0.05 generates a long tail of small amplitude in the transient response. If a larger maximum overshoot and a slower response are not desired, we need to use a lag–lead compensator as presented in Section 6–8. Comments. It is noted that under certain circumstances, however, both lead com- pensator and lag compensator may satisfy the given specifications (both transient- response specifications and steady-state specifications.) Then either compensation may be used. 6–8 LAG–LEAD COMPENSATION Lead compensation basically speeds up the response and increases the stability of the system. Lag compensation improves the steady-state accuracy of the system, but reduces the speed of the response. If improvements in both transient response and steady-state response are desired, then both a lead compensator and a lag compensator may be used simultaneously. Rather than introducing both a lead compensator and a lag compensator as separate units, how- ever, it is economical to use a single lag–lead compensator. Lag–lead compensation combines the advantages of lag and lead compensations. Since the lag–lead compensator possesses two poles and two zeros, such a compensation increases the order of the system by 2, unless cancellation of pole(s) and zero(s) occurs in the compensated system. Electronic Lag–Lead Compensator Using Operational Amplifiers. Figure 6–53 shows an electronic lag–lead compensator using operational amplifiers. The transfer Openmirrors.comSection 6–8 / Lag-Lead Compensation 331function for this compensator may be obtained as follows: The complex impedance Z1 is given by or Similarly, complex impedance Z2is given by Hence, we have The sign inverter has the transfer function Thus the transfer function of the compensator shown in Figure 6–53 is (6–21) Let us define T1=AR1+R3BC1 , T1 g=R1 C1 , T2=R2 C2 , bT2=AR2+R4BC2Eo(s) Ei(s)=Eo(s) E(s)E(s) Ei(s)=R4 R6 R3 R5cAR1+R3BC1 s+1 R1 C1 s+1dcR2 C2 s+1 AR2+R4BC2 s+1dEo(s) E(s)=-R6 R5E(s) Ei(s)=-Z2 Z1=-R4 R3AR1+R3BC1 s+1 R1 C1 s+1/H11554R2 C2 s+1 AR2+R4BC2 s+1Z2=AR2 C2 s+1BR4 AR2+R4BC2 s+1Z1=AR1 C1 s+1BR3 AR1+R3BC1 s+11 Z1=1 R1+1 C1 s+1 R3– +– +C1C2 R1 R5 Ei(s)Eo(s)E(s) Lag–lead network Sign inverterZ1 Z2R2 R3R4R6 Figure 6–53 Lag–leadcompensator.332 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method G c (s) G(s) +– Figure 6–54 Control system. Then Equation (6–21) becomes (6–22) where Note that gis often chosen to be equal to b. Lag–lead Compensation Techniques Based on the Root-Locus Approach. Consider the system shown in Figure 6–54. Assume that we use the lag–lead compen sator: (6–23) where and (Consider K c to belong to the lead portion of the lag–lead compensator.) In designing lag–lead compensators, we consider two cases where and Case 1. In this case, the design process is a combination of the design of the lead compensator and that of the lag compensator.The design procedure for the lag–lead compensator follows: 1.From the given performance specifications, determine the desired location for the dominant closed-loop poles. 2.Using the uncompensated open-loop transfer function G(s), determine the angle deficiency fif the dominant closed-loop poles are to be at the desired location.The phase-lead portion of the lag–lead compensator must contribute this angle f. 3.Assuming that we later choose sufficiently large so that the magnitude of the lag portion 4 s 1 +1 T 2 s 1 +1 bT 2 4 T 2 gZb.g=b. gZbg71. b71G c (s)=K c b gAT 1 s+1BAT 2 s+1B a T 1 gs+1 b AbT 2 s+1B=K c ± s+1 T 1 s+g T 1 ≤± s+1 T 2 s+1 bT 2 ≤ g=R 1 +R 3 R 1 71, b=R 2 +R 4 R 2 71, K c =R 2 R 4 R 6 R 1 R 3 R 5 R 1 +R 3 R 2 +R 4 E o (s) E i (s)=K c b g £ T 1 s+1 T 1 gs+1 ≥a T 2 s+1 bT 2 s+1 b =K c a s+1 T 1 ba s+1 T 2 b a s+g T 1 ba s+1 bT 2 b Openmirrors.comSection 6–8 / Lag-Lead Compensation 333is approximately unity, where is one of the dominant closed-loop poles, choose the values of and gfrom the requirement that The choice of and gis not unique. (Infinitely many sets of and gare possible.) Then determine the value of Kcfrom the magnitude condition: 4.If the static velocity error constant Kvis specified, determine the value of bto satisfy the requirement for Kv. The static velocity error constant Kvis given by where Kcandgare already determined in step 3. Hence, given the value of Kv, the value ofbcan be determined from this last equation. Then, using the value of bthus deter- mined, choose the value of such that (The preceding design procedure is illustrated in Example 6–8.) Case 2. Ifg=bis required in Equation (6–23), then the preceeding design procedure for the lag–lead compensator may be modified as follows: 1.From the given performance specifications, determine the desired location for the dominant closed-loop poles.g=b.-5°6ns1+1 T2 s1+1 bT260°4s1+1 T2 s1+1 bT24/H112161T2 =lim sS0sKcb gG(s) =lim sS0sKc±s+1 T1 s+g T1≤±s+1 T2 s+1 bT2≤G(s) Kv=lim sS0sGc(s)G(s)4Kcs1+1 T1 s1+g T1GAs1B4=1T1 T1ns1+1 T1 s1+g T1=fT1s=s1334 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method 2.The lag–lead compensator given by Equation (6–23) is modified to (6–24) whereb>1. The open-loop transfer function of the compensated system is G c (s)G(s). If the static velocity error constant K v is specified, determine the value of constant K c from the following equation: 3.To have the dominant closed-loop poles at the desired location, calculate the angle contribution fneeded from the phase-lead portion of the lag–lead compensator. 4.For the lag–lead compensator, we later choose sufficiently large so that is approximately unity, where is one of the dominant closed-loop poles. De- termine the values of and bfrom the magnitude and angle conditions: 5.Using the value of bjust determined, choose so that The value of the largest time constant of the lag–lead compensator, should not be too large to be physically realized. (An example of the design of the lag–lead compen- sator when is given in Example 6–9.) g=bbT 2 ,-5°6 n s 1 +1 T 2 s 1 +1 bT 2 60° 4 s 1 +1 T 2 s 1 +1 bT 2 4 /H112161T 2 n s 1 +1 T 1 s 1 +b T 1 =f 4 K c ± s 1 +1 T 1 s 1 +b T 1 ≤ GAs 1 B 4 =1T 1 s=s 1 4 s 1 +1 T 2 s 1 +1 bT 2 4 T 2 =lim sS0 sK c G(s) K v =lim sS0 sG c (s)G(s)G c (s)=K c AT 1 s+1BAT 2 s+1B a T 1 bs+1 b AbT 2 s+1B=K c a s+1 T 1 ba s+1 T 2 b a s+b T 1 ba s+1 bT 2 b Openmirrors.comSection 6–8 / Lag-Lead Compensation 335EXAMPLE 6–8 Consider the control system shown in Figure 6–55. The feedforward transfer function is This system has closed-loop poles at The damping ratio is 0.125, the undamped natural frequency is 2 rad/sec, and the static velocity error constant is 8 sec–1. It is desired to make the damping ratio of the dominant closed-loop poles equal to 0.5 and to increase the undamped natural frequency to 5 rad /H20862sec and the static velocity error constant to 80 sec–1. Design an appropriate compensator to meet all the performance specifications. Let us assume that we use a lag–lead compensator having the transfer function wheregis not equal to b.Then the compensated system will have the open-loop transfer function From the performance specifications, the dominant closed-loop poles must be at Since the phase-lead portion of the lag–lead compensator must contribute 55° so that the root locus passes through the desired location of the dominant closed-loop poles. To design the phase-lead portion of the compensator, we first determine the location of the zero and pole that will give 55° contribution. There are many possible choices, but we shall here choose the zero at s=–0.5 so that this zero will cancel the pole at s=–0.5 of the plant. Once the zero is chosen, the pole can be located such that the angle contribution is 55°. By simplecalculation or graphical analysis, the pole must be located at s=–5.02. Thus, the phase-lead portion of the lag–lead compensator becomes K cs+1 T1 s+g T1=Kcs+0.5 s+5.02n4 s(s+0.5)2 s=-2.50+j4.33=-235°s=-2.50 ;j4.33Gc(s)G(s) =Kc±s+1 T1 s+g T1≤±s+1 T2 s+1 bT2≤G(s)Gc(s)=Kc±s+1 T1 s+g T1≤±s+1 T2 s+1 bT2≤ (g71,b71)s=-0.2500 ;j1.9843G(s) =4 s(s+0.5) 4 s(s+ 0.5)+– Figure 6–55 Control system.336 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method Thus Next we determine the value of K c from the magnitude condition: Hence, The phase-lag portion of the compensator can be designed as follows: First the value of bis determined to satisfy the requirement on the static velocity error constant: Hence, bis determined as Finally, we choose the value such that the following two conditions are satisfied: We may choose several values for T 2 and check if the magnitude and angle conditions are satis- fied. After simple calculations we find for T 2 = 5 Since T 2 = 5 satisfies the two conditions, we may choose Now the transfer function of the designed lag–lead compensator is given by =10(2s +1)(5s +1) (0.1992s +1)(80.19s +1) =6.26 a s+0.5 s+5.02 ba s+0.2 s+0.01247 b G c (s)=(6.26) ± s+1 2 s+10.04 2 ≤± s+1 5 s+1 16.04 *5 ≤ T 2 =517magnitude 70.98, -2.10°6angle 60°-5°6 n s+1 T 2 s+1 16.04 T 2 4 s=-2.5+j4.33 60° 4 s+1 T 2 s+1 16.04 T 2 4 s=-2.5+j4.33 /H112161,T 2 b=16.04 =lim sS0 s(6.26) b 10.04 4 s(s+0.5)=4.988b=80 K v =lim sS0 sG c (s)G(s) =lim sS0 sK c b g G(s)K c = 2 (s+5.02)s 4 2 s=-2.5+j4.33 =6.26 2 K c s+0.5 s+5.024 s(s+0.5) 2 s=-2.5+j4.33 =1T 1 =2, g=5.02 0.5=10.04 Openmirrors.comSection 6–8 / Lag-Lead Compensation 337The compensated system will have the open-loop transfer function Because of the cancellation of the (s+0.5) terms, the compensated system is a third-order system. (Mathematically, this cancellation is exact, but practically such cancellation will not be exact be-cause some approximations are usually involved in deriving the mathematical model of the sys-tem and, as a result, the time constants are not precise.) The root-locus plot of the compensated system is shown in Figure 6–56(a).An enlarged view of the root-locus plot near the origin is shown in Figure 6–56(b). Because the angle contribution of the phase lag portion of the lag–leadcompensator is quite small, there is only a small change in the location of the dominant closed-loop poles from the desired location, The characteristic equation for the com-pensated system is or Hence the new closed-loop poles are located at The new damping ratio is z=0.491.Therefore the compensated system meets all the required per- formance specifications. The third closed-loop pole of the compensated system is located at Since this closed-loop pole is very close to the zero at the effect of this pole on the response is small. (Note that, in general, if a pole and a zero lie close to each other on thenegative real axis near the origin, then such a pole-zero combination will yield a long tail of smallamplitude in the transient response.)s=-0.2, s=-0.2078.s=-2.4123 ;j4.2756=(s+2.4123 +j4.2756 )(s+2.4123 -j4.2756 )(s+0.2078 )=0s 3+5.0325 s2+25.1026 s+5.008s(s+5.02)(s+0.01247 )+25.04 (s+0.2)=0s=-2.5;j4.33.Gc(s)G(s) =25.04(s +0.2) s(s+5.02)(s +0.01247) Root-Locus Plot of Compensated SystemImag Axis 10 5 –5 –10 0 Real Axis (a)–228 6 0410 –10–4 –6 –8Root-Locus Plot of Compensated System near the Origin RealAxisImag Axis –0.5 0 –0.1 –0.3 –0.4 –0.2–0.050.050.2 –0.15 –0.250.15 00.1 –0.10.25 –0.2 (b) Figure 6–56 (a) Root-locus plot of the compensated system; (b) root-locus plot near the origin.338 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method t Sec1 0 6 8 5 7 3 2 4 (a) Outputs 0.4 0.81.8 0 1.2 0.6 1 0.2 1.4 1.6 Unit-Step Responses of Compensated and Uncompensated Systems Uncompensated system Compensated system Steady-state error of compensated system = 0.0125 Steady-state error of uncompensated system = 0.125 Compensated systemUncompensated system t Sec2 1 7 9 6 8 10 0 4 3 5 (b) Outputs 10 4 0 6 9 2 1 8 5 7 3 Unit-Ramp Responses of Compensated and Uncompensated Systems Figure 6–57 Transient-response curves for the compensated system and uncompensated system. (a) Unit-step response curves; (b) unit-ramp response curves. The unit-step response curves and unit-ramp response curves before and after compensation are shown in Figure 6–57. (Notice a long tail of a small amplitude in the unit-step response of the compensated system.) EXAMPLE 6–9 Consider the control system of Example 6–8 again. Suppose that we use a lag–lead compensator of the form given by Equation (6–24), or G c (s)=K c a s+1 T 1 ba s+1 T 2 b a s+b T 1 ba s+1 bT 2 b (b71) Openmirrors.comSection 6–8 / Lag-Lead Compensation 339Assuming the specifications are the same as those given in Example 6–8, design a compensator Gc(s). The desired locations for the dominant closed-loop poles are at The open-loop transfer function of the compensated system is Since the requirement on the static velocity error constant Kvis 80 sec–1,we have Thus The time constant and the value of bare determined from (The angle deficiency of 55° was obtained in Example 6–8.) Referring to Figure 6–58, we can easily locate points AandBsuch that (Use a graphical approach or a trigonometric approach.) The result is or The phase-lead portion of the lag–lead network thus becomes For the phase-lag portion, we choose such that it satisfies the conditions -5°6ns+1 T2 s+1 3.503 T24 s=-2.50 +j4.3360° 4s+1 T2 s+1 3.503 T24 s=-2.50 +j4.33/H112161,T210as+2.38 s+8.34bT1=1 2.38=0.420, b=8.34T1=3.503AO =2.38, BO =8.34/APB =55°, PA PB=4.77 8ns+1 T1 s+b T14 s=-2.5+j4.33=55°4s+1 T1 s+b T14240 s(s+0.5)2 s=-2.5+j4.33=4s+1 T1 s+b T148 4.77=1T1Kc=10Kv=lim sS0sGc(s)G(s) =lim sS0Kc4 0.5=8Kc=80Gc(s)G(s) =Kcas+1 T1bas+1 T2b as+b T1bas+1 bT2b/H115544 s(s+0.5)s=-2.50 ;j4.33340 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method 0jv sA BP 55°j5 j4 j3 j2 j1 –j4–j3–j2–j1–10 –9–8–7–6–5–4–3–2–11 2 Figure 6–58 Determination of the desired pole-zero location. By simple calculations, we find that if we choose , then and if we choose , then Since is one of the time constants of the lag–lead compensator, it should not be too large. If can be acceptable from practical viewpoint, then we may choose . Then Thus, the lag–lead compensator becomes The compensated system will have the open-loop transfer function No cancellation occurs in this case, and the compensated system is of fourth order. Because the angle contribution of the phase lag portion of the lag–lead network is quite small, the dominant closed-loop poles are located very near the desired location. In fact, the location of the dominant closed-loop poles can be found from the characteristic equation as follows: The characteristic equation of the compensated system is which can be simplified to =(s+2.4539 +j4.3099 )(s+2.4539 -j4.3099 )(s+0.1003 )(s+3.8604 )=0s 4 +8.8685 s 3 +44.4219 s 2 +99.3188 s+9.52(s+8.34)(s+0.0285 )s(s +0.5)+40(s+2.38)(s+0.1)=0G c (s)G(s) =40(s +2.38)(s +0.1) (s+8.34)(s +0.0285)s(s +0.5)G c (s)=(10) a s+2.38 s+8.34 ba s+0.1 s+0.0285 b 1 bT 2 =1 3.503 *10=0.0285T 2 =10 T 2 =10T 2 17magnitude 70.99, -1°6angle 60°T 2 =1017magnitude 70.98, -1.5°6angle 60°T 2 =5 Openmirrors.comSection 6–8 / Lag-Lead Compensation 341The dominant closed-loop poles are located at The other closed-loop poles are located at Since the closed-loop pole at is very close to a zero at they almost cancel each other.Thus, the effect of this closed-loop pole is very small.The remaining closed-loop pole does not quite cancel the zero at The effect of this zero is to cause a larger overshoot in the step response than a similar system without such a zero. The unit-stepresponse curves of the compensated and uncompensated systems are shown in Figure 6–59(a).The unit-ramp response curves for both systems are depicted in Figure 6–59(b).s=-2.4. (s=-3.8604)s=-0.1, s=-0.1003s=-0.1003; s=-3.8604s=-2.4539 ;j4.3099 t Sec1 0.5 0 3.5 4.5 3 4 5 2 1.5 2.5 (a)Outputs 0.40.81.8 01.2 0.61 0.21.41.6Unit-Step Responses of Compensated and Uncompensated Systems Uncompensated systemCompensated system t Sec0.5 03 4 2.5 3.5 1.5 1 2 (b)Outputs 1.52.54 0.5 03.5 23 1Unit-Ramp Responses of Compensated and Uncompensated Systems Uncompensated system Compensated systemFigure 6–59 (a) Unit-stepresponse curves for the compensated and uncompensatedsystems;(b) unit-rampresponse curves for both systems.342 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method The maximum overshoot in the step response of the compensated system is approximately 38%. (This is much larger than the maximum overshoot of 21 %in the design presented in Exam- ple 6–8.) It is possible to decrease the maximum overshoot by a small amount from 38 %, but not to 20 %ifg=bis required, as in this example. Note that by not requiring g=b, we have an ad- ditional parameter to play with and thus can reduce the maximum overshoot. 6–9 PARALLEL COMPENSATION Thus far we have presented series compensation techniques using lead, lag, or lag–lead compensators. In this section we discuss parallel compensation technique. Because in the parallel compensation design the controller (or compensator) is in a minor loop, the de- sign may seem to be more complicated than in the series compensation case. It is, how- ever, not complicated if we rewrite the characteristic equation to be of the same form as the characteristic equation for the series compensated system. In this section we pres- ent a simple design problem involving parallel compensation. Basic Principle for Designing Parallel Compensated System. Referring to Figure 6–60(a), the closed-loop transfer function for the system with series compensa- tion is The characteristic equation is Given GandH, the design problem becomes that of determining the compensator G c that satisfies the given specification.1+G c GH =0C R=G c G 1+G c GH G 1 (s) G 2 (s) H(s)G c (s) G c (s) G(s) H(s) (a) (b) +– +– +– C RRC Figure 6–60 (a) Series compensation; (b) parallel or feedback compensation. Openmirrors.comSection 6–9 / Parallel Compensation 343The closed-loop transfer function for the system with parallel compensation [Figure 6–60(b)] is The characteristic equation is By dividing this characteristic equation by the sum of the terms that do not involve Gc, we obtain (6–25) If we define then Equation (6–25) becomes Since Gfis a fixed transfer function, the design of Gcbecomes the same as the case of series compensation. Hence the same design approach applies to the parallel compen-sated system. Velocity Feedback Systems. A velocity feedback system (tachometer feedback system) is an example of parallel compensated systems.The controller (or compensator)in such a system is a gain element.The gain of the feedback element in a minor loop mustbe determined properly so that the entire system satisfies the given design specifica-tions.The characteristic of such a velocity feedback system is that the variable parame-ter does not appear as a multiplying factor in the open-loop transfer function, so thatdirect application of the root-locus design technique is not possible. However, by rewrit-ing the characteristic equation such that the variable parameter appears as a multiply-ing factor, then the root-locus approach to the design is possible. An example of control system design using parallel compensation technique is pre- sented in Example 6–10. EXAMPLE 6–10 Consider the system shown in Figure 6–61. Draw a root-locus diagram.Then determine the value ofksuch that the damping ratio of the dominant closed-loop poles is 0.4. Here the system involves velocity feedback. The open-loop transfer function is Open-loop transfer function =20 s(s+1)(s +4)+20ks1+Gc Gf=0Gf=G2 1+G1 G2 H1+Gc G2 1+G1 G2 H=01+G1 G2 H+G2 Gc=0C R=G1 G2 1+G2 Gc+G1 G2 H C(s) R(s)20 (s+1) (s+ 4)1 s+–+– k Figure 6–61 Control system.344 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method Notice that the adjustable variable kdoes not appear as a multiplying factor. The characteristic equation for the system is (6–26) Define Then Equation (6–26) becomes (6–27) Dividing both sides of Equation (6–27) by the sum of the terms that do not contain K, we get or (6–28) Equation (6–28) is of the form of Equation (6–11). We shall now sketch the root loci of the system given by Equation (6–28). Notice that the open-loop poles are located at s=j2, s=–j2, s=–5, and the open-loop zero is located at s=0. The root locus exists on the real axis between 0 and –5.Since we have The intersection of the asymptotes with the real axis can be found from as The angle of departure (angle u) from the pole at s=j2 is obtained as follows: Thus, the angle of departure from the pole s=j2 is 158.2°. Figure 6–62 shows a root-locus plot for the system. Notice that two branches of the root locus originate from the poles at and terminate on the zeros at infinity. The remaining one branch originates from the pole at s=–5 and terminates on the zero at s=0. Note that the closed-loop poles with z=0.4 must lie on straight lines passing through the origin and making the angles with the negative real axis. In the present case, there are two intersections of the root-locus branch in the upper half splane and the straight line of angle 66.42°. Thus, two values of Kwill give the damping ratio zof the closed-loop poles equal to 0.4.At point P, the value of Kis Hence k=K 20=0.4490 at point PK= 2 (s+j2)(s -j2)(s +5) s 2 s=-1.0490 +j2.4065 =8.9801;66.42 °s=;j2u=180°-90°-21.8°+90°=158.2 °s=-2.5lim sSq Ks s 3 +5s 2 +4s+20=lim sSq K s 2 +5s+p=lim sSq K (s+2.5) 2 Angles of asymptote =;180°(2k +1) 2=; 90°lim sSq Ks (s+j2)(s -j2)(s +5)=lim sSq K s 2 1+Ks (s+j2)(s -j2)(s +5)=01+Ks s 3 +5s 2 +4s+20=0s 3 +5s 2 +4s+Ks+20=020k =Ks 3 +5s 2 +4s+20ks+20=0 Openmirrors.comSection 6–9 / Parallel Compensation 345At point Q, the value of Kis Hence Thus, we have two solutions for this problem. For k=0.4490, the three closed-loop poles are located at For k=1.4130, the three closed-loop poles are located at It is important to point out that the zero at the origin is the open-loop zero, but not the closed-loop zero. This is evident, because the original system shown in Figure 6–61 does not have a closed-loop zero, since G(s) R(s)=20 s(s+1)(s +4)+20(1 +ks)s=-2.1589 +j4.9652, s=-2.1589 -j4.9652, s=-0.6823s=-1.0490 +j2.4065, s=-1.0490 -j2.4065, s=-2.9021k=K 20=1.4130 at point QK=2(s+j2)(s -j2)(s +5) s2 s=-2.1589 +j4.9652=28.260jv j6 j5 j4 j3 j2 j1 –j6–j5–j4–j3–j2–j1s –11 0 –2 –3 –4 –5 –6 –7s=–2.1589 +j4.9652Q Ps = –1.0490 +j2.4065 s=–2.902166.42 ° Figure 6–62 Root-locus plot forthe system shown in Figure 6–61.346 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method The open-loop zero at s=0 was introduced in the process of modifying the characteristic equa- tion such that the adjustable variable K=20k was to appear as a multiplying factor. We have obtained two different values of kto satisfy the requirement that the damping ratio of the dominant closed-loop poles be equal to 0.4. The closed-loop transfer function with k=0.4490 is given by The closed-loop transfer function with k= 1.4130 is given by Notice that the system with k=0.4490 has a pair of dominant complex-conjugate closed-loop poles, while in the system with k=1.4130 the real closed-loop pole at s=–0.6823 is dominant, and the complex-conjugate closed-loop poles are not dominant. In this case, the response char- acteristic is primarily determined by the real closed-loop pole. Let us compare the unit-step responses of both systems. MATLAB Program 6–14 may be used for plotting the unit-step response curves in one diagram. The resulting unit-step response curves for k=0.4490 andc 2 (t)fork=1.4130Dare shown in Figure 6–63. Cc 1 (t) =20 (s+2.1589 +j4.9652)(s +2.1589 -j4.9652)(s +0.6823) C(s) R(s)=20 s 3 +5s 2 +32.26s +20 =20 (s+1.0490 +j2.4065)(s +1.0490 -j2.4065)(s +2.9021) C(s) R(s)=20 s 3 +5s 2 +12.98s +20 MATLAB Program 6–14 % ---------- Unit-step response ---------- % ***** Enter numerators and denominators of systems with % k = 0.4490 and k = 1.4130, respectively. ***** num1 = [20]; den1 = [1 5 12.98 20]; num2 = [20]; den2 = [1 5 32.26 20]; t = 0:0.1:10; c1 = step(num1,den1,t); c2 = step(num2,den2,t); plot(t,c1,t,c2) text(2.5,1.12,'k = 0.4490') text(3.7,0.85,'k = 1.4130') grid title('Unit-step Responses of Two Systems') xlabel('t Sec') ylabel('Outputs c1 and c2') Openmirrors.comExample Problems and Solutions 347From Figure 6–63 we notice that the response of the system with k=0.4490 is oscillatory. (The effect of the closed-loop pole at s=–2.9021 on the unit-step response is small.) For the system with k=1.4130, the oscillations due to the closed-loop poles at damp out much faster than purely exponential response due to the closed-loop pole at s=–0.6823. The system with k=0.4490 (which exhibits a faster response with relatively small overshoot) has a much better response characteristic than the system with k=1.4130 (which exhibits a slow overdamped response). Therefore, we should choose k=0.4490 for the present system. EXAMPLE PROBLEMS AND SOLUTIONS A–6–1. Sketch the root loci for the system shown in Figure 6–64(a). (The gain Kis assumed to be posi- tive.) Observe that for small or large values of Kthe system is overdamped and for medium val- ues of Kit is underdamped. Solution. The procedure for plotting the root loci is as follows: 1.Locate the open-loop poles and zeros on the complex plane. Root loci exist on the negative real axis between 0 and –1and between –2and–3. 2.The number of open-loop poles and that of finite zeros are the same. This means that there are no asymptotes in the complex region of the splane. 3.Determine the breakaway and break-in points. The characteristic equation for the system is or K=-s(s+1) (s+2)(s +3)1+K(s +2)(s +3) s(s+1)=0s=-2.1589 ;j4.9652t Sec01 1 0 5 2 3 4 6 7 8 9Outputs c1 and c21.2 0.4 00.6 0.21 0.8Unit-Step Responses of Two Systems k= 1.4130k= 0.4490 Figure 6–63 Unit-step responsecurves for the system shown in Figure 6–61 when the dampingratiozof the dominant closed-loop poles is setequal to 0.4. (Two possible values of k give the dampingratiozequal to 0.4.)348 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method The breakaway and break-in points are determined from as follows: Notice that both points are on root loci. Therefore, they are actual breakaway or break-in points. At point s=–0.634, the value of Kis Similarly, at s=–2.366, (Because point s=–0.634 lies between two poles, it is a breakaway point, and because point s=–2.366 lies between two zeros, it is a break-in point.)K=-(–2.366)(–1.366) (–0.366)(0.634)=14K=-(-0.634)(0.366) (1.366)(2.366)=0.0718s=-0.634, s=-2.366 =0 =- 4(s+0.634)(s +2.366) C(s+2)(s +3)D 2 dK ds=- (2s+1)(s +2)(s +3)-s(s+1)(2s +5) C(s+2)(s +3)D 2 (a) (b)R(s) C(s)jv sK= 0.0718 K= 14 –3– 2– 1 0 1j1j2 –j1 –j2 K(s+ 2)s+ 3 s(s+ 1) +– Figure 6–64 (a) Control system; (b) root-locus plot. Openmirrors.comExample Problems and Solutions 3494.Determine a sufficient number of points that satisfy the angle condition. (It can be found that the root loci involve a circle with center at –1.5 that passes through the breakaway and break-in points.) The root-locus plot for this system is shown in Figure 6–64(b). Note that this system is stable for any positive value of Ksince all the root loci lie in the left- half splane. Small values of K (0<K<0.0718) correspond to an overdamped system. Medium values ofK (0.0718<K<14) correspond to an underdamped system. Finally, large values of K (14<K) correspond to an overdamped system. With a large value of K, the steady state can be reached in much shorter time than with a small value of K. The value of Kshould be adjusted so that system performance is optimum according to a given performance index. A–6–2. Sketch the root loci for the system shown in Figure 6–65(a). Solution. A root locus exists on the real axis between points s=–1 and s=–3.6. The asymp- totes can be determined as follows: The intersection of the asymptotes and the real axis is found from s=-0+0+3.6-1 3-1=-1.3Angles of asymptotes =;180°(2k +1) 3-1=90°, -90° (a) (b)jv s –4 –3 –20 1j3 j1 –j1 –j3–1 –j2j2 K(s+ 1) s 2 (s+ 3.6) +– Figure 6–65 (a) Control system; (b) root-locus plot. Openmirrors.com350 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method Since the characteristic equation is we have The breakaway and break-in points are found from or from which we get Point s=0 corresponds to the actual breakaway point. But points are neither breakaway nor break-in points, because the corresponding gain values Kbecome complex quantities. To check the points where root-locus branches may cross the imaginary axis, substitute into the characteristic equation, yielding. or Notice that this equation can be satisfied only if v=0, K=0. Because of the presence of a dou- ble pole at the origin, the root locus is tangent to the jvaxis at v=0. The root-locus branches do not cross the jvaxis. Figure 6–65(b) is a sketch of the root loci for this system. A–6–3. Sketch the root loci for the system shown in Figure 6–66(a). Solution. A root locus exists on the real axis between point s=–0.4 ands=–3.6. The angles of asymptotes can be found as follows: The intersection of the asymptotes and the real axis is obtained from Next we shall find the breakaway points. Since the characteristic equation is we have K=-s 3 +3.6s 2 s+0.4s 3 +3.6s 2 +Ks+0.4K =0s=-0+0+3.6-0.4 3-1=-1.6Angles of asymptotes =;180°(2k +1) 3-1=90°, -90°AK-3.6v 2 B+jvAK-v 2 B=0(jv) 3 +3.6(jv) 2 +Kjv+K=0s=jvs=1.65 ;j0.9367s=0, s=-1.65 +j0.9367, s=-1.65 -j0.9367s 3 +3.3s 2 +3.6s =0dK ds=-A3s 2 +7.2sB(s+1)-As 3 +3.6s 2 B (s+1) 2 =0K=-s 3 +3.6s 2 s+1s 3 +3.6s 2 +K(s +1)=0 Openmirrors.comExample Problems and Solutions 351The breakaway and break-in points are found from from which we get or Thus, the breakaway or break-in points are at s=0 ands=–1.2. Note that s=–1.2 is a double root.When a double root occurs in at point s=–1.2, at this point.The value of gain Kat point s=–1.2 is This means that with K=4.32 the characteristic equation has a triple root at point s=–1.2. This can be easily verified as follows: s3+3.6s2+4.32s +1.728 =(s+1.2)3=0K=-s3+3.6s2 s+42 s=-1.2=4.32d2K/H20862Ads2B=0 dK /H20862ds=0s(s+1.2)2=0s3+2.4s2+1.44s =0dK ds=-A3s2+7.2sB(s+0.4) -As3+3.6s2B (s+0.4)2=0(a) (b)jv s –4 –3 –20 1j3 j1 –j1 –j3–j2j2 K(s+ 0.4) s2(s+ 3.6)–1 –60°60° +– Figure 6–66 (a) Control system; (b) root-locus plot.352 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method Hence, three root-locus branches meet at point s=–1.2. The angles of departures at point s=–1.2 of the root locus branches that approach the asymptotes are that is, 60° and –60°. (See Problem A–6–4 .) Finally, we shall examine if root-locus branches cross the imaginary axis. By substituting s=jv into the characteristic equation, we have or This equation can be satisfied only if v=0, K=0. At point v=0, the root locus is tangent to thejvaxis because of the presence of a double pole at the origin.There are no points where root- locus branches cross the imaginary axis. A sketch of the root loci for this system is shown in Figure 6–66(b). A–6–4. Referring to Problem A–6–3 , obtain the equations for the root-locus branches for the system shown in Figure 6–66(a). Show that the root-locus branches cross the real axis at the breakaway point at angles ;60°. Solution. The equations for the root-locus branches can be obtained from the angle condition which can be rewritten as By substituting we obtain or By rearranging, we have Taking tangents of both sides of this last equation, and noting that we obtain which can be simplified to vs-v(s+0.4) (s+0.4)s+v 2 =v(s+3.6) +vs s(s+3.6) -v 2 v s+0.4-v s 1+v s+0.4v s=v s+v s+3.6 1-v sv s+3.6tan c tan -1 a v s+3.6 b ;180°(2k +1) d =v s+3.6tan -1 a v s+0.4 b -tan -1 a v s b =tan -1 a v s b +tan -1 a v s+3.6 b ;180°(2k+1)tan -1 a v s+0.4 b -2tan -1 a v s b -tan -1 a v s+3.6 b =;180°(2k +1) / s+jv+0.4 -2 / s+jv / s+jv+3.6 =;180°(2k +1)s=s+jv, / s+0.4 -2 / s / s+3.6 =;180°(2k +1) n K(s +0.4) s 2 (s+3.6) =;180°(2k +1)A0.4K -3.6v 2 B+jvAK-v 2 B=0(jv) 3 +3.6(jv) 2 +K(jv)+0.4K =0;180°/H208623, Openmirrors.comExample Problems and Solutions 353or which can be further simplified to For sZ–1.6, we may write this last equation as which gives the equations for the root locus as follows: The equation v=0 represents the real axis. The root locus for 0 /H11349K/H11349qis between points s=–0.4 and s=–3.6. (The real axis other than this line segment and the origin s=0 corre- sponds to the root locus for –q/H11349K<0. ) The equations (6–29) represent the complex branches for 0 /H11349K/H11349q. These two branches lie between s=–1.6 and s=0 . [See Figure 6–66(b).] The slopes of the complex root-locus branches at the breakaway point (s=–1.2) can be found by evaluating of Equation (6–29) at point s=–1.2. Since the root-locus branches intersect the real axis with angles A–6–5. Consider the system shown in Figure 6–67(a). Sketch the root loci for the system. Observe that for small or large values of Kthe system is underdamped and for medium values of Kit is overdamped. Solution. A root locus exists on the real axis between the origin and –q. The angles of asymp- totes of the root-locus branches are obtained as The intersection of the asymptotes and the real axis is located on the real axis at The breakaway and break-in points are found from Since the characteristic equation is s3+4s2+5s+K=0dK /H20862ds=0.s=-0+2+2 3=-1.3333Angles of asymptotes =;180°(2k +1) 3=60°, -60°, -180°;60°. tan-113=60°,dv ds2 s=-1.2=;A-s s+1.62 s=-1.2=;A1.2 0.4=;13dv/H20862dsv=;(s+1.2)A-s s+1.6 v=-(s+1.2)A-s s+1.6 v=(s+1.2)A-s s+1.6 v=0vcv-(s+1.2)A-s s+1.6dcv+(s+1.2)A-s s+1.6d=0vCs(s+1.2)2+(s+1.6)v2D=0vAs3+2.4s2+1.44s+1.6v2+sv2B=0354 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method we have Now we set which yields Since these points are on root loci, they are actual breakaway or break-in points. (At point s=–1, the value of Kis 2, and at point s=–1.6667, the value of Kis 1.852.) The angle of departure from a complex pole in the upper-half splane is obtained from or The root-locus branch from the complex pole in the upper-half splane breaks into the real axis ats=–1.6667. Next we determine the points where root-locus branches cross the imaginary axis. By substi- tuting s=jvinto the characteristic equation, we have or from which we obtain v=;15 , K=20 or v=0, K=0AK-4v 2 B+jvA5-v 2 B=0(jv) 3 +4(jv) 2 +5(jv)+K=0u=-63.43 °u=180°-153.43 °-90°s=-1, s=-1.6667dK ds=-A3s 2 +8s+5B=0K=-As 3 +4s 2 +5sB (a) (b)K s(s 2 + 4s+ 5) jv s –4 –3 –20 1j3 j2 j1 –j2–j1 –j3–1K= 2 K= 1.852 +– Figure 6–67 (a) Control system; (b) root-locus plot. Openmirrors.comExample Problems and Solutions 355Root-locus branches cross the imaginary axis at and The root-locus branch on the real axis touches the jvaxis at v=0. A sketch of the root loci for the system is shown in Figure 6–67(b). Note that since this system is of third order, there are three closed-loop poles. The nature of the system response to a given input depends on the locations of the closed-loop poles. For 0<K<1.852, there are a set of complex-conjugate closed-loop poles and a real closed- loop pole. For 1.852 /H11349K/H113492, there are three real closed-loop poles. For example, the closed- loop poles are located at For 2<K, there are a set of complex-conjugate closed-loop poles and a real closed-loop pole. Thus, small values of K (0<K<1.852) correspond to an underdamped system. (Since the real closed-loop pole dominates, only a small ripple may show up in the transient response.) Mediumvalues of K(1.852 /H11349K/H113492) correspond to an overdamped system. Large values of K (2<K) correspond to an underdamped system.With a large value of K, the system responds much faster than with a smaller value of K. A–6–6. Sketch the root loci for the system shown in Figure 6–68(a). Solution. The open-loop poles are located at s=0, s=–1, s=–2+j3, ands=–2-j3. A root locus exists on the real axis between points s=0 and s=–1. The angles of the asymptotes are found as follows: Angles of asymptotes =;180°(2k +1) 4=45°, -45°, 135 °, -135° s=-1, s=-1, s=-2, for K=2 s=-1.667, s=-1.667, s=-0.667, for K=1.852v=-15 . v=15 (a) (b)jv s –4–3 –6–53 –22 01j3j4j5 j1 –j1 –j3 –j4 –j5–1 –j2j2 K s(s+ 1) (s2+ 4s+13)+– Figure 6–68 (a) Control system; (b) root-locus plot.356 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method The intersection of the asymptotes and the real axis is found from The breakaway and break-in points are found from Noting that we have from which we get Point s=–0.467 is on a root locus. Therefore, it is an actual breakaway point. The gain values K corresponding to points are complex quantities. Since the gain values are not real positive, these points are neither breakaway nor break-in points. The angle of departure from the complex pole in the upper-half splane is or Next we shall find the points where root loci may cross the jvaxis. Since the characteristic equation is by substituting s=jvinto it we obtain or from which we obtain The root-locus branches that extend to the right-half splane cross the imaginary axis at Also, the root-locus branch on the real axis touches the imaginary axis at Figure 6–68(b) shows a sketch of the root loci for the system. Notice that each root-locus branch that extends to the right-half splane crosses its own asymptote.v=0. v=;1.6125.v=; 1.6125, K=37.44 or v=0, K=0AK+v 4 -17v 2 B+jvA13-5v 2 B=0(jv) 4 +5(jv) 3 +17(jv) 2 +13(jv)+K=0s 4 +5s 3 +17s 2 +13s +K=0u=-142.13 °u=180°-123.69 °-108.44 °-90°s=-1.642 ;j2.067s=-0.467, s=-1.642 +j2.067, s=-1.642 -j2.067dK ds=-A4s 3 +15s 2 +34s +13B=0K=-s(s+1)As 2 +4s+13B=-As 4 +5s 3 +17s 2 +13sBdK /H20862ds=0.s=-0+1+2+2 4=-1.25 Openmirrors.comExample Problems and Solutions 357A–6–7. Sketch the root loci of the control system shown in Figure 6–69(a). Determine the range of gain Kfor stability. Solution. Open-loop poles are located at s=1, and A root locus exists on the real axis between points s=1 and s=– q. The asymptotes of the root-locus branches are found as follows: The intersection of the asymptotes and the real axis is obtained as The breakaway and break-in points can be located from Since we have which yields (s+1)2=0dK ds=-A3s2+6s+3B=0K=-(s-1)As2+4s+7B=-As3+3s2+3s-7BdK /H20862ds=0.s=--1+2+2 3=-1Angles of asymptotes =;180°(2k +1) 3=60°, -60°, 180 °s=-2-j13. s=-2+j13, jv sj3 j2 j1 (a) (b)K (s– 1) (s2+ 4s+ 7) –j3–j1–4 –3 –20 1K= 7K= 8K= 16 –1 +––j2 Figure 6–69 (a) Control system; (b) root-locus plot.358 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method Thus the equation dK /H20862ds=0 has a double root at s=–1. (This means that the characteristic equation has a triple root at s=–1. ) The breakaway point is located at s=–1. Three root-locus branches meet at this breakaway point.The angles of departure of the branches at the breakaway point are ;180° /H208623—that is, 60° and –60°. We shall next determine the points where root-locus branches may cross the imaginary axis. Noting that the characteristic equation is or we substitute into it and obtain By rewriting this last equation, we have This equation is satisfied when The root-locus branches cross the imaginary axis at (where K=16 ) and (where K=7 ). Since the value of gain Kat the origin is 7, the range of gain value Kfor stability is Figure 6–69(b) shows a sketch of the root loci for the system. Notice that all branches consist of parts of straight lines. The fact that the root-locus branches consist of straight lines can be verified as follows: Since the angle condition is we have By substituting into this last equation, or which can be rewritten as tan -1 a v+13 s+2 b +tan -1 a v-13 s+2 b =-tan -1 a v s-1 b ;180°(2k+1) / s+2+jAv+13 B + / s+2+jAv-13 B =- / s-1+jv ;180°(2k +1) / s-1+jv + / s+2+jv+j13 + / s+2+jv-j13 =;180°(2k +1)s=s+jv- / s-1 / s+2+j13 / s+2-j13 =;180°(2k +1) n K (s-1)As+2+j13 BAs+2-j13 B =;180°(2k +1)76K616v=0 v=;13 v=;13 , K=7+3v 2 =16 or v=0, K=7AK-7-3v 2 B+jvA3-v 2 B=0(jv) 3 +3(jv) 2 +3(jv)-7+K=0s=jvs 3 +3s 2 +3s-7+K=0(s-1)As 2 +4s+7B+K=0 Openmirrors.comExample Problems and Solutions 359Taking tangents of both sides of this last equation, we obtain or which can be simplified to or Further simplification of this last equation yields which defines three lines: Thus the root-locus branches consist of three lines. Note that the root loci for K>0 consist of portions of the straight lines as shown in Figure 6–69(b). (Note that each straight line starts from an open-loop pole and extends to infinity in the direction of 180°, 60°, or –60° measured from the real axis.) The remaining portion of each straight line corresponds to K<0. A–6–8. Consider a unity-feedback control system with the following feedforward transfer function: Using MATLAB, plot the root loci and their asymptotes. Solution. We shall plot the root loci and asymptotes on one diagram. Since the feedforward trans- fer function is given by the equation for the asymptotes may be obtained as follows: Noting that the equation for the asymptotes may be given by Ga(s)=K (s+1)3lim sSqK s3+3s2+2s/H11216lim sSqK s3+3s2+3s+1=K (s+1)3=K s3+3s2+2sG(s) =K s(s+1)(s+2)G(s) =K s(s+1)(s+2)v=0, s+1+1 13 v=0, s+1-1 13 v=0vas+1+1 13vbas+1-1 13vb=0vA3s2+6s+3-v2B=02v(s+2)(s-1)=-vAs2+4s+7-v2B2v(s+2) s2+4s+4-v2+3=-v s-1v+13 s+2+v-13 s+2 1-av+13 s+2bav-13 s+2b=-v s-1360 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method Hence, for the system we have num = [1] den = [1 3 2 0] and for the asymptotes, numa = [1] dena = [1 3 3 1] In using the following root-locus and plot commands r = rlocus(num,den) a = rlocus(numa,dena) plot([r a]) the number of rows of rand that of amust be the same. To ensure this, we include the gain con- stant Kin the commands. For example, K1 = 0:0.1:0.3; K2 = 0.3:0.005:0.5: K3 = 0.5:0.5:10; K4 = 10:5:100; K = [K1 K2 K3 K4] r = rlocus(num,den,K) a = rlocus(numa,dena,K) y = [r a] plot(y, '-') MATLAB Program 6–15 will generate a plot of root loci and their asymptotes as shown in Figure 6–70. MATLAB Program 6–15 % ---------- Root-Locus Plots ---------- num = [1]; den = [1 3 2 0]; numa = [1]; dena = [1 3 3 1]; K1 = 0:0.1:0.3; K2 = 0.3:0.005:0.5; K3 = 0.5:0.5:10; K4 = 10:5:100; K = [K1 K2 K3 K4]; r = rlocus(num,den,K); a = rlocus(numa,dena,K); y = [r a]; plot(y,'-') v = [-4 4 -4 4]; axis(v) grid title('Root-Locus Plot of G(s) = K/[s(s + 1)(s + 2)] and Asymptotes') xlabel('Real Axis') ylabel('Imag Axis') % ***** Manually draw open-loop poles in the hard copy ***** Openmirrors.comExample Problems and Solutions 361Drawing two or more plots in one diagram can also be accomplished by using the hold com- mand. MATLAB Program 6–16 uses the hold command. The resulting root-locus plot is shown in Figure 6–71.Root-Locus Plot of G(s)=K/[(s(s+1)(s+2)] and AsymptotesImag Axis4 –403 2 1 –1 –2 –3 Real Axis–4 1 –3 –2 –1 0 4 2 3 Figure 6–70 Root-locus plot. MATLAB Program 6–16 % ------------ Root-Locus Plots ------------ num = [1];den = [1 3 2 0];numa = [1];dena = [1 3 3 1];K1 = 0:0.1:0.3;K2 = 0.3:0.005:0.5;K3 = 0.5:0.5:10;K4 = 10:5:100;K = [K1 K2 K3 K4];r = rlocus(num,den,K);a = rlocus(numa,dena,K);plot(r,'o')holdCurrent plot heldplot(a,'-')v = [-4 4 -4 4]; axis(v)gridtitle('Root-Locus Plot of G(s) = K/[s(s+1)(s+2)] and Asymptotes')xlabel('Real Axis')ylabel('Imag Axis')362 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method A–6–9. Plot the root loci and asymptotes for a unity-feedback system with the following feedforward transfer function: Determine the exact points where the root loci cross the jvaxis Solution. The feedforward transfer function G(s) can be written as Note that as sapproaches infinity, can be written as where we used the following formula: The expression gives the equation for the asymptotes.lim sSq G(s) =lim sSq K (s+1) 4 (s+a) 4 =s 4 +4as 3 +6a 2 s 2 +4a 3 s+a 4 =lim sSq K (s+1) 4 /H11216lim sSq K s 4 +4s 3 +6s 2 +4s+1lim sSq G(s) =lim sSq K s 4 +4s 3 +11s 2 +14s+10lim sSq G(s)G(s) =K s 4 +4s 3 +11s 2 +14s+10G(s) =K (s 2 +2s+2)(s 2 +2s+5) Root-Locus Plot of G(s)=K/[s(s+1)(s+2)] and Aysmptotes Imag Axis 4 –40 3 2 1 –1 –2 –3 Real Axis–4 1 –3 –2 –1 04 2 3 Figure 6–71 Root-locus plot. Openmirrors.comExample Problems and Solutions 363The MATLAB program to plot the root loci of G(s) and the asymptotes is given in MATLAB Program 6–17. Note that the numerator and denominator for G(s) are num = [1] den = [1 4 11 14 10] For the numerator and denominator of the asymptotes we used numa = [1] dena = [1 4 6 4 1] Figure 6–72 shows the plot of the root loci and asymptotes. Since the characteristic equation for the system is (s2+2s+2)(s2+2s+5)+K=0lim sSqG(s) MATLAB Program 6–17 % ***** Root-locus plot ***** num = [1]; den = [1 4 11 14 10];numa = [1];dena = [1 4 6 4 1];r = rlocus(num,den);plot(r,'-')holdCurrent plot heldplot(r,'o')rlocus(numa,dena);v = [-6 4 -5 5]; axis(v); axis('square')gridtitle('Plot of Root Loci and Asymptotes') 4 2 0 −6 −4 −2015 3 24 −2−1 −5−4−3 Real AxisImag AxisPlot of Root Loci and Asymptotes Figure 6–72 Plot of root loci andasymptotes.364 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method the points where the root loci cross the imaginary axis can be found by substituting s=jvwith the characteristic equation as follows: and equating the imaginary part to zero. The result is Thus the exact points where the root loci cross the jvaxis are By equating the real part to zero, we get the gain value Kat the crossing points to be 16.25. A–6–10. Consider a unity-feedback control system with the feed-forward transfer function G(s) given by Plot a root-locus diagram with MATLAB. Solution. The feedforward transfer function G(s) can be written as A possible MATLAB program to plot a root-locus diagram is shown in MATLAB Program 6–18. The resulting root-locus plot is shown in Figure 6–73.G(s) =K(s +1) s 4 +4s 3 +11s 2 +14s+10G(s) =K(s +1) (s 2 +2s+2)(s 2 +2s+5)v=;1.8708.v=;1.8708=(v 4 -11v 2 +10+K)+j(-4v 3 +14v)=0[(jv) 2 +2jv+2][(jv) 2 +2jv+5]+K MATLAB Program 6–18 num = [1 1]; den = [1 4 11 14 10]; K1 = 0:0.1:2; K2 = 2:0.0.2:2.5; K3 = 2.5:0.5:10; K4 = 10:1:50; K = [K1 K2 K3 K4] r = rlocus(num,den,K); plot(r, 'o') v = [-8 2 -5 5]; axis(v); axis('square') grid title('Root-Locus Plot of G(s) = K(s+1)/[(s^2+2s+2)(s^2+2s+5)]') xlabel('Real Axis') ylabel('Imag Axis') Openmirrors.comExample Problems and Solutions 365A–6–11. Obtain the transfer function of the mechanical system shown in Figure 6–74. Assume that the displacement xiis the input and displacement xois the output of the system. Solution. From the diagram we obtain the following equations of motion: Taking the Laplace transforms of these two equations, assuming zero initial conditions, and then eliminating Y(s), we obtain This is the transfer function between and By defining we obtain This mechanical system is a mechanical lead network.Xo(s) Xi(s)=aTs+1 aTs+1=s+1 T s+1 aTb1 k=T, b2 b1+b2=a61Xi(s). Xo(s)Xo(s) Xi(s)=b2 b1+b2b1 ks+1 b2 b1+b2b1 ks+1 b1Ax# o-y#B=ky b2Ax# i-x# oB=b1Ax# o-y#B−3 −2 −10 1 −4 −5 −8 2 −7 −6013 245 −2−1 −5−4−3 Real AxisImag AxisRoot-Locus Plot of G(s) = K(s + 1)/[( s2 + 2 s + 2)( s2 + 2 s + 5)] Figure 6–73 Plot of root loci. b2 b1 kyxi xo Figure 6–74 Mechanical system.366 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method A–6–12. Obtain the transfer function of the mechanical system shown in Figure 6–75.Assume that the dis- placement x i is the input and displacement x o is the output. Solution. The equations of motion for this system are By taking the Laplace transforms of these two equations, assuming zero initial conditions, we obtain If we eliminate Y(s) from the last two equations, the transfer function can be obtained as Define Ifk 1 ,k 2 , b 1 ,andb 2 are chosen such that there exists a ıthat satisfies the following equation: (6–30) then can be obtained as [Note that depending on the choice of k 1 , k 2 , b 1 , and b 2 ,there does not exist a ı that satisfies Equation (6–30).] If such a ı exists and if for a given s 1 (where s=s 1 is one of the dominant closed-loop poles of the control system to which we wish to use this mechanical device) the following conditions are satisfied: then the mechanical system shown in Figure 6–75 acts as a lag–lead compensator.-5°6 n s 1 +1 T 2 s 1 +1 bT 2 60° 4 s 1 +1 T 2 s 1 +1 bT 2 4 /H112161, X o (s) X i (s)=AT 1 s+1BAT 2 s+1B a T 1 b s+1 b AbT 2 s+1B= a s+1 T 1 ba s+1 T 2 b a s+b T 1 ba s+1 bT 2 b X o (s) /H20862X i (s)b 1 k 1 +b 2 k 2 +b 1 k 2 =T 1 b+bT 2 (b71)T 1 =b 1 k 1 ,T 2 =b 2 k 2 , X o (s) X i (s)= a b 1 k 1 s+1 ba b 2 k 2 s+1 b a b 1 k 1 s+1 ba b 2 k 2 s+1 b +b 1 k 2 sX o (s) /H20862X i (s) b 1 CsX o (s)-sY(s)D=k 1 Y(s) b 2 CsX i (s)-sX o (s)D+k 2 CX i (s)-X o (s)D=b 1 CsX o (s)-sY(s)Db 1 Ax# o -y#B=k 1 yb 2 Ax# i -x# o B+k 2 Ax i -x o B=b 1 Ax# o -y#B b 1 b 2 yx i x o k 2 k 1 Figure 6–75 Mechanical system. Openmirrors.comExample Problems and Solutions 367A–6–13. Consider the model for a space-vehicle control system shown in Figure 6–76. Design a lead compensator Gc(s)such that the damping ratio zand the undamped natural frequency vnof the dominant closed-loop poles are 0.5 and 2 rad /H20862sec, respectively. Solution. First Attempt: Assume the lead compensator Gc(s)to be From the given specifications, z=0.5 and vn=2 rad /H20862sec, the dominant closed-loop poles must be located at We first calculate the angle deficiency at this closed-loop pole. This angle deficiency must be compensated by the lead compensator. There are many ways to determine the locations of the pole and zero of the lead network. Let us choose the zero of the compensator at s=–1. Then, referring to Figure 6–77, we have the following equation: 1.73205 x-1=tan (90°-70.8934 °)=0.34641 =-70.8934 ° Angle deficiency =-120°-120°-10.8934 °+180°s=-1;j13Gc(s)=Kc±s+1 T s+1 aT≤ (06a61)R(s) C(s) Lead compensatorGc(s) Space vehicle Sensor1 s2 1 0.1s+ 1+– Figure 6–76 Space-vehicle controlsystem. jv s –1019.1066 °70.8934 °j1.73205 xFigure 6–77 Determination of thepole of the leadnetwork.368 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method or Hence, The value of can be determined from the magnitude condition as follows: Thus Since the open-loop transfer function becomes a root-locus plot of the compensated system can be obtained easily with MATLAB by entering num anddenand using rlocus command. The result is shown in Figure 6–78. =11.2(s +1) 0.1s 4 +1.6s 3 +6s 2 G c (s)G(s)H(s) =11.2 s+1 (s+6)s 2 (0.1s +1)G c (s)=11.2s+1 s+6K c = 2 (s+6)s 2 (0.1s +1) s+1 2 s=-1+j13 =11.2000K c 2 s+1 s+61 s 2 1 0.1s +1 2 s=-1+j13 =1K c G c (s)=K c s+1 s+6x=1+1.73205 0.34641=6 Real Axis–10 5 10 –5 0 Imag Axis 0 10 –5 5 –10 Root-Locus Plot of Compensated System Figure 6–78 Root-locus plot of the compensated system. Openmirrors.comExample Problems and Solutions 369The closed-loop transfer function for the compensated system becomes Figure 6–79 shows the unit-step response curve. Even though the damping ratio of the dominant closed-loop poles is 0.5, the amount of overshoot is very much higher than expected.A closer look at the root-locus plot reveals that the presence of the zero at s=–1 is increasing the amount of the maximum overshoot. [In general, if a closed-loop zero or zeros (compensator zeroor zeros) lie to the right of the dominant pair of the complex poles, then the dominant poles areno longer dominant.] If large maximum overshoot cannot be tolerated, the compensator zero(s)should be shifted sufficiently to the left. In the current design, it is desirable to modify the compensator and make the maximum overshoot smaller. This can be done by modifying the lead compensator, as presented in thefollowing second attempt. Second Attempt: To modify the shape of the root loci, we may use two lead networks, each contributing half the necessary lead angle, which is Let us choose thelocation of the zeros at s=–3. (This is an arbitrary choice. Other choices such as s=–2.5 and s=–4 may be made.) Once we choose two zeros at s=–3, the necessary location of the poles can be determined as shown in Figure 6–80, or which yields y=1+1.73205 0.09535=19.1652 =tan5.4466 °=0.09535 1.73205 y-1=tan (40.89334 °-35.4467 °)70.8934 °/H208622=35.4467 °.C(s) R(s)=11.2(s +1)(0.1s +1) (s+6)s2(0.1s +1)+11.2(s +1)t Sec2 1 07 9 6 8 10 4 3 5Output 0.51.5 01Unit-Step Response of Compensated System Figure 6–79 Unit-step response of the compensatedsystem.370 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method Hence, the lead compensator will have the following transfer function: The value of can be determined from the magnitude condition as follows: or Then the lead compensator just designed is Then the open-loop transfer function becomes A root-locus plot for the compensated system is shown in Figure 6–81(a). Notice that there is no closed-loop zero near the origin.An expanded view of the root-locus plot near the origin is shown in Figure 6–81(b). The closed-loop transfer function becomes The closed-loop poles are found as follows: s=-27.9606 s=-9.1847 ;j7.4814 s=-1;j1.73205C(s) R(s)=174.3864(s +3) 2 (0.1s +1) (s+19.1652) 2 s 2 (0.1s +1)+174.3864(s +3) 2 G c (s)G(s)H(s) =174.3864 a s+3 s+19.1652 b 2 1 s 2 1 0.1s +1G c (s)=174.3864 a s+3 s+19.1652 b 2 K c =174.3864 2 K c a s+3 s+19.1652 b 2 1 s 2 1 0.1s +1 2 s=-1+j13 =1K c G c (s)=K c a s+3 s+19.1652 b 2 –20 –16 –12 –8 –4 –10jv s35.4467 ° 40.89334 °j1.73205 y Figure 6–80 Determination of the pole of the lead network. Openmirrors.comExample Problems and Solutions 371Figures 6–82(a) and (b) show the unit-step response and unit-ramp response of the compensated system.The unit-step response curve is reasonable and the unit-ramp response looks acceptable. Notice that in the unit-ramp response the output leads the input by a small amount.This is becausethe system has a feedback transfer function 1/(0.1s+1). If the feedback signal versus tis plotted, together with the unit-ramp input, the former will not lead the input ramp at steady state. SeeFigure 6–82(c).Real Axis−41 0 2 −2 −3 −1 (b)Imag Axis −213 −12 −30Root-Locus Plot of Compensated System near Origin : Closed-loop polesReal Axis–25 –30 0 10 −5 5 –15 –20 –10 (a)Imag Axis –10515 010 –15−5 –2020Root-Locus Plot of Compensated System : Closed-loop poles Figure 6–81 (a) Root-locus plot of compensated system; (b) root-locus plot near the origin.372 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method A–6–14. Consider a system with an unstable plant as shown in Figure 6–83(a). Using the root-locus approach, design a proportional-plus-derivative controller that is, determine the values of K p and such that the damping ratio zof the closed-loop system is 0.7 and the undamped natural frequency v n is 0.5 rad /H20862sec. Solution. Note that the open-loop transfer function involves two poles at s=1.085 ands=–1.085 and one zero at which is unknown at this point. Since the desired closed-loop poles must have v n =0.5 rad /H20862sec and z=0.7, they must be located at s=0.5 / 180°;45.573 ° s=-1/H20862T d ,T d BA t Sec2 1 07 9 6 8 10 4 3 5 (a) Output 0.4 0.81.4 0 1.2 0.6 1 0.2 Unit-Step Response of Compensated System t Sec1 0 5 4 2 3 (b) Unit-Ramp Input and Output 1.5 2.5 3.5 2 3 0 0.5 1 4 4.5 5 Unit-Ramp Response of Compensated System Output t Sec1 05 4 2 3 (c) Unit-Ramp Input and Feedback Signal 1.5 2.5 3.5 2 3 0 0.5 1 4 4.5 5Feedback Signal in Unit-Ramp Response Feedback Signal Figure 6–82 (a) unit-step response of the compensated system; (b) unit-ramp response of the compensated system; (c) a plot of feedback signal versus tin the unit-ramp response. Openmirrors.comExample Problems and Solutions 373(z=0.7 corresponds to a line having an angle of 45.573° with the negative real axis.) Hence, the desired closed-loop poles are at The open-loop poles and the desired closed-loop pole in the upper half-plane are located in the diagram shown in Figure 6–83(b). The angle deficiency at point s=–0.35+j0.357 is This means that the zero at must contribute 11.939°, which, in turn, determines the location of the zero as follows: s=-1 Td=-2.039s=-1/H20862Td-166.026 °-25.913 °+180°=-11.939 °s=-0.35 ;j0.357+– (a) (b)Kp(1+Tds)1 10000 ( s2– 1.1772) 0jv s45.573 °j3 j2 j1 –j1 –j3–j225.913 °166.026 °Closed-loop pole 1.085 2 –1.085 – 4 –3 –2.039 Figure 6–83 (a) PD control of anunstable plant; (b) root-locus diagram for thesystem.374 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method Hence, we have (6–31) The value of is The value of gain K p can be determined from the magnitude condition as follows: or Hence, By substituting the numerical values of and into Equation (6–31), we obtain which gives the transfer function of the desired proportional-plus-derivative controller. A–6–15. Consider the control system shown in Figure 6–84. Design a lag compensator G c (s)such that the static velocity error constant K v is 50 sec –1 without appreciably changing the location of the orig- inal closed-loop poles, which are at Solution. Assume that the transfer function of the lag compensator is G c (s)=K ˆ c s+1 T s+1 bT (b71)s=-2;j16 .K p A1+T d sB=14,273(1 +0.4904s) =6999.5(s +2.039)K p T d K p =6999.5 0.4904=14,273K p T d =6999.5 2 K p T d s+2.039 10000As 2 -1.1772B 2 s=-0.35+j0.357 =1T d =1 2.039=0.4904T d K p A1+T d sB=K p T d a 1 T d +s b =K p T d (s+2.039) G c (s) R(s) C(s)10 s(s+ 4) +– Figure 6–84 Control system. Openmirrors.comExample Problems and Solutions 375Since Kvis specified as 50 sec–1, we have Thus Now choose Then Choose T=10. Then the lag compensator can be given by The angle contribution of the lag compensator at the closed-loop pole is which is small.The magnitude of Gc(s)at is 0.981. Hence the change in the location of the dominant closed-loop poles is very small. The open-loop transfer function of the system becomes The closed-loop transfer function is To compare the transient-response characteristics before and after the compensation, the unit-step and unit-ramp responses of the compensated and uncompensated systems are shown in Figures 6–85(a) and (b), respectively.The steady-state error in the unit-ramp response is shown in Figure6–85(c). The designed lag compensator is acceptable.C(s) R(s)=10s +1 s3+4.005s2+10.02s +1Gc(s)G(s) =s+0.1 s+0.00510 s(s+4)s=-2+j6 =-1.3616 ° /Gc(s) 2 s=-2+j16=tan-1 16 -1.9-tan-1 16 -1.995s=-2+j16Gc(s)=s+0.1 s+0.005b=20Kˆc=1.Kˆc b=20Kv=lim sS0sGc(s)10 s(s+4)=Kˆc b2.5=50376 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method t Sec2 1 07 9 6 8 10 4 3 5 (a) Outputs 0.4 0.8 01.2 0.6 1 0.2 Unit-Step Responses of Compensated and Uncompensated Systems Uncompensated system Compensated system t Sec2 1 07 9 6 8 10 4 3 5 (b) Input Ramp and Outputs 2 4 0 6 3 5 1 7 8 9 10Unit-Ramp Responses of Compensated and Uncompensated Systems Uncompensated system has steady-state error of 0.4 Compensated system has steady-state error of 0.02 t Sec36 35.5 35 38.5 39.5 38 39 40 37 36.5 37.5 (c) Input Ramp and Outputs 37.5 38.540 35 39.5 38 39 35.5 37 36.5 36 Unit-Ramp Response (35 /H11021t/H11021 40) Uncompensated system Compensated system Figure 6–85 (a) Unit-step responses of the compensated and uncompensated systems; (b) unit- ramp responses of both systems; (c) unit-ramp responses showing steady-state errors. Openmirrors.comExample Problems and Solutions 377A–6–16. Consider a unity-feedback control system whose feedforward transfer function is given by Design a compensator such that the dominant closed-loop poles are located at and the static velocity error constant Kvis equal to 80 sec–1. Solution. The static velocity error constant of the uncompensated system is Since Kv=80 is required, we need to increase the open-loop gain by 128. (This implies that we need a lag compensator.) The root-locus plot of the uncompensated system reveals that it is not possible to bring the dominant closed-loop poles to by just a gain adjustment alone.See Figure 6–86. (This means that we also need a lead compensator.) Therefore, we shall employa lag–lead compensator. Let us assume the transfer function of the lag–lead compensator to be where K c=128. This is because and we obtain Kc=128. The angle deficiency at the desired closed-loop pole is The lead portion of the lag–lead compensator must contribute . To choose we may use the graphical method presented in Section 6–8.T1 60°Angle deficiency =- 120°-90°-30°+180°=- 60°s=-2+j213Kv=lim sS0sGc(s)G(s) =lim sS0sKcG(s) =Kc10 16=80Gc(s)=Kc±s+1 T1 s+b T1≤±s+1 T2 s+1 bT2≤-2;j213Kv=10 16=0.625.s=-2;j213G(s) =10 s(s+2)(s +8) Real Axis−10 5 10 −5 0Imag Axis10 −106 −6 −84 02 −28 −4Root-Locus Plot of G(s) = 10/[ s(s+2)( s+8)] Desired closed-loop pole Complex conjugate closed-loop pole Figure 6–86 Root-locus plot of Cs(s+2)(s +8)D.G(s) =10/H20862The lead portion must satisfy the following conditions: and The first condition can be simplified as By using the same approach as used in Section 6–8, the zero and pole can be determined as follows: See Figure 6–87. The value of bis thus determined as For the lag portion of the compensator, we may choose 1 bT 2 =0.01b=14.4191 T 1 =3.70, b T 1 =53.35As=b/H20862T 1 B As=1/H20862T 1 B 4 s 1 +1 T 1 s 1 +b T 1 4 s 1 =-2+j213 =1 13.3333 n s 1 +1 T 1 s 1 +b T 1 5 s 1 =-2+j213 =60° 4 128 ± s 1 +1 T 1 s 1 +b T 1 ≤ GAs 1 B 4 s 1 =-2+j213 =1 378 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method –53.35 13.3333x –3.7060° xjv ss 1 0 Figure 6–87 Graphical determination of the zero and pole of the lead portion of the compensator. Openmirrors.comExample Problems and Solutions 379Then Noting that the angle contribution of the lag portion is –1.697° and the magnitude contribution is 0.9837.This means that the dominant closed-loop poles lie close to the desired locationThus the compensator designed, is acceptable. The feedforward transfer function of the compensated system becomesA root-locus plot of the compensated system is shown in Figure 6–88(a). An enlarged root-locus plot near the origin is shown in Figure 6–88(b).G c(s)G(s) =1280(s +3.7)(s +0.1442) s(s+53.35)(s +0.01)(s +2)(s +8)Gc(s)=128as+3.70 s+53.35bas+0.1442 s+0.01bs=-2;j213.ns1+0.1442 s1+0.012 s1=-2+j213=-1.697 °2s1+0.1442 s1+0.012 s1=-2+j213=0.98371 T2=0.1442 Real Axis−40 −60 20 60 40 −20 0 (a)Imag Axis60 −60−4040 020 −20Root-Locus Plot of Compensated System Figure 6–88 (a) Root-locus plot of compensated system; (b) root-locus plot near the origin.Real Axis−10 5 10 −5 0 (b)Imag Axis10 −108 −6 −86 04 −22 −4Root-Locus Plot of Compensated System near the Origin Desired closed-loop polesTo verify the improved system performance of the compensated system, see the unit-step responses and unit-ramp responses of the compensated and uncompensated systems shown in Figures 6–89 (a) and (b), respectively. A–6–17. Consider the system shown in Figure 6–90. Design a lag–lead compensator such that the static velocity error constant K v is 50 sec –1 and the damping ratio zof the dominant closed- loop poles is 0.5. (Choose the zero of the lead portion of the lag–lead compensator to cancel the pole at s=–1 of the plant.) Determine all closed-loop poles of the compensated system. 380 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method t Sec2 1 07 9 6 8 10 4 3 5 (a) Outputs 0.4 0.81.4 0 1.2 0.6 1 0.2 Unit-Step Responses of Compensated and Uncompensated Systems Uncompensated system Compensated system t Sec2 1 07 9 6 8 10 4 3 5 (b) Outputs 3 5 0 9 4 7 1 8 6 2 10Unit-Ramp Responses of Compensated and Uncompensated Systems Uncompensated system Compensated system Figure 6–89 (a) Unit-step responses of compensated and uncompensated systems; (b) unit- ramp responses of both systems. Openmirrors.comExample Problems and Solutions 3811 s(s+ 1) (s+ 5)Gc(s) +– Figure 6–90 Control system. Solution. Let us employ the lag–lead compensator given by whereb>1. Then The specification that determines the value of Kc,o r We now choose so that will cancel the (s+1) term of the plant. The lead portion then becomes For the lag portion of the lag–lead compensator we require where s=s1is one of the dominant closed-loop poles. Noting these requirements for the lag por- tion of the compensator, at s=s1, the open-loop transfer function becomes GcAs1BGAs1B/H11216Kcas1+1 s1+bb1 s1As1+1BAs1+5B=Kc1 s1As1+bBAs1+5B4s1+1 T2 s1+1 bT24/H112161, -5°6ns1+1 T2 s1+1 bT260°s+1 s+bs+A1/H20862T1B T1=1Kc=250Kv=50 sec-1 =Kc 5 =lim sS0s KcAT1 s+1BAT2 s+1B aT1 b s+1bAbT2 s+1B 1 s(s+1)(s +5) Kv=lim sS0sGc(s)G(s)Gc(s)=Kc±s+1 T1 s+b T1≤±s+1 T2 s+1 bT2≤=KcAT1 s+1BAT2 s+1B aT1 bs+1bAbT2 s+1B382 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method Then at , the following magnitude and angle conditions must be satisfied: (6–32) (6–33) where k= 0, 1, 2, p. In Equations (6–32) and (6–33), bands 1 are unknowns. Since the damping ratiozof the dominant closed-loop poles is specified as 0.5, the closed-loop pole s=s 1 can be writ- ten as where xis as yet undetermined. Notice that the magnitude condition, Equation (6–32), can be rewritten as Noting that we have (6–34) The angle condition, Equation (6–33), can be rewritten as or (6–35) We need to solve Equations (6–34) and (6–35) for bandx. By several trial-and-error calculations, it can be found that Thus The lag portion of the lag–lead compensator can be determined as follows: Noting that the pole and zero of the lag portion of the compensator must be located near the origin, we may choose That is, 1 T 2 =0.16025 or T 2 =6.251 bT 2 =0.01s 1 =-1.9054 +j13 (1.9054) =-1.9054 +j3.3002b=16.025, x=1.9054tan -1 a 13 x -x+b b +tan -1 a 13 x -x+5 b =60°=-120°-tan -1 a 13 x -x+b b -tan -1 a 13 x -x+5 b =-180° n K c 1 A-x+j13 xBA-x+b+j13 xBA-x+5+j13 xB x2(b-x) 2 +3x 2 2(5-x) 2 +3x 2 =125K c =250, 2 K c A-x+j13 xBA-x+b+j13 xBA-x+5+j13 xB 2 =1s 1 =-x+j13 x n K c 1 s 1 As 1 +bBAs 1 +5B =;180°(2k +1) 2 K c 1 s 1 As 1 +bBAs 1 +5B 2 =1s=s 1 Openmirrors.comExample Problems and Solutions 383With the choice of we find (6–36) and (6–37) Since our choice of is acceptable. Then the lag–lead compensator just designed can be writ- ten as Therefore, the compensated system has the following open-loop transfer function: A root-locus plot of the compensated system is shown in Figure 6–91(a). An enlarged root-locus plot near the origin is shown in Figure 6–91(b). The closed loop transfer function becomes The closed-loop poles are located at Notice that the dominant closed-loop poles differ from the dominant closed-loop poles assumed in the computation of band Small deviations of the dom- inant closed-loop poles from are due to the approximations involved in determining the lag portion of the compensator. [See Equations (6–36)and (6–37).]s=;s 1=-1.9054 ;j3.3002 s=-1.8308 ;j3.2359T2 . s=;s1s=-1.8308 ;j3.2359 s=-17.205 s=-0.1684 s=-1.8308 ;j3.2359C(s) R(s)=250(s +0.16025) s(s+0.01)(s +5)(s +16.025) +250(s +0.16025)Gc(s)G(s) =250(s +0.16025) s(s+0.01)(s +5)(s +16.025)Gc(s)=250as+1 s+16.025bas+0.16025 s+0.01bT2=6.25-5°6-1.937 °60°=tan-1a3.3002 -1.74515b-tan-1a3.3002 -1.89054b=-1.937 °ns1+1 T2 s1+1 bT2=n-1.9054 +j3.3002 +0.16025 -1.9054 +j3.3002 +0.01 =2-1.74515 +j3.3002 -1.89054 +j3.30022=0.98/H112161 4s1+1 T2 s1+1 bT24=2-1.9054 +j3.3002 +0.16025 -1.9054 +j3.3002 +0.012T2=6.25,384 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method Real Axis–20 5 0 10 –10 –15 –5 (a) Imag Axis –5 515 0 10 –10 –15Root-Locus Plot of Compensated System Real Axis1 0.5 –0.5 –10 (b) Imag Axis –0.6 0 0.6 –0.2 0.2 –1 1 0.8 0.4 –0.8 –0.4 Root-Locus Plot of Compensated System near the Origin Figure 6–91 (a) Root-locus plot of compensated system; (b) root- locus plot near the origin. Figures 6–92(a) and (b) show the unit-step response and unit-ramp response of the designed system, respectively. Note that the closed-loop pole at s=–0.1684 almost cancels the zero at s=–0.16025. However, this pair of closed-loop pole and zero located near the origin pro- duces a long tail of small amplitude. Since the closed-loop pole at s=–17.205 is located very much farther to the left compared to the closed-loop poles at the effect of this real pole on the system response is very small. Therefore, the closed-loop poles at are indeed dominant closed-loop poles that determine the response characteristics of the closed-loop system. In the unit-ramp response, the steady-state error in following the unit-ramp input eventually becomes 1/H20862K v = 1 50 =0.02.s=-1.8308 ;j3.2359s=-1.8308 ;j3.2359, Openmirrors.comOpenmirrors.comExample Problems and Solutions 385A–6–18. Figure 6–93(a) is a block diagram of a model for an attitude-rate control system.The closed-loop transfer function for this system is The unit-step response of this system is shown in Figure 6–93(b). The response shows high- frequency oscillations at the beginning of the response due to the poles at The response is dominated by the pole at The settling time is approximately 240 sec. s=-0.0167.s=-0.0417 ;j2.4489. =2(s+0.05) (s+0.0417 +j2.4489)(s +0.0417 -j2.4489)(s +0.0167) C(s) R(s)=2s+0.1 s3+0.1s2+6s+0.1t Sec4 2 0 14 12 8 6 10 (a)Output 0.40.81.4 01.2 0.61 0.2Unit-Step Response of Compensated System t Sec2 1 07 9 6 8 10 4 3 5 (b)Output 37 09 48 26 5 110Unit-Ramp Response of Compensated System Figure 6–92 (a) Unit-stepresponse of the compensated system; (b) unit-rampresponse of thecompensated system.386 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method Time (sec)50 0 200 300 250 100 150 (b) Amplitude 0.3 0.6 01 0.4 0.7 0.1 0.9 0.8 0.5 0.2 Unit-Step Response of Uncompensated System R(s) C(s) 1 Rate gyroHydraulic servo Aircraft1 s 2s+ 0.1 s 2 + 0.1s+ 4 (a) +– Figure 6–93 (a) Attitude-rate control system; (b) unit-step response. It is desired to speed up the response and also eliminate the oscillatory mode at the beginning of the response. Design a suitable compensator such that the dominant closed-loop poles are at Solution. Figure 6–94 shows a block diagram for the compensated system. Note that the open-loop zero at and the open-loop pole at s=0 generate a closed-loop pole between s=0 ands=–0.05. Such a closed-loop pole becomes a dominant closed-loop pole and makes the re- sponse quite slow. Hence, it is necessary to replace this zero by a zero that is located far away from the jvaxis—for example, a zero at s=-4.s=-0.05s=-2;j213 . G c (s) R(s) C(s) 1 Rate gyroHydraulic servo Aircraft1 s 2s+ 0.1 s 2 + 0.1s+ 4 +– Figure 6–94 Compensated attitude-rate control system. Openmirrors.comOpenmirrors.comExample Problems and Solutions 387We now choose the compensator in the following form: Then the open-loop transfer function of the compensated system becomes To determine by the root-locus method, we need to find the angle deficiency at the desired closed-loop pole The angle deficiency can be found as follows: Hence, the lead compensator must provide 132.73°. Since the angle deficiency is –132.73°, we need two lead compensators, each providing 66.365°.Thus will have the following form: Suppose that we choose two zeros at s=–2. Then the two poles of the lead compensators can be obtained from or (See Figure 6–95.) Hence, Gˆc(s)=Kcas+2 s+9.9158b2 =9.9158 sp=2+3.4641 0.43761693.4641 sp-2=tan(90°-66.365 °)=0.4376169=Kcas+sz s+spb2 Gˆc(s)Gˆc(s)Gˆc(s) =-132.73 ° Angle deficiency =-143.088 °-120°-109.642 °+60°+180°s=-2+j213.Gˆc(s) =Gˆc(s) s+4 sAs2+0.1s +4B Gc(s)G(s) =Gˆc(s) s+4 2s+0.1 1 s 2s+0.1 s2+0.1s +4Gc(s)=Gˆc(s)s+4 2s+0.1 2 4 −6 −2 0 −4 −8 −10 −12j4 j2 –j4–j266.365° sps = −2 + j23jv s Figure 6–95 Pole and zero of . Gˆc(s)388 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method The entire compensator for the system becomes The value of can be determined from the magnitude condition. Since the open-loop transfer function is the magnitude condition becomes Hence, Thus the compensator becomes The open-loop transfer function is given by A root-locus plot for the compensated system is shown in Figure 6–96. The closed-loop poles for the compensated system are indicated in the plot. The closed-loop poles, the roots of the charac- teristic equation (s+9.9158) 2 sAs 2 +0.1s +4B+88.0227(s +2) 2 (s+4)=0G c (s)G(s) =88.0227(s +2) 2 (s+4) (s+9.9158) 2 sAs 2 +0.1s +4BG c (s)=88.0227(s+2) 2 (s+4) (s+9.9158) 2 (2s+0.1)G c (s) =88.0227 K c = 2 (s+9.9158) 2 sAs 2 +0.1s +4B (s+2) 2 (s+4) 2 s=-2+j213 2 K c (s+2) 2 (s+4) (s+9.9158) 2 sAs 2 +0.1s +4B 2 s=-2+j213 =1G c (s)G(s) =K c (s+2) 2 (s+4) (s+9.9158) 2 sAs 2 +0.1s +4BK c G c (s)=G ˆ c (s)s+4 2s+0.1=K c (s+2) 2 (s+9.9158) 2 s+4 2s+0.1G c (s) Real Axis–15 10 5 15 –5 –10 0 Imag Axis –10 0 10 –5 5 15 –15Root-Locus Plot of Compensated System Closed-loop poles Figure 6–96 Root-locus plot of the compensated system. Openmirrors.comExample Problems and Solutions 389are as follows: Now that the compensator has been designed, we shall examine the transient-response charac- teristics with MATLAB. The closed-loop transfer function is given by Figures 6–97(a) and (b) show the plots of the unit-step response and unit-ramp response of the compensated system. These response curves show that the designed system is acceptable.C(s) R(s)=88.0227(s +2)2(s+4) (s+9.9158)2sAs2+0.1s +4B+88.0227(s +2)2(s+4) s=-0.8868 s=-7.5224 ;j6.5326 s=-2.0000 ;j3.4641 t Sec1 0.5 0 3.5 4.5 3 4 5 2 1.5 2.5 (a)Output 0.40.81.4 01.2 0.61 0.2Unit-Step Response of Compensated System t Sec05 4 6 2 1 3 (b)Input and Output246 035 1Unit-Ramp Response of Compensated System Figure 6–97 (a) Unit-stepresponse of the compensated system; (b) unit-rampresponse of thecompensated system.390 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method A–6–19. Consider the system shown in Figure 6–98(a). Determine the value of asuch that the damping ratio zof the dominant closed poles is 0.5. Solution. The characteristic equation is The variable ais not a multiplying factor. Hence, we need to modify the characteristic equation. Since the characteristic equation can be written as we rewrite this equation such that aappears as a multiplying factor as follows: Define Then the characteristic equation becomes Notice that the characteristic equation is in a suitable form for the construction of the root loci.1+K sAs 2 +9s+18B=010a =K1+10a sAs 2 +9s+18B=0s 3 +9s 2 +18s +10a =01+10(s +a) s(s+1)(s +8)=0 (a) (b)s+a s+ 8 10 s(s+ 1) j4 j3 j2 –j4–j3–j2–j101–1 –3 –5 –7 –22 –4 –6jv s60° K= 28K= 28 j1j6 –j6j5 –j5 +– Figure 6–98 (a) Control system; (b) root-locus plot, where K=10a. Openmirrors.comExample Problems and Solutions 391This system involves three poles and no zero.The three poles are at s=0, s=–3, ands=–6. A root-locus branch exists on the real axis between points s=0 ands=–3. Also, another branch exists between points s=–6 ands=– q. The asymptotes for the root loci are found as follows: The intersection of the asymptotes and the real axis is obtained from The breakaway and break-in points can be determined from where Now we set which yields or Point s=–1.268 is on a root-locus branch. Hence, point s=–1.268 is an actual breakaway point. But point s=–4.732 is not on the root locus and therefore is neither a breakaway nor break-in point. Next we shall find points where root-locus branches cross the imaginary axis. We substitute s=jvin the characteristic equation, which is as follows: or from which we get The crossing points are at and the corresponding value of gain Kis 162. Also, a root- locus branch touches the imaginary axis at v=0. Figure 6–98(b) shows a sketch of the root loci for the system. Since the damping ratio of the dominant closed-loop poles is specified as 0.5, the desired closed-loop pole in the upper-half splane is located at the intersection of the root-locus branch in the upper-half splane and a straight line having an angle of 60° with the negative real axis.The desired dominant closed-loop poles are located at At these points, the value of gain Kis 28. Hence, a=K 10=2.8s=-1+j1.732, s=-1-j1.732v=;312v=;312, K=9v2=162 or v=0, K=0AK-9v2B+jvA18-v2B=0(jv)3+9(jv)2+18(jv)+K=0s3+9s2+18s +K=0s=-1.268, s=-4.732s2+6s+6=0dK ds=-A3s2+18s +18B=0K=-As3+9s2+18sBdK /H20862ds=0,s=-0+3+6 3=-3Angles of asymptotes =;180°(2k +1) 3=60°, -60°, 180 °392 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method Since the system involves two or more poles than zeros (in fact, three poles and no zero), the third pole can be located on the negative real axis from the fact that the sum of the three closed- loop poles is –9.Hence, the third pole is found to be at or A–6–20. Consider the system shown in Figure 6–99(a). Sketch the root loci of the system as the velocity feedback gain kvaries from zero to infinity. Determine the value of ksuch that the closed-loop poles have the damping ratio zof 0.7. Solution. The open-loop transfer function is Since kis not a multilying factor, we modify the equation such that kappears as a multiplying factor. Since the characteristic equation is we rewrite this equation as follows: (6–38) Define Then Equation (6–38) becomes 1+Ks s 2 +s+10=010k =K1+10ks s 2 +s+10=0s 2 +s+10ks +10=0Open-loop transfer function =10 (s+1+10k)ss=-7s=-9-(-1+j1.732) -(-1-j1.732) R(s) C(s)1 s kjv s (a) (b)10 s+ 1 j4 j3 j2 −j1j1 −j3−j2 −j401 −1 −4 −6 −2 −3 −5 −72K= 3.427 45.57 8 +– +– Figure 6–99 (a) Control system; (b) root-locus plot, where K=10k. Openmirrors.comExample Problems and Solutions 393Notice that the system has a zero at s=0 and two poles at Since this system involves two poles and one zero, there is a possibility that a circular root locus exists. In fact, thissystem has a circular root locus, as will be shown. Since the angle condition is we have By substituting into this last equation and rearranging, we obtain which can be rewritten as Taking tangents of both sides of this last equation, we obtain which can be simplified to or which yields Notice that v=0 corresponds to the real axis.The negative real axis (between s=0 ands=– q) corresponds to K/H113500, and the positive real axis corresponds to K<0. The equation is an equation of a circle with center at s=0,v=0 with the radius equal to A portion of this circle that lies to the left of the complex poles corresponds to the root locus for K> 0. (The portion of the circle which lies to the right of the complex poles corresponds to the root locus for K<0.) Figure 6–99(b) shows a sketch of the root loci for K> 0. Since we require z=0.7 for the closed-loop poles, we find the intersection of the circular root locus and a line having an angle of 45.57° (note that cos 45.57° =0.7) with the negative real axis. The intersection is at s=–2.214+j2.258. The gain Kcorresponding to this point is 3.427. Hence, the desired value of the velocity feedback gain kis k=K 10=0.3427110.s2+v2=10v=0 or s2+v2=10vAs2-10+v2B=02v(s+0.5) (s+0.5)2-Av2-3.12252B=v sv+3.1225 s+0.5+v-3.1225 s+0.5 1-av+3.1225 s+0.5bav-3.1225 s+0.5b=v stan-1 av+3.1225 s+0.5b+tan-1 av-3.1225 s+0.5b=tan-1 av sb;180°(2k +1)/s+0.5+j(v+3.1225) +/s+0.5+j(v-3.1225) =/s+jv;180°(2k +1)s=s+jv/s-/s+0.5+j3.1225 -/s+0.5-j3.1225 =;180°(2k +1)nKs s2+s+10=;180°(2k +1)s=-0.5;j3.1225.PROBLEMS 394 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method B–6–1. Plot the root loci for the closed-loop control sys- tem with B–6–2. Plot the root loci for the closed-loop control system with B–6–3. Plot the root loci for the system with B–6–4. Show that the root loci for a control system with are arcs of the circle centered at the origin with radius equal to B–6–5. Plot the root loci for a closed-loop control system with B–6–6. Plot the root loci for a closed-loop control system with Locate the closed-loop poles on the root loci such that the dominant closed-loop poles have a damping ratio equal to 0.5. Determine the corresponding value of gain K. B–6–7. Plot the root loci for the system shown in Figure 6–100. Determine the range of gain Kfor stability.G(s) =K(s +9) sAs 2 +4s+11B, H(s) =1G(s) =K(s +0.2) s 2 (s+3.6), H(s) =1110 .G(s) =KAs 2 +6s+10B s 2 +2s+10, H(s) =1G(s) =K s(s+0.5)As 2 +0.6s +10B, H(s) =1G(s) =K s(s+1)(s 2 +4s+5), H(s) =1G(s) =K(s +1) s 2 , H(s) =1B–6–8. Consider a unity-feedback control system with the following feedforward transfer function: Plot the root loci for the system. If the value of gain Kis set equal to 2, where are the closed-loop poles located? B–6–9. Consider the system whose open-loop transfer func- tion is given by Show that the equation for the asymptotes is given by Using MATLAB, plot the root loci and asymptotes for the system. B–6–10. Consider the unity-feedback system whose feed- forward transfer function is The constant-gain locus for the system for a given value of Kis defined by the following equation: Show that the constant-gain loci for 0 /H11349K/H11349qmay be given by Sketch the constant-gain loci for K= 1, 2, 5, 10, and 20 on thesplane. B–6–11. Consider the system shown in Figure 6–101. Plot the root loci with MATLAB. Locate the closed-loop poles when the gain Kis set equal to 2.Cs(s+1)+v 2 D 2 +v 2 =K 2 2 K s(s+1) 2 =1G(s) =K s(s+1)G a (s)H a (s)=K s 3 +4.0068s 2 +5.3515s +2.3825G(s)H(s) =K(s -0.6667 ) s 4 +3.3401 s 3 +7.0325 s 2 G(s) =K sAs 2 +4s+8B 2 s 2 (s+ 2) s+ 1 s+ 5 KR(s) C(s) +– Figure 6–100 Control system. 1 s+ 1 K(s+ 1) s(s 2 + 2s+ 6) +– Figure 6–101 Control system. Openmirrors.comProblems 395K(s– 1) (s+ 2) (s+ 4)+– G1(s) (a) (b)K(1–s) (s+ 2) (s+ 4)+– G2(s)B–6–12. Plot root-locus diagrams for the nonminimum-phase systems shown in Figures 6–102(a) and (b), respectively. B–6–14. Consider the system shown in Figure 6–104. Plot the root loci for the system. Determine the value of Ksuch that the damping ratio zof the dominant closed-loop poles is 0.5. Then determine all closed-loop poles. Plot the unit-step response curve with MATLAB.Figure 6–102 (a) and (b) Nonminimum-phase systems. B–6–13. Consider the mechanical system shown in Figure 6–103. It consists of a spring and two dashpots. Obtain the transfer function of the system. The displacement x iis the input and displacement xois the output. Is this system a mechanical lead network or lag network? b2 b1kxi xo Figure 6–103 Mechanical system. K s(s2+ 4s+ 5)+– Figure 6–104 Control system.B–6–15. Determine the values of K, and of the system shown in Figure 6–105 so that the dominant closed-looppoles have the damping ratio z=0.5 and the undamped natural frequency v n=3 rad /H20862sec.T2 T1 , C R T1s+ 1 T2s+ 1K10 s(s+ 1)+– Figure 6–105 Control system. B–6–16. Consider the control system shown in Figure 6–106. Determine the gain Kand time constant Tof the controller Gc(s) such that the closed-loop poles are located at s=-2;j2. 1 s(s+ 2)K(Ts+ 1) +– Gc(s) G(s) Figure 6–106 Control system. Gc(s)5 s(0.5s+ 1)+– Figure 6–107 Control system.B–6–17. Consider the system shown in Figure 6–107. De- sign a lead compensator such that the dominant closed-looppoles are located at Plot the unit-step re-sponse curve of the designed system with MATLAB.s=-2;j213 . B–6–18. Consider the system shown in Figure 6–108. De- sign a compensator such that the dominant closed-loop poles are located at s=-1;j1. Gc(s)1 s2 Lead compensatorSpace vehicle+– Figure 6–108 Control system.396 Chapter 6 / Control Systems Analysis and Design by the Root-Locus Method B–6–19. Referring to the system shown in Figure 6–109, de- sign a compensator such that the static velocity error con- stant is 20 sec –1 without appreciably changing the original location of a pair of the complex-conjugate closed-loop poles.As=-2;j213 BK v B–6–20. Consider the angular-positional system shown in Figure 6–110. The dominant closed-loop poles are located at The damping ratio zof the dominant closed-loop poles is 0.6.The static velocity error constant is 4.1 sec –1 , which means that for a ramp input of 360° /H20862sec the steady-state error in following the ramp input is It is desired to decrease e v to one-tenth of the present value, or to increase the value of the static velocity error con- stant to 41 sec –1 . It is also desired to keep the damping ratio zof the dominant closed-loop poles at 0.6. A small change in the undamped natural frequency v n of the dominant closed- loop poles is permissible. Design a suitable lag compensator to increase the static velocity error constant as desired.K v e v =u i K v =360°/H20862sec 4.1 sec -1 =87.8°K v s=-3.60 ;j4.80. B–6–21. Consider the control system shown in Figure 6–111. Design a compensator such that the dominant closed-loop poles are located at and the static velocity error constant is 50 sec –1 . K v s=-2;j213 G c (s)16 s(s+ 4) +– Figure 6–109 Control system. G c (s)820 s(s+ 10) ( s+ 20) +– Figure 6–110 Angular-positional system. G c (s)10 s(s+ 2) (s+ 5) +– Figure 6–111 Control system.B–6–24. Consider the system shown in Figure 6–114, which involves velocity feedback. Determine the values of the am- plifier gain Kand the velocity feedback gain so that the following specifications are satisfied: 1.Damping ratio of the closed-loop poles is 0.5 2.Settling time /H113492 sec 3.Static velocity error constant 4.0<K h <1K v /H1135050 sec -1 K h R(s) C(s)1 s K h K 2s+ 1 +– +– Figure 6–114 Control system.B–6–23. Consider the control system shown in Figure 6–113. Design a compensator such that the unit-step response curve will exhibit maximum overshoot of 25 %or less and settling time of 5 sec or less. G c (s)2s+ 1 s(s+ 1) (s+ 2) +– Figure 6–112 Control system. G c (s)1 s 2 (s+ 4) +– Figure 6–113 Control system.B–6–22. Consider the control system shown in Figure 6–112. Design a compensator such that the unit-step response curve will exhibit maximum overshoot of 30 %or less and settling time of 3 sec or less. Openmirrors.comProblems 397B–6–25. Consider the system shown in Figure 6–115. The system involves velocity feedback. Determine the value ofgain Ksuch that the dominant closed-loop poles have a damping ratio of 0.5. Using the gain Kthus determined, ob- tain the unit-step response of the system. R(s) C(s)1 s 0.2K (s+ 1) (s+ 2)+–+– Figure 6–115 Control system.B–6–26. Consider the system shown in Figure 6–116. Plot the root loci as avaries from 0 to q. Determine the value of asuch that the damping ratio of the dominant closed-loop poles is 0.5. s+a2 s2 (s+ 2)+– Figure 6–116 Control system. B–6–28. Consider the system shown in Figure 6–118. As- suming that the value of gain Kvaries from 0 to q, plot the root loci when and 0.5. Compare unit-step responses of the system for the following three cases: (1) K=10, Kh=0.1 (2) K=10, Kh=0.3 (3) K=10, Kh=0.5Kh=0.1, 0.3,B–6–27. Consider the system shown in Figure 6–117. Plot the root loci as the value of kvaries from 0 to q.What value ofkwill give a damping ratio of the dominant closed-loop poles equal to 0.5? Find the static velocity error constant ofthe system with this value of k. s+ 1.4 s+ 510 s(s+ 1) ks s+ 10+–+– Figure 6–117 Control system. R(s) C(s) 1 s KhK s+ 1+–+– Figure 6–118 Control system.7 398 Control Systems Analysis and Design by the Frequency-Response Method 7–1 INTRODUCTION By the term frequency response, we mean the steady-state response of a system to a sinusoidal input. In frequency-response methods, we vary the frequency of the input signal over a certain range and study the resulting response. In this chapter we present frequency-response approaches to the analysis and design of control systems.The information we get from such analysis is different from what we get from root-locus analysis. In fact, the frequency response and root-locus approaches complement each other. One advantage of the frequency-response approach is that we can use the data obtained from measurements on the physical system without deriving its mathematical model. In many practical designs of control systems both approaches are employed. Control engineers must be familiar with both. Frequency-response methods were developed in 1930s and 1940s by Nyquist, Bode, Nichols, and many others. The frequency-response methods are most powerful in con- ventional control theory. They are also indispensable to robust control theory. The Nyquist stability criterion enables us to investigate both the absolute and relative stabilities of linear closed-loop systems from a knowledge of their open-loop frequency- response characteristics. An advantage of the frequency-response approach is that frequency-response tests are, in general, simple and can be made accurately by use of readily available sinusoidal signal generators and precise measurement equipment. Often the transfer functions of complicated components can be determined experimentally by frequency-response tests. In addition, the frequency-response approach has the advan- tages that a system may be designed so that the effects of undesirable noise are negligible and that such analysis and design can be extended to certain nonlinear control systems. Openmirrors.comSection 7–1 / Introduction 399Although the frequency response of a control system presents a qualitative picture of the transient response, the correlation between frequency and transient responses is indirect, ex-cept for the case of second-order systems. In designing a closed-loop system, we adjust thefrequency-response characteristic of the open-loop transfer function by using several de-sign criteria in order to obtain acceptable transient-response characteristics for the system. Obtaining Steady-State Outputs to Sinusoidal Inputs. We shall show that the steady-state output of a transfer function system can be obtained directly from the si-nusoidal transfer function—that is, the transfer function in which sis replaced by jv, wherevis frequency. Consider the stable, linear, time-invariant system shown in Figure 7–1.The input and out- put of the system, whose transfer function is G(s) , are denoted by x(t)andy(t), respectively. If the input x(t) is a sinusoidal signal, the steady-state output will also be a sinusoidal sig- nal of the same frequency, but with possibly different magnitude and phase angle. Let us assume that the input signal to the system is given by [In this book “ ”is always measured in rad/sec. When the frequency is measured in cycle/sec, we use notation “ f”. That is, .] Suppose that the transfer function G(s) of the system can be written as a ratio of two polynomials in s; that is, The Laplace-transformed output Y(s) of the system is then (7–1) where X(s) is the Laplace transform of the input x(t). It will be shown that, after waiting until steady-state conditions are reached, the fre- quency response can be calculated by replacing sin the transfer function by jv. It will also be shown that the steady-state response can be given by where Mis the amplitude ratio of the output and input sinusoids and fis the phase shift between the input sinusoid and the output sinusoid. In the frequency-response test,the input frequency vis varied until the entire frequency range of interest is covered. The steady-state response of a stable, linear, time-invariant system to a sinusoidal input does not depend on the initial conditions. (Thus, we can assume the zero initialcondition.) If Y(s) has only distinct poles, then the partial fraction expansion of Equa- tion (7–1) when x(t) = X yields (7–2) =a s+jv+a– s-jv+b1 s+s1+b2 s+s2+p+bn s+sn Y(s) =G(s)X(s) =G(s) vX s2+v2sinvtG(jv)=Mejf=M/fY(s) =G(s)X(s) =p(s) q(s)X(s)G(s) =p(s) q(s)=p(s) As+s1BAs+s2BpAs+snBv=2pfvx(t) =Xsinvt G(s) X(s)x(t) Y(s)y(t)Figure 7–1 Stable, linear, time-invariant system.400 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method where aand the b i (where i=1, 2, p,n)are constants and is the complex conjugate ofa. The inverse Laplace transform of Equation (7–2) gives (7–3) For a stable system, –s 1 ,– s 2 ,p,–s n have negative real parts.Therefore, as tapproaches infinity, the terms and approach zero.Thus, all the terms on the right- hand side of Equation (7–3), except the first two, drop out at steady state. IfY(s) involves multiple poles s j of multiplicity m j ,then y(t) will involve terms such as For a stable system, the terms approach zero astapproaches infinity. Thus, regardless of whether the system is of the distinct-pole type or multiple-pole type, the steady-state response becomes (7–4) where the constant acan be evaluated from Equation (7–2) as follows: Note that Since G(jv)is a complex quantity, it can be written in the following form: where@G(jv)@represents the magnitude and frepresents the angle of G(jv); that is, The angle fmay be negative, positive, or zero. Similarly, we obtain the following expression for G(–jv): Then, noting that Equation (7–4) can be written (7–5) =Ysin (vt+f) =X@G(jv)@sin (vt+f) y ss (t)=X@G(jv)@ e j(vt+f) -e -j(vt+f) 2ja=-X@G(jv)@e -jf 2j, a – =X@G(jv)@e jf 2jG(-jv)=@G(-jv)@e -jf =@G(jv)@e -jf f= / G(jv) =tan -1 c imaginary part of G(jv) real part of G(jv) d G(jv)=@G(jv)@e jf a – =G(s)vX s 2 +v 2 (s-jv) 2 s=jv =XG(jv) 2ja=G(s)vX s 2 +v 2 (s+jv) 2 s=-jv =-XG( -jv) 2jy ss (t)=ae -jvt +a – e jvt t h j e -s j t t h j e -s j t Ah j =0, 1, 2, p,m j -1B.e -s n t e -s 1 t ,e -s 2 t ,p,y(t) =ae -jvt +a – e jvt +b 1 e -s 1 t +b 2 e -s 2 t +p+b n e -s n t (t/H113500)a – Openmirrors.comSection 7–1 / Introduction 401XY tInput x(t)=Xsinvt Output y(t)=Ysin (vt+f)Figure 7–2 Input and outputsinusoidal signals. y x G(s)K Ts+ 1Figure 7–3 First-order system.where Y=X@G(jv)@. We see that a stable, linear, time-invariant system subjected to a sinusoidal input will, at steady state, have a sinusoidal output of the same frequency asthe input. But the amplitude and phase of the output will, in general, be different fromthose of the input. In fact, the amplitude of the output is given by the product of that ofthe input and @G(jv)@, while the phase angle differs from that of the input by the amount An example of input and output sinusoidal signals is shown in Figure 7–2. On the basis of this, we obtain this important result: For sinusoidal inputs, Hence, the steady-state response characteristics of a system to a sinusoidal input can be obtained directly from The function G(jv)is called the sinusoidal transfer function. It is the ratio of Y(jv) toX(jv),is a complex quantity, and can be represented by the magnitude and phase angle with frequency as a parameter.The sinusoidal transfer function of any linear systemis obtained by substituting jvforsin the transfer function of the system. As already mentioned in Chapter 6, a positive phase angle is called phase lead, and a neg- ative phase angle is called phase lag.A network that has phase-lead characteristics is calleda lead network, while a network that has phase-lag characteristics is called a lag network. EXAMPLE 7–1 Consider the system shown in Figure 7–3. The transfer function G(s) is For the sinusoidal input x(t)=X sinvt, the steady-state output yss(t)can be found as follows: Substituting jvforsinG(s) yields G(jv)=K jTv+1G(s) =K Ts+1Y(jv) X(jv)=G(jv)/G(jv)=nY(jv) X(jv)=phase shift of the output sinusoid with respect to the input sinusoid@G(jv)@=2Y(jv) X(jv)2=amplitude ratio of the output sinuisoid to the input sinusoidf=/G(jv).402 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method The amplitude ratio of the output to the input is while the phase angle fis Thus, for the input x(t)=X sinvt, the steady-state output y ss (t)can be obtained from Equation (7–5) as follows: (7–6) From Equation (7–6), it can be seen that for small v, the amplitude of the steady-state output y ss (t)is almost equal to Ktimes the amplitude of the input.The phase shift of the output is small for small v. For large v, the amplitude of the output is small and almost inversely proportional to v. The phase shift approaches –90° as vapproaches infinity. This is a phase-lag network. EXAMPLE 7–2 Consider the network given by Determine whether this network is a lead network or lag network. For the sinusoidal input x(t)=X sinvt, the steady-state output y ss (t)can be found as follows: Since we have and Thus the steady-state output is From this expression, we find that if then Thus, if then the network is a lead network. If then the network is a lag network. Presenting Frequency-Response Characteristics in Graphical Forms. The sinusoidal transfer function, a complex function of the frequency v, is characterized by its magnitude and phase angle, with frequency as the parameter. There are three commonly used representations of sinusoidal transfer functions: T 1 6T 2 ,T 1 7T 2 , tan -1 T 1 v-tan -1 T 2 v70. T 1 7T 2 ,y ss (t)=XT 2 21+T 2 1 v 2 T 1 21+T 2 2 v 2 sin Avt+tan -1 T 1 v-tan -1 T 2 vBf= / G(jv) =tan -1 T 1 v-tan -1 T 2 v@G(jv)@=T 2 21+T 2 1 v 2 T 1 21+T 2 2 v 2 G(jv)=jv+1 T 1 jv+1 T 2 =T 2 A1+T 1 jvB T 1 A1+T 2 jvBG(s) =s+1 T 1 s+1 T 2 y ss (t)=XK 21+T 2 v 2 sin Avt-tan -1 TvBf= / G(jv) =-tan -1 Tv@G(jv)@=K 21+T 2 v 2 Openmirrors.comSection 7–2 / Bode Diagrams 4031.Bode diagram or logarithmic plot 2.Nyquist plot or polar plot 3.Log-magnitude-versus-phase plot (Nichols plots) We shall discuss these representations in detail in this chapter. We shall include the MATLAB approach to obtain Bode diagrams, Nyquist plots, and Nichols plots. Outline of the Chapter. Section 7–1 has presented introductory material on the frequency response. Section 7–2 presents Bode diagrams of various transfer-functionsystems. Section 7–3 treats polar plots of transfer functions. Section 7–4 discusses log-magnitude-versus-phase plots. Section 7–5 gives a detailed account of the Nyquiststability criterion. Section 7–6 discusses the stability analysis based on the Nyquist sta-bility criterion. Section 7–7 introduces measures of relative stability analysis. Sec-tion 7–8 presents a method for obtaining the closed-loop frequency response fromthe open-loop frequency response by use of the M and N circles. The Nichols chartis introduced here. Section 7–9 treats experimental determination of transfer func-tions. Section 7–10 presents introductory aspects of control systems design by thefrequency- response approach. Sections 7–11, 7–12, and 7–13 give detailed accounts of lead compensation, lag compensation, and lag–lead compensation techniques,respectively. 7–2 BODE DIAGRAMS Bode Diagrams or Logarithmic Plots. A Bode diagram consists of two graphs: One is a plot of the logarithm of the magnitude of a sinusoidal transfer function; theother is a plot of the phase angle; both are plotted against the frequency on a logarithmicscale. The standard representation of the logarithmic magnitude of G(jv)is 20 log@G(jv)@, where the base of the logarithm is 10.The unit used in this representation of the magnitudeis the decibel, usually abbreviated dB. In the logarithmic representation, the curves aredrawn on semilog paper, using the log scale for frequency and the linear scale for eithermagnitude (but in decibels) or phase angle (in degrees). (The frequency range of inter-est determines the number of logarithmic cycles required on the abscissa.) The main advantage of using the Bode diagram is that multiplication of magni- tudes can be converted into addition. Furthermore, a simple method for sketching anapproximate log-magnitude curve is available. It is based on asymptotic approxima-tions. Such approximation by straight-line asymptotes is sufficient if only rough in-formation on the frequency-response characteristics is needed. Should the exact curvebe desired, corrections can be made easily to these basic asymptotic plots. Expandingthe low-frequency range by use of a logarithmic scale for the frequency is highlyadvantageous, since characteristics at low frequencies are most important in practicalsystems. Although it is not possible to plot the curves right down to zero frequencybecause of the logarithmic frequency (log0=– q), this does not create a serious problem. Note that the experimental determination of a transfer function can be made simple if frequency-response data are presented in the form of a Bode diagram.404 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method Decibels (dB) Numbers0.01 0.02 0.04 0.1 0.2 0.4 0.6 1 2 3 4 5 6 8 1020 10 0 –10 –20 –30 –40 Figure 7–4 Number–decibel conversion line. Basic Factors of G(jV)H(jV).As stated earlier, the main advantage in using the logarithmic plot is the relative ease of plotting frequency-response curves. The basic factors that very frequently occur in an arbitrary transfer function G(jv)H(jv)are 1.Gain K 2.Integral and derivative factors (jv) <1 3.First-order factors (1+jvT) <1 4.Quadratic factors Once we become familiar with the logarithmic plots of these basic factors, it is possible to utilize them in constructing a composite logarithmic plot for any general form of G(jv)H(jv)by sketching the curves for each factor and adding individual curves graphically, because adding the logarithms of the gains corresponds to multiplying them together. The Gain K. A number greater than unity has a positive value in decibels, while a number smaller than unity has a negative value.The log-magnitude curve for a constant gain Kis a horizontal straight line at the magnitude of 20 log Kdecibels.The phase angle of the gain Kis zero. The effect of varying the gain Kin the transfer function is that it raises or lowers the log-magnitude curve of the transfer function by the corresponding constant amount, but it has no effect on the phase curve. A number–decibel conversion line is given in Figure 7–4. The decibel value of any number can be obtained from this line. As a number increases by a factor of 10, the corresponding decibel value increases by a factor of 20. This may be seen from the following: Similarly, 20log AK*10 n B=20logK+20n20log (K*10) =20logK+20C1+2zAjv/H20862v n B+Ajv/H20862v n B 2 D <1 Openmirrors.comSection 7–2 / Bode Diagrams 405Note that, when expressed in decibels, the reciprocal of a number differs from its value only in sign; that is, for the number K, Integral and Derivative Factors (jV)/H115511.The logarithmic magnitude of 1/jvin decibels is The phase angle of 1/jvis constant and equal to –90°. In Bode diagrams, frequency ratios are expressed in terms of octaves or decades.An octave is a frequency band from v1to 2v1, where v1is any frequency value.A decade is a frequency band from v1to 10v1, where again v1is any frequency. (On the logarithmic scale of semilog paper, any given frequency ratio can be represented by the same hori-zontal distance. For example, the horizontal distance from v=1 tov=10 is equal to that from v=3 tov=30 .) If the log magnitude –20logvdB is plotted against von a logarithmic scale, it is a straight line.To draw this straight line, we need to locate one point (0dB,v=1) on it. Since the slope of the line is –20 dB /H20862decade (or –6dB /H20862octave). Similarly, the log magnitude of jvin decibels is The phase angle of jvis constant and equal to 90°.The log-magnitude curve is a straight line with a slope of 20 dB /H20862decade. Figures 7–5(a) and (b) show frequency-response curves for 1/jvand jv, respectively. We can clearly see that the differences in the frequency responses of the factors 1/jvand jvlie in the signs of the slopes of the log- magnitude curves and in the signs of the phase angles. Both log magnitudes becomeequal to 0 dB at v=1 . If the transfer function contains the factor (1/jv) nor(jv)n, the log magnitude becomes, respectively, or The slopes of the log-magnitude curves for the factors (1/jv)nand (jv)nare thus –20n dB /H20862decade and 20ndB /H20862decade, respectively. The phase angle of (1/jv)nis equal to–90°*n over the entire frequency range, while that of (jv)nis equal to 90° *n over the entire frequency range. The magnitude curves will pass through the point(0dB,v=1) .20log @(jv)n@=n*20log ∑jv∑=20nlogv dB20log 21 (jv)n2=-n*20log ∑jv∑=-20nlogv dB20log ∑jv∑=20logv dB(-20log10v) dB=(-20logv-20) dB20log21 jv2=-20logv dB20logK=-20log 1 K406 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method First-Order Factors (1 /H11545jVT) /H115511 .The log magnitude of the first-order factor 1/(1+j vT)is For low frequencies, such that v/H112701/T, the log magnitude may be approximated by Thus, the log-magnitude curve at low frequencies is the constant 0-dB line. For high frequencies, such that v/H112711/T, This is an approximate expression for the high-frequency range. At v=1/T , the log magnitude equals 0 dB; at v=10/T , the log magnitude is –20 dB. Thus, the value of –20logvTdB decreases by 20 dB for every decade of v. For v/H112711/T, the log-magnitude curve is thus a straight line with a slope of –20 dB/decade (or –6dB/octave). Our analysis shows that the logarithmic representation of the frequency-response curve of the factor 1/(1+j vT)can be approximated by two straight-line asymptotes, one a straight line at 0 dB for the frequency range 0<v<1/T and the other a straight line with slope –20dB/decade (or –6dB /H20862octave) for the frequency range 1/T< v<q. The exact log-magnitude curve, the asymptotes, and the exact phase-angle curve are shown in Figure 7–6. The frequency at which the two asymptotes meet is called the corner frequency or break frequency. For the factor 1/(1+j vT), the frequency v=1/T is the corner fre- quency, since at v=1/T the two asymptotes have the same value. (The low-frequency asymptotic expression at v=1/T is 20 log 1 dB =0 dB, and the high-frequency-20log21+v 2 T 2 /H11216-20logvT dB-20log21+v 2 T 2 /H11216-20log1=0 dB20log 2 1 1+jvT 2 =-20log21+v 2 T 2 dB dB 40 20 0 –40–20 0.1 10 1 100 vSlope = –20 dB/decade Bode diagram of G(jv)= 1/jv (a) f 0° –180 °–90° 0.1 10 1 100 v dB 40 20 0 –40–20 0.1 10 1 100 vSlope = 20 dB/decade Bode diagram of G(jv)=jv (b) f 180° 0°90° 0.1 10 1 100 v Figure 7–5 (a) Bode diagram of G(jv)=1/j v; (b) Bode diagram of G(jv)=jv. Openmirrors.comSection 7–2 / Bode Diagrams 40710 0 –10 –20 0° –45° –90°fdB v1 20T1 10T1 5T1 T1 2T2 T5 T10 T20 TExact curveAsymptote AsymptoteCorner frequency Figure 7–6 Log-magnitudecurve, together withthe asymptotes, andphase-angle curve of 1/(1+j vT). asymptotic expression at v=1/T is also 20 log 1 dB =0 dB.) The corner frequency divides the frequency-response curve into two regions: a curve for the low-frequency re-gion and a curve for the high-frequency region.The corner frequency is very importantin sketching logarithmic frequency-response curves. The exact phase angle fof the factor 1/(1+j vT)is At zero frequency, the phase angle is 0°. At the corner frequency, the phase angle is At infinity, the phase angle becomes –90°. Since the phase angle is given by an inverse- tangent function, the phase angle is skew symmetric about the inflection point atf=–45 °. The error in the magnitude curve caused by the use of asymptotes can be calculated. The maximum error occurs at the corner frequency and is approximately equal to –3dB, since The error at the frequency one octave below the corner frequency—that is, at v=1/(2T) —is The error at the frequency one octave above the corner frequency—that is, at v=2/T — is -20log22 2+1+20log2=-20log 15 2=-0.97 dB-20logA1 4+1+20log1=-20log 15 2=-0.97 dB-20log11+1+20log1=-10log2=-3.03 dBf=-tan-1T T=-tan-11=-45°f=-tan-1vT408 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method 0 –1 –2 –3 –4dBCorner frequency 1 10T 1 5T 1 2T 1 T 2 T 3 T 5 T 10 T v Figure 7–7 Log-magnitude error in the asymptotic expression of the frequency-response curve of 1/(1+j vT). Thus, the error at one octave below or above the corner frequency is approximately equal to –1dB. Similarly, the error at one decade below or above the corner frequency is approximately –0.04 dB. The error in decibels involved in using the asymptotic ex- pression for the frequency-response curve of 1/(1+j vT)is shown in Figure 7–7. The error is symmetric with respect to the corner frequency. Since the asymptotes are quite easy to draw and are sufficiently close to the exact curve, the use of such approximations in drawing Bode diagrams is convenient in es- tablishing the general nature of the frequency-response characteristics quickly with a minimum amount of calculation and may be used for most preliminary design work. If accurate frequency-response curves are desired, corrections may easily be made by re- ferring to the curve given in Figure 7–7. In practice, an accurate frequency-response curve can be drawn by introducing a correction of 3 dB at the corner frequency and a correction of 1 dB at points one octave below and above the corner frequency and then connecting these points by a smooth curve. Note that varying the time constant Tshifts the corner frequency to the left or to the right, but the shapes of the log-magnitude and the phase-angle curves remain the same. The transfer function 1/(1+j vT)has the characteristics of a low-pass filter. For frequencies above v=1/T , the log magnitude falls off rapidly toward –q.This is es- sentially due to the presence of the time constant. In the low-pass filter, the output can follow a sinusoidal input faithfully at low frequencies. But as the input frequen- cy is increased, the output cannot follow the input because a certain amount of time is required for the system to build up in magnitude. Thus, at high frequencies, the amplitude of the output approaches zero and the phase angle of the output approaches –90°. Therefore, if the input function contains many harmonics, then the low-frequency components are reproduced faithfully at the output, while the high- frequency components are attenuated in amplitude and shifted in phase.Thus, a first- order element yields exact, or almost exact, duplication only for constant or slowly varying phenomena. An advantage of the Bode diagram is that for reciprocal factors—for example, the factor 1+jvT—the log-magnitude and the phase-angle curves need only be changed in sign, since 20 log ∑1+jvT∑=-20 log 2 1 1+jvT 2 Openmirrors.comSection 7–2 / Bode Diagrams 409dB 40 20 0 –40–20 v f 90° 0°45° vExact curve Asymptote 0.01 T0.1 T1 T10 T 0.01 T0.1 T1 T10 TAsymptote Figure 7–8 Log-magnitudecurve, together with the asymptotes, and phase-angle curvefor1+jvT.and The corner frequency is the same for both cases. The slope of the high-frequency as- ymptote of 1+jvTis 20 dB /H20862decade, and the phase angle varies from 0° to 90° as the fre- quency vis increased from zero to infinity. The log-magnitude curve, together with the asymptotes, and the phase-angle curve for the factor 1+jvTare shown in Figure 7–8. To draw a phase curve accurately, we have to locate several points on the curve.The phase angles of (1+jvT)<1are For the case where a given transfer function involves terms like (1+jvT)<n, a similar asymptotic construction may be made.The corner frequency is still at v=1/T , and the asymptotes are straight lines. The low-frequency asymptote is a horizontal straight line <84.3° at v=10 T <63.4° at v=2 T <5.7° at v=1 10T <26.6° at v=1 2T <45° at v=1 T/1+jvT=tan-1vT=-n1 1+jvT410 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method at 0 dB, while the high-frequency asymptote has the slope of –20n dB /H20862decade or 20n dB /H20862decade. The error involved in the asymptotic expressions is ntimes that for (1+jvT) <1 . The phase angle is ntimes that of (1+jvT) <1 at each frequency point. Quadratic Factors C1/H115452ZAjV/V n B/H11545AjV/V n B 2 D /H115511 .Control systems often possess quadratic factors of the form G(j◊)= (7–7) Ifz>1 , this quadratic factor can be expressed as a product of two first-order factors with real poles. If 0<z<1 , this quadratic factor is the product of two complex- conjugate factors.Asymptotic approximations to the frequency-response curves are not accurate for a factor with low values of z. This is because the magnitude and phase of the quadratic factor depend on both the corner frequency and the damping ratio z. The asymptotic frequency-response curve may be obtained as follows: Since for low frequencies such that v/H11270v n , the log magnitude becomes The low-frequency asymptote is thus a horizontal line at 0 dB. For high frequencies such thatv/H11271v n , the log magnitude becomes The equation for the high-frequency asymptote is a straight line having the slope –40 dB /H20862decade, since The high-frequency asymptote intersects the low-frequency one at v=v n , since at this frequency This frequency, v n , is the corner frequency for the quadratic factor considered. The two asymptotes just derived are independent of the value of z. Near the frequency v=v n , a resonant peak occurs, as may be expected from Equation (7–7). The damping ratiozdetermines the magnitude of this resonant peak. Errors obvi- ously exist in the approximation by straight-line asymptotes. The magnitude of the error depends on the value of z. It is large for small values of z. Figure 7–9 shows the exact log-magnitude curves, together with the straight-line asymptotes and the exact-40log v n v n =-40log1=0 dB-40log 10v v n =-40-40log v v n -20log v 2 v 2 n =-40logv v n dB-20log1=0 dB20log 3 1 1+2z a j v v n b + a j v v n b 2 3 =-20logB a 1-v 2 v 2 n b 2 + a 2z v v n b 2 1 1+2z a jv v n b + a jv v n b 2 Openmirrors.comSection 7–2 / Bode Diagrams 41120 10 –100 fdB 0° –90° –180° 0.4 0.6 0.8 1 2 4 6 8 10 0.1 0.2 v vnz = 0.1 z = 0.2 z = 0.3 z = 0.5 z = 0.7 z = 1.0 z = 0.1 z = 0.2 z = 0.3 z = 0.5 z = 0.7 z = 1.0Asymptotes Figure 7–9 Log-magnitudecurves, together with the asymptotes, and phase-angle curvesof the quadratictransfer function given by Equation (7–7). phase-angle curves for the quadratic factor given by Equation (7–7) with several values ofz. If corrections are desired in the asymptotic curves, the necessary amounts of cor- rection at a sufficient number of frequency points may be obtained from Figure 7–9. The phase angle of the quadratic factor C1+2zAjv/vnB+Ajv/vnB2D–1is (7–8) The phase angle is a function of both vandz. At v=0 , the phase angle equals 0°. At the corner frequency v=vn, the phase angle is –90° regardless of z, since Atv=q, the phase angle becomes –180 °. The phase-angle curve is skew symmetric about the inflection point—the point where f=–90 °.There are no simple ways to sketch such phase curves. We need to refer to the phase-angle curves shown in Figure 7–9.f=-tan-1a2z 0b=-tan-1q=- 90°f=n1 1+2zaj v vnb+aj v vnb2=-tan-1 ≥2z v vn 1-av vnb2¥412 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method The frequency-response curves for the factor can be obtained by merely reversing the sign of the log magnitude and that of the phase angle of the factor To obtain the frequency-response curves of a given quadratic transfer function, we must first determine the value of the corner frequency v n and that of the damping ratio z. Then, by using the family of curves given in Figure 7–9, the frequency-response curves can be plotted. The Resonant Frequency V r and the Resonant Peak Value M r .The magnitude of is (7–9) If has a peak value at some frequency, this frequency is called the resonant frequency. Since the numerator of is constant, a peak value of will occur when (7–10) is a minimum. Since Equation (7–10) can be written (7–11) the minimum value of g(v)occurs at Thus the resonant frequency v r is (7–12) As the damping ratio zapproaches zero, the resonant frequency approaches v n .F o r 0<z/H113490.707, the resonant frequency v r is less than the damped natural frequency which is exhibited in the transient response. From Equation (7–12), it can be seen that for z>0.707, there is no resonant peak. The magnitude de- creases monotonically with increasing frequency v. (The magnitude is less than 0 dB for all values of v>0 . Recall that, for 0.7<z<1 , the step response is oscillatory, but the oscillations are well damped and are hardly perceptible.)@G(jv)@v d =v n 21-z 2 ,v r =v n 21-2z 2 , for 0/H11349z/H113490.707v=v n 21-2z 2 .g(v)= c v 2 -v 2 n A1-2z 2 B v 2 n d 2 +4z 2 A1-z 2 Bg(v)= a 1-v 2 v 2 n b 2 + a 2zv v n b 2 @G(jv)@ @G(jv)@@G(jv)@@G(jv)@=1 B a 1-v 2 v 2 n b 2 + a 2zv v n b 2 G(jv)=1 1+2z a j v v n b + a j v v n b 2 1 1+2z a jv v n b + a jv v n b 2 1+2z a j v v n b + a j v v n b 2 Openmirrors.comSection 7–2 / Bode Diagrams 41314 12 10 8 6 4 2 0 z0.2 1.0 0.8 0.6 0.4Mr in dB Figure 7–10 Mr-versus- zcurve for the second-ordersystem1/C1+2zAjv/H20862v nB+ Ajv/H20862vnB2D. For 0 /H11349z/H113490.707, the magnitude of the resonant peak, Mr=|G(j vr)|, can be found from Equations (7–12) and (7–9). For 0 /H11349z/H113490.707, (7–13) For z>0.707 , (7–14) Aszapproaches zero, Mrapproaches infinity. This means that if the undamped system is excited at its natural frequency, the magnitude of G(jv)becomes infinity. The rela- tionship between Mrandzis shown in Figure 7–10. The phase angle of G(jv)at the frequency where the resonant peak occurs can be obtained by substituting Equation (7–12) into Equation (7–8). Thus, at the resonantfrequency v r, General Procedure for Plotting Bode Diagrams. MATLAB provides an easy way to plot Bode diagrams. (The MATLAB approach is presented later in this section.)Here, however, we consider the case where we want to draw Bode diagrams manuallywithout using MATLAB. First rewrite the sinusoidal transfer function G(jv)H(jv)as a product of basic factors discussed above.Then identify the corner frequencies associated with these basic factors.Finally, draw the asymptotic log-magnitude curves with proper slopes between the cornerfrequencies. The exact curve, which lies close to the asymptotic curve, can be obtainedby adding proper corrections. The phase-angle curve of G(jv)H(jv)can be drawn by adding the phase-angle curves of individual factors. The use of Bode diagrams employing asymptotic approximations requires much less time than other methods that may be used for computing the frequency response of atransfer function. The ease of plotting the frequency-response curves for a given trans-fer function and the ease of modification of the frequency-response curve as compensationis added are the main reasons why Bode diagrams are very frequently used in practice./GAjvrB=-tan-121-2z2 z=-90°+sin-1z 21-z2Mr=1Mr=@G(jv)@max=@GAjvrB@=1 2z21-z2414 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method EXAMPLE 7–3 Draw the Bode diagram for the following transfer function: Make corrections so that the log-magnitude curve is accurate. To avoid any possible mistakes in drawing the log-magnitude curve, it is desirable to put G(jv) in the following normalized form, where the low-frequency asymptotes for the first-order factors and the second-order factor are the 0-dB line: This function is composed of the following factors: The corner frequencies of the third, fourth, and fifth terms are v=3 ,v=2 , and respectively. Note that the last term has the damping ratio of 0.3536. To plot the Bode diagram, the separate asymptotic curves for each of the factors are shown in Figure 7–11.The composite curve is then obtained by algebraically adding the individual curves, also shown in Figure 7–11. Note that when the individual asymptotic curves are added at each fre- quency, the slope of the composite curve is cumulative. Below the plot has the slope of –20 dB /H20862decade.At the first corner frequency the slope changes to –60 dB /H20862decade and continues to the next corner frequency v=2 , where the slope becomes –80 dB /H20862decade. At the last corner frequency v=3 , the slope changes to –60 dB /H20862decade. Once such an approximate log-magnitude curve has been drawn, the actual curve can be obtained by adding corrections at each corner frequency and at frequencies one octave below and above the corner frequencies. For first-order factors (1+jvT) <1 , the corrections are ;3d B at the corner frequency and ;1 dB at the frequencies one octave below and above the corner frequency. Corrections necessary for the quadratic factor are obtained from Figure 7–9.The exact log-magnitude curve for G(jv)is shown by a dashed curve in Figure 7–11. Note that any change in the slope of the magnitude curve is made only at the corner frequencies of the transfer function G(jv). Therefore, instead of drawing individual magnitude curves and adding them up, as shown, we may sketch the magnitude curve without sketching individual curves. We may start drawing the lowest-frequency portion of the straight line (that is, the straight line with the slope –20 dB /H20862decade for ). As the frequency is increased, we get the effect of the complex-conjugate poles (quadratic term) at the corner frequency The complex-conjugate poles cause the slopes of the magnitude curve to change from –20 to–60 dB /H20862decade. At the next corner frequency, v=2 , the effect of the pole is to change the slope to –80 dB /H20862decade. Finally, at the corner frequency v=3 , the effect of the zero is to change the slope from –80 to–60 dB /H20862decade. For plotting the complete phase-angle curve, the phase-angle curves for all factors have to be sketched. The algebraic sum of all phase-angle curves provides the complete phase-angle curve, as shown in Figure 7–11.v=12 .v612 v=12 ,v=12 ,v=12 ,7.5, (jv) -1 , 1+j v 3, a 1+j v 2 b -1 , c 1+j v 2+(jv) 2 2 d -1 G(jv)=7.5 a jv 3+1 b (jv) a jv 2+1 b c (jv) 2 2+jv 2+1 d G(jv)=10(jv+3) (jv)(jv+2)C(jv) 2 +jv+2D Openmirrors.comSection 7–2 / Bode Diagrams 41540 20 0 –20dB –40Exact curve 0.2 0.4 0.6 0.8 1 2 4 6 8 10v –270°–180°–90°0°90° 0.2 0.4 0.6 0.8 1 2 4 6 8 10vfG(jv) 2 25 54 431 G(jv)3 1 Figure 7–11 Bode diagram of thesystem considered in Example 7–3. Minimum-Phase Systems and Nonminimum-Phase Systems. Transfer func- tions having neither poles nor zeros in the right-half splane are minimum-phase trans- fer functions, whereas those having poles and/or zeros in the right-half splane are nonminimum-phase transfer functions. Systems with minimum-phase transfer functionsare called minimum-phase systems, whereas those with nonminimum-phase transfer functions are called nonminimum-phase systems. For systems with the same magnitude characteristic, the range in phase angle of the minimum-phase transfer function is minimum among all such systems, while the range inphase angle of any nonminimum-phase transfer function is greater than this minimum. It is noted that for a minimum-phase system, the transfer function can be uniquely determined from the magnitude curve alone. For a nonminimum-phase system, this isnot the case. Multiplying any transfer function by all-pass filters does not alter themagnitude curve, but the phase curve is changed. Consider as an example the two systems whose sinusoidal transfer functions are, respectively, G 1(jv)=1+jvT 1+jvT1, G2(jv)=1-jvT 1+jvT1, 06T6T1416 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method f 0° –90° –180°G 1 (jv) G 2 (jv) v Figure 7–13 Phase-angle characteristics of the systems G 1 (s)and G 2 (s)shown in Figure 7–12. The pole–zero configurations of these systems are shown in Figure 7–12. The two sinu- soidal transfer functions have the same magnitude characteristics, but they have differ- ent phase-angle characteristics, as shown in Figure 7–13. These two systems differ from each other by the factor The magnitude of the factor (1-jvT)/(1+j vT)is always unity. But the phase angle equals –2tan –1 vTand varies from 0° to –180 ° as vis increased from zero to infinity. As stated earlier, for a minimum-phase system, the magnitude and phase-angle char- acteristics are uniquely related. This means that if the magnitude curve of a system is specified over the entire frequency range from zero to infinity, then the phase-angle curve is uniquely determined, and vice versa. This, however, does not hold for a non- minimum-phase system. Nonminimum-phase situations may arise in two different ways. One is simply when a system includes a nonminimum-phase element or elements. The other situation may arise in the case where a minor loop is unstable. For a minimum-phase system, the phase angle at v=qbecomes –90°(q-p) , where pand qare the degrees of the numerator and denominator polynomials of the transfer function, respectively. For a nonminimum-phase system, the phase angle at v=qdiffers from –90°(q-p) . In either system, the slope of the log-magnitude curve atv=qis equal to –20(q-p) dB /H20862decade. It is therefore possible to detect whether the system is minimum phase by examining both the slope of the high-frequency asymptote of the log-magnitude curve and the phase angle at v=q. If the slope of the log-magnitude curve as vapproaches infinity is –20(q-p) dB /H20862decade and the phase angle at v=qis equal to –90°(q-p) , then the system is minimum phase.G(jv)=1-jvT 1+jvT jv 1 T –1 T 1 –1 T 1 –s G 1 (s)=1+Ts 1+T 1 s jv 1 T s G 2 (s)=1–Ts 1+T 1 s 0 0 Figure 7–12 Pole–zero configurations of a minimum-phase system G 1 (s)and nonminimum-phase system G 2 (s). Openmirrors.comSection 7–2 / Bode Diagrams 4170° –100° –200° –300° – 400° –500° – 600° 0.1 0.2 0.4 0.6 0.8 1 10 24 6 8 vTe–jvTG G(jv)=e–jvT |G(jv)| = 0 dB Figure 7–14 Phase-anglecharacteristic of transport lag.Nonminimum-phase systems are slow in responding because of their faulty behavior at the start of a response. In most practical control systems, excessive phase lag should becarefully avoided. In designing a system, if fast speed of response is of primary importance,we should not use nonminimum-phase components. (A common example of nonmini-mum-phase elements that may be present in control systems is transport lag or dead time.) It is noted that the techniques of frequency-response analysis and design to be presented in this and the next chapter are valid for both minimum-phase andnonminimum-phase systems. Transport Lag. Transport lag, which is also called dead time, is of nonminimum- phase behavior and has an excessive phase lag with no attenuation at high frequencies.Such transport lags normally exist in thermal, hydraulic, and pneumatic systems. Consider the transport lag given by The magnitude is always equal to unity, since Therefore, the log magnitude of the transport lag e –jvTis equal to 0 dB. The phase angle of the transport lag is The phase angle varies linearly with the frequency v.The phase-angle characteristic of transport lag is shown in Figure 7–14. =-57.3 vT (degrees ) /G(jv)=-vT (radians )@G(jv)@=∑cosvT-jsinvT∑=1G(jv)=e-jvT418 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method 0°–20–1001020 –100° –200° –300°0° –90° –180° –270° 0.1 0.2 0.4 0.6 0.8 1 10 24 6 8 v dB e –0.5jv 1 +jv e –0.5jv 1 1+jv e –0.5jv 1+jv Figure 7–15 Bode diagram for the system e –jvL /(1+j vT) with L=0.5 andT=1. EXAMPLE 7–4 Draw the Bode diagram of the following transfer function: The log magnitude is The phase angle of G(jv)is The log-magnitude and phase-angle curves for this transfer function with L=0.5 andT=1 are shown in Figure 7–15. =-vL-tan -1 vT / G(jv) = / e -jvL + n 1 1+jvT =0+20log 2 1 1+jvT 2 20log @G(jv)@=20log @e -jvL @+20log 2 1 1+jvT 2 G(jv)=e -jvL 1+jvT Openmirrors.comSection 7–2 / Bode Diagrams 419R(s) C(s) E(s) G(s) +– Figure 7–16 Unity-feedbackcontrol system. dB 20 log Kp 0–20 dB/decade –40 dB/decade v in log scale Figure 7–17 Log-magnitude curveof a type 0 system.Relationship between System Type and Log-Magnitude Curve. Consider the unity-feedback control system. The static position, velocity, and acceleration error con-stants describe the low-frequency behavior of type 0, type 1, and type 2 systems,respectively. For a given system, only one of the static error constants is finite andsignificant. (The larger the value of the finite static error constant, the higher the loopgain is as vapproaches zero.) The type of the system determines the slope of the log-magnitude curve at low frequencies. Thus, information concerning the existence and magnitude of the steady-state error of a control system to a given input can be determined from the observationof the low-frequency region of the log-magnitude curve. Determination of Static Position Error Constants. Consider the unity-feedback control system shown in Figure 7–16. Assume that the open-loop transfer function isgiven by or Figure 7–17 shows an example of the log-magnitude plot of a type 0 system. In such a system, the magnitude of G(jv)equals K pat low frequencies, or It follows that the low-frequency asymptote is a horizontal line at 20 log KpdB.lim vS0G(jv)=K=KpG(jv)=KATa jv+1BATb jv+1B p ATm jv+1B (jv)NAT1 jv+1BAT2 jv+1B p ATp jv+1BG(s) =KATa s+1BATb s+1BpATm s+1B sNAT1 s+1BAT2 s+1BpATp s+1B420 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method Determination of Static Velocity Error Constants. Consider the unity-feedback control system shown in Figure 7–16. Figure 7–18 shows an example of the log-magnitude plot of a type 1 system. The intersection of the initial –20-dB /H20862decade segment (or its extension) with the line v=1 has the magnitude 20 log K v .This may be seen as follows: In a type 1 system Thus, The intersection of the initial –20-dB /H20862decade segment (or its extension) with the 0-dB line has a frequency numerically equal to K v . To see this, define the frequency at this intersection to be v 1 ; then or As an example, consider the type 1 system with unity feedback whose open-loop transfer function is If we define the corner frequency to be v 2 and the frequency at the intersection of the –40-dB /H20862decade segment (or its extension) with 0-dB line to be v 3 , then v 2 =F J, v 2 3 =K JG(s) =K s(Js +F)K v =v 1 2 K v jv 1 2 =120log 2 K v jv 2 v=1 =20logK v G(jv)=K v jv, for v/H112701 dB 0–20 dB/decade –40 dB/decadev in log scale 20 log K v v 1 v 2 v 3 v = 1 Figure 7–18 Log-magnitude curve of a type 1 system. Openmirrors.comSection 7–2 / Bode Diagrams 421dB 0–20 dB/decade–40 dB/decade –60 dB/decade v in log scale20 log Ka v = 1va =Ka Figure 7–19 Log-magnitude curveof a type 2 system.Since it follows that or On the Bode diagram, Thus, the v3point is just midway between the v2andv1points. The damping ratio zof the system is then Determination of Static Acceleration Error Constants. Consider the unity- feedback control system shown in Figure 7–16. Figure 7–19 shows an example of thelog-magnitude plot of a type 2 system. The intersection of the initial –40-dB /H20862decade segment (or its extension) with the v=1 line has the magnitude of 20 log K a. Since at low frequencies it follows that 20log 2Ka (jv)22 v=1=20logKaG(jv)=Ka (jv)2, for v/H112701z=F 21KJ=v2 2v3logv1-logv3=logv3-logv2v1 v3=v3 v2v1 v2=v2 3v1=Kv=K F422 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method The frequency v a at the intersection of the initial –40-dB /H20862decade segment (or its extension) with the 0-dB line gives the square root of K a numerically. This can be seen from the following: which yields Plotting Bode Diagrams with MATLAB. The command bode computes magni- tudes and phase angles of the frequency response of continuous-time, linear, time- invariant systems. When the command bode (without left-hand arguments) is entered in the computer, MATLAB produces a Bode plot on the screen. Most commonly used bode commands are bode(num,den) bode(num,den,w) bode(A,B,C,D) bode(A,B,C,D,w) bode(A,B,C,D,iu,w) bode(sys) When invoked with left-hand arguments, such as [mag,phase,w] = bode(num,den,w) bode returns the frequency response of the system in matrices mag,phase , and w.N o plot is drawn on the screen.The matrices mag andphase contain magnitudes and phase angles of the frequency response of the system, evaluated at user-specified frequency points.The phase angle is returned in degrees.The magnitude can be converted to deci- bels with the statement magdB = 20*log10(mag) Other Bode commands with left-hand arguments are [mag,phase,w] = bode(num,den) [mag,phase,w] = bode(num,den,w) [mag,phase,w] = bode(A,B,C,D) [mag,phase,w] = bode(A,B.C,D,w) [mag,phase,w] = bode(A,B,C,D,iu,w) [mag,phase,w] = bode(sys) To specify the frequency range, use the command logspace(d1,d2) orlogspace (d1,d2,n). logspace(d1,d2) generates a vector of 50 points logarithmically equally spaced between decades 10 d1 and10 d2 . (50 points include both endpoints. There are 48 points between the endpoints.) To generate 50 points between 0.1 rad /H20862sec and 100 rad /H20862sec, enter the command w = logspace(-1,2)v a =1K a 20log 2 K a Ajv a B 2 2 =20log1=0 Openmirrors.comSection 7–2 / Bode Diagrams 423MATLAB Program 7–1 num = [25]; den = [1 4 25];bode(num,den)title('Bode Diagram of G(s) = 25/(s^2 + 4s + 25)') Frequency (rad/sec)Bode Diagram of G(s) = 25/( s2 + 4s + 25) −200−50 −100 −1500−60−40−20Phase (deg); Magnitude (dB)20 0 100101102Figure 7–20 Bode diagram of G(s) =25 s2+4s+25.logspace(dl,d2,n) generates npoints logarithmically equally spaced between decades 10d1and10d2.(npoints include both endpoints.) For example, to generate 100 points in- cluding both endpoints between 1 rad /H20862sec and 1000 rad /H20862sec, enter the following command: w = logspace(0,3,100) To incorporate the user-specified frequency points when plotting Bode diagrams, thebode command must include the frequency vector w, such as bode(num,den,w) and [mag,phase,w] = bode(A,B,C,D,w) . EXAMPLE 7–5 Consider the following transfer function: Plot a Bode diagram for this transfer function. When the system is defined in the form use the command bode(num,den) to draw the Bode diagram. [When the numerator and denom- inator contain the polynomial coefficients in descending powers of s,bode(num,den) draws the Bode diagram.] MATLAB Program 7–1 shows a program to plot the Bode diagram for this sys-tem. The resulting Bode diagram is shown in Figure 7–20.G(s) =num (s) den(s)G(s) =25 s2+4s+25424 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method Frequency (rad/sec)Bode Diagram of G(s) = 9( s 2 + 0.2 s + 1)/[ s(s 2 + 1.2 s + 9)] −1000 −50100 50−20 Phase (deg); Magnitude (dB) −1040 0102030 10 −2 10 −1 10 0 10 1 Figure 7–22 Bode diagram of G(s) =9As 2 +0.2s +1B sAs 2 +1.2s +9B. EXAMPLE 7–6 Consider the system shown in Figure 7–21. The open-loop transfer function is Plot a bode diagram. MATLAB Program 7–2 plots a Bode diagram for the system.The resulting plot is shown in Figure 7–22. The frequency range in this case is automatically determined to be from 0.01 to 10 rad /H20862sec.G(s) =9As 2 +0.2s +1B sAs 2 +1.2s +9B 9(s 2 + 0.2s+ 1) s(s 2 + 1.2s+ 9) +– Figure 7–21 Control system. MATLAB Program 7–2 num = [9 1.8 9]; den = [1 1.2 9 0]; bode(num,den) title('Bode Diagram of G(s) = 9(s^2 + 0.2s + 1)/[s(s^2 + 1.2s + 9)]') Openmirrors.comSection 7–2 / Bode Diagrams 425Frequency (rad/sec)Bode Diagram of G(s) = 9( s2 + 0.2 s + 1)/[ s(s2 + 1.2 s + 9)] −100−50050100−50Phase (deg); Magnitude (dB)050 10−210−1100101102103Figure 7–23 Bode diagram of G(s) =9As2+0.2s +1B sAs2+1.2s +9B.MATLAB Program 7–3 num = [9 1.8 9]; den = [1 1.2 9 0];w = logspace(-2,3,100);bode(num,den,w)title('Bode Diagram of G(s) = 9(s^2 + 0.2s + 1)/[s(s^2 + 1.2s + 9)]')If it is desired to plot the Bode diagram from 0.01 to 1000 rad /H20862sec, enter the following command: w = logspace(-2,3,100) This command generates 100 points logarithmically equally spaced between 0.01 and 100 rad /H20862sec. (Note that such a vector wspecifies the frequencies in radians per second at which the frequency response will be calculated.) If we use the command bode(num,den,w) then the frequency range is as the user specified, but the magnitude range and phase-angle range will be automatically determined. See MATLAB Program 7–3 and the resulting plot inFigure 7–23.426 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method Obtaining Bode Diagrams of Systems Defined in State Space. Consider the system defined by where state vector ( n-vector) output vector ( m-vector) control vector ( r-vector) state matrix ( n*n matrix) control matrix ( n*r matrix) output matrix ( m*n matrix) direct transmission matrix ( m*r matrix) A Bode diagram for this system may be obtained by entering the command bode(A,B,C,D) or others listed earlier in this section. The command bode(A,B,C,D) produces a series of Bode plots, one for each input of the system, with the frequency range automatically determined. (More points are used when the response is changing rapidly.) The command bode(A,B,C,D,iu) , where iuis the ith input of the system, produces the Bode diagrams from the input iu to all the outputs Ay 1 ,y 2 ,p,y m Bof the system, with a frequency range automatically determined. (The scalar iuis an index into the in- puts of the system and specifies which input is to be used for plotting Bode diagrams). If the control vector uhas three inputs such that then iumust be set to either 1, 2, or 3. If the system has only one input u, then either of the following commands may be used: bode(A,B,C,D) or bode(A,B,C,D,1) EXAMPLE 7–7 Consider the following system: This system has one input uand one output y. By using the command bode(A,B,C,D) y=[1 0] B x 1 x 2 R B x# 1 x# 2 R = B 0 -251 -4 RB x 1 x 2 R + B 0 25 R u u= C u 1 u 2 u 3 S D= C= B= A= u= y= x=y=Cx+Dux#=Ax+Bu Openmirrors.comSection 7–3 / Polar Plots 427Frequency (rad/sec)Bode Diagram −200−50 −100 −1500−60−40−20Phase (deg); Magnitude (dB)20 0 100101102Figure 7–24 Bode diagram of thesystem considered inExample 7–7.MATLAB Program 7–4 A = [0 1;-25 -4]; B = [0;25];C = [1 0];D = [0];bode(A,B,C,D)title('Bode Diagram')and entering MATLAB Program 7–4 into the computer, we obtain the Bode diagram shown in Figure 7–24. 7–3 POLAR PLOTS The polar plot of a sinusoidal transfer function G(jv)is a plot of the magnitude of G(jv) versus the phase angle of G(jv)on polar coordinates as vis varied from zero to infin- ity.Thus, the polar plot is the locus of vectors as vis varied from zero to infinity. Note that in polar plots a positive (negative) phase angle is measured counter-clockwise (clockwise) from the positive real axis.The polar plot is often called the Nyquistplot.An example of such a plot is shown in Figure 7–25. Each point on the polar plot ofG(jv)represents the terminal point of a vector at a particular value of v. In the polar plot, it is important to show the frequency graduation of the locus. The projections ofG(jv)on the real and imaginary axes are its real and imaginary components.@G(jv)@ /G(jv)If we replace the command bode(A,B,C,D) in MATLAB Program 7–4 with bode(A,B,C,D,1) then MATLAB will produce the Bode diagram identical to that shown in Figure 7–24.428 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method MATLAB may be used to obtain a polar plot G(jv)or to obtain and accurately for various values of vin the frequency range of interest. An advantage in using a polar plot is that it depicts the frequency-response charac- teristics of a system over the entire frequency range in a single plot. One disadvantage is that the plot does not clearly indicate the contributions of each individual factor of the open-loop transfer function. Integral and Derivative Factors (jV) /H115511 .The polar plot of G(jv)=1/j vis the negative imaginary axis, since The polar plot of G(jv)=jvis the positive imaginary axis. First-Order Factors (1/H11545jVT) /H115511 .For the sinusoidal transfer function the values of G(jv)atv=0 andv=1/T are, respectively, and Ifvapproaches infinity, the magnitude of G(jv)approaches zero and the phase angle approaches –90°. The polar plot of this transfer function is a semicircle as the frequen- cy vis varied from zero to infinity, as shown in Figure 7–26(a). The center is located at 0.5 on the real axis, and the radius is equal to 0.5. To prove that the polar plot of the first-order factor is a semi- circle, define G(jv)=X+jYG(jv)=1/H20862(1+jvT)G a j1 T b =1 12 / -45° G(j0) =1 / 0° G(jv)=1 1+jvT=1 21+v 2 T 2 / -tan -1 vT G(jv)=1 jv=-j 1 v=1 v / -90° / G(jv) @G(jv)@ Im Re G(jv) v = 0v =` v 1 v 2 v 3 G(jv) Im [G(jv)]Re [G(jv)] Figure 7–25 Polar plot. Openmirrors.comSection 7–3 / Polar Plots 429where Then we obtain Thus, in the X-Yplane G(jv)is a circle with center at and with radius as shown in Figure 7–26(b). The lower semicircle corresponds to 0 /H11349v/H11349q, and the upper semicircle corresponds to –q/H11349v/H113490. The polar plot of the transfer function 1+jvTis simply the upper half of the straight line passing through point (1,0) in the complex plane and parallel to the imaginary axis, as shown in Figure 7–27. The polar plot of 1+jvThas an appearance completely different from that of 1/(1+j vT). Quadratic Factors C1/H115452ZAjV/VnB/H11545AjV/VnB2D/H115511.The low- and high-fre- quency portions of the polar plot of the following sinusoidal transfer function are given, respectively, by and The polar plot of this sinusoidal transfer function starts at and ends at as vincreases from zero to infinity. Thus, the high-frequency portion of G(jv)is tangent to the negative real axis.0/-180° 1/0°lim vSqG(jv)=0/-180° lim vS0G(jv)=1/0°G(jv)=1 1+2zaj v vnb+aj v vnb2, for z701 2, X=1 2,Y=0aX-1 2b2 +Y2=a1 21-v2 T2 1+v2 T2b2 +a-vT 1+v2 T2b2 =a1 2b2 Y=-vT 1+v2 T2=imaginary part of G(jv) X=1 1+v2 T2=real part of G(jv)Im Re v = 00 0.5 0.5v =/H11009 (a) (b)v vv1 1+v2T2 1 1 vT= 1G j1 T/H20849 /H20849 G j1 T/H20849 /H208490Y Xv =–/H11009 v =/H11009 v = 0vT 1+v2T2 Figure 7–26 (a) Polar plot of1/(1+j vT); (b) plot ofG(jv)inX-Y plane. Im Rev = 0v` 1 0 Figure 7–27 Polar plot of1+jvT.430 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method Im Rev =` v = 0 Resonant peak v n v r 0 Figure 7–29 Polar plot showing the resonant peak and resonant frequency v r . Examples of polar plots of the transfer function just considered are shown in Figure 7–28. The exact shape of a polar plot depends on the value of the damping ratio z, but the general shape of the plot is the same for both the underdamped case (1>z>0) and overdamped case (z>1) . For the underdamped case at v=v n , we have G(jv n )=1/(j2 z), and the phase angle at v=v n is–90°. Therefore, it can be seen that the frequency at which the G(jv)locus intersects the imaginary axis is the undamped natural frequency v n .I n the polar plot, the frequency point whose distance from the origin is maximum cor- responds to the resonant frequency v r . The peak value of G(jv)is obtained as the ratio of the magnitude of the vector at the resonant frequency v r to the magnitude of the vector at v=0 .The resonant frequency v r is indicated in the polar plot shown in Figure 7–29. For the overdamped case, as zincreases well beyond unity, the G(jv)locus approaches a semicircle. This may be seen from the fact that, for a heavily damped system, the characteristic roots are real, and one is much smaller than the other. Since, for sufficiently large z, the effect of the larger root (larger in the absolute value) on the response becomes very small, the system behaves like a first-order one. v = 0Im Re 01v =/H11009 (z: Large) (z: Small)v n v n v n v n Figure 7–28 Polar plots of forz>0.1 1+2z a jv v n b + a jv v n b 2 Openmirrors.comSection 7–3 / Polar Plots 431Im Rev = 0 01v` Figure 7–30 Polar plot of forz>0. 1+2zajv vnb+ajv vnb2 Next, consider the following sinusoidal transfer function: The low-frequency portion of the curve is and the high-frequency portion is Since the imaginary part of G(jv)is positive for v>0 and is monotonically increasing, and the real part of G(jv)is monotonically decreasing from unity, the general shape of the polar plot of G(jv)is as shown in Figure 7–30. The phase angle is between 0° and 180°. EXAMPLE 7–8 Consider the following second-order transfer function: Sketch a polar plot of this transfer function. Since the sinusoidal transfer function can be written the low-frequency portion of the polar plot becomes and the high-frequency portion becomes lim vSqG(jv)=0-j0lim vS0G(jv)=-T-jqG(jv)=1 jv(1+jvT)=- T 1+v2 T2-j 1 vA1+v2 T2BG(s) =1 s(Ts +1)lim vSqG(jv)=q /180°lim vS0G(jv)=1/0° =a1-v2 v2 nb+ja2zv vnb G(jv)=1+2zaj v vnb+aj v vnb2432 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method The general shape of the polar plot of G(jv)is shown in Figure 7–31. The G(jv)plot is asymp- totic to the vertical line passing through the point (–T,0). Since this transfer function involves an integrator (1/s) , the general shape of the polar plot differs substantially from those of second-order transfer functions that do not have an integrator. EXAMPLE 7–9 Obtain the polar plot of the following transfer function: Since G(jv)can be written the magnitude and phase angle are, respectively, and Since the magnitude decreases from unity monotonically and the phase angle also decreases monotonically and indefinitely, the polar plot of the given transfer function is a spiral, as shown in Figure 7–32. / G(jv) = / e -jvL + n 1 1+jvT =-vL-tan -1 vT@G(jv)@=@e -jvL @/H11554 2 1 1+jvT 2 =1 21+v 2 T 2 G(jv)=Ae -jvL B a 1 1+jvT b G(jv)=e -jvL 1+jvT Im Re 0 0 v v` –T Figure 7–31 Polar plot of 1/Cjv(1+jvT)D. Im Re1 Figure 7–32 Polar plot of e -jvL /H20862(1+jvT). Openmirrors.comSection 7–3 / Polar Plots 433Im Re 0 00v = 0 vvvv v`` `Type 2 system Type 1 system Type 0 systemFigure 7–33 Polar plots of type 0,type 1, and type 2systems.General Shapes of Polar Plots. The polar plots of a transfer function of the form where n>m or the degree of the denominator polynomial is greater than that of the numerator, will have the following general shapes: 1.Forl=0 or type 0systems: The starting point of the polar plot (which corre- sponds to v=0 ) is finite and is on the positive real axis. The tangent to the polar plot at v=0 is perpendicular to the real axis. The terminal point, which corresponds to v=q, is at the origin, and the curve is tangent to one of the axes. 2.Forl=1 or type 1systems: thejvterm in the denominator contributes –90°t o the total phase angle of G(jv)for 0 /H11349v/H11349q.At v=0 , the magnitude of G(jv) is infinity, and the phase angle becomes –90°.At low frequencies, the polar plot is asymptotic to a line parallel to the negative imaginary axis.At v=q, the magni- tude becomes zero, and the curve converges to the origin and is tangent to one ofthe axes. 3.Forl=2 or type 2systems: The (jv) 2term in the denominator contributes –180 ° to the total phase angle of G(jv)for 0 /H11349v/H11349q. At v=0 , the magni- tude of G(jv)is infinity, and the phase angle is equal to –180 °. At low frequencies, the polar plot may be asymptotic to the negative real axis. Atv=q, the magnitude becomes zero, and the curve is tangent to one of the axes. The general shapes of the low-frequency portions of the polar plots of type 0, type 1, and type 2 systems are shown in Figure 7–33. It can be seen that, if the degree of the =b 0(jv)m+b1(jv)m-1+p a0(jv)n+a1(jv)n-1+p G(jv)=KA1+jvTaBA1+jvTbB p (jv)lA1+jvT1BA1+jvT2B p434 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method denominator polynomial of G(jv)is greater than that of the numerator, then the G(jv) loci converge to the origin clockwise.At v=q, the loci are tangent to one or the other axes, as shown in Figure 7–34. Note that any complicated shapes in the polar plot curves are caused by the nu- merator dynamics—that is, by the time constants in the numerator of the transfer func- tion. Figure 7–35 shows examples of polar plots of transfer functions with numerator dynamics. In analyzing control systems, the polar plot of G(jv)in the frequency range of interest must be accurately determined. Table 7–1 shows sketches of polar plots of several transfer functions. Im Re 0 v =/H11009 n–m= 1n–m= 2n–m= 3 G(jv)=b o (jv) m +… a o (jv) n +… Figure 7–34 Polar plots in the high-frequency range. Im Re 0 0v=` v Im Re 0 0v=` v Figure 7–35 Polar plots of transfer functions with numerator dynamics. Openmirrors.comSection 7–3 / Polar Plots 435vIm ReIm Re 0 00 Im ReIm Re 0 0 Im ReIm Re 0 Im ImIm ImRe ReRe Re0 00 010v v v v 0 0vv0 0v =/H11009 v =/H11009 v =/H11009 v =/H11009v =/H11009 v =/H11009v =/H110091 jv1 1 11+jvT jvT 1+jvT jv jvT 1+jvT 1 av =/H11009 v = 0 v = 0 v = 0 v = 0 v = 0/H11009 /H11009 1 (jv)2 1+jvT 1+jvaT (a/H11022 1)1 (1+jvT1) (1 +jvT2) (1 +jvT3) vn2 jv[(jv)2+ 2zvn(jv)+vn2]1 + jvT1 jv (1+jvT2) (1 +jvT3)1Table 7–1 Polar Plots of Simple Transfer Functions Drawing Nyquist Plots with MATLAB. Nyquist plots, just like Bode diagrams, are commonly used in the frequency-response representation of linear, time-invariant,feedback control systems. Nyquist plots are polar plots, while Bode diagrams arerectangular plots. One plot or the other may be more convenient for a particular opera-tion, but a given operation can always be carried out in either plot. The MATLAB command nyquist computes the frequency response for continuous- time, linear, time-invariant systems.When invoked without left-hand arguments, nyquist produces a Nyquist plot on the screen.436 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method The command nyquist(num,den) draws the Nyquist plot of the transfer function where num anddencontain the polynomial coefficients in descending powers of s. Other commonly used nyquist commands are nyquist(num,den,w) nyquist(A,B,C,D) nyquist(A,B,C,D,w) nyquist(A,B,C,D,iu,w) nyquist(sys) The command involving the user-specified frequency vector w, such as nyquist(num,den,w) calculates the frequency response at the specified frequency points in radians per second. When invoked with left-hand arguments such as [re,im,w] = nyquist(num,den) [re,im,w] = nyquist(num,den,w) [re,im,w] = nyquist(A,B,C,D) [re,im,w] = nyquist(A,B,C,D,w) [re,im,w] = nyquist(A,B,C,D,iu,w) [re,im,w] = nyquist(sys) MATLAB returns the frequency response of the system in the matrices re,im,andw. No plot is drawn on the screen. The matrices reandimcontain the real and imaginary parts of the frequency response of the system, evaluated at the frequency points speci- fied in the vector w. Note that reandimhave as many columns as outputs and one row for each element in w. EXAMPLE 7–10 Consider the following open-loop transfer function: Draw a Nyquist plot with MATLAB. Since the system is given in the form of the transfer function, the command nyquist(num,den) may be used to draw a Nyquist plot. MATLAB Program 7–5 produces the Nyquist plot shown in Figure 7–36. In this plot, the ranges for the real axis and imaginary axis are automatically determined.G(s) =1 s 2 +0.8s +1 G(s) =num (s) den(s) Openmirrors.comSection 7–3 / Polar Plots 437MATLAB Program 7–5 num = [1]; den = [1 0.8 1];nyquist(num,den)gridtitle('Nyquist Plot of G(s) = 1/(s^2 + 0.8s + 1)') MATLAB Program 7–6 % ---------- Nyquist plot ----------num = [1]; den = [1 0.8 1];nyquist(num,den)v = [-2 2 -2 2]; axis(v)gridtitle('Nyquist Plot of G(s) = 1/(s^2 + 0.8s + 1)')Real Axis−0.5 −1 1.5 0.5 1 0Imaginary Axis −1.51.5 −0.5 −100.51Nyquist Plot of G(s) = 1/( s2+ 0.8 s+ 1) Figure 7–36 Nyquist plot of G(s) =1 s2+0.8s +1. If we wish to draw the Nyquist plot using manually determined ranges—for example, from –2 to 2 on the real axis and from –2to 2 on the imaginary axis—enter the following command into the computer: v = [-2 2 -2 2]; axis(v); or, combining these two lines into one, axis([-2 2 -2 2]); See MATLAB Program 7–6 and the resulting Nyquist plot shown in Figure 7–37.438 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method Caution. In drawing a Nyquist plot, where a MATLAB operation involves “Divide by zero,” the resulting Nyquist plot may have an erroneous or undesirable appearance. For example, if the transfer function G(s) is given by then the MATLAB command num = [1]; den = [1 1 0]; nyquist(num,den) produces an undesirable Nyquist plot. An example of an undesirable Nyquist plot is shown in Figure 7–38. If such an undesirable Nyquist plot appears on the computer,G(s) =1 s(s+1) Real Axis−2 2 −1.5 1.5 1 0.5 0 −0.5 −1 Imaginary Axis −1 0.5 −22 −0.5 −1.5 0 1 1.5 Nyquist Plot of G(s) = 1/( s 2 + 0.8 s+ 1) Figure 7–37 Nyquist plot of G(s) =1 s 2 +0.8s +1. Real Axis−1.2 −1.4 0 −0.4 −0.2 −0.8 −1 −0.6 Imaginary Axis −150150 −50 −100050100Nyquist Diagram Figure 7–38 Undesirable Nyquist plot. Openmirrors.comSection 7–3 / Polar Plots 439Real Axis−1.5 −21 2 0.5 1.5 −0.5 −10Imaginary Axis −21 −55 −12 −3 −4034Nyquist Plot of G(s) = 1/[ s(s+1)] Figure 7–39 Nyquist plot of G(s) =1 s(s+1).then it can be corrected if we specify the axis(v) . For example, if we enter the axis command v = [-2 2 -5 5]; axis(v) in the computer, then a desirable form of Nyquist plot can be obtained. See Example 7–11. EXAMPLE 7–11 Draw a Nyquist plot for the following G(s) : MATLAB Program 7–7 will produce a desirable form of Nyquist plot on the computer, even though a warning message “Divide by zero” may appear on the screen.The resulting Nyquist plotis shown in Figure 7–39.G(s) =1 s(s+1) MATLAB Program 7–7 % ---------- Nyquist plot----------num = [1]; den = [1 1 0];nyquist(num,den)v = [-2 2 -5 5]; axis(v)gridtitle('Nyquist Plot of G(s) = 1/[s(s + 1)]') Notice that the Nyquist plot shown in Figure 7–39 includes the loci for both v>0 andv<0 . If we wish to draw the Nyquist plot for only the positive frequency region (v>0) , then we need to use the command [re,im,w]=nyquist(num,den,w)440 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method Drawing Nyquist Plots of a System Defined in State Space. Consider the system defined by where state vector ( n-vector) output vector ( m-vector) control vector ( r-vector) state matrix ( n*n matrix) control matrix ( n*r matrix) output matrix ( m*n matrix) direct transmission matrix ( m*r matrix) D= C= B= A= u= y= x=y=Cx+Dux#=Ax+BuMATLAB Program 7–8 % ---------- Nyquist plot---------- num = [1]; den = [1 1 0]; w = 0.1:0.1:100; [re,im,w] = nyquist(num,den,w); plot(re,im) v = [-2 2 -5 5]; axis(v) grid title('Nyquist Plot of G(s) = 1/[s(s + 1)]') xlabel('Real Axis') ylabel('Imag Axis') Real Axis–1.5 –21 2 0.5 1.5 –0.5 –1 0 Imag Axis –2 1 –55 –1 2 –3 –4 0 3 4 Nyquist Plot of G(s)=1/[s(s+1)] Figure 7–40 Nyquist plot of forv70.G(s) =1 s(s+1) A MATLAB program using this nyquist command is shown in MATLAB Program 7–8. The resulting Nyquist plot is presented in Figure 7–40. Openmirrors.comSection 7–3 / Polar Plots 441MATLAB Program 7–9 A = [0 1;-25 -4]; B = [0;25];C = [1 0];D = [0];nyquist(A,B,C,D)gridtitle('Nyquist Plot')Nyquist plots for this system may be obtained by the use of the command nyquist(A,B,C,D) This command produces a series of Nyquist plots, one for each input and output com- bination of the system. The frequency range is automatically determined. The command nyquist(A,B,C,D,iu) produces Nyquist plots from the single input iuto all the outputs of the system, with the frequency range determined automatically. The scalar iuis an index into the inputs of the system and specifies which input to use for the frequency response. The command nyquist(A,B,C,D,iu,w) uses the user-supplied frequency vector w. The vector wspecifies the frequencies in radians per second at which the frequency response should be calculated. EXAMPLE 7–12 Consider the system defined by Draw a Nyquist plot. This system has a single input uand a single output y. A Nyquist plot may be obtained by entering the command nyquist(A,B,C,D) or nyquist(A,B,C,D,1) MATLAB Program 7–9 will provide the Nyquist plot. (Note that we obtain the identical result byusing either of these two commands.) Figure 7–41 shows the Nyquist plot produced by MATLABProgram 7–9. y=[1 0]Bx1 x2R+[0] u Bx# 1 x# 2R=B0 -251 -4RBx1 x2R+B0 25Ru442 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method EXAMPLE 7–13 Consider the system defined by This system involves two inputs and two outputs. There are four sinusoidal output–input re- lationships: and Draw Nyquist plots for the system. (When considering input u 1 , we assume that input u 2 is zero, and vice versa.) The four individual Nyquist plots can be obtained by the use of the command nyquist(A,B,C,D) MATLAB Program 7–10 produces the four Nyquist plots. They are shown in Figure 7–42.Y 2 (jv)/H20862U 2 (jv). Y 1 (jv)/H20862U 2 (jv), Y 2 (jv)/H20862U 1 (jv), Y 1 (jv)/H20862U 1 (jv), B y 1 y 2 R = B 1 00 1 RB x 1 x 2 R + B 0 00 0 RB u 1 u 2 R B x# 1 x# 2 R = B -1 6.5-1 0 RB x 1 x 2 R + B 1 11 0 RB u 1 u 2 R Real Axis–0.4 –0.6 0.6 1 0.4 0.8 0 –0.2 0.2 1.2 Imag Axis –1 01.5 –0.5 0.5 –1.5 1 Nyquist Plot Figure 7–41 Nyquist plot of system considered in Example 7–12. MATLAB Program 7–10 A = [-1 -1;6.5 0]; B = [1 1;1 0]; C = [1 0;0 1]; D = [0 0;0 0]; nyquist(A,B,C,D) Openmirrors.comSection 7–4 / Log-Magnitude-versus-Phase Plots 4437–4 LOG-MAGNITUDE-VERSUS-PHASE PLOTS Another approach to graphically portraying the frequency-response characteristics is to use the log-magnitude-versus-phase plot, which is a plot of the logarithmicmagnitude in decibels versus the phase angle or phase margin for a frequency rangeof interest. [The phase margin is the difference between the actual phase angle f and –180 °; that is, f-(–180 °)=180 °+f.] The curve is graduated in terms of the frequency v. Such log-magnitude-versus-phase plots are commonly called Nichols plots. In the Bode diagram, the frequency-response characteristics of G(jv)are shown on semilog paper by two separate curves, the log-magnitude curve and the phase-anglecurve, while in the log-magnitude-versus-phase plot, the two curves in the Bode dia-gram are combined into one. In the manual approach the log-magnitude-versus-phaseplot can easily be constructed by reading values of the log magnitude and phase anglefrom the Bode diagram. Notice that in the log-magnitude-versus-phase plot a change inthe gain constant of G(jv)merely shifts the curve up (for increasing gain) or down (for decreasing gain), but the shape of the curve remains the same. Advantages of the log-magnitude-versus-phase plot are that the relative stability of the closed-loop system can be determined quickly and that compensation can be workedout easily. The log-magnitude-versus-phase plot for the sinusoidal transfer function G(jv)and that for 1/G(jv)are skew symmetrical about the origin, since 21 G(jv)2 in dB =-@G(jv)@ in dB4 20 −2 −41 0.5 0 −0.5 −14 2 0 −2 −4 4 2 0 −2 −412 0 −1 Real Axis312 0 −13 01 −1 −22 01 −1 −22From: U 1 From: U2 From: U1 From: U2 Real AxisReal Axis Real AxisTo:Y2Imaginary Axis To:Y1 To:Y2 To:Y1Nyquist Diagrams Figure 7–42 Nyquist plot ofsystem considered in Example 7–13.444 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method and Figure 7–43 compares frequency-response curves of in three different representations. In the log-magnitude-versus-phase plot, the vertical distance between the points v=0 andv=v r , where v r is the resonant frequency, is the peak value of G(jv)in decibels. Since log-magnitude and phase-angle characteristics of basic transfer functions have been discussed in detail in Sections 7–2 and 7–3, it will be sufficient here to give exam- ples of some log-magnitude-versus-phase plots. Table 7–2 shows such examples. (How- ever, more on Nichols charts will be discussed in Section 7–6.)G(jv)=1 1+2z a j v v n b + a j v v n b 2 n 1 G(jv) =- / G(jv) 05 –5 –10 0° –90° –180° |G| in dB G M r M r 0.2v n 0.5v n v n 2v n v r (a)v = 0v = 0v =` ∞v vIm Re v r v n v r v n M r (b) (c)–12 –156 3 0 1 –6–3 –9 –90° –180° 0° |G| in dB G Figure 7–43 Three representations of the frequency response of for z>0. (a) Bode diagram; (b) polar plot; (c) log-magnitude-versus-phase plot.1 1+2z a jv v n b + a jv v n b 2 , Openmirrors.comSection 7–5 / Nyquist Stability Criterion 445|G| in dB20 10 0 –10 –20 –180 ° 0° 180° G |G| in dB20 10 0 –10 –20 –180 ° 0° 180° G|G| in dB20 10 0 –10 –20 –180 ° 0° 180° G |G| in dB20 10 0 –10 –20 –180 ° 0° 180° G|G| in dB20 10 0 –10 –20 –180 ° 0° 180° G |G| in dB20 10 0 –10 –20 –180 ° 0° 180° Gv v0 v = 1 /H11009/H11009G =1 jvG =1 1 + jvT v v = 0 G =(jv)2 + 2zvn(jv) + vn2 vn2G = 1 + jvTG =e–jvL G =1 jv(1 + jvT)/H11009 vv = 0/H11009 v v = 0 /H11009 vv = 0 /H11009vv0Table 7–2 Log-Magnitude-versus-Phase Plots of Simple Transfer Functions 7–5 NYQUIST STABILITY CRITERION The Nyquist stability criterion determines the stability of a closed-loop system from its open-loop frequency response and open-loop poles. This section presents mathematical background for understanding the Nyquist sta- bility criterion. Consider the closed-loop system shown in Figure 7–44.The closed-looptransfer function is C(s) R(s)=G(s) 1+G(s)H(s)446 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method For stability, all roots of the characteristic equation must lie in the left-half splane. [It is noted that, although poles and zeros of the open-loop transfer function G(s)H(s) may be in the right-half splane, the system is stable if all the poles of the closed-loop transfer function (that is, the roots of the characteristic equation) are in the left-half splane.] The Nyquist stability criterion relates the open-loop frequency response G(jv)H(jv)to the number of zeros and poles of 1+G(s)H(s) that lie in the right-half splane.This criterion, derived by H. Nyquist, is useful in control engineering be- cause the absolute stability of the closed-loop system can be determined graphically from open-loop frequency-response curves, and there is no need for actually determining the closed-loop poles. Analytically obtained open-loop frequency-response curves, as well as those experimentally obtained, can be used for the stability analysis.This is convenient be- cause, in designing a control system, it often happens that mathematical expressions for some of the components are not known; only their frequency-response data are available. The Nyquist stability criterion is based on a theorem from the theory of complex variables.To understand the criterion, we shall first discuss mappings of contours in the complex plane. We shall assume that the open-loop transfer function G(s)H(s) is representable as a ratio of polynomials in s. For a physically realizable system, the degree of the denom- inator polynomial of the closed-loop transfer function must be greater than or equal to that of the numerator polynomial.This means that the limit of G(s)H(s) assapproaches infinity is zero or a constant for any physically realizable system. Preliminary Study. The characteristic equation of the system shown in Figure 7–44 is We shall show that, for a given continuous closed path in the splane that does not go through any singular points, there corresponds a closed curve in the F(s) plane. The number and direction of encirclements of the origin of the F(s) plane by the closed curve play a particularly important role in what follows, for later we shall correlate the number and direction of encirclements with the stability of the system. Consider, for example, the following open-loop transfer function: The characteristic equation is (7–15) =1+2 s-1=s+1 s-1=0F(s) =1+G(s)H(s)G(s)H(s) =2 s-1F(s) =1+G(s)H(s) =01+G(s)H(s) =0 R(s) C(s) G(s) H(s) +– Figure 7–44 Closed-loop system. Openmirrors.comSection 7–5 / Nyquist Stability Criterion 447s PlaneF(s) Plane3 2 0 –22 34 –2 –3ReIm jv v=–2 s=–1s=–2 s= 1sv= 0 v= 2v=–1 v= 1s= 2s= 0 –2 –10 1 2j2 j1 –j1 –j21 –13 –1 (a) (b)Figure 7–45 Conformal mapping of thes-plane grids into the F(s) plane, whereF(s)=(s+1)/(s-1). The function F(s) is analytic#everywhere in the splane except at its singular points. For each point of analyticity in the splane, there corresponds a point in the F(s) plane. For example, if s=2+j1 , then F(s) becomes Thus, point s=2+j1 in the splane maps into point 2-j1 in the F(s) plane. Thus, as stated previously, for a given continuous closed path in the splane, which does not go through any singular points, there corresponds a closed curve in the F(s) plane. For the characteristic equation F(s) given by Equation (7–15), the conformal map- ping of the lines and the lines [see Figure 7–45(a)] yield cir-cles in the F(s) plane, as shown in Figure 7–45(b). Suppose that representative point s traces out a contour in the splane in the clockwise direction. If the contour in the s plane encloses the pole of F(s) , there is one encirclement of the origin of the F(s) plane by the locus of F(s) in the counterclockwise direction. [See Figure 7–46(a).] If the con- tour in the splane encloses the zero of F(s), there is one encirclement of the origin of theF(s) plane by the locus of F(s) in the clockwise direction. [See Figure 7–46(b).] If the contour in the splane encloses both the zero and the pole or if the contour enclos- es neither the zero nor the pole, then there is no encirclement of the origin of the F(s) plane by the locus of F(s). [See Figures 7–46(c) and (d).] From the foregoing analysis, we can say that the direction of encirclement of the ori- gin of the F(s) plane by the locus of F(s) depends on whether the contour in the splane encloses a pole or a zero. Note that the location of a pole or zero in the splane, whether in the right-half or left-half splane, does not make any difference, but the enclosure of a pole or zero does. If the contour in the splane encloses equal numbers of poles and zeros, then the corresponding closed curve in the F(s) plane does not encircle the ori- gin of the F(s) plane.The foregoing discussion is a graphical explanation of the mapping theorem, which is the basis for the Nyquist stability criterion.s=0, ;1, ;2 v=0, ;1, ;2F(2 +j1)=2+j1+1 2+j1-1=2-j1 #A complex function F(s) is said to be analytic in a region if F(s) and all its derivatives exist in that region.448 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method jv s Plane j2 j1 0 –j1 –j23 1 –12 –2A B CDs jv j2 j1 0 –j1 –j23 1 –12A B C Ds jv j2 0 –j23 1 –1AB C Ds jv 03 1 –12 –2G HF E C DB As Im F(s) Plane 2 1 0 –1 –212 A/H11032 A/H11032D/H11032 D/H11032 A/H11032C/H11032 B/H11032 B/H11032C/H11032D/H11032 E/H11032F/H11032G/H11032B/H11032C/H11032 D/H11032 C/H11032 B/H11032Re Im 2 1 0 –1 –212 Re Im 2 1 0 –1 –21 –12 Re Im 2 1 0 –1 –23 1 –12 Re 3 –1 3 –1 –2 2 –2j1 –j1 j2 j1 –j1 –j23 H/H11032A/H11032(a) (b) (c) (d) Figure 7–46 Closed contours in the s plane and their corresponding closed curves in the F(s) plane, where F(s)=(s+1)/(s-1). Mapping Theorem. LetF(s) be a ratio of two polynomials in s. Let Pbe the num- ber of poles and Zbe the number of zeros of F(s) that lie inside some closed contour in thesplane, with multiplicity of poles and zeros accounted for. Let the contour be such that it does not pass through any poles or zeros of F(s) .This closed contour in the splane is then mapped into the F(s) plane as a closed curve. The total number Nof clockwise encirclements of the origin of the F(s) plane, as a representative point straces out the entire contour in the clockwise direction, is equal to Z-P . (Note that by this mapping theorem, the numbers of zeros and of poles cannot be found—only their difference.) Openmirrors.comSection 7–5 / Nyquist Stability Criterion 449We shall not present a formal proof of this theorem here, but leave the proof to Problem A–7–6 . Note that a positive number Nindicates an excess of zeros over poles of the function F(s) and a negative Nindicates an excess of poles over zeros. In control system applications, the number Pcan be readily determined for F(s)=1+G(s)H(s) from the function G(s)H(s) . Therefore, if Nis determined from the plot of F(s) , the number of zeros in the closed contour in the splane can be determined readily. Note that the exact shapes of the s-plane contour and F(s) locus are immaterial so far as encir- clements of the origin are concerned, since encirclements depend only on the enclosureof poles and/or zeros of F(s) by the s-plane contour. Application of the Mapping Theorem to the Stability Analysis of Closed-Loop Systems. For analyzing the stability of linear control systems, we let the closed con- tour in the splane enclose the entire right-half splane. The contour consists of the en- tire jvaxis from v=– qto±qand a semicircular path of infinite radius in the right-half splane. Such a contour is called the Nyquist path. (The direction of the path is clockwise.) The Nyquist path encloses the entire right-half splane and encloses all the zeros and poles of 1+G(s)H(s) that have positive real parts. [If there are no zeros of1+G(s)H(s) in the right-half splane, then there are no closed-loop poles there, and the system is stable.] It is necessary that the closed contour, or the Nyquist path, notpass through any zeros and poles of 1+G(s)H(s) . If G(s)H(s) has a pole or poles at the origin of the splane, mapping of the point s=0 becomes indeterminate. In such cases, the origin is avoided by taking a detour around it. (A detailed discussion of thisspecial case is given later.) If the mapping theorem is applied to the special case in which F(s) is equal to 1+G(s)H(s) , then we can make the following statement: If the closed contour in the s plane encloses the entire right-half splane, as shown in Figure 7–47, then the num- ber of right-half plane zeros of the function F(s)=1+G(s)H(s) is equal to the num- ber of poles of the function F(s)=1+G(s)H(s) in the right-half splane plus the number of clockwise encirclements of the origin of the 1+G(s)H(s) plane by the corresponding closed curve in this latter plane. Because of the assumed condition that the function of 1+G(s)H(s) remains constant as straverses the semicircle of infinite radius. Because of this, whether the locus of 1+G(s)H(s) encircles the origin of the 1+G(s)H(s) plane can be determined by considering only a part of the closed contour in the splane—that is, the jvaxis. Encirclements of the origin, if there are any, occur onlylim sSq C1+G(s)H(s)D=constant jv s 0s Plane ` Figure 7–47 Closed contour inthesplane.450 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method Im Re 01 1+G(jv)H(jv)Im Re 0–1 1+G(jv)H(jv) G(jv)H(jv)GH Plane 1+GH Plane Figure 7–48 Plots of in the1+GH plane andGH plane.1+G(jv)H(jv) while a representative point moves from –jqto±jqalong the jvaxis, provided that no zeros or poles lie on the jvaxis. Note that the portion of the 1+G(s)H(s) contour from v=– qtov=qis sim- ply1+G(j v)H(jv). Since 1+G(j v)H(jv)is the vector sum of the unit vector and the vector G(jv)H(jv),1+G(j v)H(jv)is identical to the vector drawn from the –1+j0 point to the terminal point of the vector G(jv)H(jv), as shown in Figure 7–48. Encirclement of the origin by the graph of 1+G(j v)H(jv)is equivalent to encir- clement of the –1+j0 point by just the G(jv)H(jv)locus.Thus, the stability of a closed- loop system can be investigated by examining encirclements of the –1+j0 point by the locus of G(jv)H(jv). The number of clockwise encirclements of the –1+j0 point can be found by drawing a vector from the –1+j0 point to the G(jv)H(jv)locus, starting from v=– q, going through v=0 , and ending at v=± q, and by counting the number of clockwise rotations of the vector. Plotting G(jv)H(jv)for the Nyquist path is straightforward. The map of the nega- tivejvaxis is the mirror image about the real axis of the map of the positive jvaxis.That is, the plot of G(jv)H(jv)and the plot of G(–jv)H(–jv)are symmetrical with each other about the real axis. The semicircle with infinite radius maps into either the origin of the GH plane or a point on the real axis of the GH plane. In the preceding discussion, G(s)H(s) has been assumed to be the ratio of two poly- nomials in s. Thus, the transport lag e –Ts has been excluded from the discussion. Note, however, that a similar discussion applies to systems with transport lag, although a proof of this is not given here. The stability of a system with transport lag can be determined from the open-loop frequency-response curves by examining the number of encir- clements of the –1+j0 point, just as in the case of a system whose open-loop transfer function is a ratio of two polynomials in s. Nyquist Stability Criterion. The foregoing analysis, utilizing the encirclement of the–1+j0 point by the G(jv)H(jv)locus, is summarized in the following Nyquist stability criterion: Nyquist stability criterion [for a special case when G(s)H(s) has neither poles nor zeros on the jvaxis]: In the system shown in Figure 7–44, if the open-loop transfer func- tion G(s)H(s) haskpoles in the right-half splane and then for stability, the G(jv)H(jv)locus, as vvaries from –qtoq, must encircle the –1+j0 point ktimes in the counterclockwise direction.lim sSq G(s)H(s) =constant , Openmirrors.comSection 7–5 / Nyquist Stability Criterion 451Im Re 0 –1GH Plane Figure 7–49 Region enclosed by aNyquist plot.Remarks on the Nyquist Stability Criterion 1.This criterion can be expressed as where number of zeros of 1+G(s)H(s) in the right-half splane number of clockwise encirclements of the –1+j0 point number of poles of G(s)H(s) in the right-half splane IfPis not zero, for a stable control system, we must have Z=0 ,o r N=–P , which means that we must have Pcounterclockwise encirclements of the –1+j0 point. IfG(s)H(s) does not have any poles in the right-half splane, then Z=N . Thus, for stability there must be no encirclement of the –1+j0 point by the G(jv)H(jv)locus. In this case it is not necessary to consider the locus for the en- tirejvaxis, only for the positive-frequency portion. The stability of such a system can be determined by seeing if the –1+j0 point is enclosed by the Nyquist plot ofG(jv)H(jv). The region enclosed by the Nyquist plot is shown in Figure 7–49. For stability, the –1+j0 point must lie outside the shaded region. 2.We must be careful when testing the stability of multiple-loop systems since they may include poles in the right-half splane. (Note that although an inner loop may be unstable, the entire closed-loop system can be made stable by proper design.)Simple inspection of encirclements of the –1+j0 point by the G(jv)H(jv)locus is not sufficient to detect instability in multiple-loop systems. In such cases, how-ever, whether any pole of 1+G(s)H(s) is in the right-half splane can be deter- mined easily by applying the Routh stability criterion to the denominator ofG(s)H(s) . If transcendental functions, such as transport lag e –Ts, are included in G(s)H(s) , they must be approximated by a series expansion before the Routh stabilitycriterion can be applied. 3.If the locus of G(jv)H(jv)passes through the –1+j0 point, then zeros of the characteristic equation, or closed-loop poles, are located on the jvaxis.This is not desirable for practical control systems. For a well-designed closed-loop system,none of the roots of the characteristic equation should lie on the jvaxis. P= N= Z=Z=N+P452 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method jvjv ss 0s Planes Plane j 0+ j 0–` s=e e ju e Figure 7–50 Contour near the origin of the splane and closed contour in thesplane avoiding poles and zeros at the origin. Special Case when G(s)H(s) Involves Poles and /or Zeros on the jVAxis. In the previous discussion, we assumed that the open-loop transfer function G(s)H(s) has neither poles nor zeros at the origin.We now consider the case where G(s)H(s) involves poles and/or zeros on the jvaxis. Since the Nyquist path must not pass through poles or zeros of G(s)H(s) , if the func- tion G(s)H(s) has poles or zeros at the origin (or on the jvaxis at points other than the origin), the contour in the splane must be modified. The usual way of modifying the contour near the origin is to use a semicircle with the infinitesimal radius e, as shown in Figure 7–50. [Note that this semicircle may lie in the right-half splane or in the left-half splane. Here we take the semicircle in the right-half splane.] A representative point s moves along the negative jvaxis from –jqtoj0–. From s=j0– tos=j0±, the point moves along the semicircle of radius e(wheree/H112701)and then moves along the posi- tivejvaxis from j0±tojq. From s=j q, the contour follows a semicircle with infinite radius, and the representative point moves back to the starting point, s=–j q.The area that the modified closed contour avoids is very small and approaches zero as the radius eapproaches zero. Therefore, all the poles and zeros, if any, in the right-half splane are enclosed by this contour. Consider, for example, a closed-loop system whose open-loop transfer function is given by The points corresponding to s=j0± and s=j0– on the locus of G(s)H(s) in the G(s)H(s) plane are –jqand jq, respectively. On the semicircular path with radius e (where e/H112701), the complex variable scan be written whereuvaries from –90° to ±90°. Then G(s)H(s) becomes GAee ju BHAee ju B=K ee ju =K e e -ju s=ee ju G(s)H(s) =K s(Ts +1) Openmirrors.comSection 7–5 / Nyquist Stability Criterion 453jv ss PlaneD C AB E Fj 0+ j 0–+j` –j`` ` (e /H11021/H11021 1) v = 0 +–1D/H11032,E/H11032,F/H11032v =–` v =`GHPlane ReA/H11032 B/H11032 C/H11032Im v = 0– Figure 7–51 s-Plane contour and the G(s)H(s) locus in the GH plane, where G(s)H(s) =K/H20862Cs(Ts +1)D. The value K/H20862eapproaches infinity as eapproaches zero, and –uvaries from 90° to –90° as a representative point smoves along the semicircle in the splane. Thus, the points G(j0–)H(j0–)=j qandG(j0±)H(j0±)=–j qare joined by a semicircle of infinite radius in the right-half GH plane.The infinitesimal semicircular detour around the ori- gin in the splane maps into the GH plane as a semicircle of infinite radius. Figure 7–51 shows the s-plane contour and the G(s)H(s) locus in the GH plane. Points A, B , and Con the s-plane contour map into the respective points A¿,B¿, and C¿on the G(s)H(s) locus.As seen from Figure 7–51, points D, E , and Fon the semicircle of infinite radius in the splane map into the origin of the GH plane. Since there is no pole in the right- half splane and the G(s)H(s) locus does not encircle the –1+j0 point, there are no zeros of the function 1+G(s)H(s) in the right-half splane. Therefore, the system is stable. For an open-loop transfer function G(s)H(s) involving a 1/snfactor (where n=2 ,3 ,p), the plot of G(s)H(s) hasnclockwise semicircles of infinite radius about the origin as a representative point smoves along the semicircle of radius e(where e/H112701). For example, consider the following open-loop transfer function: ThenAsuvaries from –90° to 90° in the splane, the angle of G(s)H(s) varies from 180° to –180 °, as shown in Figure 7–52. Since there is no pole in the right-half splane and the locus encircles the –1+j0 point twice clockwise for any positive value of K, there are two zeros of 1+G(s)H(s) in the right-half splane. Therefore, this system is always unstable.lim sSeejuG(s)H(s) =K e2e2ju=K e2e-2juG(s)H(s) =K s2(Ts +1)454 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method Note that a similar analysis can be made if G(s)H(s) involves poles and/or zeros on thejvaxis. The Nyquist stability criterion can now be generalized as follows: Nyquist stability criterion [for a general case when G(s)H(s) has poles and/or zeros on the jvaxis]: In the system shown in Figure 7–44, if the open-loop transfer function G(s)H(s) haskpoles in the right-half splane, then for stability the G(s)H(s) locus, as a representative point straces on the modified Nyquist path in the clockwise di- rection, must encircle the –1+j0 point ktimes in the counterclockwise direction. 7–6 STABILITY ANALYSIS In this section, we shall present several illustrative examples of the stability analysis of control systems using the Nyquist stability criterion. If the Nyquist path in the splane encircles Zzeros and Ppoles of 1+G(s)H(s) and does not pass through any poles or zeros of 1+G(s)H(s) as a representative point s moves in the clockwise direction along the Nyquist path, then the corresponding con- tour in the G(s)H(s) plane encircles the –1+j0 point N=Z-P times in the clock- wise direction. (Negative values of Nimply counterclockwise encirclements.) In examining the stability of linear control systems using the Nyquist stability crite- rion, we see that three possibilities can occur: 1.There is no encirclement of the –1+j0 point. This implies that the system is sta- ble if there are no poles of G(s)H(s) in the right-half splane; otherwise, the sys- tem is unstable. 2.There are one or more counterclockwise encirclements of the –1+j0 point. In this case the system is stable if the number of counterclockwise encirclements is the same as the number of poles of G(s)H(s) in the right-half splane; otherwise, the system is unstable. 3.There are one or more clockwise encirclements of the –1+j0 point. In this case the system is unstable. In the following examples, we assume that the values of the gain Kand the time con- stants (such as T, and ) are all positive. T 2 T 1 , jv s Plane sGH Plane Rej 0+ j 0–`+j` –j`e /H11021/H11021 1v = 0+ v = 0––1`Im v =–`v =` Figure 7–52 s-Plane contour and the G(s)H(s) locus in the GH plane, where G(s)H(s) =K/H20862Cs 2 (Ts +1)D. Openmirrors.comSection 7–6 / Stability Analysis 455Im Re –1GH Plane G(jv)H(jv)v = 0 v = –` v =` Figure 7–53 Polar plot ofG(jv)H(jv) considered in Example 7–14. Im Re Re –1–1GH Plane v = 0– v = 0+ImGH Plane v = 0– v = 0+ Small K Large K(Stable) (Unstable)P= 0 P= 0 N= 0 Z= 0 v =–/H11009v =/H11009 v =–/H11009v =/H11009N= 2 Z= 2 Figure 7–54 Polar plots of thesystem considered in Example 7–15.EXAMPLE 7–14 Consider a closed-loop system whose open-loop transfer function is given by Examine the stability of the system. A plot of G(jv)H(jv)is shown in Figure 7–53. Since G(s)H(s) does not have any poles in the right-half splane and the –1+j0 point is not encircled by the G(jv)H(jv)locus, this system is stable for any positive values of K, and T2 . T1 ,G(s)H(s) =K AT1 s+1BAT2 s+1B EXAMPLE 7–15 Consider the system with the following open-loop transfer function: Determine the stability of the system for two cases: (1) the gain Kis small and (2) Kis large. The Nyquist plots of the open-loop transfer function with a small value of Kand a large value ofKare shown in Figure 7–54.The number of poles of G(s)H(s) in the right-half splane is zero.G(s)H(s) =K sAT1 s+1BAT2 s+1B456 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method Im ReGH Plane v = 0– v = 0+v =–/H11009 v =/H11009Im ReGH Plane v = 0– v = 0+v =–/H11009 v =/H11009Im ReGH Plane v = 0+ v = 0–v =/H11009 v =–/H11009 T 1 /H11021 T 2 (Stable)T 1 = T 2 G(jv)H(jv) locus passes through the –1+j0 pointT 1 /H11022 T 2 (Unstable) Figure 7–55 Polar plots of the system considered in Example 7–16.Therefore, for this system to be stable, it is necessary that N=Z=0 or that the G(s)H(s) locus not encircle the –1+j0 point. For small values of K, there is no encirclement of the –1+j0 point. Hence, the system is sta- ble for small values of K. For large values of K, the locus of G(s)H(s) encircles the –1+j0 point twice in the clockwise direction, indicating two closed-loop poles in the right-half splane, and the system is unstable. (For good accuracy, Kshould be large. From the stability viewpoint, however, a large value of Kcauses poor stability or even instability.To compromise between accuracy and stability, it is necessary to insert a compensation network into the system. Compensating tech- niques in the frequency domain are discussed in Sections 7–11 through 7–13.) EXAMPLE 7–16 The stability of a closed-loop system with the following open-loop transfer function depends on the relative magnitudes of and Draw Nyquist plots and determine the stability of the system. Plots of the locus G(s)H(s) for three cases, and are shown in Figure 7–55. For the locus of G(s)H(s) does not encircle the –1+j0 point, and the closed-loop system is stable. For , the G(s)H(s) locus passes through the–1+j0 point, which indicates that the closed-loop poles are located on the jvaxis. For the locus of G(s)H(s) encircles the –1+j0 point twice in the clockwise direction. Thus, the closed-loop system has two closed-loop poles in the right-half splane, and the system is unstable.T 1 7T 2 ,T 1 =T 2 T 1 6T 2 ,T 1 7T 2 , T 1 6T 2 ,T 1 =T 2 ,T 2 . T 1 G(s)H(s) =KAT 2 s+1B s 2 AT 1 s+1B EXAMPLE 7–17 Consider the closed-loop system having the following open-loop transfer function: Determine the stability of the system.G(s)H(s) =K s(Ts -1) Openmirrors.comSection 7–6 / Stability Analysis 457Im ReGH Plane v = 0–v = 0+ –1v =` v =–` Figure 7–56 Polar plot of thesystem considered in Example 7–17. Im ReGH Plane v = 0–v = 0+ –1v =–` v =` Figure 7–57 Polar plot of thesystem considered in Example 7–18.The function G(s)H(s) has one pole (s=1/T) in the right-half splane.Therefore, P=1 .T he Nyquist plot shown in Figure 7–56 indicates that the G(s)H(s) plot encircles the –1+j0 point once clockwise. Thus, N=1 . Since Z=N+P , we find that Z=2 . This means that the closed- loop system has two closed-loop poles in the right-half splane and is unstable. EXAMPLE 7–18 Investigate the stability of a closed-loop system with the following open-loop transfer function: The open-loop transfer function has one pole (s=1) in the right-half splane, or P=1 .T h e open-loop system is unstable. The Nyquist plot shown in Figure 7–57 indicates that the –1+j0 point is encircled by the G(s)H(s) locus once in the counterclockwise direction. Therefore, N=–1 . Thus, Zis found from Z=N+P to be zero, which indicates that there is no zero of 1+G(s)H(s) in the right-half splane, and the closed-loop system is stable. This is one of the examples for which an unstable open-loop system becomes stable when the loop is closed.G(s)H(s) =K(s +3) s(s-1) (K71)458 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method R(s) C(s)G(s) G 1 (s) G 2 (s) H 1 (s)H 2 (s) +– +– Figure 7–59 Multiple-loop system. Conditionally Stable Systems. Figure 7–58 shows an example of a G(jv)H(jv) locus for which the closed-loop system can be made unstable by varying the open-loop gain. If the open-loop gain is increased sufficiently, the G(jv)H(jv)locus encloses the –1+j0 point twice, and the system becomes unstable. If the open-loop gain is decreased sufficiently, again the G(jv)H(jv)locus encloses the –1+j0 point twice. For stable operation of the system considered here, the critical point –1+j0 must not be located in the regions between OAand BCshown in Figure 7–58. Such a system that is stable only for limited ranges of values of the open-loop gain for which the –1+j0 point is completely outside the G(jv)H(jv)locus is a conditionally stable system. A conditionally stable system is stable for the value of the open-loop gain lying be- tween critical values, but it is unstable if the open-loop gain is either increased or de- creased sufficiently. Such a system becomes unstable when large input signals are applied, since a large signal may cause saturation, which in turn reduces the open-loop gain of the system. It is advisable to avoid such a situation. Multiple-Loop System. Consider the system shown in Figure 7–59.This is a mul- tiple-loop system. The inner loop has the transfer function G(s) =G 2 (s) 1+G 2 (s)H 2 (s) Im ReGH Plane 0 0A B Cv =` v Figure 7–58 Polar plot of a conditionally stable system. Openmirrors.comSection 7–6 / Stability Analysis 459Figure 7–60 Control system.IfG(s) is unstable, the effects of instability are to produce a pole or poles in the right-half splane.Then the characteristic equation of the inner loop, 1+ G2(s)H2(s)=0 , has a zero or zeros in the right-half splane. If G2(s)andH2(s)have poles here, then the number Z1of right-half plane zeros of 1+ G2(s)H2(s)can be found from where N1is the number of clockwise encirclements of the –1+j0 point by the G2(s)H2(s) locus. Since the open-loop transfer function of the entire system is given byG 1(s)G(s) H1(s), the stability of this closed-loop system can be found from the Nyquist plot of G1(s)G(s) H1(s)and knowledge of the right-half plane poles of G1(s)G(s) H1(s). Notice that if a feedback loop is eliminated by means of block diagram reductions, there is a possibility that unstable poles are introduced; if the feedforward branch iseliminated by means of block diagram reductions, there is a possibility that right-halfplane zeros are introduced.Therefore, we must note all right-half plane poles and zerosas they appear from subsidiary loop reductions. This knowledge is necessary in deter-mining the stability of multiple-loop systems. EXAMPLE 7–19 Consider the control system shown in Figure 7–60.The system involves two loops. Determine the range of gain Kfor stability of the system by the use of the Nyquist stability criterion. (The gain Kis positive.) To examine the stability of the control system, we need to sketch the Nyquist locus of G(s) , where However, the poles of G(s) are not known at this point.Therefore, we need to examine the minor loop if there are right-half s-plane poles. This can be done easily by use of the Routh stability criterion. Since the Routh array becomes as follows: Notice that there are two sign changes in the first column. Hence, there are two poles of G2(s)in the right-half splane. Once we find the number of right-half splane poles of G2(s), we proceed to sketch the Nyquist locus of G(s) , where G(s) =G1(s)G2(s)=K(s +0.5) s3+s2+1s3 s2 s1 s01 1 -1 10 10G 2(s)=1 s3+s2+1G(s) =G1(s)G2(s)Z1=N1+P1 ,P1 R(s) C(s) K(s+ 0.5) G1(s) G2(s)1 s2(s+ 1)+–+–460 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method Im v = 0.8 v = 0.7j1.5G K Plane v = 0.6 v = 0.9j1 G(jv) K v = 0.4 v = 1 j0.5 v = 1.5v = 1.4 v = 3 v = 0v =/H11009v = 0.2 v = 0.1 –1 –0.5 0 0.5 1 Re v = 2v =–/H11009 –j0.5 –j1 –j1.5 Figure 7–61 Polar plot of G(jv)/K.Our problem is to determine the range of the gain Kfor stability. Hence, instead of plotting Nyquist loci of G(jv)for various values of K, we plot the Nyquist locus of G(jv)/K. Figure 7–61 shows the Nyquist plot or polar plot of G(jv)/K. Since G(s) has two poles in the right-half splane, we have Noting that Z=N+P for stability, we require Z=0 orN=–2 . That is, the Nyquist locus of G(jv)must encircle the –1+j0 point twice counterclockwise. From Figure 7–61, we see that, if the critical point lies between 0 and –0.5 , then the G(jv)/K locus encircles the critical point twice counterclockwise. Therefore, we require –0.5K<–1 The range of the gain Kfor stability is 2<KP=2. Openmirrors.comSection 7–6 / Stability Analysis 461Nyquist Stability Criterion Applied to Inverse Polar Plots. In the previous analyses, the Nyquist stability criterion was applied to polar plots of the open-loop trans-fer function G(s)H(s) . In analyzing multiple-loop systems, the inverse transfer function may sometimes be used in order to permit graphical analysis; this avoids much of the numerical calculation.(The Nyquist stability criterion can be applied equally well to inverse polar plots. Themathematical derivation of the Nyquist stability criterion for inverse polar plots is thesame as that for direct polar plots.) The inverse polar plot of G(jv)H(jv)is a graph of 1/CG(jv)H(jv)Das a function of v. For example, if G(jv)H(jv)is thenThe inverse polar plot for v/H113500 is the lower half of the vertical line starting at the point (1, 0) on the real axis. The Nyquist stability criterion applied to inverse plots may be stated as follows: For a closed-loop system to be stable, the encirclement, if any, of the –1+j0 point by the 1/CG(s)H(s)Dlocus (as smoves along the Nyquist path) must be counterclockwise, and the number of such encirclements must be equal to the number of poles of 1/CG(s)H(s)D [that is, the zeros of G(s)H(s) ] that lie in the right-half splane. [The number of zeros ofG(s)H(s) in the right-half splane may be determined by the use of the Routh sta- bility criterion.] If the open-loop transfer function G(s)H(s) has no zeros in the right- half splane, then for a closed-loop system to be stable, the number of encirclements of the–1+j0 point by the 1/CG(s)H(s)Dlocus must be zero. Note that although the Nyquist stability criterion can be applied to inverse polar plots, if experimental frequency-response data are incorporated, counting the numberof encirclements of the 1/CG(s)H(s)Dlocus may be difficult because the phase shift cor- responding to the infinite semicircular path in the splane is difficult to measure. For example, if the open-loop transfer function G(s)H(s) involves transport lag such that then the number of encirclements of the –1+j0 point by the 1/CG(s)H(s)Dlocus be- comes infinite, and the Nyquist stability criterion cannot be applied to the inverse polarplot of such an open-loop transfer function. In general, if experimental frequency-response data cannot be put into analytical form, both the G(jv)H(jv)and 1/CG(jv)H(jv)Dloci must be plotted. In addition, the number of right-half plane zeros of G(s)H(s) must be determined. It is more dif- ficult to determine the right-half plane zeros of G(s)H(s) (in other words, to deter- mine whether a given component is minimum phase) than it is to determine theright-half plane poles of G(s)H(s) (in other words, to determine whether the com- ponent is stable).G(s)H(s) =Ke -jvL s(Ts +1)1 G(jv)H(jv)=1 jvT+1G(jv)H(jv)=jvT 1+jvT462 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method Depending on whether the data are graphical or analytical and whether nonmini- mum-phase components are included, an appropriate stability test must be used for multiple-loop systems. If the data are given in analytical form or if mathematical ex- pressions for all the components are known, the application of the Nyquist stability cri- terion to inverse polar plots causes no difficulty, and multiple-loop systems may be analyzed and designed in the inverse GH plane. (See Problem A–7–15 .) 7–7 RELATIVE STABILITY ANALYSIS Relative Stability. In designing a control system, we require that the system be stable. Furthermore, it is necessary that the system have adequate relative stability. In this section, we shall show that the Nyquist plot indicates not only whether a sys- tem is stable, but also the degree of stability of a stable system.The Nyquist plot also gives information as to how stability may be improved, if this is necessary. In the following discussion, we shall assume that the systems considered have unity feedback. Note that it is always possible to reduce a system with feedback ele- ments to a unity-feedback system, as shown in Figure 7–62. Hence, the extension of relative stability analysis for the unity-feedback system to nonunity-feedback sys- tems is possible. We shall also assume that, unless otherwise stated, the systems are minimum-phase systems; that is, the open-loop transfer function has neither poles nor zeros in the right- half splane. Relative Stability Analysis by Conformal Mapping. One of the important prob- lems in analyzing a control system is to find all closed-loop poles or at least those clos- est to the jvaxis (or the dominant pair of closed-loop poles). If the open-loop frequency-response characteristics of a system are known, it may be possible to esti- mate the closed-loop poles closest to the jvaxis. It is noted that the Nyquist locus G(jv) need not be an analytically known function of v. The entire Nyquist locus may be ex- perimentally obtained. The technique to be presented here is essentially graphical and is based on a conformal mapping of the splane into the G(s) plane. R(s) C(s) G H R(s) GHC(s)1 H +– +– Figure 7–62 Modification of a system with feedback elements to a unity- feedback system. Openmirrors.comSection 7–7 / Relative Stability Analysis 463s Planejv G(jv)s 0jv4 jv3 jv2 jv1 –s4–s3–s2–s1GPlaneIm Re –10 Constant s curvesConstant v curvesv4 v3 v2 v1–s4 –s3–s2–s1 Figure 7–63 Conformal mappingofs-plane grids into theG(s) plane. s Planejv s 0 (a) (b)s Planejv s 0 Figure 7–64 Two systems withtwo closed-looppoles each.Consider the conformal mapping of constant- slines (lines s=s+jv, where sis constant and vvaries) and constant- vlines (lines s=s+jv, where vis constant and svaries) in the splane.The s=0 line (the jvaxis) in the splane maps into the Nyquist plot in the G(s) plane.The constant- slines in the splane map into curves that are sim- ilar to the Nyquist plot and are in a sense parallel to the Nyquist plot, as shown in Fig-ure 7–63.The constant- vlines in the splane map into curves, also shown in Figure 7–63. Although the shapes of constant- sand constant- vloci in the G(s) plane and the closeness of approach of the G(jv)locus to the –1+j0 point depend on a particular G(s) , the closeness of approach of the G(jv)locus to the –1+j0 point is an indication of the relative stability of a stable system. In general, we may expect that the closer theG(jv)locus is to the –1+j0 point, the larger the maximum overshoot is in the step transient response and the longer it takes to damp out. Consider the two systems shown in Figures 7–64(a) and (b). (In Figure 7–64, the :’s indicate closed-loop poles.) System (a) is obviously more stable than system (b) becausethe closed-loop poles of system (a) are located farther left than those of system (b).Figures 7–65(a) and (b) show the conformal mapping of s-plane grids into the G(s) plane. The closer the closed-loop poles are located to the jvaxis, the closer the G(jv) locus is to the –1+j0 point.464 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method Phase and Gain Margins. Figure 7–66 shows the polar plots of G(jv)for three different values of the open-loop gain K. For a large value of the gain K, the system is unstable.As the gain is decreased to a certain value, the G(jv)locus passes through the –1+j0 point. This means that with this gain value the system is on the verge of insta- bility, and the system will exhibit sustained oscillations. For a small value of the gain K, the system is stable. In general, the closer the G(jv)locus comes to encircling the –1+j0 point, the more oscillatory is the system response.The closeness of the G(jv)locus to the –1+j0 point can be used as a measure of the margin of stability. (This does not apply, however, to conditionally stable systems.) It is common practice to represent the closeness in terms of phase margin and gain margin. Phase margin: The phase margin is that amount of additional phase lag at the gain crossover frequency required to bring the system to the verge of instability.The gain crossover frequency is the frequency at which @G(jv)@, the magnitude of the open- loop transfer function, is unity. The phase margin gis 180° plus the phase angle f of the open-loop transfer function at the gain crossover frequency, or g=180 °+f Im ReG Plane 0 –1 K : Large K : Small K= open-loop gain Figure 7–66 Polar plots of KA1+jvT a BA1+jvT b B p (jv)A1+jvT 1 BA1+jvT 2 B p. Im ReG Plane 0–1 G(jv) (a) (b)Im ReG Plane 0 –1 G(jv) Figure 7–65 Conformal mappings ofs-plane grids for the systems shown in Figure 7–64 into the G(s) plane. Openmirrors.comSection 7–7 / Relative Stability Analysis 465|G| in dB |G| in dB0+ –0+ –|G| in dB+ –|G| in dB+ ––90° –180° –270°–90° –180° –270°G GLogv LogvLogv LogvPositive gain margin Positive phase marginNegative gain margin Negative phase margin Stable systemIm Im Re Re Unstable system Stable system Unstable systemStable system Unstable system (a) (b) (c)Negative phase margin Negative phase marginPositive gain margin Positive gain marginPositive phase margin Positive phase marginNegative gain margin Negative gain margin1 Kg fg G(jv)Gplane Gplane 1 Kgfg G(jv)1 1 –1 –1 0 0 –270° –180° –90° –270° –180° –90° G GFigure 7–67 Phase and gainmargins of stable and unstable systems. (a) Bode diagrams;(b) polar plots;(c) log-magnitude-versus-phase plots.Figures 7–67(a), (b), and (c) illustrate the phase margin of both a stable system and an unstable system in Bode diagrams, polar plots, and log-magnitude-versus-phase plots.In the polar plot, a line may be drawn from the origin to the point at which the unit cir-cle crosses the G(jv)locus. If this line lies below (above) the negative real axis, then the466 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method anglegis positive (negative).The angle from the negative real axis to this line is the phase margin.The phase margin is positive for g>0 and negative for g<0 . For a minimum- phase system to be stable, the phase margin must be positive. In the logarithmic plots, the critical point in the complex plane corresponds to the 0-dB and –180 ° lines. Gain margin: The gain margin is the reciprocal of the magnitude @G(jv)@at the frequency at which the phase angle is –180 °. Defining the phase crossover fre- quency v 1 to be the frequency at which the phase angle of the open-loop transfer function equals –180 ° gives the gain margin K g : In terms of decibels, The gain margin expressed in decibels is positive if K g is greater than unity and nega- tive if K g is smaller than unity.Thus, a positive gain margin (in decibels) means that the system is stable, and a negative gain margin (in decibels) means that the system is unstable. The gain margin is shown in Figures 7–67(a), (b), and (c). For a stable minimum-phase system, the gain margin indicates how much the gain can be increased before the system becomes unstable. For an unstable system, the gain mar- gin is indicative of how much the gain must be decreased to make the system stable. The gain margin of a first- or second-order system is infinite since the polar plots for such systems do not cross the negative real axis. Thus, theoretically, first- or second- order systems cannot be unstable. (Note, however, that so-called first- or second-order systems are only approximations in the sense that small time lags are neglected in de- riving the system equations and are thus not truly first- or second-order systems. If these small lags are accounted for, the so-called first- or second-order systems may become unstable.) It is noted that for a nonminimum-phase system with unstable open loop the stability condition will not be satisfied unless the G(jv)plot encircles the –1+j0 point. Hence, such a stable nonminimum-phase system will have negative phase and gain margins. It is also important to point out that conditionally stable systems will have two or more phase crossover frequencies, and some higher-order systems with complicated numerator dynamics may also have two or more gain crossover frequencies, as shown in Figure 7–68. For stable systems having two or more gain crossover frequencies, the phase margin is measured at the highest gain crossover frequency. A Few Comments on Phase and Gain Margins. The phase and gain margins of a control system are a measure of the closeness of the polar plot to the –1+j0 point. Therefore, these margins may be used as design criteria. It should be noted that either the gain margin alone or the phase margin alone does not give a sufficient indication of the relative stability. Both should be given in the determination of relative stability. For a minimum-phase system, both the phase and gain margins must be positive for the system to be stable. Negative margins indicate instability. Proper phase and gain margins ensure us against variations in the system components and are specified for definite positive values.The two values bound the behavior of theK g dB =20logK g =-20log @GAjv 1 B@K g =1 @GAjv 1 B@ Openmirrors.comSection 7–7 / Relative Stability Analysis 467v =` v =` vIm Im Re Re 0v 0v1 v1v2 v2v3 v3Phase crossover frequencies (v1,v2,v3) Gain crossover frequencies (v1,v2,v3)Figure 7–68 Polar plots showingmore than two phase or gain crossover frequencies. Figure 7–69 Control system.closed-loop system near the resonant frequency. For satisfactory performance, the phase margin should be between 30° and 60°, and the gain margin should be greater than 6 dB.With these values, a minimum-phase system has guaranteed stability, even if the open-loop gain and time constants of the components vary to a certain extent. Although thephase and gain margins give only rough estimates of the effective damping ratio of theclosed-loop system, they do offer a convenient means for designing control systems oradjusting the gain constants of systems. For minimum-phase systems, the magnitude and phase characteristics of the open- loop transfer function are definitely related.The requirement that the phase margin bebetween 30° and 60° means that in a Bode diagram the slope of the log-magnitude curveat the gain crossover frequency should be more gradual than –40 dB /H20862decade. In most practical cases, a slope of –20dB /H20862decade is desirable at the gain crossover frequency for stability. If it is –40 dB /H20862decade, the system could be either stable or unstable. (Even if the system is stable, however, the phase margin is small.) If the slope at the gain crossoverfrequency is –60 dB /H20862decade or steeper, the system is most likely unstable. For nonminimum-phase systems, the correct interpretation of stability margins re- quires careful study.The best way to determine the stability of nonminimum-phase sys-tems is to use the Nyquist diagram approach rather than Bode diagram approach. EXAMPLE 7–20 Obtain the phase and gain margins of the system shown in Figure 7–69 for the two cases where K=10 andK=100 . R(s) C(s) K s(s+ 1) (s+ 5)+–468 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method The phase and gain margins can easily be obtained from the Bode diagram.A Bode diagram of the given open-loop transfer function with K=10 is shown in Figure 7–70(a). The phase and gain margins for K=10 are Phase margin =21 °, Gain margin =8 dB Therefore, the system gain may be increased by 8 dB before the instability occurs. Increasing the gain from K=10 toK=100 shifts the 0-dB axis down by 20 dB, as shown in Figure 7–70(b). The phase and gain margins are Phase margin =–30 °, Gain margin =–12 dB Thus, the system is stable for K=10, but unstable for K=100 . Notice that one of the very convenient aspects of the Bode diagram approach is the ease with which the effects of gain changes can be evaluated. Note that to obtain satisfactory performance, we must increase the phase margin to 30° ~60°. This can be done by decreasing the gain K. Decreas- ingKis not desirable, however, since a small value of Kwill yield a large error for the ramp input. This suggests that reshaping of the open-loop frequency-response curve by adding compensation may be necessary. Compensation techniques are discussed in detail in Sections 7–11 through 7–13. Obtaining Gain Margin, Phase Margin, Phase-Crossover Frequency, and Gain- Crossover Frequency with MATLAB. The gain margin, phase margin, phase-crossover frequency, and gain-crossover frequency can be obtained easily with MATLAB.The com- mand to be used is [Gm,pm,wcp,wcg] = margin(sys) 30 20 10 0 –30–20–10 0° –90° –180° –270° |G| in dB |G| in dBG 0.2 0.4 0.6 0.8 1 2 4 6 8 100° –90° –30°–180° –270° G 0.2 0.4 0.6 0.8 1 2 4 6 8 10K= 10 K= 100 + 8 dB (Gain margin) (Phase margin) +21° vv30 20 10 0 –1050 40 (Gain margin) –12 dB (Phase margin) (a) (b) Figure 7–70 Bode diagrams of the system shown in Figure 7–69; (a) with K=10 and (b) with K=100. Openmirrors.comSection 7–7 / Relative Stability Analysis 469G(s)20(s+ 1) s(s+ 5)(s2+ 2s+ 10)+– Figure 7–71 Closed-loop system. Frequency (rad/sec)Bode Diagram −300−100 −150 −200 −2500 −50−100Phase (deg); Magnitude (dB)50 −500 10−11001014.0131 0.4426 1029.9293 dB 103.6573 Figure 7–72 Bode diagram of G(s) shown in Figure 7–71.MATLAB Program 7–11 num = [20 20]; den = conv([1 5 0],[1 2 10]);sys = tf(num,den);w = logspace(-1,2,100);bode(sys,w)[Gm,pm,wcp,wcg] = margin(sys);GmdB = 20*log10(Gm);[GmdB pm wcp wcg] ans = 9.9293 103.6573 4.0131 0.4426where Gm is the gain margin, pmis the phase margin, wcp is the phase-crossover fre- quency, and wcg is the gain-crossover frequency. For details of how to use this com- mand, see Example 7–21. EXAMPLE 7–21 Draw a Bode diagram of the open-loop transfer function G(s) of the closed-loop system shown in Figure 7–71. Determine the gain margin, phase margin, phase-crossover frequency, and gain- crossover frequency with MATLAB. A MATLAB program to plot a Bode diagram and to obtain the gain margin, phase margin, phase-crossover frequency, and gain-crossover frequency is shown in MATLAB Program 7–11.The Bode diagram of G(s) is shown in Figure 7–72.470 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method Resonant Peak Magnitude M r and Resonant Frequency V r .Consider the standard second-order system shown in Figure 7–73.The closed-loop transfer function is (7–16) wherezandv n are the damping ratio and the undamped natural frequency, respectively. The closed-loop frequency response is where As given by Equation (7–12), for 0 /H11349z/H113490.707, the maximum value of Moccurs at the frequency v r , where (7–17) The frequency v r is the resonant frequency. At the resonant frequency, the value of M is maximum and is given by Equation (7–13), rewritten (7–18) where M r is defined as the resonant peak magnitude . The resonant peak magnitude is related to the damping of the system. The magnitude of the resonant peak gives an indication of the relative stability of the system. A large resonant peak magnitude indicates the presence of a pair of dominant closed-loop poles with small damping ratio, which will yield an undesirable transient response.A smaller resonant peak magnitude, on the other hand, indicates the absence of a pair of dominant closed-loop poles with small damping ratio, meaning that the system is well damped. Remember that v r is real only if z<0.707 . Thus, there is no closed-loop resonance ifz>0.707 . [The value of M r is unity only if z>0.707 . See Equation (7–14).] Since the values of M r andv r can be easily measured in a physical system, they are quite useful for checking agreement between theoretical and experimental analyses.M r =1 2z21-z 2 v r =v n 21-2z 2 M=1 B a 1-v 2 v 2 n b 2 + a 2zv v n b 2 , a=-tan -1 2zv v n 1-v 2 v 2 n C(jv) R(jv)=1 a 1-v 2 v 2 n b +j2zv v n =Me ja C(s) R(s)=v 2 n s 2 +2zv n s+v 2 n R(s) C(s)v n s(s+ 2z v n ) 2 +– Figure 7–73 Standard second- order system. Openmirrors.comSection 7–7 / Relative Stability Analysis 471It is noted, however, that in practical design problems the phase margin and gain margin are more frequently specified than the resonant peak magnitude to indicate thedegree of damping in a system. Correlation between Step Transient Response and Frequency Response in the Standard Second-Order System. The maximum overshoot in the unit-step re- sponse of the standard second-order system, as shown in Figure 7–73, can be exactlycorrelated with the resonant peak magnitude in the frequency response. Hence, essen-tially the same information about the system dynamics is contained in the frequency re-sponse as is in the transient response. For a unit-step input, the output of the system shown in Figure 7–73 is given by Equa- tion (5–12), or where (7–19) On the other hand, the maximum overshoot M pfor the unit-step response is given by Equation (5–21), or (7–20) This maximum overshoot occurs in the transient response that has the damped natural frequency The maximum overshoot becomes excessive for values ofz<0.4. Since the second-order system shown in Figure 7–73 has the open-loop transfer function for sinusoidal operation, the magnitude of G(jv)becomes unity when which can be obtained by equating @G(jv)@to unity and solving for v.At this frequency, the phase angle of G(jv)is Thus, the phase margin gis (7–21) Equation (7–21) gives the relationship between the damping ratio zand the phase margin g. (Notice that the phase margin gis a function only of the damping ratio z.) =tan -12z 32 1+4z4-2z2 =90°-tan-132 1+4z4-2z2 2z g=180°+/G(jv)/G(jv)=-/jv-/jv+2zvn=-90°-tan-132 1+4z4-2z2 2zv=vn32 1+4z4-2z2G(s) =v2 n sAs+2zvnBvd=vn21-z2.Mp=e-Az/H2086221-z2Bpvd=vn21-z2c(t) =1-e-zvn tacosvd t+z 21-z2 sinvd tb, fort/H113500472 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method In the following, we shall summarize the correlation between the step transient response and frequency response of the standard second-order system given by Equation (7–16): 1.The phase margin and the damping ratio are directly related. Figure 7–74 shows a plot of the phase margin gas a function of the damping ratio z. It is noted that for the stan- dard second-order system shown in Figure 7–73, the phase margin gand the damping ratiozare related approximately by a straight line for 0 /H11349z/H113490.6, as follows: Thus a phase margin of 60° corresponds to a damping ratio of 0.6. For higher-order systems having a dominant pair of closed-loop poles, this relationship may be used as a rule of thumb in estimating the relative stability in the transient response (that is, the damping ratio) from the frequency response. 2.Referring to Equations (7–17) and (7–19), we see that the values of v r andv d are almost the same for small values of z.Thus, for small values of z, the value of v r is indicative of the speed of the transient response of the system. 3.From Equations (7–18) and (7–20), we note that the smaller the value of zis, the larger the values of M r andM p are.The correlation between M r andM p as a func- tion of zis shown in Figure 7–75. A close relationship between M r andM p can be seen for z>0.4 . For very small values of z,M r becomes very large AM r /H112711B, while the value of M p does not exceed 1. Correlation between Step Transient Response and Frequency Response in General Systems. The design of control systems is very often carried out on the basis of the frequency response. The main reason for this is the relative simplicity of this ap- proach compared with others. Since in many applications it is the transient response of the system to aperiodic inputs rather than the steady-state response to sinusoidal in- puts that is of primary concern, the question of correlation between transient response and frequency response arises.z=g 100° 90° 60° 30° 0°0 0.4 0.8 1.2 1.6 2.0 zg Straight-line approximation Figure 7–74 Curveg(phase margin) versus zfor the system shown in Figure 7–73. Openmirrors.comFor the standard second-order system shown in Figure 7–73, mathematical rela- tionships correlating the step transient response and frequency response can be obtainedeasily.The time response of the standard second-order system can be predicted exactlyfrom a knowledge of the M randvrof its closed-loop frequency response. For nonstandard second-order systems and higher-order systems, the correlation is more complex, and the transient response may not be predicted easily from the fre-quency response because additional zeros and/or poles may change the correlation be-tween the step transient response and the frequency response existing for the standardsecond-order system. Mathematical techniques for obtaining the exact correlation areavailable, but they are very laborious and of little practical value. The applicability of the transient-response–frequency-response correlation existing for the standard second-order system shown in Figure 7–73 to higher-order systems depends onthe presence of a dominant pair of complex-conjugate closed-loop poles in the latter systems.Clearly, if the frequency response of a higher-order system is dominated by a pair of com-plex-conjugate closed-loop poles, the transient-response– frequency-response correlationexisting for the standard second-order system can be extended to the higher-order system. For linear, time-invariant, higher-order systems having a dominant pair of complex- conjugate closed-loop poles, the following relationships generally exist between the steptransient response and frequency response: 1.The value of M ris indicative of the relative stability. Satisfactory transient per- formance is usually obtained if the value of Mris in the range 1.0< Mr<1.4 A0d B <Mr<3 dBB, which corresponds to an effective damping ratio of 0.4<z<0.7 . For values of Mrgreater than 1.5, the step transient response may exhibit several overshoots. (Note that, in general, a large value of Mrcorresponds to a large overshoot in the step transient response. If the system is subjected tonoise signals whose frequencies are near the resonant frequency v r, the noise will be amplified in the output and will present serious problems.) 2.The magnitude of the resonant frequency vris indicative of the speed of the tran- sient response. The larger the value of vr, the faster the time response is. In other words, the rise time varies inversely with vr. In terms of the open-loop frequency Section 7–7 / Relative Stability Analysis 4733 Mr 2 1 Mp 00.2 0.4 0.6 0.8 1.0 zMr=1 2z 1–z2 Mp=c(tp)–1 [Equation (5-21)] Figure 7–75 Curves Mrversusz andMpversuszfor the system shown inFigure 7–73.474 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method response, the damped natural frequency in the transient response is somewhere between the gain crossover frequency and phase crossover frequency. 3.The resonant peak frequency v r and the damped natural frequency v d for the step transient response are very close to each other for lightly damped systems. The three relationships just listed are useful for correlating the step transient re- sponse with the frequency response of higher-order systems, provided that they can be approximated by the standard second-order system or a pair of complex-conjugate closed-loop poles. If a higher-order system satisfies this condition, a set of time-domain specifications may be translated into frequency-domain specifications. This simplifies greatly the design work or compensation work of higher-order systems. In addition to the phase margin, gain margin, resonant peak M r , and resonant fre- quency v r , there are other frequency-domain quantities commonly used in performance specifications. They are the cutoff frequency, bandwidth, and the cutoff rate. These will be defined in what follows. Cutoff Frequency and Bandwidth. Referring to Figure 7–76, the frequency v b at which the magnitude of the closed-loop frequency response is 3 dB below its zero-fre- quency value is called the cutoff frequency . Thus For systems in which The closed-loop system filters out the signal components whose frequencies are greater than the cutoff frequency and transmits those signal components with frequencies lower than the cutoff frequency. The frequency range 0 /H11349v/H11349v b in which the magnitude of is greater than –3dB is called the bandwidth of the system. The bandwidth indicates the frequency where the gain starts to fall off from its low-frequency value.Thus, the bandwidth indicates how well the system will track an input sinusoid. Note that for a given v n , the rise time in- creases with increasing damping ratio z. On the other hand, the bandwidth decreases with the increase in z. Therefore, the rise time and the bandwidth are inversely proportional to each other.C(jv)/H20862R(jv) 2 C(jv) R(jv) 2 6-3 dB, for v7v b @C(j0) /H20862R(j0)@=0 dB, 2 C(jv) R(jv) 2 6 2 C(j0) R(j0) 2 -3 dB, forv7v b dB 0 –3 Bandwidth v b v in log scale Figure 7–76 Plot of a closed-loop frequency response curve showing cutoff frequency v b and bandwidth. Openmirrors.comSection 7–7 / Relative Stability Analysis 475dB 0 –20 0.33I II II IIII 1 1 11 v (in log scale) (a) (b) (c)00 c(t) r(t)c(t) r(t) r(t)t tFigure 7–77 Comparison ofdynamic characteristics of the two systemsconsidered inExample 7–22.(a) Closed-loop frequency-response curves; (b) unit-stepresponse curves;(c) unit-rampresponse curves.The specification of the bandwidth may be determined by the following factors: 1.The ability to reproduce the input signal.A large bandwidth corresponds to a small rise time, or fast response. Roughly speaking, we can say that the bandwidth is proportionalto the speed of response. (For example, to decrease the rise time in the step responseby a factor of 2, the bandwidth must be increased by approximately a factor of 2.) 2.The necessary filtering characteristics for high-frequency noise. For the system to follow arbitrary inputs accurately, it must have a large bandwidth. From the viewpoint of noise, however, the bandwidth should not be too large.Thus, thereare conflicting requirements on the bandwidth, and a compromise is usually necessary forgood design. Note that a system with large bandwidth requires high-performancecomponents, so the cost of components usually increases with the bandwidth. Cutoff Rate. The cutoff rate is the slope of the log-magnitude curve near the cutoff fre- quency.The cutoff rate indicates the ability of a system to distinguish the signal from noise. It is noted that a closed-loop frequency response curve with a steep cutoff charac- teristic may have a large resonant peak magnitude, which implies that the system has arelatively small stability margin. EXAMPLE 7–22 Consider the following two systems: Compare the bandwidths of these two systems. Show that the system with the larger bandwidth has a faster speed of response and can follow the input much better than the one with the smaller bandwidth. Figure 7–77(a) shows the closed-loop frequency-response curves for the two systems. (Asymptot- ic curves are shown by dashed lines.) We find that the bandwidth of system I is 0 /H11349v/H113491 rad /H20862sec and that of system II is 0 /H11349v/H113490.33 rad /H20862sec. Figures 7–77(b) and (c) show, respectively, the unit-step re- sponse and unit-ramp response curves for the two systems. Clearly, system I, whose bandwidth is threetimes wider than that of system II, has a faster speed of response and can follow the input much better.System I: C(s) R(s)=1 s+1, System II: C(s) R(s)=1 3s+1476 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method MATLAB Approach to Get Resonant Peak, Resonant Frequency, and Band- width. The resonant peak is the value of the maximum magnitude (in decibels) of the closed-loop frequency response.The resonant frequency is the frequency that yields the maximum magnitude. MATLAB commands to be used for obtaining the resonant peak and resonant frequency are as follows: [mag,phase,w] = bode(num,den,w); or [mag,phase,w] = bode(sys,w); [Mp,k] = max(mag); resonant_peak = 20*log10(Mp); resonant_frequency = w(k) The bandwidth can be obtained by entering the following lines in the program: n = 1; while 20*log10(mag(n)) > = -3; n = n + 1; end bandwidth = w(n) For a detailed MATLAB program, see Example 7–23. EXAMPLE 7–23 Consider the system shown in Figure 7–78. Using MATLAB, obtain a Bode diagram for the closed- loop transfer function. Obtain also the resonant peak, resonant frequency, and bandwidth. MATLAB Program 7–12 produces a Bode diagram for the closed-loop system as well as the resonant peak, resonant frequency, and bandwidth. The resulting Bode diagram is shown in MATLAB Program 7–12 nump = [1]; denp = [0.5 1.5 1 0]; sysp = tf(nump,denp); sys = feedback(sysp,1); w = logspace(-1,1); bode(sys,w) [mag,phase,w] = bode(sys,w); [Mp,k] = max(mag); resonant_peak = 20*log10(Mp) resonant_peak = 5.2388 resonant_frequency = w(k) resonant_frequency = 0.7906 n = 1; while 20*log(mag(n))> = -3; n = n + 1; end bandwidth = w(n) bandwidth = 1.2649 Openmirrors.comSection 7–8 / Closed-Loop Frequency Response of Unity-Feedback Systems 477Figure 7–79.The resonant peak is obtained as 5.2388 dB.The resonant frequency is 0.7906 rad /H20862sec. The bandwidth is 1.2649 rad /H20862sec. These values can be verified from Figure 7–78. 7–8 CLOSED-LOOP FREQUENCY RESPONSE OF UNITY- FEEDBACK SYSTEMS Closed-Loop Frequency Response. For a stable, unity-feedback closed-loop sys- tem, the closed-loop frequency response can be obtained easily from that of the open-loop frequency response. Consider the unity-feedback system shown in Figure 7–80(a).The closed-loop transfer function is In the Nyquist or polar plot shown in Figure 7–80(b), the vector represents GAjv 1B, wherev1is the frequency at point A. The length of the vector is @GAjv1B@and the angle of the vector is The vector the vector from the –1+j0 point to the Nyquist locus, represents 1+GAjv1B. Therefore, the ratio of to repre- sents the closed-loop frequency response, or OA! PA!=GAjv1B 1+GAjv1B=CAjv1B RAjv1BPA! OA! ,PA! , /GAjv1B. OA!OA!OA!C(s) R(s)=G(s) 1+G(s)1 s(0.5s+ 1) (s+ 1)+–R(s) C(s) Figure 7–78 Closed-loop system. Frequency (rad/sec)Bode Diagram −300−50 −100 −150 −200 −2500−60−40−20Phase (deg); Magnitude (dB)20 0 10−1100101Figure 7–79 Bode diagram of theclosed-loop transfer function of the system shown inFigure 7–78.478 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method The magnitude of the closed-loop transfer function at v=v 1 is the ratio of the magni- tudes of to . The phase angle of the closed-loop transfer function at v=v 1 is the angle formed by the vectors to —that is f-u, shown in Figure 7–80(b). By measuring the magnitude and phase angle at different frequency points, the closed-loop frequency-response curve can be obtained. Let us define the magnitude of the closed-loop frequency response as Mand the phase angle as a,o r In the following, we shall find the constant-magnitude loci and constant-phase-angle loci. Such loci are convenient in determining the closed-loop frequency response from the polar plot or Nyquist plot. Constant-Magnitude Loci ( Mcircles). To obtain the constant-magnitude loci, let us first note that G(jv) is a complex quantity and can be written as follows: where XandYare real quantities. Then Mis given by andM 2 is Hence (7–22) IfM=1 , then from Equation (7–22), we obtain This is the equation of a straight line parallel to the Yaxis and passing through the point A- 1 2 ,0B.X=- 1 2 .X 2 A1-M 2 B-2M 2 X-M 2 +A1-M 2 BY 2 =0M 2 =X 2 +Y 2 (1+X) 2 +Y 2 M=∑X+jY∑ ∑1+X+jY∑G(jv)=X+jYC(jv) R(jv)=Me ja PA ! OA !PA ! OA ! (a) (b)G(s)Im ReO P–1+j0 A G(jv)uf v 1 f –u +– Figure 7–80 (a) Unity-feedback system; (b) determination of closed-loop frequency response from open-loop frequency response. Openmirrors.comSection 7–8 / Closed-Loop Frequency Response of Unity-Feedback Systems 479– 4 –3 –2 –1 01 2 XYM= 1.2 M= 1.3M= 1 M= 1.4 M= 1.6 M= 2.0 M= 3.0 M= 5.0 –1 –212M= 0.8 M= 0.4M= 0.6 Figure 7–81 A family of constantMcircles.If Equation (7–22) can be written If the term M2/AM2-1B2is added to both sides of this last equation, we obtain (7–23) Equation (7–23) is the equation of a circle with center at X=–M2/AM2-1B,Y=0 and with radius @M/AM2-1B@. The constant Mloci on the G(s) plane are thus a family of circles.The center and ra- dius of the circle for a given value of Mcan be easily calculated. For example, for M=1.3 , the center is at (–2.45, 0) and the radius is 1.88. A family of constant Mcir- cles is shown in Figure 7–81. It is seen that as Mbecomes larger compared with 1, the Mcircles become smaller and converge to the –1+j0 point. For M>1 , the centers of theMcircles lie to the left of the –1+j0 point. Similarly, as Mbecomes smaller com- pared with 1, the Mcircle becomes smaller and converges to the origin. For 0<M<1 , the centers of the Mcircles lie to the right of the origin. M=1 corresponds to the locus of points equidistant from the origin and from the –1+j0 point. As stated earlier, it is a straight line passing through the point and parallel to the imaginary axis. (Theconstant Mcircles corresponding to M>1 lie to the left of the M=1 line, and those corresponding to 0<M<1 lie to the right of the M=1 line.) The Mcircles are sym- metrical with respect to the straight line corresponding to M=1 and with respect to the real axis.A- 1 2,0BaX+M2 M2-1b2 +Y2=M2 AM2-1B2X2+2M2 M2-1X+M2 M2-1+Y2=0MZ1,480 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method Constant-Phase-Angle Loci ( NCircles). We shall obtain the phase angle ain terms of XandY. Since the phase angle ais If we define then Since we obtain or The addition of to both sides of this last equation yields (7–24) This is an equation of a circle with center at Y=1 /H20862(2N) and with radius For example, if a=30°, then N= tana=0.577, and the center and the radius of the circle corresponding to a=30° are found to be (–0.5, 0.866) and unity, respectively. Since Equation (7–24) is satisfied when X=Y=0 and X=–1 ,Y=0 regardless of the value of N, each circle passes through the origin and the –1+j0 point. The constant aloci can be drawn easily, once the value of Nis given.A family of constant Ncircles is shown in Figure 7–82 with aas a parameter. It should be noted that the constant Nlocus for a given value of ais actually not the entire circle, but only an arc. In other words, the a=30° and a=–150 ° arcs are parts of the same circle. This is so because the tangent of an angle remains the same if ;180° (or multiples thereof) is added to the angle. The use of the Mand Ncircles enables us to find the entire closed-loop frequency response from the open-loop frequency response G(jv)without calculating the magni- tude and phase of the closed-loop transfer function at each frequency.The intersections 3 1 4 +1/H20862(2N) 2 .X=- 1 2 , a X+1 2 b 2 + a Y-1 2N b 2 =1 4+ a 1 2N b 2 A 1 4 B+1/H20862(2N) 2 X 2 +X+Y 2 -1 NY=0N=Y X-Y 1+X 1+Y X a Y 1+X b =Y X 2 +X+Y 2 tan (A-B)=tanA-tanB 1+tanA tanBN=tan c tan -1 a Y X b -tan -1 a Y 1+X b d tana=Na=tan -1 a Y X b -tan -1 a Y 1+X b / e ja = n X+jY 1+X+jY Openmirrors.comSection 7–8 / Closed-Loop Frequency Response of Unity-Feedback Systems 481–33 –3 –2–2 –111 22 XY a= 20° a= 30° a= 40° a= 100°60° 120°80° –60°–120 ° –80° a=–100° a=–40° a=–30° a=–20°Figure 7–82 A family of constantNcircles. of the G(jv)locus and the Mcircles and Ncircles give the values of Mand Nat fre- quency points on the G(jv)locus. The Ncircles are multivalued in the sense that the circle for a=a1and that for a=a1;180° n (n=1, 2, p)are the same. In using the Ncircles for the determination of the phase angle of closed-loop systems, we must interpret the proper value of a.T o avoid any error, start at zero frequency, which corresponds to a=0 °, and proceed to higher frequencies. The phase-angle curve must be continuous. Graphically, the intersections of the G(jv)locus and Mcircles give the values of M at the frequencies denoted on the G(jv)locus. Thus, the constant Mcircle with the smallest radius that is tangent to the G(jv)locus gives the value of the resonant peak magnitude Mr. If it is desired to keep the resonant peak value less than a certain value, then the system should not enclose the critical point (–1+j0 point )and, at the same time, there should be no intersections with the particular Mcircle and the G(jv)locus. Figure 7–83(a) shows the G(jv)locus superimposed on a family of Mcircles. Figure 7–83(b) shows the G(jv)locus superimposed on a family of Ncircles. From these plots, it is possible to obtain the closed-loop frequency response by inspection. It is seen thattheM=1.1 circle intersects the G(jv)locus at frequency point v=v This means that at this frequency the magnitude of the closed-loop transfer function is 1.1. In Fig-ure 7–83(a), the M=2 circle is just tangent to the G (jv)locus. Thus, there is only one point on the G(jv)locus for which @C(jv)/R(jv)@is equal to 2. Figure 7–83(c) shows the closed-loop frequency-response curve for the system.The upper curve is the M-versus- frequency vcurve, and the lower curve is the phase angle a-versus-frequency vcurve. The resonant peak value is the value of Mcorresponding to the Mcircle of small- est radius that is tangent to the G(jv)locus. Thus, in the Nyquist diagram, the resonant482 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method peak value M r and the resonant frequency v r can be found from the M-circle tangency to the G(jv)locus. (In the present example, M r =2 andv r =v 4 .) Nichols Chart. In dealing with design problems, we find it convenient to construct theMandNloci in the log-magnitude-versus-phase plane. The chart consisting of the Mand Nloci in the log-magnitude-versus-phase diagram is called the Nichols chart. The G(jv)locus drawn on the Nichols chart gives both the gain characteristics and a= G 1+G M=G 1+G Im ReIm Re2 0 0 –2–2 –4–4 –2 –42 –2 –4M= 1.2 M= 1.4M= 1.1 M= 1.1M= 2M= 0.6 M= 1.2 G(jv) G(jv) v 1 (a) (b) (c)20° 60° –20°–40° –10° v 1 v 2 v 2 v 3 v 3 v 4 v 4 v 5 v 5 2 1.5 1 0.5 0 0° –90° –180° –270°v 1 v 2 v 3 v 4 v 5 vv Figure 7–83 (a)G(jv)locus superimposed on a family of Mcircles; (b)G(jv)locus superimposed on a family of Ncircles; (c) closed-loop frequency-response curves. Openmirrors.comSection 7–8 / Closed-Loop Frequency Response of Unity-Feedback Systems 483+–RCG 0.25 dB 0.5 dB 1 dB 2 dB 3 dB 4 dB 5 dB 6 dB 9 dB –18 dB–12 dB–6 dB–5 dB–4 dB–3 dB–2 dB–1 dB–0.5 dB–0.25 dB–0.1 dB0.1 dB 0 dB 12 dB120° 150° –180° –150° –120° –90° –60° –30° –20° –10° –5° –2° 90°60°30°20°10°5°2° 0°–2° –5° –10° –20° –30° –60°36 32 28 24 20 1612 8 4 0 –16–12–8–4 –240°–210°–180°–150°–120°–90°–60°–30° 0° GH|GH| in dB Figure 7–84 Nichols chart.phase characteristics of the closed-loop transfer function at the same time.The Nichols chart is shown in Figure 7–84, for phase angles between 0° and –240 °. Note that the critical point (–1+j0 point )is mapped to the Nichols chart as the point (0d B , –180 °). The Nichols chart contains curves of constant closed-loop magni- tude and phase angle. The designer can graphically determine the phase margin, gainmargin, resonant peak magnitude, resonant frequency, and bandwidth of the closed-loop system from the plot of the open-loop locus, G(jv). The Nichols chart is symmetric about the –180 ° axis. The Mand Nloci repeat for every 360°, and there is symmetry at every 180° interval.The Mloci are centered about the critical point (0dB,–180 °).The Nichols chart is useful for determining the frequency response of the closed loop from that of the open loop. If the open-loop frequency-re-sponse curve is superimposed on the Nichols chart, the intersections of the open-loopfrequency-response curve G(jv)and the Mand Nloci give the values of the magni- tude Mand phase angle aof the closed-loop frequency response at each frequency point. If the G(jv)locus does not intersect the M= M rlocus, but is tangent to it, then the resonant peak value of Mof the closed-loop frequency response is given by Mr.T he resonant frequency is given by the frequency at the point of tangency. As an example, consider the unity-feedback system with the following open-loop transfer function: To find the closed-loop frequency response by use of the Nichols chart, the G(jv)locus is constructed in the log-magnitude-versus-phase plane by use of MATLAB or fromG(jv)=K s(s+1)(0.5s +1), K=1484 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method the Bode diagram. Figure 7–85(a) shows the G(jv)locus together with the MandNloci. The closed-loop frequency-response curves may be constructed by reading the magni- tudes and phase angles at various frequency points on the G(jv)locus from the Mand Nloci, as shown in Figure 7–85(b). Since the largest magnitude contour touched by the G(jv)locus is 5 dB, the resonant peak magnitude M r is 5 dB. The corresponding reso- nant peak frequency is 0.8 rad /H20862sec. Notice that the phase crossover point is the point where the G(jv)locus intersects the–180 ° axis (for the present system, v=1.4 rad /H20862sec), and the gain crossover point is the point where the locus intersects the 0-dB axis (for the present system, v=0.76 rad /H20862sec). The phase margin is the horizontal distance (measured in degrees) between the gain crossover point and the critical point (0d B , –180 °). The gain margin is the distance (in decibels) between the phase crossover point and the critical point. The bandwidth of the closed-loop system can easily be found from the G(jv)locus in the Nichols diagram. The frequency at the intersection of the G(jv)locus and the M=–3 dB locus gives the bandwidth. If the open-loop gain Kis varied, the shape of the G(jv)locus in the log-magnitude- versus-phase diagram remains the same, but it is shifted up (for increasing K) or down (for decreasing K) along the vertical axis. Therefore, the G(jv)locus intersects the M 20 16 12 8 4 0 –16–12–8–4 –240° –210° –180° –150° –120° –90° (a) (b)G 1 dB 3 dB0.25 dB 5 dB 12 dB |G| in dB –1 dB –5 dB –12 dB1.81.4 1.2 1 0.80.6 0.40.2 –30°–20°–10° –60° –120° –150° –90° v in rad/sec G 1+G G 1+G in dB –270°–180°–90°–15–10–50510 0° 0.1 0.2 0.4 0.6 0.8 1 2 Figure 7–85 (a) Plot of G(jv)superimposed on Nichols chart; (b) closed-loop frequency-response curves. Openmirrors.comSection 7–8 / Closed-Loop Frequency Response of Unity-Feedback Systems 485|G| in dB G15 10 5 0 –5 –10 –15 –90° –120° –150° –180°Mr= 1.4 20 log K= 4G(jv) G(jv) K Figure 7–86 Determination of thegain Kusing the Nichols chart.andNloci differently, resulting in a different closed-loop frequency-response curve. For a small value of the gain K, the G(jv)locus will not be tangent to any of the Mloci, which means that there is no resonance in the closed-loop frequency response. EXAMPLE 7–24 Consider the unity-feedback control system whose open-loop transfer function is Determine the value of the gain Kso that Mr=1.4 . The first step in the determination of the gain Kis to sketch the polar plot of Figure 7–86 shows the Mr=1.4 locus and the G(jv)/K locus. Changing the gain has no effect on the phase angle, but merely moves the curve vertically up for K>1 and down for K<1 . In Figure 7–86, the G(jv)/K locus must be raised by 4 dB in order that it be tangent to the desired Mrlocus and that the entire G(jv)/K locus be outside the Mr=1.4 locus.The amount of vertical shift of the G(jv)/K locus determines the gain necessary to yield the desired value of Mr. Thus, by solving we obtain K=1.5920logK=4G(jv) K=1 jv(1+jv)G(jv)=K jv(1+jv)486 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method 7–9 EXPERIMENTAL DETERMINATION OF TRANSFER FUNCTIONS The first step in the analysis and design of a control system is to derive a mathematical model of the plant under consideration. Obtaining a model analytically may be quite dif- ficult.We may have to obtain it by means of experimental analysis.The importance of the frequency-response methods is that the transfer function of the plant, or any other com- ponent of a system, may be determined by simple frequency-response measurements. If the amplitude ratio and phase shift have been measured at a sufficient number of frequencies within the frequency range of interest, they may be plotted on the Bode di- agram.Then the transfer function can be determined by asymptotic approximations.We build up asymptotic log-magnitude curves consisting of several segments. With some trial-and-error juggling of the corner frequencies, it is usually possible to find a very close fit to the curve. (Note that if the frequency is plotted in cycles per second rather than radians per second, the corner frequencies must be converted to radians per sec- ond before computing the time constants.) Sinusoidal-Signal Generators. In performing a frequency-response test, suitable sinusoidal-signal generators must be available. The signal may have to be in mechani- cal, electrical, or pneumatic form. The frequency ranges needed for the test are ap- proximately 0.001 to 10 Hz for large-time-constant systems and 0.1 to 1000 Hz for small-time-constant systems. The sinusoidal signal must be reasonably free from har- monics or distortion. For very low frequency ranges (below 0.01 Hz), a mechanical signal generator (together with a suitable pneumatic or electrical transducer if necessary) may be used. For the frequency range from 0.01 to 1000 Hz, a suitable electrical-signal generator (together with a suitable transducer if necessary) may be used. Determination of Minimum-Phase Transfer Functions from Bode Diagrams. As stated previously, whether a system is minimum phase can be determined from the frequency-response curves by examining the high-frequency characteristics. To determine the transfer function, we first draw asymptotes to the experimental- ly obtained log-magnitude curve. The asymptotes must have slopes of multiples of ;20 dB /H20862decade. If the slope of the experimentally obtained log-magnitude curve changes from –20 to–40 dB /H20862decade at v=v 1 , it is clear that a factor 1/C1+jAv/v 1 BD exists in the transfer function. If the slope changes by –40 dB /H20862decade at v=v 2 , there must be a quadratic factor of the form in the transfer function. The undamped natural frequency of this quadratic factor is equal to the corner frequency v 2 . The damping ratio zcan be determined from the experimentally obtained log-magnitude curve by measuring the amount of resonant peak near the corner frequency v 2 and comparing this with the curves shown in Figure 7–9. Once the factors of the transfer function G(jv)have been determined, the gain can be determined from the low-frequency portion of the log-magnitude curve. Since such1 1+2z a jv v 2 b + a jv v 2 b 2 Openmirrors.comterms as 1+jAv/v1Band1+2zAjv/v2B+Ajv/v2B2become unity as vapproaches zero, at very low frequencies the sinusoidal transfer function G(jv)can be written In many practical systems, lequals 0, 1, or 2. 1.For l=0 , or type 0 systems, or The low-frequency asymptote is a horizontal line at 20 log KdB. The value of K can thus be found from this horizontal asymptote. 2.For l=1 , or type 1 systems, or which indicates that the low-frequency asymptote has the slope –20 dB /H20862decade. The frequency at which the low-frequency asymptote (or its extension) intersectsthe 0-dB line is numerically equal to K. 3.For l=2 , or type 2 systems, or The slope of the low-frequency asymptote is –40 dB /H20862decade. The frequency at which this asymptote (or its extension) intersects the 0-dB line is numerically equalto Examples of log-magnitude curves for type 0, type 1, and type 2 systems are shown in Figure 7–87, together with the frequency to which the gain Kis related. The experimentally obtained phase-angle curve provides a means of checking the transfer function obtained from the log-magnitude curve. For a minimum-phase system,the experimental phase-angle curve should agree reasonably well with the theoreticalphase-angle curve obtained from the transfer function just determined.These two phase-angle curves should agree exactly in both the very low and very high frequency ranges.If the experimentally obtained phase angle at very high frequencies (compared with thecorner frequencies) is not equal to –90°(q-p) , where pandqare the degrees of the nu- merator and denominator polynomials of the transfer function, respectively, then thetransfer function must be a nonminimum-phase transfer function.1K .20log @G(jv)@=20logK-40logv, for v/H112701G(jv)=K (jv)2, for v/H11270120log @G(jv)@=20logK-20logv, for v/H112701G(jv)=K jv, for v/H11270120log @G(jv)@=20logK, for v/H112701G(jv)=K, for v/H112701lim vS0G(jv)=K (jv)l Section 7–9 / Experimental Determination of Transfer Functions 487488 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method Nonminimum-Phase Transfer Functions. If, at the high-frequency end, the com- puted phase lag is 180° less than the experimentally obtained phase lag, then one of the zeros of the transfer function should have been in the right-half splane instead of the left-half splane. If the computed phase lag differed from the experimentally obtained phase lag by a constant rate of change of phase, then transport lag, or dead time, is present. If we assume the transfer function to be of the form where G(s) is a ratio of two polynomials in s, then where we used the fact that constant. Thus, from this last equation, we can evaluate the magnitude of the transport lag T.lim vSq / G(jv) = =0-T=-T =lim vSq d dv C / G(jv) -vTD lim vSq d dv / G(jv)e -jvT =lim vSq d dv C / G(jv) + / e -jvT DG(s)e -Ts (a)0–20 20 log K –40 –40dB v =K v =Kv in log scale (b) (c)0–20 –20 –20 –20–40 –40 –40 –40dB v in log scale0dB v in log scale 0dB v in log scale0dB v in log scalev =K v =K Figure 7–87 (a) Log-magnitude curve of a type 0 system; (b) log- magnitude curves of type 1 systems; (c) log-magnitude curves of type 2 systems. (The slopes shown are in dB /H20862decade.) Openmirrors.comA Few Remarks on the Experimental Determination of Transfer Functions 1.It is usually easier to make accurate amplitude measurements than accurate phase- shift measurements. Phase-shift measurements may involve errors that may becaused by instrumentation or by misinterpretation of the experimental records. 2.The frequency response of measuring equipment used to measure the system out- put must have a nearly flat magnitude-versus-frequency curve. In addition, thephase angle must be nearly proportional to the frequency. 3.Physical systems may have several kinds of nonlinearities. Therefore, it is nec- essary to consider carefully the amplitude of input sinusoidal signals. If the am-plitude of the input signal is too large, the system will saturate, and thefrequency-response test will yield inaccurate results. On the other hand, a smallsignal will cause errors due to dead zone. Hence, a careful choice of the ampli-tude of the input sinusoidal signal must be made. It is necessary to sample thewaveform of the system output to make sure that the waveform is sinusoidaland that the system is operating in the linear region during the test period. (Thewaveform of the system output is not sinusoidal when the system is operating inits nonlinear region.) 4.If the system under consideration is operating continuously for days and weeks, then normal operation need not be stopped for frequency-response tests. The si-nusoidal test signal may be superimposed on the normal inputs.Then, for linear sys-tems, the output due to the test signal is superimposed on the normal output. Forthe determination of the transfer function while the system is in normal opera-tion, stochastic signals (white noise signals) also are often used. By use of corre-lation functions, the transfer function of the system can be determined withoutinterrupting normal operation. EXAMPLE 7–25 Determine the transfer function of the system whose experimental frequency-response curves are as shown in Figure 7–88. The first step in determining the transfer function is to approximate the log-magnitude curve by asymptotes with slopes ;20 dB /H20862decade and multiples thereof, as shown in Figure 7–88. We then estimate the corner frequencies. For the system shown in Figure 7–88, the following form of the transfer function is estimated: The value of the damping ratio zis estimated by examining the peak resonance near v=6 rad /H20862sec. Referring to Figure 7–9, zis determined to be 0.5. The gain Kis numerically equal to the frequency at the intersection of the extension of the low-frequency asymptote that has 20 dB/decade slope and the 0-dB line. The value of Kis thus found to be 10. Therefore, G(jv)is tentatively determined as or G(s) =320(s +2) s(s+1)As2+8s+64BG(jv)=10(1 +0.5jv) jv(1+jv)c1+aj v 8b+aj v 8b2 dG(jv)=K(1 +0.5jv) jv(1+jv)c1+2zaj v 8b+aj v 8b2 d Section 7–9 / Experimental Determination of Transfer Functions 489490 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method This transfer function is tentative because we have not examined the phase-angle curve yet. Once the corner frequencies are noted on the log-magnitude curve, the corresponding phase- angle curve for each component factor of the transfer function can easily be drawn.The sum of these component phase-angle curves is that of the assumed transfer function. The phase-angle curve for G(jv)is denoted by in Figure 7–88. From Figure 7–88, we clearly notice a dis- crepancy between the computed phase-angle curve and the experimentally obtained phase- angle curve. The difference between the two curves at very high frequencies appears to be a constant rate of change. Thus, the discrepancy in the phase-angle curves must be caused by transport lag. Hence, we assume the complete transfer function to be G(s)e –Ts . Since the discrepancy be- tween the computed and experimental phase angles is –0.2vrad for very high frequencies, we can determine the value of Tas follows: or The presence of transport lag can thus be determined, and the complete transfer function deter- mined from the experimental curves is G(s)e -Ts =320(s +2)e -0.2s s(s+1)As 2 +8s+64BT=0.2 sec.lim vSq d dv / G(jv)e -jvT =-T=-0.2 / G 40 20 0 –20 –40 –60dB –80 –100 0.1 0.2 0.4 0.6 1 4 2 6 10 20 40–500°–400°–300°–200°–100°0° v in rad/sec G Magnitude (asymptotic) (K= 10) Magnitude (experimental) Phase angle (experimental) Figure 7–88 Bode diagram of a system. (Solid curves are experimentally obtained curves.) Openmirrors.comSection 7–10 / Control Systems Design by Frequency-Response Approach 4917–10 CONTROL SYSTEMS DESIGN BY FREQUENCY- RESPONSE APPROACH In Chapter 6 we presented root-locus analysis and design. The root-locus method was shown to be very useful to reshape the transient-response characteristics of closed-loop control systems. The root-locus approach gives us direct information on the tran-sient response of the closed-loop system.The frequency-response approach, on the otherhand, gives us this information only indirectly. However, as we shall see in the remain-ing three sections of this chapter, the frequency-response approach is very useful in de-signing control systems. For any design problem, the designer will do well to use both approaches to the design and choose the compensator that most closely produces the desired closed-loop response. In most control systems design, transient-response performance is usually very im- portant. In the frequency-response approach, we specify the transient-response per-formance in an indirect manner.That is, the transient-response performance is specifiedin terms of the phase margin, gain margin, resonant peak magnitude (they give a roughestimate of the system damping); the gain crossover frequency, resonant frequency, band-width (they give a rough estimate of the speed of transient response); and static errorconstants (they give the steady-state accuracy). Although the correlation between thetransient response and frequency response is indirect, the frequency-domain specifica-tions can be easily met in the Bode diagram approach. After the open loop has been designed, the closed-loop poles and zeros can be de- termined. Then, the transient-response characteristics must be checked to see whetherthe designed system satisfies the requirements in the time domain. If it does not, thenthe compensator must be modified and the analysis repeated until a satisfactory resultis obtained. Design in the frequency domain is simple and straightforward. The frequency- response plot indicates clearly the manner in which the system should be modified, al-though the exact quantitative prediction of the transient-response characteristics cannotbe made. The frequency-response approach can be applied to systems or componentswhose dynamic characteristics are given in the form of frequency-response data. Notethat because of difficulty in deriving the equations governing certain components, suchas pneumatic and hydraulic components, the dynamic characteristics of such compo-nents are usually determined experimentally through frequency-response tests.The ex-perimentally obtained frequency-response plots can be combined easily with other suchplots when the Bode diagram approach is used. Note also that in dealing with high-frequency noises we find that the frequency-response approach is more convenient thanother approaches. There are basically two approaches in the frequency-domain design. One is the polar plot approach and the other is the Bode diagram approach. When a compensator isadded, the polar plot does not retain the original shape, and, therefore, we need to drawa new polar plot, which will take time and is thus inconvenient. On the other hand, a Bodediagram of the compensator can be simply added to the original Bode diagram, andthus plotting the complete Bode diagram is a simple matter.Also, if the open-loop gainis varied, the magnitude curve is shifted up or down without changing the slope of thecurve, and the phase curve remains the same. For design purposes, therefore, it is bestto work with the Bode diagram.A common approach to the design based on the Bode diagram is that we first adjust the open-loop gain so that the requirement on the steady-state accuracy is met.Then the magnitude and phase curves of the uncompensated open loop (with the open-loop gain just adjusted) are plotted. If the specifications on the phase margin and gain margin are not satisfied, then a suitable compensator that will reshape the open-loop transfer func- tion is determined. Finally, if there are any other requirements to be met, we try to sat- isfy them, unless some of them are mutually contradictory. Information Obtainable from Open-Loop Frequency Response. The low- frequency region (the region far below the gain crossover frequency) of the locus indi- cates the steady-state behavior of the closed-loop system.The medium-frequency region (the region near the gain crossover frequency) of the locus indicates relative stability. The high-frequency region (the region far above the gain crossover frequency) indi- cates the complexity of the system. Requirements on Open-Loop Frequency Response. We might say that, in many practical cases, compensation is essentially a compromise between steady-state accura- cy and relative stability. To have a high value of the velocity error constant and yet satisfactory relative sta- bility, we find it necessary to reshape the open-loop frequency-response curve. The gain in the low-frequency region should be large enough, and near the gain crossover frequency, the slope of the log-magnitude curve in the Bode diagram should be–20 dB /H20862decade.This slope should extend over a sufficiently wide frequency band to assure a proper phase margin. For the high-frequency region, the gain should be atten- uated as rapidly as possible to minimize the effects of noise. Examples of generally desirable and undesirable open-loop and closed-loop frequency-response curves are shown in Figure 7–89. Referring to Figure 7–90, we see that the reshaping of the open-loop frequency- response curve may be done if the high-frequency portion of the locus follows the G 1 (jv) locus, while the low-frequency portion of the locus follows the G 2 (jv)locus.The reshaped locus G c (jv)G(jv)should have reasonable phase and gain margins or should be tangent to a proper Mcircle, as shown. 492 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method Im Re –10 DesirableUndesirable Im dB Re Logv–1 0 DesirableUndesirable (a) (b) Desirable Undesirable Figure 7–89 (a) Examples of desirable and undesirable open-loop frequency-response curves; (b) examples of desirable and undesirable closed-loop frequency-response curves. Openmirrors.comBasic Characteristics of Lead, Lag, and Lag–Lead Compensation. Lead com- pensation essentially yields an appreciable improvement in transient response and asmall change in steady-state accuracy. It may accentuate high-frequency noise effects. Lagcompensation, on the other hand, yields an appreciable improvement in steady-stateaccuracy at the expense of increasing the transient-response time. Lag compensationwill suppress the effects of high-frequency noise signals. Lag–lead compensation com-bines the characteristics of both lead compensation and lag compensation.The use of alead or lag compensator raises the order of the system by 1 (unless cancellation occursbetween the zero of the compensator and a pole of the uncompensated open-loop trans-fer function).The use of a lag–lead compensator raises the order of the system by 2 [un-less cancellation occurs between zero(s) of the lag–lead compensator and pole(s) of theuncompensated open-loop transfer function], which means that the system becomesmore complex and it is more difficult to control the transient-response behavior.The par-ticular situation determines the type of compensation to be used. 7–11 LEAD COMPENSATION We shall first examine the frequency characteristics of the lead compensator. Then we present a design technique for the lead compensator by use of the Bode diagram. Characteristics of Lead Compensators. Consider a lead compensator having the following transfer function: whereais the attenuation factor of the lead compensator. It has a zero at s=–1/T and a pole at s=–1/( aT).Since 0<a<1, we see that the zero is always located to the right of the pole in the complex plane. Note that for a small value of athe pole is lo- cated far to the left. The minimum value of ais limited by the physical construction ofK c a Ts+1 aTs+1=Kcs+1 T s+1 aT (06a61) Section 7–11 / Lead Compensation 493Im Re –10MCircle G2(jv) G1(jv)Gc(jv)G(jv) Figure 7–90 Reshaping of theopen-loop frequency-response curve.the lead compensator. The minimum value of ais usually taken to be about 0.05. (This means that the maximum phase lead that may be produced by a lead compensator is about 65°.) [See Equation (7–25).] Figure 7–91 shows the polar plot of with K c =1. For a given value of a, the angle between the positive real axis and the tan- gent line drawn from the origin to the semicircle gives the maximum phase-lead angle, f m .We shall call the frequency at the tangent point v m .From Figure 7–91 the phase angle at v=v m isf m ,where (7–25) Equation (7–25) relates the maximum phase-lead angle and the value of a. Figure 7–92 shows the Bode diagram of a lead compensator when K c =1 anda=0.1. The corner frequencies for the lead compensator are v=1/T andv=1/(aT)=10/T. By examining Figure 7–92, we see that v m is the geometric mean of the two corner fre- quencies, or logv m =1 2 a log 1 T+log 1 aT b sinf m =1-a 2 1+a 2=1-a 1+aK c a jvT+1 jvaT+1 (06a61) 494 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method Im Rev m 01v =` v = 0f m 1 2 (1+a)a 1 2 (1–a) Figure 7–91 Polar plot of a lead compensator a(jvT+1)/(j vaT+1) , where 0<a<1. 10 0 v in rad/sec–10 –20 90° 0°dB 0.1 T 1 T 10 T 100 T /H2088110 T f m Figure 7–92 Bode diagram of a lead compensator a(jvT+1)/(j vaT+1), wherea=0.1. Openmirrors.comHence, (7–26) As seen from Figure 7–92, the lead compensator is basically a high-pass filter. (The high frequencies are passed, but low frequencies are attenuated.) Lead Compensation Techniques Based on the Frequency-Response Approach. The primary function of the lead compensator is to reshape the frequency-responsecurve to provide sufficient phase-lead angle to offset the excessive phase lag associatedwith the components of the fixed system. Consider the system shown in Figure 7–93. Assume that the performance specifica- tions are given in terms of phase margin, gain margin, static velocity error constants,and so on. The procedure for designing a lead compensator by the frequency-responseapproach may be stated as follows: 1.Assume the following lead compensator: Define Then The open-loop transfer function of the compensated system is where Determine gain Kto satisfy the requirement on the given static error constant. 2.Using the gain Kthus determined, draw a Bode diagram of G 1(jv),the gain- adjusted but uncompensated system. Evaluate the phase margin. 3.Determine the necessary phase-lead angle to be added to the system. Add an additional 5° to 12° to the phase-lead angle required, because the addition of theG1(s)=KG(s)Gc(s)G(s) =KTs+1 aTs+1G(s) =Ts+1 aTs+1KG(s) =Ts+1 aTs+1G1(s)Gc(s)=KTs+1 aTs+1Kc a=KGc(s)=Kc a Ts+1 aTs+1=Kcs+1 T s+1 aT (06a61)vm=1 1aT Section 7–11 / Lead Compensation 495Gc(s) G(s) +– Figure 7–93 Control system.lead compensator shifts the gain crossover frequency to the right and decreases the phase margin. 4.Determine the attenuation factor aby use of Equation (7–25). Determine the frequency where the magnitude of the uncompensated system G 1 (jv)is equal to Select this frequency as the new gain crossover frequency. This frequency corresponds to and the maximum phase shift f m occurs at this frequency. 5.Determine the corner frequencies of the lead compensator as follows: Zero of lead compensator: Pole of lead compensator: 6.Using the value of Kdetermined in step 1 and that of adetermined in step 4, calculate constant K c from 7.Check the gain margin to be sure it is satisfactory. If not, repeat the design process by modifying the pole–zero location of the compensator until a satisfactory result is obtained. EXAMPLE 7–26 Consider the system shown in Figure 7–94. The open-loop transfer function is It is desired to design a compensator for the system so that the static velocity error constant K v is 20 sec –1 ,the phase margin is at least 50°, and the gain margin is at least 10 dB. We shall use a lead compensator of the form The compensated system will have the open-loop transfer function G c (s)G(s) . Define where K= K c a.G 1 (s)=KG(s) =4K s(s+2)G c (s)=K c a Ts+1 aTs+1=K c s+1 T s+1 aTG(s) =4 s(s+2) K c =K a v=1 aT v=1 Tv m =1/H20862A1a TB,-20logA1/H208621a B. 496 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method 4 s(s+ 2) +– Figure 7–94 Control system. Openmirrors.comThe first step in the design is to adjust the gain Kto meet the steady-state performance spec- ification or to provide the required static velocity error constant. Since this constant is given as20 sec –1, we obtain or With K=10 , the compensated system will satisfy the steady-state requirement. We shall next plot the Bode diagram of Figure 7–95 shows the magnitude and phase-angle curves of G1(jv). From this plot, the phase and gain margins of the system are found to be 17° and ±qdB, respectively. (A phase margin of 17° implies that the system is quite oscillatory.Thus, satisfying the specification on the steady stateyields a poor transient-response performance.) The specification calls for a phase margin of at least 50°. We thus find the additional phase lead necessary to satisfy the relative stability re- quirement is 33°.To achieve a phase margin of 50° without decreasing the value of K, the lead com- pensator must contribute the required phase angle. Noting that the addition of a lead compensator modifies the magnitude curve in the Bode di- agram, we realize that the gain crossover frequency will be shifted to the right.We must offset the increased phase lag of G 1(jv)due to this increase in the gain crossover frequency. Considering the shift of the gain crossover frequency, we may assume that fm,the maximum phase lead re- quired, is approximately 38°. (This means that 5° has been added to compensate for the shift inthe gain crossover frequency.) Since sinf m=1-a 1+aG1(jv)=40 jv(jv+2)=20 jv(0.5jv+1)K=10Kv=lim sS0sGc(s)G(s) =lim sS0sTs+1 aTs+1G1(s)=lim sS0s4K s(s+2)=2K=20 Section 7–11 / Lead Compensation 49712 4 8 v in rad/sec40 20 0 –20 –40 0° –90° –180° 10 20 40 60 10017°dB Figure 7–95 Bode diagram forG 1(jv)=10G(j v) =40/Cjv(jv+2)Df m =38 ° corresponds to a=0.24. Once the attenuation factor ahas been determined on the basis of the required phase-lead angle, the next step is to determine the corner frequencies v=1/T andv=1/(aT)of the lead compensator. To do so, we first note that the maximum phase-lead anglef m occurs at the geometric mean of the two corner frequencies, or [See Equa- tion (7–26).] The amount of the modification in the magnitude curve at due to the inclusion of the term (Ts+1)/( aTs+1) is Note that and@G 1 (jv)@=–6.2 dB corresponds to v=9 rad /H20862sec.We shall select this frequency to be the new gain crossover frequency v c . Noting that this frequency corresponds to or we obtain and The lead compensator thus determined is where the value of K c is determined as Thus, the transfer function of the compensator becomes Note that The magnitude curve and phase-angle curve for G c (jv)/10 are shown in Figure 7–96. The compensated system has the following open-loop transfer function: G c (s)G(s) =41.7s+4.41 s+18.44 s(s+2)G c (s) KG 1 (s)=G c (s) 1010G(s) =G c (s)G(s)G c (s)=41.7s+4.41 s+18.4=100.227s +1 0.054s +1K c =K a=10 0.24=41.7G c (s)=K c s+4.41 s+18.4=K c a0.227s +1 0.054s +11 aT=v c 1a =18.41 T=1a v c =4.41v c =1/H20862A1a TB,1/H20862A1a TB,1 1a =1 10.24 =1 0.49=6.2 dB 2 1+jvT 1+jvaT 2 v=1/H20862A1a TB = 4 1+j 1 1a 1+ja 1 1a 4 =1 1a v=1/H20862A1a TBv=1/H20862A1a TB. 498 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method Openmirrors.comThe solid curves in Figure 7–96 show the magnitude curve and phase-angle curve for the compen- sated system. Note that the bandwidth is approximately equal to the gain crossover frequency. The lead compensator causes the gain crossover frequency to increase from 6.3 to 9 rad /H20862sec. The in- crease in this frequency means an increase in bandwidth.This implies an increase in the speed ofresponse.The phase and gain margins are seen to be approximately 50° and ±qdB, respectively. The compensated system shown in Figure 7–97 therefore meets both the steady-state and the relative-stability requirements. Note that for type 1 systems, such as the system just considered, the value of the static veloc- ity error constant K vis merely the value of the frequency corresponding to the intersection of the extension of the initial –20-dB /H20862decade slope line and the 0-dB line, as shown in Figure 7–96. Note also that we have changed the slope of the magnitude curve near the gain crossover frequencyfrom –40 dB /H20862decade to –20 dB /H20862decade. Section 7–11 / Lead Compensation 49940 20 0 –20 –40 0° –90° –180°Gc 10 Kv 50° 124 6 v in rad/sec10 20 40 60 100Gc 10GcG GcG–6 dB G1= 10G G1= 10GdB Figure 7–96 Bode diagram for thecompensated system. 4 s(s+ 2)41.7( s+ 4.41) s+ 18.4+– Figure 7–97 Compensatedsystem.Figure 7–98 shows the polar plots of the gain-adjusted but uncompensated open-loop trans- fer function G 1 (jv)=10 G(j v)and the compensated open-loop transfer function G c (jv)G(jv). From Figure 7–98, we see that the resonant frequency of the uncompensated system is about 6 rad /H20862sec and that of the compensated system is about 7 rad /H20862sec. (This also indicates that the bandwidth has been increased.) From Figure 7–98, we find that the value of the resonant peak M r for the uncompensated sys- tem with K=10 is 3.The value of M r for the compensated system is found to be 1.29.This clear- ly shows that the compensated system has improved relative stability. Note that, if the phase angle of G 1 (jv)decreases rapidly near the gain crossover frequency, lead compensation becomes ineffective because the shift in the gain crossover frequency to the right makes it difficult to provide enough phase lead at the new gain crossover frequency. This means that, to provide the desired phase margin, we must use a very small value for a. The value ofa, however, should not be too small (smaller than 0.05) nor should the maximum phase lead f m be too large (larger than 65°), because such values will require an additional gain of excessive value. [If more than 65° is needed, two (or more) lead networks may be used in series with an iso- lating amplifier.] Finally, we shall examine the transient-response characteristics of the designed system. We shall obtain the unit-step response and unit-ramp response curves of the compensated and uncompensated systems with MATLAB. Note that the closed-loop transfer functions of the uncompensated and compensated systems are given, respectively, by and C(s) R(s)=166.8s +735.588 s 3 +20.4s 2 +203.6s +735.588C(s) R(s)=4 s 2 +2s+4 500 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method M r = 1.29 –4–3–2–1–1 –2 –3 – 401 M r = 3Im Re 1 44 66 1010 v =3v =3G 1 (jv) G c (jv)G(jv) Figure 7–98 Polar plots of the gain-adjusted but uncompensated open-loop transfer function G 1 and compensated open- loop transfer function G c G. Openmirrors.comMATLAB programs for obtaining the unit-step response and unit-ramp response curves are given in MATLAB Program 7–13. Figure 7–99 shows the unit-step response curves of the system before and after compensation. Also, Figure 7–100 depicts the unit-ramp response curves before andafter compensation. These response curves indicate that the designed system is satisfactory. Section 7–11 / Lead Compensation 501MATLAB Program 7–13 %*****Unit-step responses***** num = [4]; den = [1 2 4];numc = [166.8 735.588];denc = [1 20.4 203.6 735.588];t = 0:0.02:6;[c1,x1,t] = step(num,den,t);[c2,x2,t] = step(numc,denc,t);plot (t,c1,'.',t,c2,'-')gridtitle('Unit-Step Responses of Compensated and Uncompensated Systems')xlabel('t Sec')ylabel('Outputs')text(0.4,1.31,'Compensated system')text(1.55,0.88,'Uncompensated system') %*****Unit-ramp responses*****num1 = [4]; den1 = [1 2 4 0];num1c = [166.8 735.588];den1c = [1 20.4 203.6 735.588 0];t = 0:0.02:5;[y1,z1,t] = step(num1,den1,t);[y2,z2,t] = step(num1c,den1c,t);plot(t,y1,'.',t,y2,'-',t,t,'--')gridtitle('Unit-Ramp Responses of Compensated and Uncompensated Systems')xlabel('t Sec')ylabel('Outputs')text(0.89,3.7,'Compensated system')text(2.25,1.1,'Uncompensated system') It is noted that the closed-loop poles for the compensated system are located as follows: Because the dominant closed-loop poles are located far from the jvaxis, the response damps out quickly.s=-6.4918s=-6.9541 ;j8.0592502 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method 7–12 LAG COMPENSATION In this section we first discuss the Nyquist plot and Bode diagram of the lag compensator. Then we present lag compensation techniques based on the frequency-response approach. Characteristics of Lag Compensators. Consider a lag compensator having the following transfer function: G c (s)=K c b Ts+1 bTs+1=K c s+1 T s+1 bT (b71) Outputs 5 2 0 3.5 4.5 1.5 0.5 3 4 2.5 1 t Sec01 0.5 5 3.5 4.5 3 4 2 1.5 2.5 Unit-Ramp Responses of Compensated and Uncompensated Systems Compensated system Uncompensated system Figure 7–100 Unit-ramp response curves of the compensated and uncompensated systems. Outputs 1.4 0.6 0 1 1.2 0.4 0.2 0.8 t Sec01 6 4 5 2 3 Unit-Step Responses of Compensated and Uncompensated Systems Compensated system Uncompensated system Figure 7–99 Unit-step response curves of the compensated and uncompensated systems. Openmirrors.comSection 7–12 / Lag Compensation 503In the complex plane, a lag compensator has a zero at s=–1/T and a pole at s=–1/( bT).The pole is located to the right of the zero. Figure 7–101 shows a polar plot of the lag compensator. Figure 7–102 shows a Bode diagram of the compensator, where Kc=1 andb=10. The corner frequencies of the lag compensator are at v=1/T andv=1/(bT).As seen from Figure 7–102, where the values of Kcandbare set equal to 1 and 10, respectively, the magnitude of the lag compensator becomes 10 (or 20 dB) at low frequencies and unity (or 0 dB) at high fre-quencies. Thus, the lag compensator is essentially a low-pass filter. Lag Compensation Techniques Based on the Frequency-Response Approach. The primary function of a lag compensator is to provide attenuation in the high-frequency range to give a system sufficient phase margin. The phase-lag characteristicis of no consequence in lag compensation. The procedure for designing lag compensators for the system shown in Figure 7–93 by the frequency-response approach may be stated as follows: 1.Assume the following lag compensator: G c(s)=Kc b Ts+1 bTs+1=Kcs+1 T s+1 bT (b71)Im 0R ev = 0 v =`Kc Kcb Figure 7–101 Polar plot of a lagcompensatorK cb(jvT+1)/H20862(jvbT+1). 30 20 v in rad/sec10 0 0° –90°dB 0.01 T0.1 T1 T10 TFigure 7–102 Bode diagram of a lag compensator b(jvT+1)/(j vbT+1), withb=10.Define Then The open-loop transfer function of the compensated system is where Determine gain Kto satisfy the requirement on the given static velocity error constant. 2.If the gain-adjusted but uncompensated system G 1 (jv)=KG(j v)does not sat- isfy the specifications on the phase and gain margins, then find the frequency point where the phase angle of the open-loop transfer function is equal to –180 ° plus the required phase margin. The required phase margin is the specified phase margin plus 5° to 12°. (The addition of 5° to 12° compensates for the phase lag of the lag compensator.) Choose this frequency as the new gain crossover frequency. 3.To prevent detrimental effects of phase lag due to the lag compensator, the pole and zero of the lag compensator must be located substantially lower than the new gain crossover frequency. Therefore, choose the corner frequency v=1/T (cor- responding to the zero of the lag compensator) 1 octave to 1 decade below the new gain crossover frequency. (If the time constants of the lag compensator do not become too large, the corner frequency v=1/T may be chosen 1 decade below the new gain crossover frequency.) Notice that we choose the compensator pole and zero sufficiently small. Thus the phase lag occurs at the low-frequency region so that it will not affect the phase margin. 4.Determine the attenuation necessary to bring the magnitude curve down to 0 dB at the new gain crossover frequency. Noting that this attenuation is de- termine the value of b. Then the other corner frequency (corresponding to the pole of the lag compensator) is determined from v=1/(bT). 5.Using the value of Kdetermined in step 1 and that of bdetermined in step 4, cal- culate constant K c from K c =K b-20logb,G 1 (s)=KG(s)G c (s)G(s) =KTs+1 bTs+1G(s) =Ts+1 bTs+1KG(s) =Ts+1 bTs+1G 1 (s)G c (s)=KTs+1 bTs+1K c b=K 504 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method Openmirrors.comSection 7–12 / Lag Compensation 505EXAMPLE 7–27 Consider the system shown in Figure 7–103. The open-loop transfer function is given by It is desired to compensate the system so that the static velocity error constant Kvis 5 sec–1, the phase margin is at least 40°, and the gain margin is at least 10 dB. We shall use a lag compensator of the form Define Define also The first step in the design is to adjust the gain Kto meet the required static velocity error con- stant. Thus, or With K=5, the compensated system satisfies the steady-state performance requirement. We shall next plot the Bode diagram of G1(jv)=5 jv(jv+1)(0.5jv+1)K=5 =lim sS0 sK s(s+1)(0.5s +1)=K=5 Kv=lim sS0sGc(s)G(s) =lim sS0s Ts+1 bTs+1 G1(s)=lim sS0sG1(s)G1(s)=KG(s) =K s(s+1)(0.5s +1)Kc b=KGc(s)=Kc b Ts+1 bTs+1=Kcs+1 T s+1 bT (b71)G(s) =1 s(s+1)(0.5s +1) 1 s(s+1) (0.5 s+ 1)+– Figure 7–103 Control system.The magnitude curve and phase-angle curve of G 1 (jv)are shown in Figure 7–104. From this plot, the phase margin is found to be –20°, which means that the gain-adjusted but uncompensated system is unstable. Noting that the addition of a lag compensator modifies the phase curve of the Bode diagram, we must allow 5° to 12° to the specified phase margin to compensate for the modification of the phase curve. Since the frequency corresponding to a phase margin of 40° is 0.7 rad /H20862sec, the new gain crossover frequency (of the compensated system) must be chosen near this value. To avoid overly large time constants for the lag compensator, we shall choose the corner frequency v=1/T (which corresponds to the zero of the lag compensator) to be 0.1 rad /H20862sec. Since this corner frequency is not too far below the new gain crossover frequency, the modification in the phase curve may not be small. Hence, we add about 12° to the given phase margin as an allowance to account for the lag angle introduced by the lag compensator.The required phase margin is now 52°.The phase angle of the uncompensated open-loop transfer function is –128 ° at about v=0.5 rad /H20862sec. So we choose the new gain crossover frequency to be 0.5 rad /H20862sec.To bring the magnitude curve down to 0 dB at this new gain crossover frequency, the lag compensator must give the necessary attenuation, which in this case is –20dB. Hence, or The other corner frequency v=1(bT), which corresponds to the pole of the lag compen- sator, is then determined as 1 bT=0.01 rad /H20862secb=1020log 1 b=-20 11 dB0 dB 0° –90° –180° –270° v in rad/sec0.02 0.004G 1 G 1 G c G G c K G c 40 20 –20 –40 40° 0.01 0.04 0.1 0.6 0.2 0.4 1 2 4G c G Figure 7–104 Bode diagrams for G 1 (gain-adjusted but uncompensated open-loop transfer function), G c (compensator), and G c G(compensated open-loop transfer function). 506 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method Openmirrors.comSection 7–12 / Lag Compensation 507Thus, the transfer function of the lag compensator is Since the gain Kwas determined to be 5 and bwas determined to be 10, we have The open-loop transfer function of the compensated system is The magnitude and phase-angle curves of Gc(jv)G(jv)are also shown in Figure 7–104. The phase margin of the compensated system is about 40°, which is the required value. The gain margin is about 11 dB, which is quite acceptable.The static velocity error constant is 5 sec–1, as required. The compensated system, therefore, satisfies the requirements on both the steady state and the relative stability. Note that the new gain crossover frequency is decreased from approximately 1 to 0.5 rad /H20862sec. This means that the bandwidth of the system is reduced. To further show the effects of lag compensation, the log-magnitude-versus-phase plots of the gain- adjusted but uncompensated system G1(jv)and of the compensated system Gc(jv)G(jv)are shown in Figure 7–105.The plot of G1(jv)clearly shows that the gain-adjusted but uncompensated system is unstable. The addition of the lag compensator stabilizes the system. The plot of Gc(jv)G(jv)is tan- gent to the M=3 dB locus. Thus, the resonant peak value is 3 dB, or 1.4, and this peak occurs at v=0.5 rad /H20862sec. Compensators designed by different methods or by different designers (even using the same ap- proach) may look sufficiently different. Any of the well-designed systems, however, will give similartransient and steady-state performance. The best among many alternatives may be chosen from the economic consideration that the time constants of the lag compensator should not be too large.G c(s)G(s) =5(10s +1) s(100s +1)(s +1)(0.5s +1)Kc=K b=5 10=0.5Gc(s)=Kc(10)10s +1 100s +1=Kcs+1 10 s+1 100 8 4 0 –4 –90/H1103424 1620 12 –8 –12 –16 –20 –240/H11034–210/H11034–180/H11034–150/H11034–120/H11034 G1G1in dB0.60.4 0.8 10.1 0.2 2 0.60.4 0.8 G1 GcG3 dB 1 24Figure 7–105 Log-magnitude-versus-phase plots ofG 1(gain-adjusted but uncompensatedopen-loop transferfunction) and G cG (compensated open-loop transferfunction).508 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method Finally, we shall examine the unit-step response and unit-ramp response of the compensated system and the original uncompensated system without gain adjustment. The closed-loop trans- fer functions of the compensated and uncompensated systems are and respectively. MATLAB Program 7–14 will produce the unit-step and unit-ramp responses of the compensated and uncompensated systems.The resulting unit-step response curves and unit-ramp response curves are shown in Figures 7–106 and 7–107, respectively. From the response curves we find that the designed system satisfies the given specifications and is satisfactory.C(s) R(s)=1 0.5s 3 +1.5s 2 +s+1C(s) R(s)=50s +5 50s 4 +150.5s 3 +101.5s 2 +51s +5 MATLAB Program 7–14 %*****Unit-step response***** num = [1]; den = [0.5 1.5 1 1]; numc = [50 5]; denc = [50 150.5 101.5 51 5]; t = 0:0.1:40; [c1,x1,t] = step(num,den,t); [c2,x2,t] = step(numc,denc,t); plot(t,c1,'.',t,c2,'-') grid title('Unit-Step Responses of Compensated and Uncompensated Systems') xlabel('t Sec') ylabel('Outputs') text(12.7,1.27,'Compensated system') text(12.2,0.7,'Uncompensated system') %*****Unit-ramp response***** num1 = [1]; den1 = [0.5 1.5 1 1 0]; num1c = [50 5]; den1c = [50 150.5 101.5 51 5 0]; t = 0:0.1:20; [y1,z1,t] = step(num1,den1,t); [y2,z2,t] = step(num1c,den1c,t); plot(t,y1,'.',t,y2,'-',t,t,'--'); grid title('Unit-Ramp Responses of Compensated and Uncompensated Systems') xlabel('t Sec') ylabel('Outputs') text(8.3,3,'Compensated system') text(8.3,5,'Uncompensated system') Openmirrors.comSection 7–12 / Lag Compensation 509Note that the zero and poles of the designed closed-loop system are as follows: The dominant closed-loop poles are very close to the jvaxis with the result that the response is slow. Also, a pair of the closed-loop pole at s=–0.1228 and the zero at s=–0.1 produces a slowly decreasing tail of small amplitude. Poles at s=-0.2859 ;j0.5196, s=-0.1228, s=-2.3155 Zero at s=-0.1Outputs1.4 0.6 011.2 0.4 0.20.8 t Sec01 0 5 40 30 35 25 15 20Unit-Step Responses of Compensated and Uncompensated Systems Compensated system Uncompensated system Figure 7–106 Unit-step responsecurves for the compensated and uncompensatedsystems (Example7–27). Outputs20 8 01218 4 216 1014 6 t Sec04 2 20 14 18 12 16 8 6 10Unit-Ramp Responses of Compensated and Uncompensated Systems Compensated systemUncompensated systemFigure 7–107 Unit-ramp responsecurves for the compensated and uncompensatedsystems (Example7–27).A Few Comments on Lag Compensation. 1.Lag compensators are essentially low-pass filters. Therefore, lag compensation permits a high gain at low frequencies (which improves the steady-state per- formance) and reduces gain in the higher critical range of frequencies so as to im- prove the phase margin. Note that in lag compensation we utilize the attenuation characteristic of the lag compensator at high frequencies rather than the phase- lag characteristic. (The phase-lag characteristic is of no use for compensation purposes.) 2.Suppose that the zero and pole of a lag compensator are located at s=–z and s=–p, respectively.Then the exact locations of the zero and pole are not critical provided that they are close to the origin and the ratio z/pis equal to the required multiplication factor of the static velocity error constant. It should be noted, however, that the zero and pole of the lag compensator should not be located unnecessarily close to the origin, because the lag compen- sator will create an additional closed-loop pole in the same region as the zero and pole of the lag compensator. The closed-loop pole located near the origin gives a very slowly decaying tran- sient response, although its magnitude will become very small because the zero of the lag compensator will almost cancel the effect of this pole. However, the tran- sient response (decay) due to this pole is so slow that the settling time will be ad- versely affected. It is also noted that in the system compensated by a lag compensator the trans- fer function between the plant disturbance and the system error may not involve a zero that is near this pole. Therefore, the transient response to the disturbance input may last very long. 3.The attenuation due to the lag compensator will shift the gain crossover frequency to a lower frequency point where the phase margin is accept- able. Thus, the lag compensator will reduce the bandwidth of the system and will result in slower transient response. [The phase angle curve of G c (jv)G(jv)is relatively unchanged near and above the new gain crossover frequency.] 4.Since the lag compensator tends to integrate the input signal, it acts approximately as a proportional-plus-integral controller. Because of this, a lag-compensated sys- tem tends to become less stable. To avoid this undesirable feature, the time con- stant Tshould be made sufficiently larger than the largest time constant of the system. 5.Conditional stability may occur when a system having saturation or limiting is compensated by use of a lag compensator.When the saturation or limiting takes place in the system, it reduces the effective loop gain. Then the system becomes less stable and unstable operation may even result, as shown in Figure 7–108. To avoid this, the system must be designed so that the effect of lag compensa- tion becomes significant only when the amplitude of the input to the saturat- ing element is small. (This can be done by means of minor feedback-loop compensation.) 510 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method Openmirrors.comSection 7–13 / Lag–Lead Compensation 5117–13 LAG–LEAD COMPENSATION We shall first examine the frequency-response characteristics of the lag–lead compen- sator. Then we present the lag–lead compensation technique based on the frequency-response approach. Characteristic of Lag–Lead Compensator. Consider the lag–lead compensator given by (7–27) whereg>1 andb>1. The term produces the effect of the lead network, and the termproduces the effect of the lag network.s+1 T2 s+1 bT2=baT2 s+1 bT2 s+1b (b71)s+1 T1 s+g T1=1 g°T1 s+1 T1 gs+1¢ (g71)Gc(s)=Kc±s+1 T1 s+g T1≤±s+1 T2 s+1 bT2≤dB40 30 20 10 0 –10 –20 –90° –180° –270° 0.7 1 2 4 6 8 10 20Large gain Small gain v in rad/secf /H11022 0f /H11021 0 Figure 7–108 Bode diagram of aconditionally stablesystem.In designing a lag–lead compensator, we frequently chose g=b. (This is not necessary. We can, of course, choose gZb.) In what follows, we shall consider the case where g=b.The polar plot of the lag–lead compensator with K c =1 andg=b becomes as shown in Figure 7–109. It can be seen that, for 0<v<v 1 ,the compensator acts as a lag compensator, while for v 1 <v<qit acts as a lead compensator. The frequency v 1 is the frequency at which the phase angle is zero. It is given by (To derive this equation, see Problem A–7–21 .) Figure 7–110 shows the Bode diagram of a lag–lead compensator when K c =1, g=b=10, and Notice that the magnitude curve has the value 0 dB at the low- and high-frequency regions.T 2 =10T 1 .v 1 =1 1T 1 T 2 512 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method Im Re 01v =v 1 v = 0v =` Figure 7–109 Polar plot of a lag–lead compensator given by Equation (7–27), with K c =1 and g=b. 10 0 –10 –20 –30 90° 0° –90° v in rad/secdB 0.01 T 1 1 T 1 10 T 1 0.1 T 1 0.001 T 1 100 T 1 Figure 7–110 Bode diagram of a lag–lead compensator given by Equation (7–27) with K c =1, g=b=10, and T 2 =10T 1 . Openmirrors.comSection 7–13 / Lag–Lead Compensation 513Lag–Lead Compensation Based on the Frequency-Response Approach. The design of a lag–lead compensator by the frequency-response approach is based on thecombination of the design techniques discussed under lead compensation and lagcompensation. Let us assume that the lag–lead compensator is of the following form: (7–28) whereb>1. The phase-lead portion of the lag–lead compensator (the portion involv- ing ) alters the frequency-response curve by adding phase-lead angle and increasingthe phase margin at the gain crossover frequency.The phase-lag portion (the portion in-volving ) provides attenuation near and above the gain crossover frequency and there-by allows an increase of gain at the low-frequency range to improve the steady-stateperformance. We shall illustrate the details of the procedures for designing a lag–lead compen- sator by an example. EXAMPLE 7–28 Consider the unity-feedback system whose open-loop transfer function is It is desired that the static velocity error constant be 10 sec–1,the phase margin be 50°, and the gain margin be 10 dB or more. Assume that we use the lag–lead compensator given by Equation (7–28). [Note that the phase- lead portion increases both the phase margin and the system bandwidth (which implies increas-ing the speed of response). The phase-lag portion maintains the low-frequency gain.] The open-loop transfer function of the compensated system is G c(s)G(s). Since the gain Kof the plant is adjustable, let us assume that Kc=1. Then, From the requirement on the static velocity error constant, we obtain Hence, We shall next draw the Bode diagram of the uncompensated system with K=20, as shown in Figure 7–111. The phase margin of the gain-adjusted but uncompensated system is found to be –32°, which indicates that the gain-adjusted but uncompensated system is unstable. The next step in the design of a lag–lead compensator is to choose a new gain crossover fre- quency. From the phase-angle curve for G(jv),we notice that at v=1.5 rad /H20862sec. It is convenient to choose the new gain crossover frequency to be 1.5 rad /H20862sec so that the phase- lead angle required at v=1.5 rad /H20862sec is about 50°, which is quite possible by use of a single lag–lead network. Once we choose the gain crossover frequency to be 1.5 rad /H20862sec, we can determine the corner frequency of the phase-lag portion of the lag–lead compensator. Let us choose the corner fre-quency (which corresponds to the zero of the phase-lag portion of the compensator) tobe 1 decade below the new gain crossover frequency, or at v=0.15 rad /H20862sec.v=1/H20862T 2/G(jv)=-180°K=20Kv=lim sS0sGc(s)G(s) =lim sS0sGc(s)K s(s+1)(s +2)=K 2=10lim sS0Gc(s)=1.G(s) =K s(s+1)(s +2)T2T1Gc(s)=Kc(T1 s+1)(T2 s+1) aT1 bs+1b(bT2 s+1)=Kcas+1 T1bas+1 T2b as+b T1bas+1 bT2bRecall that for the lead compensator the maximum phase-lead angle f m is given by Equation (7–25), where ais1/bin the present case. By substituting a=1/bin Equation (7–25), we have Notice that b=10 corresponds to f m =54.9 °. Since we need a 50° phase margin, we may choose b=10 . (Note that we will be using several degrees less than the maximum angle, 54.9°.) Thus, b=10 Then the corner frequency (which corresponds to the pole of the phase-lag portion of the compensator) becomes v=0.015 rad /H20862sec. The transfer function of the phase-lag portion of the lag–lead compensator then becomes The phase-lead portion can be determined as follows: Since the new gain crossover frequen- cy is v=1.5 rad /H20862sec, from Figure 7–111, G(j1.5) is found to be 13 dB. Hence, if the lag–lead com- pensator contributes –13 dB at v=1.5 rad /H20862sec, then the new gain crossover frequency is as desired. From this requirement, it is possible to draw a straight line of slope 20 dB /H20862decade, pass- ing through the point (1.5 rad /H20862sec,–13 dB). The intersections of this line and the 0-dB line and –20-dB line determine the corner frequencies. Thus, the corner frequencies for the lead portions+0.15 s+0.015=10 a 6.67s +1 66.7s +1 b v=1/H20862bT 2 sinf m =1-1 b 1+1 b=b-1 b+1 514 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method v in rad/secdB60 40 20 0 –40–20 90° 0 –90° –180° –270° 0.02 0.01 0.04 0.1 0.2 0.4 0.6GG c GG G c G G c G c 16 dB 124 6 1 0–32°50° Figure 7–111 Bode diagrams for G (gain-adjusted but uncompensated open-loop transfer function), G c (compensator), and G c G(compensated open-loop transfer function). Openmirrors.comSection 7–13 / Lag–Lead Compensation 515arev=0.7 rad /H20862sec and v=7 rad /H20862sec. Thus, the transfer function of the lead portion of the lag–lead compensator becomes Combining the transfer functions of the lag and lead portions of the compensator, we obtain the transfer function of the lag–lead compensator. Since we chose Kc=1, we have The magnitude and phase-angle curves of the lag–lead compensator just designed are shown in Figure 7–111. The open-loop transfer function of the compensated system is (7–29) The magnitude and phase-angle curves of the system of Equation (7–29) are also shown in Fig- ure 7–111. The phase margin of the compensated system is 50°, the gain margin is 16 dB, and thestatic velocity error constant is 10 sec –1. All the requirements are therefore met, and the design has been completed. Figure 7–112 shows the polar plots of G(jv)(gain-adjusted but uncompensated open-loop transfer function) and Gc(jv)G(jv)(compensated open-loop transfer function).The Gc(jv)G(jv) locus is tangent to the M=1.2 circle at about v=2 rad /H20862sec. Clearly, this indicates that the com- pensated system has satisfactory relative stability. The bandwidth of the compensated system is slightly larger than 2 rad /H20862sec. =10(1.43s +1)(6.67s +1) s(0.143s +1)(66.7s +1)(s +1)(0.5s +1) Gc(s)G(s) =(s+0.7)(s +0.15)20 (s+7)(s +0.015)s(s +1)(s +2)Gc(s)=as+0.7 s+7bas+0.15 s+0.015b=a1.43s +1 0.143s +1ba6.67s +1 66.7s +1bs+0.7 s+7=1 10a1.43s +1 0.143s +1b M= 1.2 v = 0.15v = 1Im Re G GcG 0.20.4 –8–7–6–5–4–3–2–1021 12 –22 –1 –4 –3 –5 –8 –712 –6 Figure 7–112 Polar plots of G(gain adjusted) and GcG.In the following we shall examine the transient-response characteristics of the compensated system. (The gain-adjusted but uncompensated system is unstable.) The closed-loop transfer func- tion of the compensated system is The unit-step and unit-ramp response curves obtained with MATLAB are shown in Figures 7–113 and 7–114, respectively.C(s) R(s)=95.381s 2 +81s +10 4.7691s 5 +47.7287s 4 +110.3026s 3 +163.724s 2 +82s +10 516 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method Output 1.6 0.6 0 1 1.4 0.4 0.2 1.2 0.8 t Sec04 2 20 14 18 12 16 8 6 10 Unit-Step Response of Compensated System Figure 7–113 Unit-step response of the compensated system (Example 7–28). Output 20 8 0 12 18 4 2 16 10 14 6 t Sec04 2 20 14 18 12 16 8 6 10 Unit-Ramp Response of Compensated System Figure 7–114 Unit-ramp response of the compensated system (Example 7–28). Openmirrors.comSection 7–13 / Lag–Lead Compensation 517Note that the designed closed-loop control system has the following closed-loop zeros and poles: The pole at s=–0.1785 and zero at s=–0.1499 are located very close to each other. Such a pair of pole and zero produces a long tail of small amplitude in the step response, as seen in Figure 7–113.Also, the pole at s=–0.5425 and zero at s=–0.6993 are located fairly close to each other.This pair adds amplitude to the long tail. Summary of Control Systems Design by Frequency-Response Approach. The last three sections presented detailed procedures for designing lead, lag, andlag–lead compensators by the use of simple examples. We have shown that the designof a compensator to satisfy the given specifications (in terms of the phase margin andgain margin) can be carried out in the Bode diagram in a simple and straightforwardmanner. It is noted that not every system can be compensated with a lead, lag, orlag–lead compensator. In some cases compensators with complex poles and zeros maybe used. For systems that cannot be designed by use of the root-locus or frequency-response methods, the pole-placement method may be used. (See Chapter 10.) In agiven design problem if both conventional design methods and the pole-placementmethod can be used, conventional methods (root-locus or frequency-response methods)usually result in a lower-order stable compensator. Note that a satisfactory design of acompensator for a complex system may require a creative application of all availabledesign methods. Comparison of Lead, Lag, and Lag–Lead Compensation 1.Lead compensation is commonly used for improving stability margins. Lag com- pensation is used to improve the steady-state performance. Lead compensationachieves the desired result through the merits of its phase-lead contribution, where-as lag compensation accomplishes the result through the merits of its attenuationproperty at high frequencies. 2.In some design problems both lead compensation and lag compensation may sat- isfy the specifications. Lead compensation yields a higher gain crossover frequen-cy than is possible with lag compensation. The higher gain crossover frequencymeans a larger bandwidth.A large bandwidth means reduction in the settling time.The bandwidth of a system with lead compensation is always greater than thatwith lag compensation.Therefore, if a large bandwidth or fast response is desired,lead compensation should be employed. If, however, noise signals are present, thena large bandwidth may not be desirable, since it makes the system more suscepti-ble to noise signals because of an increase in the high-frequency gain. Hence, lagcompensation should be used for such a case. 3.Lead compensation requires an additional increase in gain to offset the attenua- tion inherent in the lead network.This means that lead compensation will requirea larger gain than that required by lag compensation.A larger gain, in most cases,implies larger space, greater weight, and higher cost. s=-0.1785, s=-0.5425, s=-7.4923 Poles at s=-0.8973 ;j1.4439 Zeros at s=-0.1499, s=-0.69934.Lead compensation may generate large signals in the system. Such large signals are not desirable because they will cause saturation in the system. 5.Lag compensation reduces the system gain at higher frequencies without reduc- ing the system gain at lower frequencies. Since the system bandwidth is reduced, the system has a slower speed to respond. Because of the reduced high-frequen- cy gain, the total system gain can be increased, and thereby low-frequency gain can be increased and the steady-state accuracy can be improved. Also, any high- frequency noises involved in the system can be attenuated. 6.Lag compensation will introduce a pole-zero combination near the origin that will generate a long tail with small amplitude in the transient response. 7.If both fast responses and good static accuracy are desired, a lag–lead compensator may be employed. By use of the lag–lead compensator, the low-frequency gain can be increased (which means an improvement in steady-state accuracy), while at the same time the system bandwidth and stability margins can be increased. 8.Although a large number of practical compensation tasks can be accomplished with lead, lag, or lag–lead compensators, for complicated systems, simple compensation by use of these compensators may not yield satisfactory results. Then, different compensators having different pole–zero configurations must be employed. Graphical Comparison. Figure 7–115(a) shows a unit-step response curve and unit-ramp response curve of an uncompensated system. Typical unit-step response and unit-ramp response curves for the compensated system using a lead, lag, and lag–lead compensator, respectively, are shown in Figures 7–115(b), (c), and (d). The system with a lead compensator exhibits the fastest response, while that with a lag compensator ex- hibits the slowest response, but with marked improvements in the unit-ramp response. The system with a lag–lead compensator will give a compromise; reasonable improve- 518 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method c(t) 1 0 t c(t) 1 0 t c(t) 1 0 t c(t) 1 0 t c(t) 0 t c(t) 0 t c(t) 0 t c(t) 0 t e ss e ss e ss e ss (a) (b) (c) (d) Figure 7–115 Unit-step response curves and unit-ramp response curves. (a) Uncompensated system; (b) lead compensated system; (c) lag compensated system; (d) lag–lead compensated system. Openmirrors.comSection 7–13 / Lag–Lead Compensation 519ments in both the transient response and steady-state response can be expected. The response curves shown depict the nature of improvements that may be expected fromusing different types of compensators. Feedback Compensation. A tachometer is one of the rate feedback devices. Another common rate feedback device is the rate gyro. Rate gyros are commonly usedin aircraft autopilot systems. Velocity feedback using a tachometer is very commonly used in positional servo systems. It is noted that, if the system is subjected to noise signals, velocity feedbackmay generate some difficulty if a particular velocity feedback scheme performsdifferentiation of the output signal. (The result is the accentuation of the noise effects.) Cancellation of Undesirable Poles. Since the transfer function of elements in cascade is the product of their individual transfer functions, it is possible to cancel someundesirable poles or zeros by placing a compensating element in cascade, with its polesand zeros being adjusted to cancel the undesirable poles or zeros of the original system.For example, a large time constant may be canceled by use of the lead network as follows: If is much smaller than we can effectively eliminate the large time constant Figure 7–116 shows the effect of canceling a large time constant in step transientresponse. If an undesirable pole in the original system lies in the right-half splane, this com- pensation scheme should not be used since, although mathematically it is possible tocancel the undesirable pole with an added zero, exact cancellation is physically impos-sible because of inaccuracies involved in the location of the poles and zeros. A pole inthe right-half splane not exactly canceled by the compensator zero will eventually lead to unstable operation, because the response will involve an exponential term that in-creases with time. It is noted that if a left-half plane pole is almost canceled but not exactly can- celed, as is almost always the case, the uncanceled pole-zero combination will causethe response to have a small amplitude but long-lasting transient-response compo-nent. If the cancellation is not exact but is reasonably good, then this component willbe small. It should be noted that the ideal control system is not the one that has a transfer function of unity. Physically, such a control system cannot be built since it cannotT 1 . T1 , T2a1 T1 s+1baT1 s+1 T2 s+1b=1 T2 s+1AT1 s+1B/H20862AT2 s+1BT1 x xy zyz tt t1 T1s+ 1T1s+ 1 T2s+ 1Figure 7–116 Step-response curvesshowing the effect of canceling a large time constant.instantaneously transfer energy from the input to the output. In addition, since noise is almost always present in one form or another, a system with a unity transfer function is not desirable. A desired control system, in many practical cases, may have one set of dominant complex-conjugate closed-loop poles with a reasonable damping ratio and undamped natural frequency.The determination of the significant part of the closed-loop pole-zero configuration, such as the location of the domi- nant closed-loop poles, is based on the specifications that give the required system performance. Cancellation of Undesirable Complex-Conjugate Poles. If the transfer func- tion of a plant contains one or more pairs of complex-conjugate poles, then a lead, lag, or lag–lead compensator may not give satisfactory results. In such a case, a network that has two zeros and two poles may prove to be useful. If the zeros are chosen so as to cancel the undesirable complex-conjugate poles of the plant, then we can essentially replace the undesirable poles by acceptable poles. That is, if the undesirable complex- conjugate poles are in the left-half splane and are in the form then the insertion of a compensating network having the transfer function will result in an effective change of the undesirable complex-conjugate poles to ac- ceptable poles. Note that even though the cancellation may not be exact, the com- pensated system will exhibit better response characteristics. (As stated earlier, this approach cannot be used if the undesirable complex-conjugate poles are in the right- half splane.) Familiar networks consisting only of RCcomponents whose transfer functions pos- sess two zeros and two poles are the bridged- Tnetworks. Examples of bridged- Tnet- works and their transfer functions are shown in Figure 7–117. (The derivations of the transfer functions of the bridged- Tnetworks were given in Problem A–3–5 .)s 2 +2z 1 v 1 s+v 2 1 s 2 +2z 2 v 2 s+v 2 2 1 s 2 +2z 1 v 1 s+v 2 1 520 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method C 2 RR C 1 R 2 CC R 1 e i e o e i e o (a) (b)E o (s) E i (s)RC 1 RC 2 s 2 + 2RC 2 s+ 1 RC 1 RC 2 s 2 + (RC 1 + 2RC 2 )s+ 1 = E o (s) E i (s)R 1 CR 2 Cs 2 + 2R 1 Cs+ 1 R 1 CR 2 Cs 2 + (R 2 C+ 2R 1 C)s+ 1 = Figure 7–117 Bridged- Tnetworks. Openmirrors.comExample Problems and Solutions 521Concluding Comments. In the design examples presented in this chapter, we have been primarily concerned only with the transfer functions of compensators. In ac-tual design problems, we must choose the hardware. Thus, we must satisfy additionaldesign constraints such as cost, size, weight, and reliability. The system designed may meet the specifications under normal operating condi- tions but may deviate considerably from the specifications when environmental changesare considerable. Since the changes in the environment affect the gain and time con-stants of the system, it is necessary to provide automatic or manual means to adjust thegain to compensate for such environmental changes, for nonlinear effects that were nottaken into account in the design, and also to compensate for manufacturing tolerancesfrom unit to unit in the production of system components. (The effects of manufactur-ing tolerances are suppressed in a closed-loop system; therefore, the effects may not becritical in closed-loop operation but critical in open-loop operation.) In addition to this,the designer must remember that any system is subject to small variations due mainlyto the normal deterioration of the system. 15 10 5 0 –5 –10 –15 90° 45° 0° –45° –90° 0.2 0.4 0.6 1 2 4 6 10 20 40 v in rad/secC(jv) R(jv)C(jv) R(jv)in dBAsymptote Figure 7–118 Bode diagram for10(1 +jv)/H20862C(2+jv)(5+jv)D.EXAMPLE PROBLEMS AND SOLUTIONS A–7–1. Consider a system whose closed-loop transfer function is Clearly, the closed-loop poles are located at s=–2 ands=–5 , and the system is not oscillatory. Show that the closed-loop frequency response of this system will exhibit a resonant peak, al- though the damping ratio of the closed-loop poles is greater than unity. Solution. Figure 7–118 shows the Bode diagram for the system. The resonant peak value is ap- proximately 3.5 dB. (Note that, in the absence of a zero, the second-order system with z>0.7 will not exhibit a resonant peak; however, the presence of a closed-loop zero will cause such a peak.)C(s) R(s)=10(s +1) (s+2)(s +5)A–7–2. Consider the system defined by Obtain the sinusoidal transfer functions and In deriving and we assume that Simi- larly, in obtaining and we assume that Solution. The transfer matrix expression for the system defined by is given by where G(s)is the transfer matrix and is given by For the system considered here, the transfer matrix becomes Hence Assuming that U 2 (jv)=0 , we find and as follows: Similarly, assuming that U 1 (jv)=0 , we find and as follows: Notice that is a nonminimum-phase transfer function. Y 2 (jv)/H20862U 2 (jv)Y 2 (jv) U 2 (jv)=jv-25 (jv) 2 +4jv+25Y 1 (jv) U 2 (jv)=jv+5 (jv) 2 +4jv+25Y 2 (jv)/H20862U 2 (jv) Y 1 (jv)/H20862U 2 (jv)Y 2 (jv) U 1 (jv)=-25 (jv) 2 +4jv+25Y 1 (jv) U 1 (jv)=jv+4 (jv) 2 +4jv+25Y 2 (jv)/H20862U 1 (jv) Y 1 (jv)/H20862U 1 (jv) B Y 1 (s) Y 2 (s) R = D s+4 s 2 +4s+25 -25 s 2 +4s+25s+5 s 2 +4s+25 s-25 s 2 +4s+25 TB U 1 (s) U 2 (s) R = D s+4 s 2 +4s+25 -25 s 2 +4s+25s+5 s 2 +4s+25 s-25 s 2 +4s+25 T =1 s 2 +4s+25 B s+4 -251 s RB 1 01 1 R C(s I-A) -1 B+D= B 1 00 1 RB s 25-1 s+4 R -1 B 1 01 1 R G(s)=C(s I-A) -1 B+DY(s)=G(s)U(s)y#=Cx+Dux#=Ax+BuU 1 (jv)=0. Y 2 (jv)/H20862U 2 (jv), Y 1 (jv)/H20862U 2 (jv)U 2 (jv)=0. Y 2 (jv)/H20862U 1 (jv), Y 1 (jv)/H20862U 1 (jv) Y 2 (jv)/H20862U 2 (jv).Y 1 (jv)/H20862U 2 (jv), Y 2 (jv)/H20862U 1 (jv), Y 1 (jv)/H20862U 1 (jv), B y 1 y 2 R = B 1 00 1 RB x 1 x 2 R B x# 1 x# 2 R = B 0 -251 -4 RB x 1 x 2 R + B 1 01 1 RB u 1 u 2 R 522 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method Openmirrors.comExample Problems and Solutions 523Frequency (rad/sec)Phase (deg); Magnitude (dB)Bode Diagrams 100101102100101102From: U1 From: U2 −40−200 −1000100 −1000100 −2000200To:Y1 To:Y2 Figure 7–119 Bode diagrams.A–7–3. Referring to Problem A–7–2, plot Bode diagrams for the system, using MATLAB. Solution. MATLAB Program 7–15 produces Bode diagrams for the system. There are four sets of Bode diagrams: two for input 1 and two for input 2. These Bode diagrams are shown inFigure 7–119. MATLAB Program 7–15 A = [0 1;-25 -4]; B = [1 1;0 1];C = [1 0;0 1];D = [0 0;0 0];bode(A,B,C,D)524 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method K s(s+ 1) (s+ 5) +– R(s) C(s) Figure 7–120 Closed-loop system. A–7–4. Using MATLAB, plot Bode diagrams for the closed-loop system shown in Figure 7–120 for K=1, K=10, andK=20. Plot three magnitude curves in one diagram and three phase-angle curves in another diagram. Solution. The closed-loop transfer function of the system is given by Hence the numerator and denominator of C(s) /H20862R(s) are num = [K] den = [1 6 5 K] A possible MATLAB program is shown in MATLAB Program 7–16.The resulting Bode diagrams are shown in Figures 7–121(a) and (b). =K s 3 +6s 2 +5s+K C(s) R(s)=K s(s+1)(s +5)+K MATLAB Program 7–16 w = logspace(-1,2,200); for i = 1:3; if i = 1; K = 1;[mag,phase,w] = bode([K],[1 6 5 K],w); mag1dB = 20*log10(mag); phase1 = phase; end; if i = 2; K = 10;[mag,phase,w] = bode([K],[1 6 5 K],w); mag2dB = 20*log10(mag); phase2 = phase; end; if i = 3; K = 20;[mag,phase,w] = bode([K],[1 6 5 K],w); mag3dB = 20*log10(mag); phase3 = phase; end; end semilogx(w,mag1dB,'-',w,mag2dB,'-',w,mag3dB,'-') grid title('Bode Diagrams of G(s) = K/[s(s + 1)(s + 5)], where K = 1, K = 10, and K = 20') xlabel('Frequency (rad/sec)') ylabel('Gain (dB)') text(1.2,-31,'K = 1') text(1.1,-8,'K = 10') text(11,-31,'K = 20') semilogx(w,phase1,'-',w,phase2,'-',w,phase3,'-') grid xlabel('Frequency (rad/sec)') ylabel('Phase (deg)') text(0.2,-90,'K = 1') text(0.2,-20,'K =10') text(1.6,-20,'K = 20') Openmirrors.comExample Problems and Solutions 525Frequency (rad/sec)Bode Diagrams of G(s) = K/[s(s + 1)( s + 5)], where K = 1, K = 10, and K = 20 −140Gain (dB) −120−100−80−60−40−2020 0 10−1100101102K = 10 K = 20 K = 1 (a) Frequency (rad/sec)−300−200−150−100−50 −2500Phase (deg) 10−1100101102K = 10 K = 20 K = 1 (b)Figure 7–121 Bode diagrams:(a) Magnitude- versus-frequency curves; (b) phase-angle-versus-frequency curves. A–7–5. Prove that the polar plot of the sinusoidal transfer function is a semicircle. Find the center and radius of the circle.G(jv)=jvT 1+jvT, for 0/H11349v/H11349q526 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method Solution. The given sinusoidal transfer function G(jv)can be written as follows: where Then Hence, we see that the plot of G(jv)is a circle centered at (0.5,0) with radius equal to 0.5. The upper semicircle corresponds to 0 /H11349v/H11349q, and the lower semicircle corresponds to –q/H11349v/H113490. A–7–6. Prove the following mapping theorem: Let F(s) be a ratio of polynomials in s. Let Pbe the num- ber of poles and Zbe the number of zeros of F(s) that lie inside a closed contour in the splane, with multiplicity accounted for. Let the closed contour be such that it does not pass through any poles or zeros of F(s) .The closed contour in the splane then maps into the F(s) plane as a closed curve. The number Nof clockwise encirclements of the origin of the F(s) plane, as a representa- tive point straces out the entire contour in the splane in the clockwise direction, is equal to Z-P . Solution. To prove this theorem, we use Cauchy’s theorem and the residue theorem. Cauchy’s theorem states that the integral of F(s) around a closed contour in the splane is zero if F(s) is analytic # within and on the closed contour, or Suppose that F(s) is given by where X(s) is analytic in the closed contour in the splane and all the poles and zeros are located in the contour. Then the ratio F¿(s)/F(s) can be written (7–30) This may be seen from the following consideration: If is given by then has a zero of kth order at s=–z 1 . Differentiating F(s) with respect to syields Hence, (7–31) We see that by taking the ratio , the kth-order zero of becomes a simple pole of . F ˆ ¿(s) /H20862F ˆ (s)F ˆ (s) F ˆ ¿(s) /H20862F ˆ (s)F ˆ ¿(s) F ˆ (s)=k s+z 1 +X¿(s) X(s)F ˆ ¿(s)=kAs+z 1 B k-1 X(s) +As+z 1 B k X¿(s)F ˆ (s)F ˆ (s)=As+z 1 B k X(s)F ˆ (s)F¿(s) F(s)= a k 1 s+z 1 +k 2 s+z 2 +p b a m 1 s+p 1 +m 2 s+p 2 +p b +X¿(s) X(s)F(s) =As+z 1 B k 1 As+z 2 B k 2 p As+p 1 B m 1 As+p 2 B m 2 pX(s)IF(s) ds=0 a X-1 2 b 2 +Y 2 =Av 2 T 2 -1B 2 4A1+v 2 T 2 B 2 +v 2 T 2 A1+v 2 T 2 B 2 =1 4X=v 2 T 2 1+v 2 T 2 , Y=vT 1+v 2 T 2 G(jv)=X+jY # For the definition of an analytic function, see the footnote on page 447. Openmirrors.comExample Problems and Solutions 527If the last term on the right-hand side of Equation (7–31) does not contain any poles or zeros in the closed contour in the splane, F¿(s)/F(s) is analytic in this contour except at point s=–z1. Then, referring to Equation (7–30) and using the residue theorem, which states that the integralofF¿(s)/F(s) taken in the clockwise direction around a closed contour in the splane is equal to –2pjtimes the residues at the simple poles of F¿(s)/F(s) ,o r we have where total number of zeros of F(s) enclosed in the closed contour in the splane total number of poles of F(s) enclosed in the closed contour in the splane [The kmultiple zeros (or poles) are considered kzeros (or poles) located at the same point.] Since F(s) is a complex quantity, F(s) can be written andNoting that F¿(s)/F(s) can be written we obtain If the closed contour in the splane is mapped into the closed contour in the F(s) plane, then The integral is zero since the magnitude is the same at the initial point and the final point of the contour Thus we obtain The angular difference between the final and initial values of uis equal to the total change in the phase angle of F¿(s)/F(s) as a representative point in the splane moves along the closed contour. Noting that Nis the number of clockwise encirclements of the origin of the F(s) plane andu 2-u1is zero or a multiple of 2 prad, we obtain u2-u1 2p=-Nu2-u1 2p=P-ZG.ln ∑F∑DGdln ∑F∑IF¿(s) F(s)ds= IG dln ∑F∑+j IGdu=j 3du=2pj(P -Z)GF¿(s) F(s)=dln ∑F∑ ds+jdu dsF¿(s) F(s)=dlnF(s) dslnF(s) =ln ∑F∑+juF(s) =∑F∑eju P=m1+m2+p=Z=k1+k2+p=IF¿(s) F(s)ds=-2pjCAk1+k2+pB-Am1+m2+pBD=-2pj(Z -P)IF¿(s) F(s)ds=-2pjaa residuesb528 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method 0 Re (a)Im v=/H11009 –1 v= 0 ReIm –1 G Plane v=/H11009 v= 0+v= 0– /H11009 (b) Figure 7–123 (a) Nyquist plot; (b) complete Nyquist plot in the Gplane.Thus, we have the relationship This proves the theorem. Note that by this mapping theorem, the exact numbers of zeros and of poles cannot be found— only their difference. Note also that, from Figures 7–122(a) and (b), we see that if udoes not change through 2 prad, then the origin of the F(s) plane cannot be encircled. A–7–7. The Nyquist plot (polar plot) of the open-loop frequency response of a unity-feedback control system is shown in Figure 7–123(a). Assuming that the Nyquist path in the splane encloses the entire right-half splane, draw a complete Nyquist plot in the Gplane.Then answer the following questions: (a) If the open-loop transfer function has no poles in the right-half splane, is the closed-loop system stable? (b) If the open-loop transfer function has one pole and no zeros in right-half splane, is the closed- loop system stable? (c) If the open-loop transfer function has one zero and no poles in the right-half splane, is the closed-loop system stable?N=Z-P ReIm u 1 u 2 u 2 Origin encircled u 2 –u 1 = 2pOrigin not encircled u 2 –u 1 = 0F(s) Plane F(s) Plane 0 (a) (b) ReIm 0 u 1 Figure 7–122 Determination of encirclement of the origin of F(s) plane. Openmirrors.comExample Problems and Solutions 529Solution. Figure 7–123(b) shows a complete Nyquist plot in the Gplane.The answers to the three questions are as follows: (a) The closed-loop system is stable, because the critical point (–1+j0) is not encircled by the Nyquist plot. That is, since P=0 andN=0 , we have Z=N+P=0 . (b) The open-loop transfer function has one pole in the right-half splane. Hence, P=1 .( T h e open-loop system is unstable.) For the closed-loop system to be stable, the Nyquist plot must encircle the critical point (–1+j0) once counterclockwise. However, the Nyquist plot does not encircle the critical point. Hence, N=0 .Therefore, Z=N+P=1 .The closed-loop sys- tem is unstable. (c) Since the open-loop transfer function has one zero, but no poles, in the right-half splane, we have Z=N+P=0 . Thus, the closed-loop system is stable. (Note that the zeros of the open-loop transfer function do not affect the stability of the closed-loop system.) A–7–8. Is a closed-loop system with the following open-loop transfer function and with K=2 stable? Find the critical value of the gain Kfor stability. Solution. The open-loop transfer function is This open-loop transfer function has no poles in the right-half splane. Thus, for stability, the –1+j0 point should not be encircled by the Nyquist plot. Let us find the point where the Nyquist plot crosses the negative real axis. Let the imaginary part of G(jv)H(jv)be zero, or from which Substituting into G(jv)H(jv), we obtain The critical value of the gain Kis obtained by equating –2K/3 to–1,o r Hence, The system is stable if Hence, the system with K=2 is unstable. 06K63 2.K=3 2-2 3K=-1Gaj1 12bHaj1 12b=-2K 3v=1/H2086212v=; 1 121-2v2=0 =K -3v2+jvA1-2v2B G(jv)H(jv)=K jv(jv+1)(2jv+1)G(s)H(s) =K s(s+1)(2s +1)530 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method ReIm Re ReIm Im –1 –1 G Plane G Plane G Plane (Stable) (Unstable)(a) (b)v=/H11009 v=/H11009 v=/H11009v=–/H11009 v=–/H11009 v=–/H11009v= 0 v= 0 v= 0 P= 1 N=–1 Z= 0P= 1 N= 0 K/H11021 1 K/H11022 1Z= 1 K 2 K 2 – Figure 7–125 (a) Polar plot of K/(jv-1) ; (b) polar plots of K/(jv-1) for stable and unstable cases.A–7–9. Consider the closed-loop system shown in Figure 7–124. Determine the critical value of Kfor stability by the use of the Nyquist stability criterion. Solution. The polar plot of is a circle with center at –K/2 on the negative real axis and radius K/2 , as shown in Figure 7–125(a). As vis increased from –qtoq, the G(jv)locus makes a counterclockwise rotation. In this system, P=1 because there is one pole of G(s) in the right-half splane. For the closed- loop system to be stable, Zmust be equal to zero.Therefore, N=Z-P must be equal to –1,o r there must be one counterclockwise encirclement of the –1+j0 point for stability. (If there is no encirclement of the –1+j0 point, the system is unstable.) Thus, for stability, Kmust be greater than unity, and K=1 gives the stability limit. Figure 7–125(b) shows both stable and unstable cases ofG(jv)plots.G(jv)=K jv-1 R(s) C(s)K s– 1 +– Figure 7–124 Closed-loop system. Openmirrors.comExample Problems and Solutions 531ReIm 4 3 v= 2.45 v= 2 v= 1.5–1 –2–11 123 v= 1v= 06 8910 v= 0.52.65 1+jv 2.65 e–0.8jv 1+jvFigure 7–126 Polar plots of and2.65/(1+j v).2.65e-0.8jv/H20862(1+jv)A–7–10. Consider a unity-feedback system whose open-loop transfer function is Using the Nyquist plot, determine the critical value of Kfor stability. Solution. For this system, The imaginary part of G(jv)is equal to zero if Hence,Solving this equation for the smallest positive value of v, we obtain Substituting v=2.4482 into G(jv), we obtain The critical value of Kfor stability is obtained by letting G(j2.4482) equal –1. Hence, or Figure 7–126 shows the Nyquist or polar plots of 2.65e –0.8jv/(1+j v)and2.65/(1+j v).The first- order system without transport lag is stable for all values of K, but the one with a transport lag of 0.8 sec becomes unstable for K>2.65 .K=2.650.378K =1G(j2.4482) =K 1+2.44822(cos1.9586 -2.4482 sin1.9586) =-0.378Kv=2.4482v=-tan0.8vsin0.8v+vcos0.8v=0 =K 1+v2C(cos0.8v-vsin0.8v)-j(sin0.8v+vcos0.8v)D =K(cos0.8v-jsin0.8v)(1-jv) 1+v2 G(jv)=Ke-0.8jv jv+1G(s) =Ke-0.8s s+1532 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method A–7–11. Consider a unity-feedback system with the following open-loop transfer function: Draw a Nyquist plot with MATLAB and examine the stability of the closed-loop system. Solution. MATLAB Program 7–17 produces the Nyquist diagram shown in Figure 7–127. From this figure, we see that the Nyquist plot does not encircle the –1+j0 point. Hence, N=0 in the Nyquist stability criterion. Since no open-loop poles lie in the right-half splane, P=0. Therefore, Z=N+P=0. The closed-loop system is stable.G(s) =20As 2 +s+0.5B s(s+1)(s +10) A–7–12. Consider the same system as discussed in Problem A–7–11 . Draw the Nyquist plot for only the positive-frequency region. Solution. Drawing a Nyquist plot for only the positive-frequency region can be done by the use of the following command: [re,im,w] = nyquist(num,den,w) The frequency region may be divided into several subregions by using different increments. For example, the frequency region of interest may be divided into three subregions as follows: w1 = 0.1:0.1:10; w2 = 10:2:100; w3 = 100:10:500; w = [w1 w2 w3] MATLAB Program 7–17 num = [20 20 10]; den = [1 11 10 0]; nyquist(num,den) v = [-2 3 -3 3]; axis(v) grid Real Axis−1−0.5 −1.5 −23 1 1.5 0.5 2 2.5 0 Imaginary Axis −33 2 1 −2−10Nyquist Diagram Figure 7–127 Nyquist plot of G(s) =20As 2 +s+0.5B s(s+1)(s +10). Openmirrors.comExample Problems and Solutions 533Real Axis–3 3 2 1 0 –1 –2Imag Axis –3 –51 –1 –4–20Nyquist Plot of G(s)= 20(s2+s+0.5)/[ s(s+1)(s+10)] Figure 7–128 Nyquist plot for thepositive-frequency region.MATLAB Program 7–18 num = [20 20 10]; den = [1 11 10 0];w1 = 0.1:0.1:10; w2 = 10:2:100; w3 = 100:10:500;w = [w1 w2 w3];[re,im,w] = nyquist(num,den,w);plot(re,im)v = [-3 3 -5 1]; axis(v);gridtitle('Nyquist Plot of G(s) = 20(s^2 + s + 0.5)/[s(s + 1)(s + 10)]')xlabel('Real Axis')ylabel('Imag Axis') A–7–13. Referring to Problem A–7–12 , plot the polar locus of G(s) where Locate on the polar locus frequency points where v=0.2, 0.3, 0.5, 1, 2, 6, 10, and 20 rad /H20862sec. Also, find the magnitudes and phase angles of G(jv)at the specified frequency points. Solution. In MATLAB Program 7–19 we used the frequency vector w, which consists of three frequency subvectors: w1,w2, and w3. Instead of such a w, we may simply use theG(s) =20As2+s+0.5B s(s+1)(s +10)MATLAB Program 7–18 uses this frequency region. Using this program, we obtain the Nyquist plot shown in Figure 7–128.534 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method MATLAB Program 7–19 num = [20 20 10]; den = [1 11 10 0]; ww = logspace(-1,2,100); nyquist(num,den,ww) v = [-2 3 -5 0]; axis(v); grid hold Current plot held w = [0.2 0.3 0.5 1 2 6 10 20]; [re,im,w] = nyquist(num,den,w); plot(re,im,'o') text(1.1,-4.8,'w = 0.2') text(1.1,-3.1,'0.3') text(1.25,-1.7,'0.5') text(1.37,-0.4,'1') text(1.8,-0.3,'2') text(1.4,-1.1,'6') text(0.77,-0.8,'10') text(0.037,-0.8,'20') % ----- To get the values of magnitude and phase (in degrees) of G(jw) % at the specified w values, enter the command [mag,phase,w] % = bode(num,den,w) ------ [mag,phase,w] = bode(num,den,w); % ----- The following table shows the specified frequency values w and % the corresponding values of magnitude and phase (in degrees) ----- [w mag phase] ans = 0.2000 4.9176 -78.9571 0.3000 3.2426 -72.2244 0.5000 1.9975 -55.9925 1.0000 1.5733 -24.1455 2.0000 1.7678 -14.4898 6.0000 1.6918 -31.0946 10.0000 1.4072 -45.0285 20.0000 0.8933 -63.4385 frequency vector w = logscale(d 1 ,d 2 ,n ). MATLAB Program 7–19 uses the following fre- quency vector: w = logscale(-1,2,100) This MATLAB program plots the polar locus and locates the specified frequency points on the polar locus, as shown in Figure 7–129. Openmirrors.comExample Problems and Solutions 535MATLAB Program 7–20 num = [-1 -4 -6]; den = [1 5 4];nyquist(num,den);gridtitle('Nyquist Plot of G(s) = -(s^2 + 4s + 6)/(s^2 + 5s + 4)')A–7–14. Consider a unity-feedback, positive-feedback system with the following open-loop transfer function: Draw a Nyquist plot. Solution. The Nyquist plot of the positive-feedback system can be obtained by defining num and denas num = [-1 -4 -6] den = [1 5 4] and using the command nyquist(num,den) . MATLAB Program 7–20 produces the Nyquist plot, as shown in Figure 7–130. This system is unstable, because the –1+j0 point is encircled once clockwise. Note that this is a special case where the Nyquist plot passes through –1+j0 point and also encircles this point once clockwise. This means that the closed-loop system is degenerate; the system behaves as if itwere an unstable first-order system. See the following closed-loop transfer function of the positive-feedback system: =s 2+4s+6 s-2 C(s) R(s)=s2+4s+6 s2+5s+4-As2+4s+6BG(s) =s2+4s+6 s2+5s+4Real Axis−1−0.5 −1.5 −23 1 1.5 0.5 2 2.5 0Imaginary Axis −50 −0.5 −1 −2.5 −3 −3.5 −4 −4.5−2−1.5Nyquist Diagram w = 0.20.30.5621 10 20 Figure 7–129 Polar plot of G(jv) given in Problem A–7–13 .536 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method Note that the Nyquist plot for the positive-feedback case is a mirror image about the imaginary axis of the Nyquist plot for the negative-feedback case.This may be seen from Figure 7–131, which was obtained by use of MATLAB Program 7–21. (Note that the positive-feedback case is unsta- ble, but the negative-feedback case is stable.) MATLAB Program 7–21 num1 = [1 4 6]; den1 = [1 5 4]; num2 = [-1 -4 -6]; den2 = [1 5 4]; nyquist(num1,den1); hold on nyquist(num2,den2); v = [-2 2 -1 1]; axis(v); grid title('Nyquist Plots of G(s) and -G(s)') text(1.0,0.5,'G(s)') text(0.57,-0.48,'Use this Nyquist') text(0.57,-0.61,'plot for negative') text(0.57,-0.73,'feedback system') text(-1.3,0.5,'-G(s)') text(-1.7,-0.48,'Use this Nyquist') text(-1.7,-0.61,'plot for positive') text(-1.7,-0.73,'feedback system') Real Axis–1.4 –1.5 –0.9 –0.7 –1 –0.8 –1.2 –1.3 –1.1 Imag Axis –0.2 0.1 –0.50.5 –0.1 0.2 –0.3 –0.4 0 0.3 0.4 Nyquist Plot of G(s)= –(s 2 +4s+6)/(s 2 +5s+4) Figure 7–130 Nyquist plot for positive-feedback system. Openmirrors.comExample Problems and Solutions 537Real Axis–1.5 –2 1 2 0.5 1.5 –0.5 –1 0Imag Axis –0.40.2 –11 –0.20.4 –0.6 –0.800.60.8Nyquist Plots of G(s) and –G(s) –G(s) G(s) Use this Nyquist plot for positive feedback systemUse this Nyquist plot for negative feedback systemFigure 7–131 Nyquist plots forpositive-feedback system and negative- feedback system. A–7–15. Consider the control system shown in Figure 7–60. (Refer to Example 7–19.) Using the inverse polar plot, determine the range of gain Kfor stability. Solution. Since we have Hence, the inverse of the feedforward transfer function is Notice that 1/G(s) has a pole at s=–0.5 . It does not have any pole in the right-half splane. Therefore, the Nyquist stability equation reduces to Z=N since P=0 . The reduced equation states that the number Zof the zeros of 1+C1/G(s)Din the right-half splane is equal to N, the number of clockwise encirclements of the–1+j0 point. For stability, Nmust be equal to zero, or there should be no encirclement. Fig- ure 7–132 shows the Nyquist plot or polar plot of K/G(jv). Notice that since =0.5-0.5v 2-v4+jvA-1+0.5v2B 0.25 +v2 K G(jv)=c(jv)3+(jv)2+1 jv+0.5da0.5-jv 0.5-jvbZ=N+P1 G(s)=s3+s2+1 K(s +0.5)G(s) =G1(s)G2(s)=K(s +0.5) s3+s2+1G2(s)=1 s3+s2+1538 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method Figure 7–132 Polar plot of K/G(jv). theK/G(jv)locus crosses the negative real axis at and the crossing point at the nega- tive real axis is –2. From Figure 7–132, we see that if the critical point lies in the region between –2and–q, then the critical point is not encircled. Hence, for stability, we require Thus, the range of gain Kfor stability is 2<K which is the same result as we obtained in Example 7–19. A–7–16. Figure 7–133 shows a block diagram of a space-vehicle control system. Determine the gain Ksuch that the phase margin is 50°. What is the gain margin in this case? Solution. Since we have The requirement that the phase margin be 50° means that must be equal to –130 °, where v c is the gain crossover frequency, or / GAjv c B =-130° / GAjv c B / G(jv) = / jv+2 -2 / jv =tan -1 v 2-180°G(jv)=K(jv+2) (jv) 2 -16-2 Kv=12 , Im ReK G PlaneK G Locus /H11009 /H11009 –/H11009–20 2v = 0v = 2 vv Openmirrors.comExample Problems and Solutions 539Hence, we set from which we obtain Since the phase curve never crosses the –180 ° line, the gain margin is ±qdB. Noting that the magnitude of G(jv)must be equal to 0 dB at v=2.3835 , we have from which we get This Kvalue will give the phase margin of 50°. A–7–17. For the standard second-order system show that the bandwidth vbis given by Note that vb/vnis a function only of z. Plot a curve of vb/vnversusz. Solution. The bandwidth vbis determined from @CAjvbB/RAjvbB@=–3 dB. Quite often, instead of –3dB, we use –3.01 dB, which is equal to 0.707. Thus, Then from which we get v4 n=0.5CAv2 n-v2 bB2+4z2v2 n v2bDv2 n 3Av2 n-v2 bB2+A2zvn vbB2=0.7072CAjvbB RAjvbB2=2v2 n AjvbB2+2zvnAjvbB+v2 n2=0.707vb=vnA1-2z2+24z4-4z2+2B1/H208622C(s) R(s)=v2 n s2+2zvn s+v2 nK=2.38352 222+2.38352=1.82592K(jv+2) (jv)22 v=2.3835=1vc=2.3835 rad /H20862sectan-1vc 2=50°G(s)K(s+ 2)1 s2+– Figure 7–133 Space-vehicle controlsystem.540 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method 2.0 1.8 1.6 1.4 1.2 1.0 0.8 0.6 0.4 0.2 0 0 0.2 0.4 0.6 0.8 1.0 zv b v n Figure 7–134 Curve of v b /v n versusz, where v b is the bandwidth. By dividing both sides of this last equation by v 4 n , we obtain Solving this last equation for Av b /v n B 2 yields SinceAv b /v n B 2 >0 , we take the plus sign in this last equation. Then or Figure 7–134 shows a curve relating v b /v n versusz. A–7–18. A Bode diagram of the open-loop transfer function G(s) of a unity-feedback control system is shown in Figure 7–135. It is known that the open-loop transfer function is minimum phase. From the diagram, it can be seen that there is a pair of complex-conjugate poles at v=2 rad /H20862sec. Determine the damping ratio of the quadratic term involving these complex-conjugate poles. Also, determine the transfer function G(s) . Solution. Referring to Figure 7–9 and examining the Bode diagram of Figure 7–135, we find the damping ratio zand undamped natural frequency v n of the quadratic term to be z=0.1, v n =2 rad /H20862secv b =v n A1-2z 2 +24z 4 -4z 2 +2 B 1/H208622 v 2 b =v 2 n A1-2z 2 +24z 4 -4z 2 +2 B a v b v n b 2 =-2z 2 +1;24z 4 -4z 2 +2 1=0.5 e c 1- a v b v n b 2 d 2 +4z 2 a v b v n b 2 f Openmirrors.comExample Problems and Solutions 54140 20 –20 dB0 –40 –60 –80 0.1 0.2 0.4 0.6 1 4 2 6 10 20 60 40 100–270°–180°–90°0° v in rad/secFigure 7–135 Bode diagram of theopen-loop transfer function of a unity- feedback controlsystem. Noting that there is another corner frequency at v=0.5 rad /H20862sec and the slope of the magnitude curve in the low-frequency region is –40 dB /H20862decade, G(jv)can be tentatively determined as follows: Since, from Figure 7–135 we find @G(j0.1)@=40 dB, the gain value Kcan be determined to be unity.Also, the calculated phase curve, versus v, agrees with the given phase curve. Hence, the transfer function G(s) can be determined to be A–7–19. A closed-loop control system may include an unstable element within the loop.When the Nyquist stability criterion is to be applied to such a system, the frequency-response curves for the unsta-ble element must be obtained. How can we obtain experimentally the frequency-response curves for such an unstable ele- ment? Suggest a possible approach to the experimental determination of the frequency response of an unstable linear element. Solution. One possible approach is to measure the frequency-response characteristics of the un- stable element by using it as a part of a stable system.G(s) =4(2s +1) s2As2+0.4s +4B/G(jv)G(jv)=Kajv 0.5+1b (jv)2cajv 2b2 +0.1(jv)+1d542 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method Consider the system shown in Figure 7–136. Suppose that the element G 1 (s)is unstable. The complete system may be made stable by choosing a suitable linear element G 2 (s). We apply a si- nusoidal signal at the input. At steady state, all signals in the loop will be sinusoidal. We measure the signals e(t), the input to the unstable element, and x(t), the output of the unstable element. By changing the frequency [and possibly the amplitude for the convenience of measuring e(t) andx(t)] of the input sinusoid and repeating this process, it is possible to obtain the frequency re- sponse of the unstable linear element. A–7–20. Show that the lead network and lag network inserted in cascade in an open loop act as proportional-plus-derivative control (in the region of small v) and proportional-plus-integral control (in the region of large v), respectively. Solution. In the region of small v, the polar plot of the lead network is approximately the same as that of the proportional-plus-derivative controller. This is shown in Figure 7–137(a). Similarly, in the region of large v, the polar plot of the lag network approximates the proportional-plus-integral controller, as shown in Figure 7–137(b). A–7–21. Consider a lag–lead compensator G c (s)defined by Show that at frequency v 1 ,where the phase angle of G c (jv)becomes zero. (This compensator acts as a lag compensator for 0<v<v 1 and acts as a lead compensator for v 1 <v<q.) (Refer to Figure 7–109.)v 1 =1 1T 1 T 2 G c (s)=K c a s+1 T 1 ba s+1 T 2 b a s+b T 1 ba s+1 bT 2 b G 1 (s) G 2 (s)re x c +– Figure 7–136 Control system. Im Im Re 0PD controller Lead network av = 0 v =`v =`v = 0 (a) (b)PI controller1Re 01 Lag network1 b Figure 7–137 (a) Polar plots of a lead network and a proportional-plus- derivative controller; (b) polar plots of a lag network and a proportional-plus- integral controller. Openmirrors.comExample Problems and Solutions 543Solution. The angle of Gc(jv)is given by At we have Since or and also we have Thus, the angle of GcAjv1Bbecomes 0° at A–7–22. Consider the control system shown in Figure 7–138. Determine the value of gain Ksuch that the phase margin is 60°. What is the gain margin with this value of gain K? Solution. The open-loop transfer function is =K(10s +1) s3+1.5s2+0.5s G(s) =K s+0.1 s+0.5 10 s(s+1)v=v1=1/H208621T1 T2./GcAjv1B=0°tan-11 bBT1 T2+tan-1bBT2 T1=90°tan-1 BT1 T2+tan-1 BT2 T1=90°tan atan-1 BT1 T2+tan-1 BT2 T1b=BT1 T2+BT2 T1 1-BT1 T2BT2 T1=q/GcAjv1B=tan-1 BT1 T2+tan-1 BT2 T1-tan-1 1 b BT1 T2-tan-1bBT2 T1v=v1=1/H208621T1 T2, =tan-1vT1+tan-1vT2-tan-1vT1/H20862b-tan-1vT2 b /Gc(jv)=njv+1 T1+njv+1 T2-njv+b T1-njv+1 bT2 Ks+ 0.1 s+ 0.510 s(s+ 1)+– Figure 7–138 Control system.544 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method MATLAB Program 7–22 num = [10 1]; den = [1 1.5 0.5 0]; bode(num,den) title('Bode Diagram of G(s) = (10s + 1)/[s(s + 0.5)(s + 1)]') Let us plot the Bode diagram of G(s) when K=1 . MATLAB Program 7–22 may be used for this purpose. Figure 7–139 shows the Bode diagram produced by this program. From this diagram the required phase margin of 60° occurs at the frequency v=1.15 rad /H20862sec. The magnitude of G(jv) at this frequency is found to be 14.5 dB. Then gain Kmust satisfy the following equation: or K=0.18820logK=-14.5 dB Frequency (rad/sec)Bode Diagram of G(s) = (10 s + 1)/[ s(s + 0.5)( s + 1)] −200−150−50 −100−50 Phase (deg); Magnitude (dB) 0100 50 10 −3 10 −2 10 −1 10 0 10 1 Figure 7–139 Bode diagram of G(s) =10s +1 s(s+0.5)(s +1).Thus, we have determined the value of gain K. Since the angle curve does not cross the –180 ° line, the gain margin is ±qdB. To verify the results, let us draw a Nyquist plot of Gfor the frequency range w = 0.5:0.01:1.15 The end point of the locus (v=1.15 rad /H20862sec)will be on a unit circle in the Nyquist plane.To check the phase margin, it is convenient to draw the Nyquist plot on a polar diagram, using polar grids. To draw the Nyquist plot on a polar diagram, first define a complex vector zby z = re + i *im = re iu where randu(theta) are given by r = abs(z) theta = angle(z) The absmeans the square root of the sum of the real part squared and imaginary part squared; angle means tan –1 (imaginary part/real part). Openmirrors.comExample Problems and Solutions 545If we use the command polar(theta,r) MATLAB will produce a plot in the polar coordinates. Subsequent use of the grid command draws polar grid lines and grid circles. MATLAB Program 7–23 produces the Nyquist plot of G(jv), where vis between 0.5 and 1.15 rad /H20862sec.The resulting plot is shown in Figure 7–140. Notice that point G(j1.15) lies on the unit MATLAB Program 7–23 %*****Nyquist plot in rectangular coordinates***** num = [1.88 0.188]; den = [1 1.5 0.5 0];w = 0.5:0.01:1.15;[re,im,w] = nyquist(num,den,w); %*****Convert rectangular coordinates into polar coordinates % by defining z, r, theta as follows***** z = re + i*im; r = abs(z);theta = angle(z); %*****To draw polar plot, enter command 'polar(theta,r)'*****polar(theta,r) text(-1,3,'Check of Phase Margin')text(0.3,-1.7,'Nyquist plot')text(-2.2,-0.75,'Phase margin')text(-2.2,-1.1,'is 60 degrees')text(1.45,-0.7,'Unit circle') Nyquist plotPhase margin is 60 degreesUnit circle 27024021018015012090 60 30 0 3003302 1 0.5Check of Phase Margin 2.5 1.5 Figure 7–140 Nyquist plot of G(jv)showing that the phase margin is 60°.circle, and the phase angle of this point is –120 °. Hence, the phase margin is 60°. The fact that point G(j1.15) is on the unit circle verifies that at v=1.15 rad /H20862sec the magnitude is equal to 1 or 0 dB. (Thus, v=1.15 is the gain crossover frequency.) Thus, K=0.188 gives the desired phase margin of 60°. Note that in writing ‘text’ in the polar diagram we enter the textcommand as follows: text(x,y,' ') For example, to write ‘Nyquist plot’ starting at point (0.3, –1.7) , enter the command text(0.3, –1.7,'Nyquist plot') The text is written horizontally on the screen. A–7–23. If the open-loop transfer function G(s) involves lightly damped complex-conjugant poles, then more than one Mlocus may be tangent to the G(jv)locus. Consider the unity-feedback system whose open-loop transfer function is (7–32) Draw the Bode diagram for this open-loop transfer function. Draw also the log-magnitude-versus- phase plot, and show that two Mloci are tangent to the G(jv)locus. Finally, plot the Bode diagram for the closed-loop transfer function. Solution. Figure 7–141 shows the Bode diagram of G(jv). Figure 7–142 shows the log-magni- tude-versus-phase plot of G(jv). It is seen that the G(jv)locus is tangent to the M=8 -dB locus atv=0.97 rad /H20862sec, and it is tangent to the M=–4 -dB locus at v=2.8 rad /H20862sec.G(s) =9 s(s+0.5)As 2 +0.6s +10B 546 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method 40 20 0dB –20 –40 0/H11034 –90/H11034 –180/H11034 –270/H11034 –360/H11034 0.1 0.2 0.4 1 2 4 10 v in rad/sec Figure 7–141 Bode diagram of G(s) given by Equation (7–32). Openmirrors.comExample Problems and Solutions 547Figure 7–143 shows the Bode diagram of the closed-loop transfer function. The magnitude curve of the closed-loop frequency response shows two resonant peaks. Note that such a caseoccurs when the closed-loop transfer function involves the product of two lightly damped second-order terms and the two corresponding resonant frequencies are sufficiently separated from each other. As a matter of fact, the closed-loop transfer function of this system can be written =9 As2+0.487s +1BAs2+0.613s +9B C(s) R(s)=G(s) 1+G(s)30 2418 12 6 0 –18–12–6 –360/H11034 –270/H11034 –180/H11034 –90/H11034M= 0.5 dB M=–2 dB M= 8 dBM= 2 dB M=–4 dB0.1 0.3 0.5 1 1.5 2 2.53 3.5 GGin dB Figure 7–142 Log-magnitude-versus-phase plot of G(s) given by Equation (7–32). 20 0 –20 –40 0° –90° –180° –270° –360° 0.1 0.2 0.4 0.6 1 2 4 6 10 v in rad/secdB Figure 7–143 Bode diagram of where G(s) is given by Equation (7–32).G(s) /H20862C1+G(s)D,Clearly, the denominator of the closed-loop transfer function is a product of two lightly damped second-order terms (the damping ratios are 0.243 and 0.102), and the two resonant frequencies are sufficiently separated. A–7–24. Consider the system shown in Figure 7–144(a). Design a compensator such that the closed-loop system will satisfy the requirements that the static velocity error constant =20 sec –1 ,phase margin =50 °, and gain margin G10 dB. Solution. To satisfy the requirements, we shall try a lead compensator G c (s)of the form (If the lead compensator does not work, then we need to employ a compensator of different form.) The compensated system is shown in Figure 7–144(b). Define where K= K c a. The first step in the design is to adjust the gain Kto meet the steady-state per- formance specification or to provide the required static velocity error constant. Since the static ve- locity error constant K v is given as 20 sec –1 , we have or K=2 With K=2, the compensated system will satisfy the steady-state requirement. We shall next plot the Bode diagram of G 1 (s)=20 s(s+1) =10K =20 =lim sS0 s10K s(s+1) =lim sS0 s Ts+1 aTs+1 G 1 (s) K v =lim sS0 sG c (s)G(s)G 1 (s)=KG(s) =10K s(s+1) =K c s+1 T s+1 aT G c (s)=K c a Ts+1 aTs+1 548 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method G c (s) G(s) G(s)10 s(s+ 1) (b) 10 s(s+ 1) (a) +– +– Figure 7–144 (a) Control system; (b) compensated system. Openmirrors.comExample Problems and Solutions 549MATLAB Program 7–24 produces the Bode diagram shown in Figure 7–145. From this plot, the phase margin is found to be 14°. The gain margin is ±qdB. Frequency (rad/sec)Bode Diagram of G1(s) = 20/[ s(s + 1)] −200−100 −150−50−100Phase (deg); Magnitude (dB)50 −500 10−1100101102Figure 7–145 Bode diagram ofG 1(s).MATLAB Program 7–24 num = [20]; den = [1 1 0];w = logspace(-1,2,100);bode(num,den,w)title('Bode Diagram of G1(s) = 20/[s(s + 1)]') Since the specification calls for a phase margin of 50°, the additional phase lead necessary to satisfy the phase-margin requirement is 36°. A lead compensator can contribute this amount. Noting that the addition of a lead compensator modifies the magnitude curve in the Bode di- agram, we realize that the gain crossover frequency will be shifted to the right.We must offset theincreased phase lag of G 1(jv)due to this increase in the gain crossover frequency.Taking the shift of the gain crossover frequency into consideration, we may assume that fm,the maximum phase lead required, is approximately 41°. (This means that approximately 5° has been added to com- pensate for the shift in the gain crossover frequency.) Since fm=41 ° corresponds to a=0.2077. Note that a=0.21 corresponds to fm=40.76 °. Whether we choose fm=41 ° or fm=40.76 ° does not make much difference in the final solution. Hence, let us choose a=0.21.sinfm=1-a 1+aOnce the attenuation factor ahas been determined on the basis of the required phase-lead angle, the next step is to determine the corner frequencies v=1/T andv=1/(aT)of the lead compensator. Notice that the maximum phase-lead angle f m occurs at the geometric mean of the two corner frequencies, or The amount of the modification in the magnitude curve at due to the inclusion of the term (Ts+1)/( aTs+1) is Note that We need to find the frequency point where, when the lead compensator is added, the total mag- nitude becomes 0 dB. From Figure 7–145 we see that the frequency point where the magnitude of G 1 (jv)is –6.7778 dB occurs between v=1 and 10 rad /H20862sec. Hence, we plot a new Bode diagram of G 1 (jv)in the frequency range between v=1 and 10 to locate the exact point where G 1 (jv)=–6.7778 dB. MATLAB Program 7–25 produces the Bode diagram in this frequency range, which is shown in Figure 7–146. From this diagram, we find the frequency point where occurs at v=6.5686 rad /H20862sec. Let us select this frequency to be the new gain crossover frequency, or v c =6.5686 rad /H20862sec. Noting that this frequency corresponds to or we obtain and 1 aT=v c 1a =6.5686 10.21 =14.33391 T=v c 1a =6.568610.21 =3.0101v c =1 1a T1/H20862A1a TB,@G 1 (jv)@=-6.7778 dB1 1a =1 10.21 =6.7778 dB 2 1+jvT 1+jvaT 2 v=1 1a T = 4 1+j1 1a 1+ja1 1a 4 =1 1a v=1/H20862A1a TBv=1/H20862A1a TB. 550 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method MATLAB Program 7–25 num = [20]; den = [1 1 0]; w = logspace(0,1,100); bode(num,den,w) title('Bode Diagram of G1(s) = 20/[s(s + 1)]') Openmirrors.comExample Problems and Solutions 551The lead compensator thus determined is where Kcis determined as Thus, the transfer function of the compensator becomes MATLAB Program 7–26 produces the Bode diagram of this lead compensator, which is shown in Figure 7–147.Gc(s)=9.5238s+3.0101 s+14.3339=20.3322 s+1 0.06976 s+1Kc=K a=2 0.21=9.5238Gc(s)=Kcs+3.0101 s+14.3339=Kca0.3322 s+1 0.06976 s+1Frequency (rad/sec)Bode Diagram of G1(s) = 20/[ s(s + 1)] −180−140−130 −150 −160 −170−120−20−100Phase (deg); Magnitude (dB)40 30 20 10 100101Figure 7–146 Bode diagram ofG 1(s). MATLAB Program 7–26 numc = [9.5238 28.6676]; denc = [1 14.3339];w = logspace(-1,3,100);bode(numc,denc,w)title('Bode Diagram of Gc(s) = 9.5238(s + 3.0101)/(s + 14.3339')552 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method Frequenc y (rad/sec)Bode Diagram of Gc(s) = 9.5238( s + 3.0101)/( s + 14.3339) 040 30 20 1060 505 Phase (deg); Magnitude (dB) 1020 15 10 −1 10 0 10 1 10 2 10 3 Figure 7–147 Bode diagram of G c (s). The open-loop transfer function of the designed system is MATLAB Program 7–27 will produce the Bode diagram of G c (s)G(s) , which is shown in Figure 7–148.=95.238 s+286.6759 s 3 +15.3339 s 2 +14.3339 sG c (s)G(s) =9.5238s+3.0101 s+14.333910 s(s+1) MATLAB Program 7–27 num = [95.238 286.6759]; den = [1 15.3339 14.3339 0]; sys = tf(num,den); w = logspace( –1,3,100); bode(sys,w); grid; title('Bode Diagram of Gc(s)G(s)') [Gm,pm,wcp,wcg] = margin(sys); GmdB = 20*log10(Gm); [Gmdb,pm,wcp,wcg] ans = Inf 49.4164 Inf 6.5686 Openmirrors.comExample Problems and Solutions 553From MATLAB Program 7–27 and Figure 7–148 it is clearly seen that the phase margin is ap- proximately 50° and the gain margin is ±q dB. Since the static velocity error constant Kvis 20 sec–1, all the specifications are met. Before we conclude this problem, we need to check the transient-response characteristics. Unit-Step Response: We shall compare the unit-step response of the compensated system with that of the original uncompensated system. The closed-loop transfer function of the original uncompensated system is The closed-loop transfer function of the compensated system is MATLAB Program 7–28 produces the unit-step responses of the uncompensated and compen- sated systems. The resulting response curves are shown in Figure 7–149. Clearly, the compensat-ed system exhibits a satisfactory response. Note that the closed-loop zero and poles are located as follows: Zero at s=–3.0101 Poles at s=–5.2880 ;j5.6824 ,s=–4.7579 Unit-Ramp Response: It is worthwhile to check the unit-ramp response of the compensated system. Since K v=20 sec–1, the steady-state error following the unit-ramp input will beC(s) R(s)=95.238 s+286.6759 s3+15.3339 s2+110.5719 s+286.6759C(s) R(s)=10 s2+s+10Frequenc y (rad/sec)Bode Diagram of Gc(s)G(s) −200−100 −150−50−100Phase (deg); Magnitude (dB)−5050 0 10−1100101102103Figure 7–148 Bode diagram ofG c(s)G(s).MATLAB Program 7–29 produces the unit-ramp response curves. [Note that the unit-ramp response is obtained as the unit-step response of C(s)/sR(s) .] The resulting curves are shown in Figure 7–150.The compensated system has a steady-state error equal to one-half that of the orig- inal uncompensated system. 554 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method Outputs 1.8 0.8 0 1.2 1.6 0.6 0.2 1 1.4 0.4 t Sec01 6 4 5 2 3 Unit-Step Responses of Uncompensated System and Compensated System Uncompensated system Compensated system Figure 7–149 Unit-step responses of the uncompensated and compensated systems. MATLAB Program 7–28 %*****Unit-step responses***** num1 = [10]; den1 = [1 1 10]; num2 = [95.238 286.6759]; den2 = [1 15.3339 110.5719 286.6759]; t = 0:0.01:6; [c1,x1,t] = step(num1,den1,t); [c2,x2,t] = step(num2,den2,t); plot(t,c1,'.',t,c2,'-') grid; title('Unit-Step Responses of Uncompensated System and Compensated System') xlabel('t Sec'); ylabel('Outputs') text(1.70,1.45,'Uncompensated System') text(1.1,0.5,'Compensated System') 1/K v =0.05 . The static velocity error constant of the uncompensated system is 10 sec –1 . Hence, the original uncompensated system will have twice as large a steady-state error in following the unit-ramp input. Openmirrors.comExample Problems and Solutions 555A–7–25. Consider a unity-feedback system whose open-loop transfer function is Design a lag–lead compensator Gc(s)such that the static velocity error constant is 10 sec–1, the phase margin is 50°, and the gain margin is 10 dB or more.G(s) =K s(s+1)(s +4)MATLAB Program 7–29 %*****Unit-ramp responses*****num1 = [10]; den1 = [1 1 10 0];num2 = [95.238 286.6759];den2 = [1 15.3339 110.5719 286.6759 0];t = 0:0.01:3;[c1,x1,t] = step(num1,den1,t);[c2,x2,t] = step(num2,den2,t);plot(t,c1,'.',t,c2,'-',t,t,'--');grid;title('Unit-Ramp Responses of Uncompensated System and Compensated System');xlabel('t Sec');ylabel('Outputs')text(1.2,0.65,'Uncompensated System')text(0.1,1.3,'Compensated System') Outputs3 022.5 1 0.51.5 t Sec0 0.5 3 2 2.5 1 1.5Unit-Ramp Responses of Uncompensated System and Compensated System Compensated System Uncompensated SystemFigure 7–150 Unit-ramp responsesof the uncompensated and compensated systems.Solution. We shall design a lag–lead compensator of the form Then the open-loop transfer function of the compensated system is G c (s)G(s) . Since the gain K of the plant is adjustable, let us assume that K c =1 . Then From the requirement on the static velocity error constant, we obtain Hence, K=40 We shall first plot a Bode diagram of the uncompensated system with K=40 . MATLAB Pro- gram 7–30 may be used to plot this Bode diagram.The diagram obtained is shown in Figure 7–151. =K 4=10 K v =lim sS0 sG c (s)G(s) =lim sS0 sG c (s) K s(s+1)(s +4)lim sS0 G c (s)=1.G c (s)=K c a s+1 T 1 ba s+1 T 2 b a s+b T 1 ba s+1 bT 2 b 556 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method MATLAB Program 7–30 num = [40]; den = [1 5 4 0]; w = logspace(-1,1,100); bode(num,den,w) title('Bode Diagram of G(s) = 40/[s(s + 1)(s + 4)]') Frequency (rad/sec) Bode Diagram of G(s) = 40/[ s(s + 1)( s + 4)] −250−100 −150 −200−50−40−200 Phase (deg); Magnitude (dB) 40 20 10 −1 10 0 10 1 Figure 7–151 Bode diagram of G(s) =40/H20862Cs(s+1)(s +4)D. Openmirrors.comExample Problems and Solutions 557From Figure 7–151, the phase margin of the gain-adjusted but uncompensated system is found to be –16°, which indicates that this system is unstable. The next step in the design of a lag–lead compensator is to choose a new gain crossover frequency. From the phase-angle curveforG(jv), we notice that the phase crossover frequency is v=2 rad /H20862sec. We may choose the new gain crossover frequency to be 2 rad /H20862sec so that the phase-lead angle required at v=2 rad /H20862sec is about 50°. A single lag–lead compensator can provide this amount of phase- lead angle quite easily. Once we choose the gain crossover frequency to be 2 rad /H20862sec, we can determine the corner frequencies of the phase-lag portion of the lag–lead compensator. Let us choose the corner frequency (which corresponds to the zero of the phase-lag portion of the compensator)to be 1 decade below the new gain crossover frequency, or at v=0.2 rad /H20862sec. For another corner frequency we need the value of b. The value of bcan be determined from the consideration of the lead portion of the compensator, as shown next. For the lead compensator, the maximum phase-lead angle f mis given by Notice that b=10 corresponds to fm=54.9 °. Since we need a 50° phase margin, we may choose b=10 . (Note that we will be using several degrees less than the maximum angle, 54.9°.) Thus, b=10 Then the corner frequency (which corresponds to the pole of the phase-lag portion of the compensator) becomes v=0.02 The transfer function of the phase-lag portion of the lag–lead compensator becomes The phase-lead portion can be determined as follows: Since the new gain crossover frequency isv=2 rad /H20862sec, from Figure 7–151, @G(j2)@is found to be 6 dB. Hence, if the lag–lead compen- sator contributes –6dB at v=2 rad /H20862sec, then the new gain crossover frequency is as desired. From this requirement, it is possible to draw a straight line of slope 20 dB/decade passing through the point (2 rad /H20862sec,–6dB). (Such a line has been manually drawn on Figure 7–151.) The intersec- tions of this line and the 0-dB line and –20-dB line determine the corner frequencies. From this consideration, the corner frequencies for the lead portion can be determined as v=0.4 rad /H20862sec andv=4 rad /H20862sec. Thus, the transfer function of the lead portion of the lag–lead compensator becomes Combining the transfer functions of the lag and lead portions of the compensator, we can obtain the transfer function Gc(s)of the lag–lead compensator. Since we chose Kc=1 , we have Gc(s)=s+0.4 s+4s+0.2 s+0.02=(2.5s+1)(5s+1) (0.25s+1)(50s+1)s+0.4 s+4=1 10a2.5s +1 0.25s +1bs+0.2 s+0.02=10a5s+1 50s +1bv=1/H20862AbT2Bsinfm=b-1 b+1v=1/H20862AbT2B,v=1/H20862T2The open-loop transfer function of the compensated system is Using MATLAB Program 7–32 the magnitude and phase-angle curves of the designed open-loop transfer function G c (s)G(s) can be obtained as shown in Figure 7–153. Note that the denominator polynomial den1 was obtained using the conv command, as follows: =40s 2 +24s +3.2 s 5 +9.02s 4 +24.18s 3 +16.48s 2 +0.32s G c (s)G(s) =(s+0.4)(s +0.2) (s+4)(s +0.02) 40 s(s+1)(s +4) 558 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method MATLAB Program 7–31 numc = [1 0.6 0.08]; denc = [1 4.02 0.08]; bode(numc,denc) title('Bode Diagram of Lag–Lead Compensator') Frequency (rad/sec)Bode Diagram of Lag-Lead Compensator −50050−20−15 Phase (deg); Magnitude (dB) −100 −5 10 −3 10 −2 10 −1 10 0 10 1 10 2 Figure 7–152 Bode diagram of the designed lag–lead compensator. a = [1 4.02 0.08]; b = [1 5 4 0]; conv(a,b) ans = 1.0000 9.0200 24.1800 16.4800 0.320000 0 The Bode diagram of the lag–lead compensator G c (s)can be obtained by entering MATLAB Program 7–31 into the computer. The resulting plot is shown in Figure 7–152. Openmirrors.comExample Problems and Solutions 559Since the phase margin of the compensated system is 50°, the gain margin is 12 dB, and the static velocity error constant is 10 sec–1, all the requirements are met. We shall next investigate the transient-response characteristics of the designed system. Unit-Step Response: Noting that we have To determine the denominator polynomial with MATLAB, we may proceed as follows: Define c(s) =40(s +0.4)(s +0.2) =40s2+24s +3.2 b(s) =s(s+1)(s +4)=s3+5s2+4s a(s) =(s+4)(s +0.02) =s2+4.02s +0.08 =40(s +0.4)(s +0.2) (s+4)(s +0.02)s(s +1)(s +4)+40(s +0.4)(s +0.2) C(s) R(s)=Gc(s)G(s) 1+Gc(s)G(s)Gc(s)G(s) =40(s +0.4)(s +0.2) (s+4)(s +0.02)s(s +1)(s +4)MATLAB Program 7–32 num1 = [40 24 3.2]; den1 = [1 9.02 24.18 16.48 0.32 0];bode(num1,den1)title('Bode Diagram of Gc(s)G(s)') Frequency (rad/sec)Bode Diagram of Gc(s)G(s) −300−250−200−150−100−500−100Phase (deg); Magnitude (dB)−50050100 10−410−310−210−1100101102Figure 7–153 Bode diagram of theopen-loop transfer function G c(s)G(s) of the compensatedsystem.Then we have a = [1 4.02 0.08] b = [1 5 4 0] c = [40 24 3.2] Using the following MATLAB program, we obtain the denominator polynomial. 560 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method a = [1 4.02 0.08]; b = [1 5 4 0]; c = [40 24 3.2]; p = [conv(a,b)] + [0 0 0 c] p = 1.0000 9.0200 24.1800 56.4800 24.3200 3.2000 MATLAB Program 7–33 %*****Unit-step response**** num = [40 24 3.2]; den = [1 9.02 24.18 56.48 24.32 3.2]; t = 0:0.2:40; step(num,den,t) grid title('Unit-Step Response of Compensated System') Amplitude 1.2 0.4 0 1 0.2 0.6 0.8Unit-Step Response of Compensated System Time (sec)01 0 5 40 30 35 25 15 20 Figure 7–154 Unit-step response curve of the compensated system.MATLAB Program 7–33 is used to obtain the unit-step response of the compensated system. The resulting unit-step response curve is shown in Figure 7–154. (Note that the gain-adjusted but uncompensated system is unstable.) Openmirrors.comProblems 561Unit-Ramp Response: The unit-ramp response of the compensated system may be obtained by entering MATLAB Program 7–34 into the computer. Here we converted the unit-ramp responseofG cG/A1+ GcGBinto the unit-step response of GcG/CsA1+ GcGBD. The unit-ramp response curve obtained using this program is shown in Figure 7–155. MATLAB Program 7–34 %*****Unit-ramp response*****num = [40 24 3.2]; den = [1 9.02 24.18 56.48 24.32 3.2 0];t = 0:0.05:20;c = step(num,den,t);plot(t,c,'-',t,t,'.')gridtitle('Unit-Ramp Response of Compensated System')xlabel('Time (sec)')ylabel('Unit-Ramp Input and Output c(t)')Unit-Ramp Input and Output c(t)20 8 01218 4 216 1014 6 Time (sec)04 2 20 14 18 12 16 8 6 10Unit-Ramp Response of Compensated System Figure 7–155 Unit-ramp responseof the compensated system. PROBLEMS B–7–1. Consider the unity-feedback system with the open- loop transfer function: G(s) =10 s+1Obtain the steady-state output of the system when it is sub- jected to each of the following inputs: (a) r(t)= sin(t+30 °) (b) r(t)=2 cos(2t-45 °) (c) r(t)= sin(t+30 °)- 2 cos (2t-45 °)562 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method B–7–2. Consider the system whose closed-loop transfer function is Obtain the steady-state output of the system when it is sub- jected to the input r(t)=R sinvt. B–7–3. Using MATLAB, plot Bode diagrams of G 1 (s)and G 2 (s)given below. G 1 (s)is a minimum-phase system and G 2 (s)is a nonmini- mum-phase system. B–7–4. Plot the Bode diagram of B–7–5. Given show that B–7–6. Consider a unity-feedback control system with the following open-loop transfer function: This is a nonminimum-phase system. Two of the three open-loop poles are located in the right-half splane as follows: Plot the Bode diagram of G(s) with MATLAB. Explain why the phase-angle curve starts from 0° and approaches ±180 °. s=0.2328 -j0.7926 s=0.2328 +j0.7926 Open-loop poles at s=-1.4656G(s) =s+0.5 s 3 +s 2 +1@GAjv n B@=1 2zG(s) =v 2 n s 2 +2zv n s+v 2 n G(s) =10As 2 +0.4s +1B sAs 2 +0.8s +9B G 2 (s)=1-s 1+2s G 1 (s)=1+s 1+2sC(s) R(s)=KAT 2 s+1B T 1 s+1B–7–7. Sketch the polar plots of the open-loop transfer function for the following two cases: (a) (b) B–7–8. Draw a Nyquist locus for the unity-feedback control system with the open-loop transfer function Using the Nyquist stability criterion, determine the stabili- ty of the closed-loop system. B–7–9. A system with the open-loop transfer function is inherently unstable.This system can be stabilized by adding derivative control. Sketch the polar plots for the open-loop transfer function with and without derivative control. B–7–10. Consider the closed-loop system with the following open-loop transfer function: Plot both the direct and inverse polar plots of G(s)H(s) with K=1 and K=10 . Apply the Nyquist stability crite- rion to the plots, and determine the stability of the system with these values of K. B–7–11. Consider the closed-loop system whose open-loop transfer function is Find the maximum value of Kfor which the system is stable. B–7–12. Draw a Nyquist plot of the following G(s) : B–7–13. Consider a unity-feedback control system with the following open-loop transfer function: Draw a Nyquist plot of G(s) and examine the stability of the system.G(s) =1 s 3 +0.2s 2 +s+1G(s) =1 sAs 2 +0.8s +1BG(s)H(s) =Ke -2s sG(s)H(s) =10K(s +0.5) s 2 (s+2)(s +10)G(s)H(s) =K s 2 AT 1 s+1BG(s) =K(1 -s) s+1T7T a 70, T7T b 70T a 7T70, T b 7T70G(s)H(s) =KAT a s+1BAT b s+1B s 2 (Ts +1) Openmirrors.comProblems 563B–7–14. Consider a unity-feedback control system with the following open-loop transfer function: Draw a Nyquist plot of G(s) and examine the stability of the closed-loop system. B–7–15. Consider the unity-feedback system with the fol- lowing G(s) : Suppose that we choose the Nyquist path as shown in Fig- ure 7–156. Draw the corresponding G(jv)locus in the G(s) plane. Using the Nyquist stability criterion, determine thestability of the system.G(s) =1 s(s-1)G(s) =s2+2s+1 s3+0.2s2+s+1 B–7–16. Consider the closed-loop system shown in Figure 7–157. G(s) has no poles in the right-half splane. If the Nyquist plot of G(s) is as shown in Figure 7–158(a), is this system stable? If the Nyquist plot is as shown in Figure 7–158(b), is this system stable?jv s` e Figure 7–156 Nyquist path. G(s) +– Figure 7–157 Closed-loop system.B–7–17. A Nyquist plot of a unity-feedback system with the feedforward transfer function G(s) is shown in Figure 7–159. IfG(s) has one pole in the right-half splane, is the sys- tem stable? IfG(s) has no pole in the right-half splane, but has one zero in the right-half splane, is the system stable?Figure 7–158 Nyquist plots. 0 –1R eIm G(jv) Figure 7–159 Nyquist plot.0R eIm –1 (a) ReIm 0 –1 (b)B–7–18. Consider the unity-feedback control system with the following open-loop transfer function G(s) : Plot Nyquist diagrams of G(s) forK=1, 10 , and 100. B–7–19. Consider a negative-feedback system with the fol- lowing open-loop transfer function: Plot the Nyquist diagram of G(s). If the system were a pos- itive-feedback one with the same open-loop transfer func- tion G(s), what would the Nyquist diagram look like? B–7–20. Consider the control system shown in Figure 7–160. Plot Nyquist diagrams of G(s), where fork=0.3, 0.5 , and 0.7. =10 s 3 +6s 2 +(5+10k)s G(s) =10 sC(s+1)(s +5)+10kDG(s) =2 s(s+1)(s +2)G(s) =K(s +2) s(s+1)(s +10) 564 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method k 1 s 10 (s+ 1) (s+ 5) +– +– Figure 7–160 Control system.B–7–22. Referring to Problem B–7–21 , it is desired to plot only for v>0 . Write a MATLAB program to produce such a plot. If it is desired to plot for –q<v<q, what changes must be made in the MATLAB program? B–7–23. Consider the unity-feedback control system whose open-loop transfer function is Determine the value of aso that the phase margin is 45°. B–7–24. Consider the system shown in Figure 7–161. Draw a Bode diagram of the open-loop transfer function G(s) . Determine the phase margin and gain margin.G(s) =as+1 s 2 Y 1 (jv)/H20862U 1 (jv)Y 1 (jv)/H20862U 1 (jv) G(s) 25 s(s+ 1) (s+ 10) +– Figure 7–161 Control system. G(s) 20(s+ 1) s(s 2 + 2s+ 10) ( s+ 5) +– Figure 7–162 Control system.B–7–21. Consider the system defined by There are four individual Nyquist plots involved in this sys- tem. Draw two Nyquist plots for the input u 1 in one dia- gram and two Nyquist plots for the input u 2 in another diagram. Write a MATLAB program to obtain these two diagrams. B y 1 y 2 R = B 1 00 1 RB x 1 x 2 R + B 0 00 0 RB u 1 u 2 R B x# 1 x# 2 R = B -1 6.5-1 0 RB x 1 x 2 R + B 1 11 0 RB u 1 u 2 R B–7–25. Consider the system shown in Figure 7–162. Draw a Bode diagram of the open-loop transfer function G(s) . Determine the phase margin and gain margin with MATLAB. Openmirrors.comProblems 565B–7–26. Consider a unity-feedback control system with the open-loop transfer function Determine the value of the gain Ksuch that the phase margin is 50°. What is the gain margin with this gain K? B–7–27. Consider the system shown in Figure 7–163. Draw a Bode diagram of the open-loop transfer function, and determine the value of the gain Ksuch that the phase margin is 50°. What is the gain margin of this system withthis gain K?G(s) =K sAs2+s+4B 10 s(s+ 1)Ks+ 0.1 s+ 0.5+– Figure 7–163 Control system.B–7–28. Consider a unity-feedback control system whose open-loop transfer function is Determine the value of the gain Ksuch that the resonant peak magnitude in the frequency response is 2 dB, or Mr=2 dB. B–7–29. A Bode diagram of the open-loop transfer function G(s) of a unity-feedback control system is shown in Figure 7–164. It is known that the open-loop transfer function isminimum phase. From the diagram, it can be seen that thereis a pair of complex-conjugate poles at v=2 rad /H20862sec. Determine the damping ratio of the quadratic term involv-ing these complex-conjugate poles. Also, determine the transfer function G(s) .G(s) =K sAs2+s+0.5B 40 20 –20 dB0 –40 –60 –80 0.1 0.2 0.4 0.6 1 4 2 6 10 20 60 40 100–270°–180°–90°0° v in rad/sec Figure 7–164 Bode diagram of the open-loop transfer function of a unity- feedback control system.566 Chapter 7 / Control Systems Analysis and Design by the Frequency-Response Method B–7–30. Draw Bode diagrams of the PI controller given by and the PD controller given by B–7–31. Figure 7–165 shows a block diagram of a space- vehicle attitude-control system. Determine the proportional gain constant K p and derivative time such that the band- width of the closed-loop system is 0.4 to 0.5 rad /H20862sec. (Note that the closed-loop bandwidth is close to the gain crossover frequency.) The system must have an adequate phase mar- gin. Plot both the open-loop and closed-loop frequency re- sponse curves on Bode diagrams.T d G c (s)=5(1 +0.5s)G c (s)=5 a 1+1 2s b K p (1+T d s)1 s 2 +– G c (s)K s(0.1s+ 1)(s+ 1) +– Figure 7–166 Closed-loop system.B–7–32. Referring to the closed-loop system shown in Fig- ure 7–166, design a lead compensator G c (s)such that the phase margin is 45°, gain margin is not less than 8 dB, and the static velocity error constant K v is 4.0 sec –1 . Plot unit-step and unit-ramp response curves of the compensated system with MATLAB. B–7–33. Consider the system shown in Figure 7–167. It is desired to design a compensator such that the static velocity error constant is 4 sec –1 , phase margin is 50°, and gain margin is 8 dB or more. Plot the unit-step and unit- ramp response curves of the compensated system with MATLAB. G c (s) 1Hydraulic servo1 s Aircraft2s+ 0.1 s 2 + 0.1s+ 4 Rate gyroC R +– Figure 7–167 Control system. G c (s)1 s(s+ 1)(s+ 5) +– Figure 7–168 Control system.B–7–34. Consider the system shown in Figure 7–168. De- sign a lag–lead compensator such that the static velocity error constant K v is 20 sec –1 , phase margin is 60°, and gain margin is not less than 8 dB. Plot the unit-step and unit- ramp response curves of the compensated system with MATLAB.Figure 7–165 Block diagram of space-vehicle attitude-control system. Openmirrors.com8 567PID Controllers and Modified PID Controllers 8–1 INTRODUCTION In previous chapters, we occasionally discussed the basic PID controllers. For example, we presented electronic, hydraulic, and pneumatic PID controllers. We also designedcontrol systems where PID controllers were involved. It is interesting to note that more than half of the industrial controllers in use today are PID controllers or modified PID controllers. Because most PID controllers are adjusted on-site, many different types of tuning rules have been proposed in the literature. Using these tuning rules, delicate and fine tun-ing of PID controllers can be made on-site. Also, automatic tuning methods have beendeveloped and some of the PID controllers may possess on-line automatic tuningcapabilities. Modified forms of PID control, such as I-PD control and multi-degrees-of-freedom PID control, are currently in use in industry. Many practical methods for bump-less switching (from manual operation to automatic operation) and gain scheduling arecommercially available. The usefulness of PID controls lies in their general applicability to most control sys- tems. In particular, when the mathematical model of the plant is not known and there-fore analytical design methods cannot be used, PID controls prove to be most useful. Inthe field of process control systems, it is well known that the basic and modified PID con-trol schemes have proved their usefulness in providing satisfactory control, although inmany given situations they may not provide optimal control. In this chapter we first present the design of a PID controlled system using Ziegler and Nichols tuning rules.We next discuss a design of PID controller with the conventional568 Chapter 8 / PID Controllers and Modified PID Controllers Plant K p (1++ T d s)1 T i s +– Figure 8–1 PID control of a plant. frequency-response approach, followed by the computational optimization approach to design PID controllers. Then we introduce modified PID controls such as PI-D control and I-PD control.Then we introduce multi-degrees-of-freedom control systems, which can satisfy conflicting requirements that single-degree-of-freedom control systems cannot. (For the definition of multi-degrees-of-freedom control systems, see Section 8–6.) In practical cases, there may be one requirement on the response to disturbance input and another requirement on the response to reference input. Often these two re- quirements conflict with each other and cannot be satisfied in the single-degree-of- freedom case. By increasing the degrees of freedom, we are able to satisfy both. In this chapter we present two-degrees-of-freedom control systems in detail. The computational optimization approach presented in this chapter to design con- trol systems (such as to search optimal sets of parameter values to satisfy given transient response specifications) can be used to design both single-degree-of-freedom control sys- tems and multi-degrees-of-freedom control systems, provided a fairly precice mathe- matical model of the plant is known. Outline of the Chapter. Section 8–1 has presented introductory material for the chapter. Section 8–2 deals with a design of a PID controller with Ziegler–Nichols Rules. Section 8–3 treats a design of a PID controller with the frequency-response approach. Section 8–4 presents a computational optimization approach to obtain optimal param- eter values of PID controllers. Section 8–5 discusses multi-degrees-of-freedom control systems including modified PID control systems. 8–2 ZIEGLER–NICHOLS RULES FOR TUNING PID CONTROLLERS PID Control of Plants. Figure 8–1 shows a PID control of a plant. If a mathe- matical model of the plant can be derived, then it is possible to apply various design techniques for determining parameters of the controller that will meet the transient and steady-state specifications of the closed-loop system. However, if the plant is so com- plicated that its mathematical model cannot be easily obtained, then an analytical or computational approach to the design of a PID controller is not possible.Then we must resort to experimental approaches to the tuning of PID controllers. The process of selecting the controller parameters to meet given performance spec- ifications is known as controller tuning. Ziegler and Nichols suggested rules for tuning PID controllers (meaning to set values and ) based on experimental step responses or based on the value of that results in marginal stability when only pro- portional control action is used. Ziegler–Nichols rules, which are briefly presented in the following, are useful when mathematical models of plants are not known. (These rules can, of course, be applied to the design of systems with known mathematicalK p T d T i , K p , Openmirrors.comSection 8–2 / Ziegler–Nichols Rules for Tuning PID Controllers 569Plant u(t) c(t)1Figure 8–2 Unit-step response of a plant. Tangent line at inflection point K 0c(t) t LTFigure 8–3 S-shaped responsecurve.models.) Such rules suggest a set of values of and that will give a stable oper- ation of the system. However, the resulting system may exhibit a large maximum over-shoot in the step response, which is unacceptable. In such a case we need series of finetunings until an acceptable result is obtained. In fact, the Ziegler–Nichols tuning rulesgive an educated guess for the parameter values and provide a starting point for fine tun-ing, rather than giving the final settings for and in a single shot. Ziegler–Nichols Rules for Tuning PID Controllers. Ziegler and Nichols pro- posed rules for determining values of the proportional gain integral time and de-rivative time based on the transient response characteristics of a given plant. Suchdetermination of the parameters of PID controllers or tuning of PID controllers can bemade by engineers on-site by experiments on the plant. (Numerous tuning rules for PIDcontrollers have been proposed since the Ziegler–Nichols proposal. They are availablein the literature and from the manufacturers of such controllers.) There are two methods called Ziegler–Nichols tuning rules: the first method and the second method. We shall give a brief presentation of these two methods. First Method. In the first method, we obtain experimentally the response of the plant to a unit-step input, as shown in Figure 8–2. If the plant involves neither integra-tor(s) nor dominant complex-conjugate poles, then such a unit-step response curve maylook S-shaped, as shown in Figure 8–3. This method applies if the response to a stepinput exhibits an S-shaped curve. Such step-response curves may be generated experi-mentally or from a dynamic simulation of the plant. The S-shaped curve may be characterized by two constants, delay time Land time constant T.The delay time and time constant are determined by drawing a tangent line at the inflection point of the S-shaped curve and determining the intersections of thetangent line with the time axis and line c(t)=K, as shown in Figure 8–3. The transferT dTi , Kp ,Td Kp ,Ti ,Td Kp ,Ti ,570 Chapter 8 / PID Controllers and Modified PID Controllers K p Plantr(t) c(t) u(t) +– Figure 8–4 Closed-loop system with a proportional controller. function C(s)/U(s) may then be approximated by a first-order system with a transport lag as follows: Ziegler and Nichols suggested to set the values of and according to the formula shown in Table 8–1. Notice that the PID controller tuned by the first method of Ziegler–Nichols rules gives Thus, the PID controller has a pole at the origin and double zeros at s=–1/L. Second Method. In the second method, we first set and Using the proportional control action only (see Figure 8–4), increase K p from 0 to a critical value K cr at which the output first exhibits sustained oscillations. (If the output does not ex- hibit sustained oscillations for whatever value K p may take, then this method does not apply.) Thus, the critical gain K cr and the corresponding period are experimentally P cr T d =0. T i =q =0.6T a s+1 L b 2 s =1.2 T L a 1+1 2Ls+0.5Ls b G c (s)=K p a 1+1 T i s+T d s b T d T i , K p ,C(s) U(s)=Ke -Ls Ts+1 Type of Controller P q 0 PI 0 PID 2L 0.5L 1.2T LL 0.30.9T LT LT d T i K p Table 8–1 Ziegler–Nichols Tuning Rule Based on Step Response of Plant (First Method) Openmirrors.comSection 8–2 / Ziegler–Nichols Rules for Tuning PID Controllers 571Pcr 0 tc(t) Figure 8–5 Sustained oscillationwith period ( is measured in sec.)P cr Pcr . Type of Controller P 0.5 Kcr q 0 PI 0.45 Kcr 0 PID 0.6 Kcr 0.125Pcr 0.5Pcr1 1.2PcrTd Ti KpTable 8–2 Ziegler–Nichols Tuning Rule Based on Critical Gain Kcrand Critical Period (Second Method) Pcrdetermined (see Figure 8–5). Ziegler and Nichols suggested that we set the values of the parameters and according to the formula shown in Table 8–2. Td Kp ,Ti , Notice that the PID controller tuned by the second method of Ziegler–Nichols rules gives Thus, the PID controller has a pole at the origin and double zeros at Note that if the system has a known mathematical model (such as the transfer func- tion), then we can use the root-locus method to find the critical gain Kcrand the fre- quency of the sustained oscillations vcr, where These values can be found from the crossing points of the root-locus branches with the jvaxis. (Obviously, if the root-locus branches do not cross the jvaxis, this method does not apply.)2p/H20862vcr=Pcr .s=-4/H20862Pcr . =0.075Kcr Pcr as+4 Pcrb2 s =0.6Kcra1+1 0.5Pcr s+0.125Pcr sb Gc(s)=Kpa1+1 Ti s+Td sb572 Chapter 8 / PID Controllers and Modified PID Controllers G c (s) PID controller1 s(s+ 1)(s+ 5) C(s) R(s) +– Figure 8–6 PID-controlled system. Comments. Ziegler–Nichols tuning rules (and other tuning rules presented in the literature) have been widely used to tune PID controllers in process control systems where the plant dynamics are not precisely known. Over many years, such tuning rules proved to be very useful. Ziegler–Nichols tuning rules can, of course, be applied to plants whose dynamics are known. (If the plant dynamics are known, many analytical and graphical approaches to the design of PID controllers are available, in addition to Ziegler–Nichols tuning rules.) EXAMPLE 8–1 Consider the control system shown in Figure 8–6 in which a PID controller is used to control the system. The PID controller has the transfer function Although many analytical methods are available for the design of a PID controller for the pres- ent system, let us apply a Ziegler–Nichols tuning rule for the determination of the values of pa- rameters and Then obtain a unit-step response curve and check to see if the designed system exhibits approximately 25 %maximum overshoot. If the maximum overshoot is excessive (40%or more), make a fine tuning and reduce the amount of the maximum overshoot to ap- proximately 25 %or less. Since the plant has an integrator, we use the second method of Ziegler–Nichols tuning rules. By setting and we obtain the closed-loop transfer function as follows: The value of K p that makes the system marginally stable so that sustained oscillation occurs can be obtained by use of Routh’s stability criterion. Since the characteristic equation for the closed-loop system is s 3 +6s 2 +5s+ K p =0 the Routh array becomes as follows: s 3 s 2 s 1 s 0 1 6 30-K p 6 K p 5 K p C(s) R(s)=K p s(s+1)(s +5)+K p T d =0, T i =qT d . T i , K p ,G c (s)=K p a 1+1 T i s+T d s b Openmirrors.comSection 8–2 / Ziegler–Nichols Rules for Tuning PID Controllers 573PID controller1 s(s+ 1)(s+ 5) 6.3223 ( s+ 1.4235)2 sC(s) R(s) +–Figure 8–7 Block diagram of thesystem with PID controller designed by use of theZiegler–Nicholstuning rule (secondmethod).Examining the coefficients of the first column of the Routh table, we find that sustained oscilla- tion will occur if Thus, the critical gain K cris Kcr=30 With gain Kpset equal to the characteristic equation becomes s3+6s2+5s+30=0 To find the frequency of the sustained oscillation, we substitute s=jvinto this characteristic equation as follows: (jv)3+6(jv)2+5(jv)+30=0 or 6A5-v2B+jvA5-v2B=0 from which we find the frequency of the sustained oscillation to be or Hence, the period of sustained oscillation is Referring to Table 8–2, we determine and as follows: The transfer function of the PID controller is thus The PID controller has a pole at the origin and double zero at s=–1.4235. A block diagram of the control system with the designed PID controller is shown in Figure 8–7. =6.3223(s +1.4235)2 s =18a1+1 1.405s+0.35124sb Gc(s)=Kpa1+1 Ti s+Td sb Td=0.125Pcr=0.35124 Ti=0.5Pcr=1.405 Kp=0.6Kcr=18Td Ti , Kp ,Pcr=2p v=2p 15=2.8099v=15. v2=5Kcr(=30),Kp=30.574 Chapter 8 / PID Controllers and Modified PID Controllers Next, let us examine the unit-step response of the system. The closed-loop transfer function C(s)/R(s) is given by The unit-step response of this system can be obtained easily with MATLAB. See MATLAB Program 8–1. The resulting unit-step response curve is shown in Figure 8–8. The maximum overshoot in the unit-step response is approximately 62 %.The amount of maximum overshoot is excessive. It can be reduced by fine tuning the controller parameters. Such fine tuning can be made on the computer. We find that by keeping and by moving the double zero of the PID controller to s=–0.65 —that is, using the PID controller (8–1) the maximum overshoot in the unit-step response can be reduced to approximately 18 %(see Figure 8–9). If the proportional gain K p is increased to 39.42, without changing the location of the double zero (s=–0.65), that is, using the PID controller (8–2) G c (s)=39.42 a 1+1 3.077s+0.7692s b =30.322(s+0.65) 2 sG c (s)=18 a 1+1 3.077s+0.7692s b =13.846(s+0.65) 2 sK p =18C(s) R(s)=6.3223s 2 +18s +12.811 s 4 +6s 3 +11.3223s 2 +18s +12.811 MATLAB Program 8–1 % ---------- Unit-step response ---------- num = [6.3223 18 12.811]; den = [1 6 11.3223 18 12.811]; step(num,den) grid title('Unit-Step Response') Unit-Step Response Time (sec)02 14 12 8 10 4 6 Amplitude 00.81.8 1.2 0.6 0.2 1.4 1.6 1 0.4 Figure 8–8 Unit-step response curve of PID- controlled system designed by use of the Ziegler–Nichols tuning rule (second method). Openmirrors.comSection 8–2 / Ziegler–Nichols Rules for Tuning PID Controllers 575Unit-Step ResponseAmplitude 00.61.2 0.8 0.4 0.21 Time (sec)01 7 6 4 5 2 3Figure 8–9 Unit-step response ofthe system shown inFigure 8–6 with PIDcontroller havingparameters and T d=0.7692.Ti=3.077,Kp=18, Amplitude1.4 0.8 0.4 011.2 0.6 0.2Unit-Step Response Time (sec)0 0.5 5 4.5 3 3.5 4 1 1.5 2 2.5Figure 8–10 Unit-step response ofthe system shown inFigure 8–6 with PIDcontroller havingparameters and T d=0.7692.Ti=3.077,Kp=39.42,then the speed of response is increased, but the maximum overshoot is also increased to approxi- mately 28 %, as shown in Figure 8–10. Since the maximum overshoot in this case is fairly close to 25 % and the response is faster than the system with given by Equation (8–1), we may consider as given by Equation (8–2) as acceptable. Then the tuned values of and become It is interesting to observe that these values respectively are approximately twice the values sug- gested by the second method of the Ziegler–Nichols tuning rule.The important thing to note hereis that the Ziegler–Nichols tuning rule has provided a starting point for fine tuning. It is instructive to note that, for the case where the double zero is located at s=–1.4235, in- creasing the value of K pincreases the speed of response, but as far as the percentage maximum overshoot is concerned, varying gain Kphas very little effect.The reason for this may be seen fromKp=39.42, Ti=3.077, Td=0.7692Td Ti , Kp ,Gc(s) Gc(s)576 Chapter 8 / PID Controllers and Modified PID Controllers the root-locus analysis. Figure 8–11 shows the root-locus diagram for the system designed by use of the second method of Ziegler–Nichols tuning rules. Since the dominant branches of root loci are along the lines for a considerable range of K,varying the value of K(from 6 to 30) will not change the damping ratio of the dominant closed-loop poles very much. However, varying the lo- cation of the double zero has a significant effect on the maximum overshoot, because the damping ratio of the dominant closed-loop poles can be changed significantly.This can also be seen from the root-locus analysis. Figure 8–12 shows the root-locus diagram for the system where the PID controller has the double zero at s=–0.65. Notice the change of the root-locus configuration.This change in the configuration makes it possible to change the damping ratio of the dominant closed-loop poles. In Figure 8–12, notice that, in the case where the system has gain K=30.322, the closed-loop poles at s=–2.35_j4.82 act as dominant poles.Two additional closed-loop poles are very near the double zero at s=–0.65, with the result that these closed-loop poles and the double zero almost can- cel each other.The dominant pair of closed-loop poles indeed determines the nature of the response. On the other hand, when the system has K=13.846, the closed-loop poles at s=–2.35_j2.62 are not quite dominant because the two other closed-loop poles near the double zero at s=–0.65 have considerable effect on the response. The maximum overshoot in the step response in this case (18 %) is much larger than the case where the system is of second order and having only dominant closed-loop poles. (In the latter case the maximum overshoot in the step response would be approximately 6 %.) It is possible to make a third, a fourth, and still further trials to obtain a better response. But this will take a lot of computations and time. If more trials are desired, it is desirable to use the computational approach presented in Section 10–3. Problem A–8–12 solves this problem with the computational approach with MATLAB. It finds sets of parameter values that will yield the maximum overshoot of 10 %or less and the settling time of 3 sec or less.A solution to the present problem obtained in Problem A–8–12 is that for the PID controller defined by G c (s)=K(s+a) 2 sz=0.3 1 s(s+ 1)(s+ 5) jv j3 j2 j1 –j3–j2–j1–3 –2 –1 –4 –51 0 sK= 6.32 K= 6.32K= 6.32 K= 6.32z= 0.3 z= 0.3K(s+ 1.4235) 2 s+– Figure 8–11 Root-locus diagram of system when PID controller has double zero at s=–1.4235. Openmirrors.comSection 8–3 / Design of PID Controllers with Frequency-Response Approach 5771 s(s+ 1)(s+5)K(s+ 0.65)2 sjv j8 j6 j4 j2 –j6 –j8–j4–j2–6 –4 –2 –8 –10 2 0 sK= 60 K= 30.322 K= 30.322K= 13.846 K= 13.846K= 13.846 K= 60z= 0.358 z= 0.67+– Figure 8–12 Root-locus diagram of system when PID controller has double zero at s=–0.65. K=13.846corresponds to given by Equation (8–1) andK=30.322 corresponds to given by Equation (8–2).G c(s)Gc(s) the values of Kandaare K=29, a=0.25 with the maximum overshoot equal to 9.52 %and settling time equal to 1.78 sec.Another possible solution obtained there is that K=27, a=0.2 with the 5.5 %maximum overshoot and 2.89 sec of settling time. See Problem A–8–12 for details. 8–3 DESIGN OF PID CONTROLLERS WITH FREQUENCY-RESPONSE APPROACH In this section we present a design of a PID controller based on the frequency-response approach. Consider the system shown in Figure 8–13. Using a frequency-response approach, de- sign a PID controller such that the static velocity error constant is 4 sec−1, phase margin is 50° or more, and gain margin is 10 dB or more. Obtain the unit-step and unit-rampresponse curves of the PID controlled system with MATLAB. Let us choose the PID controller to be G c(s)=K(as +1)(bs +1) sSince the static velocity error constant K v is specified as 4 sec –1 , we have Thus Next, we plot a Bode diagram of MATLAB Program 8–2 produces a Bode diagram of G(s) .The resulting Bode diagram is shown in Figure 8–14.G(s) =4 sAs 2 +1BG c (s)=4(as+1)(bs +1) s=K=4K v =lim sS0 sG c (s)1 s 2 +1=lim sS0 sK(as +1)(bs +1) s1 s 2 +1 578 Chapter 8 / PID Controllers and Modified PID Controllers Figure 8–13 Control system. G c (s)1 s 2 + 1 +– MATLAB Program 8–2 num = [4]; den = [1 0.00000000001 1 0]; w = logspace(-1,1,200); bode(num,den,w) title('Bode Diagram of 4/[s(s^2+1)]') Frequency (rad/sec) Bode Diagram of 4/[ s(s 2 + 1)] −300−100−50 −150 −200 −2500−500 Phase (deg); Magnitude (dB) 50 10 −1 10 0 10 1 Figure 8–14 Bode diagram of 4/CsAs 2 +1BD. Openmirrors.comSection 8–3 / Design of PID Controllers with Frequency-Response Approach 579MATLAB Program 8–3 num = [20 4]; den = [1 0.00000000001 1 0];w = logspace(-2,1,101);bode(num,den,w)title('Bode Diagram of G(s) = 4(5s+1)/[s(s^2+1)]') Frequency (rad/sec)Bode Diagram of G(s) = 4(5 s + 1)/[ s(s2 + 1)] −200−50 −100 −1500−200Phase (deg); Magnitude (dB)60 2040 10−210−1100101Figure 8–15 Bode diagram ofG(s)=4(5s+1)/CsAs 2+1BD.We need the phase margin of at least 50° and gain margin of 10 dB or more. From the Bode diagram of Figure 8–14, we notice that the gain crossover frequency is approximately v=1.8 rad /H20862sec. Let us assume the gain crossover frequency of the compensated system to be somewhere between v=1 andv=10 rad /H20862sec. Noting that we choose a=5. Then, (as+1) will contribute up to 90° phase lead in the high- frequency region. MATLAB Program 8–3 produces the Bode diagram of The resulting Bode diagram is shown in Figure 8–15.4(5s+1) sAs2+1BGc(s)=4(as+1)(bs +1) sBased on the Bode diagram of Figure 8–15, we choose the value of b.The term (bs+1) needs to give the phase margin of at least 50°. By simple MATLAB trials, we find b=0.25 to give the phase margin of at least 50° and gain margin of ±qdB.There- fore, by choosing b=0.25, we have and the open-loop transfer function of the designed system becomes MATLAB Program 8–4 produces the Bode diagram of the open-loop transfer function. The resulting Bode diagram is shown in Figure 8–16. From it we see that the static ve- locity error constant is 4 sec –1 , the phase margin is 55°, and the gain margin is ±qdB.=5s 2 +21s+4 s 3 +s Open-loop transfer function =4(5s+1)(0.25s+1) s1 s 2 +1G c (s)=4(5s+1)(0.25s+1) s 580 Chapter 8 / PID Controllers and Modified PID Controllers MATLAB Program 8–4 num = [5 21 4]; den = [1 0 1 0]; w = logspace(-2,2,100); bode(num,den,w) title('Bode Diagram of 4(5s+1)(0.25s+1)/[s(s^2+1)]') Frequency (rad/sec)Bode Diagram of 4(5 s + 1)(0.25 s + 1)/[ s(s 2 + 1)] −200−100−50050 −150100−50 Phase (deg); Magnitude (dB) 0100 50 10 –2 10 –1 10 0 10 1 10 2 Figure 8–16 Bode diagram of 4(5s+1)(0.25s+1)/ CsAs 2 +1BD. Openmirrors.comSection 8–3 / Design of PID Controllers with Frequency-Response Approach 581Therefore, the designed system satisfies all the requirements.Thus, the designed system is acceptable. (Note that there exist infinitely many systems that satisfy all the require-ments. The present system is just one of them.) Next, we shall obtain the unit-step response and the unit-ramp response of the de- signed system. The closed-loop transfer function is Note that the closed-loop zeros are located at The closed-loop poles are located at Notice that the complex-conjugate closed-loop poles have the damping ratio of 0.5237. MATLAB Program 8–5 produces the unit-step response and the unit-ramp response.s=-0.1897s=-2.4052 -j3.9119s=-2.4052 +j3.9119s=-4, s=-0.2C(s) R(s)=5s2+21s+4 s3+5s2+22s+4 MATLAB Program 8–5 %***** Unit-step response *****num = [5 21 4]; den = [1 5 22 4];t = 0:0.01:14;c = step(num,den,t);plot(t,c)gridtitle('Unit-Step Response of Compensated System')xlabel('t (sec)')ylabel('Output c(t)') %***** Unit-ramp response *****num1 = [5 21 4]; den1 = [1 5 22 4 0];t = 0:0.02:20;c = step(num1,den1,t);plot(t,c,'-',t,t,'--')title('Unit-Ramp Response of Compensated System')xlabel('t (sec)')ylabel('Unit-Ramp Input and Output c(t)')text(10.8,8,'Compensated System')582 Chapter 8 / PID Controllers and Modified PID Controllers Output c(t) t (sec)Unit-Step Response of Compensated System 1.4 1.2 1 0.8 0.6 0.4 0.2 0 02468 1 0 1 2 1 4 Figure 8–17 Unit-step response curve. Unit-Ramp Input and Output c(t) t (sec)Unit-Ramp Response of Compensated System 20 18 16 14 12 10 8 6 4 2 0 02468 1 0 1 2 1 4 1 6 1 8 2 0 Compensated System Figure 8–18 Unit-ramp input and the output curve. The resulting unit-step response curve is shown in Figure 8–17 and the unit- ramp response curve in Figure 8–18. Notice that the closed-loop pole at s=/H110020.1897 and the zero at s=/H110020.2 produce a long tail of small amplitude in the unit-step response. For an additional example of design of a PID controller based on the frequency- response approach, see Problem A–8–7 . Openmirrors.comSection 8–4 / Design of PID Controllers with Computational Optimization Approach 5838–4 DESIGN OF PID CONTROLLERS WITH COMPUTATIONAL OPTIMIZATION APPROACH In this section we shall explore how to obtain an optimal set (or optimal sets) of parameter values of PID controllers to satisfy the transient response specifications byuse of MATLAB.We shall present two examples to illustrate the approach in this section. EXAMPLE 8–2 Consider the PID-controlled system shown in Figure 8–19. The PID controller is given by It is desired to find a combination of Kandasuch that the closed-loop system will have 10 %(or less) maximum overshoot in the unit-step response. (We will not include any other condition inthis problem. But other conditions can easily be included, such as that the settling time be less thana specified value. See, for example, Example 8–3.) There may be more than one set of parameters that satisfy the specifications. In this example, we shall obtain all sets of parameters that satisfy the given specifications. To solve this problem with MATLAB, we first specify the region to search for appropriate K anda.We then write a MATLAB program that, in the unit-step response, will find a combination ofKandawhich will satisfy the criterion that the maximum overshoot is 10 %or less. Note that the gain Kshould not be too large, so as to avoid the possibility that the system re- quire an unnecessarily large power unit. Assume that the region to search for Kandais 2/H11349K/H113493 and 0.5/H11349a/H113491.5 If a solution does not exist in this region, then we need to expand it. In some problems, however, there is no solution, no matter what the search region might be. In the computational approach, we need to determine the step size for each of Kanda. In the actual design process, we need to choose step sizes small enough. However, in this example, to avoidan overly large number of computations, we choose the step sizes to be reasonable—say, 0.2 for both Kanda. To solve this problem it is possible to write many different MATLAB programs.We present here one such program, MATLAB Program 8–6. In this program, notice that we use two “for” loops.Westart the program with the outer loop to vary the “ K” values. Then we vary the “ a” values in the inner loop. We proceed by writing the MATLAB program such that the nested loops in the pro- gram begin with the lowest values of “ K” and “ a” and step toward the highest. Note that, depend- ing on the system and the ranges of search for “ K” and “ a” and the step sizes chosen, it may take from several seconds to a few minutes for MATLAB to compute the desired sets of the values. In this program the statement solution(k,:) = [K(i) a(j) m] will produce a table of K, a, m values. (In the present system there are 15 sets of Kandathat will exhibit m<1.10 —that is, the maximum overshoot is less than 10 %.)Gc(s)=K(s+a)2 s R(s) KC(s) PID controller1.2 0.36s3+ 1.86 s2+ 2.5s+ 1(s+a)2 s+– Figure 8–19 PID-controlledsystem.584 Chapter 8 / PID Controllers and Modified PID Controllers To sort out the solution sets in the order of the magnitude of the maximum overshoot (starting from the smallest value of mand ending at the largest value of min the table), we use the command sortsolution = sortrows(solution,3) MATLAB Program 8–6 %'K' and 'a' values to test K = [2.0 2.2 2.4 2.6 2.8 3.0]; a = [0.5 0.7 0.9 1.1 1.3 1.5]; % Evaluate closed-loop unit-step response at each 'K' and 'a' combination % that will yield the maximum overshoot less than 10% t = 0:0.01:5; g = tf([1.2],[0.36 1.86 2.5 1]); k = 0; for i = 1:6; for j = 1:6; gc = tf(K(i)*[1 2*a(j) a(j)^2], [1 0]); % controller G = gc*g/(1 + gc*g); % closed-loop transfer function y = step(G,t); m = max(y); if m < 1.10 k = k+1; solution(k,:) = [K(i) a(j) m]; end end end solution % Print solution table solution = 2.0000 0.5000 0.9002 2.0000 0.7000 0.9807 2.0000 0.9000 1.0614 2.2000 0.5000 0.9114 2.2000 0.7000 0.9837 2.2000 0.9000 1.0772 2.4000 0.5000 0.9207 2.4000 0.7000 0.9859 2.4000 0.9000 1.0923 2.6000 0.5000 0.9283 2.6000 0.7000 0.9877 2.8000 0.5000 0.9348 2.8000 0.7000 1.0024 3.0000 0.5000 0.9402 3.0000 0.7000 1.0177 sortsolution = sortrows(solution,3) % Print solution table sorted by % column 3 (continues on next page ) Openmirrors.comSection 8–4 / Design of PID Controllers with Computational Optimization Approach 585sortsolution = 2.0000 0.5000 0.9002 2.2000 0.5000 0.91142.4000 0.5000 0.92072.6000 0.5000 0.92832.8000 0.5000 0.93483.0000 0.5000 0.94022.0000 0.7000 0.98072.2000 0.7000 0.98372.4000 0.7000 0.98592.6000 0.7000 0.98772.8000 0.7000 1.00243.0000 0.7000 1.01772.0000 0.9000 1.06142.2000 0.9000 1.07722.4000 0.9000 1.0923 % Plot the response with the largest overshoot that is less than 10%K = sortsolution(k,1)K = 2.4000 a = sortsolution(k,2)a = 0.9000 gc = tf(K*[1 2*a a^2], [1 0]); G = gc*g/(1 + gc*g);step(G,t)grid % See Figure 8–20 % If you wish to plot the response with the smallest overshoot that is % greater than 0%, then enter the following values of 'K' and 'a' K = sortsolution(11,1)K = 2.8000 a = sortsolution(11,2)a = 0.7000 gc = tf(K*[1 2*a a^2], [1 0]); G = gc*g/(1 + gc*g);step(G,t)grid % See Figure 8–21586 Chapter 8 / PID Controllers and Modified PID Controllers Amplitude Time (sec)Step Response 1.4 1.2 1 0.8 0.6 0.4 0.2 0 0 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5 Figure 8–20 Unit-step response of the system with K=2.4 anda=0.9. (The maximum overshoot is 9.23 %.) To plot the unit-step response curve of the last set of the Kand avalues in the sorted table, we enter the commands K = sortsolution (k,1) a = sortsolution (k,2) and use the step command. (The resulting unit-step response curve is shown in Figure 8–20.) To plot the unit-step response curve with the smallest overshoot that is greater than 0 %found in the sorted table, enter the commands K = sortsolution (11,1) a = sortsolution (11,2) and use the step command. (The resulting unit-step response curve is shown in Figure 8–21.) Amplitude Time (sec)Step Response 1.21.4 1 0.8 0.6 0.4 0.2 0 0 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5 Figure 8–21 Unit-step response of the system with K=2.8 anda=0.7. (The maximum overshoot is 0.24 %.) Openmirrors.comSection 8–4 / Design of PID Controllers with Computational Optimization Approach 587To plot the unit-step response curve of the system with any set shown in the sorted table, we spec- ify the Kandavalues by entering an appropriate sortsolution command. Note that for a specification that the maximum overshoot be between 10 %and 5 %,there would be three sets of solutions: K=2.0000, a=0.9000, m=1.0614K=2.2000, a=0.9000, m=1.0772K=2.4000, a=0.9000, m=1.0923 Unit-step response curves for these three cases are shown in Figure 8–22. Notice that the sys- tem with a larger gain Khas a smaller rise time and larger maximum overshoot.Which one of these three systems is best depends on the system’s objective. EXAMPLE 8–3 Consider the system shown in Figure 8–23. We want to find all combinations of Kand avalues such that the closed-loop system has a maximum overshoot of less than 15 %, but more than 10 %, in the unit-step response. In addition, the settling time should be less than 3 sec. In this problem,assume that the search region is 3/H11349K/H113495and 0.1/H11349a/H113493 Determine the best choice of the parameters Kanda.Amplitude Time (sec)Unit-Step Response Curves 1.4 1.2 1 0.80.60.4 0.2 0 0 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5K = 2.4, a = 0.9 K = 2.2, a = 0.9 K = 2, a = 0.9 Figure 8–22 Unit-step responsecurves of system withK=2, a=0.9;K=2.2, a=0.9; andK=2.4, a=0.9. R(s) C(s) PID controller4 s3+ 6s2 + 8s + 4+– Plant(s+ a)2 sK Figure 8–23 PID-controlledsystem with a simplified PID controller.588 Chapter 8 / PID Controllers and Modified PID Controllers In this problem, we choose the step sizes to be reasonable, — say 0.2 for Kand 0.1 for a. MATLAB Program 8–7 gives the solution to this problem. From the sortsolution table, it looks like the first row is a good choice. Figure 8–24 shows the unit step response curve for K= 3.2 and a= 0.9. Since this choice requires a smaller Kvalue than most other choices, we may decide that the first row is the best choice. MATLAB Program 8–7 t = 0:0.01:8; k = 0; for K = 3:0.2:5; for a = 0.1:0.1:3; num = [4*K 8*K*a 4*K*a^2]; den = [1 6 8+4*K 4+8*K*a 4*K*a^2]; y = step(num,den,t); s = 801;while y(s)>0.98 & y(s)<1.02; s = s – 1;end; ts = (s–1)*0.01; % ts = settling time; m = max(y); if m<1.15 & m>1.10; if ts<3.00; k = k+1; solution(k,:) = [K a m ts]; end end end end solution solution = 3.0000 1.0000 1.1469 2.7700 3.2000 0.9000 1.1065 2.8300 3.4000 0.9000 1.1181 2.7000 3.6000 0.9000 1.1291 2.5800 3.8000 0.9000 1.1396 2.4700 4.0000 0.9000 1.1497 2.3800 4.2000 0.8000 1.1107 2.8300 4.4000 0.8000 1.1208 2.5900 4.6000 0.8000 1.1304 2.4300 4.8000 0.8000 1.1396 2.3100 5.0000 0.8000 1.1485 2.2100 sortsolution = sortrows(solution,3) sortsolution = 3.2000 0.9000 1.1065 2.8300 4.2000 0.8000 1.1107 2.8300 3.4000 0.9000 1.1181 2.7000 4.4000 0.8000 1.1208 2.5900 3.6000 0.9000 1.1291 2.5800 4.6000 0.8000 1.1304 2.4300 4.8000 0.8000 1.1396 2.3100 3.8000 0.9000 1.1396 2.4700 (continues on next page ) Openmirrors.comSection 8–4 / Design of PID Controllers with Computational Optimization Approach 5893.0000 1.0000 1.1469 2.7700 5.0000 0.8000 1.1485 2.21004.0000 0.9000 1.1497 2.3800 % Plot the response curve with the smallest overshoot shown in sortsolution table. K = sortsolution(1,1), a = sortsolution(1,2) K = 3.2000 a = 0.9000num = [4*K 8*K*a 4*K*a^2]; den = [1 6 8+4*K 4+8*K*a 4*K*a^2];num num = 12.8000 23.0400 10.3680den den = 1.0000 6.0000 20.8000 27.0400 10.3680y = step(num,den,t); plot(t,y) % See Figure 8–24.gridtitle('Unit-Step Response')xlabel('t sec')ylabel('Output y(t)') 000.20.40.60.811.21.4 2468 t secOutput y(t)Unit-Step Response Figure 8–24 Unit-step responsecurve of the systemwith K= 3.2 and a= 0.9.590 Chapter 8 / PID Controllers and Modified PID Controllers 8–5 MODIFICATIONS OF PID CONTROL SCHEMES Consider the basic PID control system shown in Figure 8–25(a), where the system is sub- jected to disturbances and noises. Figure 8–25(b) is a modified block diagram of the same system. In the basic PID control system such as the one shown in Figure 8–25(b), if the ref- erence input is a step function, then, because of the presence of the derivative term in the control action, the manipulated variable u(t) will involve an impulse function (delta func- tion). In an actual PID controller, instead of the pure derivative term , we employ where the value of gis somewhere around 0.1.Therefore, when the reference input is a step function, the manipulated variable u(t) will not involve an impulse function, but will involve a sharp pulse function. Such a phenomenon is called set-point kick . PI-D Control. To avoid the set-point kick phenomenon, we may wish to operate the derivative action only in the feedback path so that differentiation occurs only on the feedback signal and not on the reference signal.The control scheme arranged in this way is called the PI-D control. Figure 8–26 shows a PI-D-controlled system. From Figure 8–26, it can be seen that the manipulated signal U(s) is given by U(s) =K p a 1+1 T i s b R(s) -K p a 1+1 T i s+T d s b B(s)T d s 1+gT d sT d s PID controllerPlant G p (s) 1 T i s 1 T d sOutput Y(s) Noise N(s)Reference input R(s) (a) (b)Disturbance D(s) G p (s)Y(s) N(s)R(s) E(s) B(s)Observed signal B(s) U(s)D(s) K p +– ++ ++ ++ ++ + ++ +– Figure 8–25 (a) PID-controlled system; (b) equivalent block diagram. Openmirrors.comSection 8–5 / Modifications of PID Control Schemes 591Notice that in the absence of the disturbances and noises, the closed-loop transfer function of the basic PID control system [shown in Figure 8–25(b)] and the PI-D controlsystem (shown in Figure 8–26) are given, respectively, by and It is important to point out that in the absence of the reference input and noises, the closed-loop transfer function between the disturbance D(s) and the output Y(s) in either case is the same and is given by I-PD Control. Consider the case where the reference input is a step function. Both PID control and PI-D control involve a step function in the manipulated signal. Such astep change in the manipulated signal may not be desirable in many occasions. There-fore, it may be advantageous to move the proportional action and derivative action tothe feedback path so that these actions affect the feedback signal only. Figure 8–27 showssuch a control scheme. It is called the I-PD control. The manipulated signal is given by Notice that the reference input R(s) appears only in the integral control part. Thus, in I-PD control, it is imperative to have the integral control action for proper operation ofthe control system.U(s) =K p1 Ti sR(s) -Kpa1+1 Ti s+Td sbB(s)Y(s) D(s)=Gp(s) 1+Kp Gp(s)a1+1 Ti s+Td sbY(s) R(s)=a1+1 Ti sbKp Gp(s) 1+a1+1 Ti s+Td sbKp Gp(s)Y(s) R(s)=a1+1 Ti s+Td sbKp Gp(s) 1+a1+1 Ti s+Td sbKp Gp(s)1 Tis1 Gp(s)Y(s) N(s)R(s) E(s) B(s)U(s)D(s) Kp Tds B(s)+–+–+++ ++Figure 8–26 PI-D-controlledsystem.592 Chapter 8 / PID Controllers and Modified PID Controllers 1 T i s G p (s)Y(s) N(s)R(s) B(s) B(s)U(s)D(s) K p T d s 1 +– + – ++ ++ Figure 8–27 I-PD-controlled system. The closed-loop transfer function Y(s)/R(s) in the absence of the disturbance input and noise input is given by It is noted that in the absence of the reference input and noise signals, the closed-loop transfer function between the disturbance input and the output is given by This expression is the same as that for PID control or PI-D control. Two-Degrees-of-Freedom PID Control. We have shown that PI-D control is ob- tained by moving the derivative control action to the feedback path, and I-PD control is obtained by moving the proportional control and derivative control actions to the feedback path. Instead of moving the entire derivative control action or proportional control action to the feedback path, it is possible to move only portions of these control actions to the feedback path, retaining the remaining portions in the feedforward path. In the literature, PI-PD control has been proposed. The characteristics of this control scheme lie between PID control and I-PD control. Similarly, PID-PD control can be considered. In these control schemes, we have a controller in the feedforward path and another controller in the feedback path. Such control schemes lead us to a more gener- al two-degrees-of-freedom control scheme.We shall discuss details of such a two-degrees- of-freedom control scheme in subsequent sections of this chapter. 8–6 TWO-DEGREES-OF-FREEDOM CONTROL Consider the system shown in Figure 8–28, where the system is subjected to the disturbance input D(s) and noise input N(s), in addition to the reference input R(s). is the transfer function of the controller and is the transfer function of the plant. We assume that is fixed and unalterable. G p (s)G p (s) G c (s)Y(s) D(s)=G p (s) 1+K p G p (s) a 1+1 T i s+T d s b Y(s) R(s)= a 1 T i s b K p G p (s) 1+K p G p (s) a 1+1 T i s+T d s b Openmirrors.comSection 8–6 / Two-Degrees-of-Freedom Control 593For this system, three closed-loop transfer functions Y(s)/R(s)= Gyr, Y(s)/D(s)= Gyd,andY(s)/N(s)= Gynmay be derived. They are [In deriving Y(s)/R(s), we assumed D(s)=0 andN(s)=0. Similar comments apply to the derivations of Y(s)/D(s) andY(s)/N(s). ] The degrees of freedom of the control system refers to how many of these closed-loop transfer functions are independent. Inthe present case, we have Among the three closed-loop transfer functions G yr,Gyn,and Gyd, if one of them is given, the remaining two are fixed. This means that the system shown in Figure 8–28 isa one-degree-of-freedom control system. Next consider the system shown in Figure 8–29, where is the transfer function of the plant. For this system, closed-loop transfer functions G yr,Gyn,andGydare given, respectively, by Gyn=Y(s) N(s)=- AGc1+Gc2BGp 1+AGc1+Gc2BGp Gyd=Y(s) D(s)=Gp 1+AGc1+Gc2BGp Gyr=Y(s) R(s)=Gc1 Gp 1+AGc1+Gc2BGpGp(s) Gyn=Gyd-Gp Gp Gyr=Gp-Gyd Gp Gyn=Y(s) N(s)=- Gc Gp 1+Gc Gp Gyd=Y(s) D(s)=Gp 1+Gc Gp Gyr=Y(s) R(s)=Gc Gp 1+Gc GpGp(s)Y(s) N(s)R(s) B(s)U(s)D(s) Gc(s) +–++ ++Figure 8–28 One-degree-of-freedom control system.594 Chapter 8 / PID Controllers and Modified PID Controllers Hence, we have In this case, if G yd is given, then G yn is fixed, but G yr is not fixed, because G c1 is independent of G yd .Thus, two closed-loop transfer functions among three closed-loop transfer functions G yr ,G yd ,andG yn are independent. Hence, this system is a two-degrees- of-freedom control system. Similarly, the system shown in Figure 8–30 is also a two-degrees-of-freedom control system, because for this system G yn =Y(s) N(s)=- G c1 G p 1+G c1 G p G yd =Y(s) D(s)=G p 1+G c1 G p G yr =Y(s) R(s)=G c1 G p 1+G c1 G p +G c2 G p 1+G c1 G p G yn =G yd -G p G p G yr =G c1 G yd G p (s) G c1 (s)Y(s) N(s)R(s) B(s)U(s)D(s) G c2 (s) B(s) ++ ++ +– +– Figure 8–29 Two-degrees-of- freedom control system. G p (s) G c1 (s) G c2 (s) Y(s) N(s)U(s)D(s) R(s) B(s) +– ++ ++ ++ Figure 8–30 Two-degrees-of- freedom control system. Openmirrors.comSection 8–7 / Zero-Placement Approach to Improve Response Characteristics 595Hence, Clearly, if Gydis given, then Gynis fixed, but Gyris not fixed, because Gc2is independ- ent of Gyd. It will be seen in Section 8–7 that, in such a two-degrees-of-freedom control system, both the closed-loop characteristics and the feedback characteristics can be adjustedindependently to improve the system response performance. 8–7 ZERO-PLACEMENT APPROACH TO IMPROVE RESPONSE CHARACTERISTICS We shall show here that by use of the zero-placement approach presented later in this section, we can achieve the following: The responses to the ramp reference input and acceleration reference input exhibit no steady-state errors. In high-performance control systems it is always desired that the system output follow the changing input with minimum error. For step, ramp, and acceleration inputs, it isdesired that the system output exhibit no steady-state error. In what follows, we shall demonstrate how to design control systems that will exhibit no steady-state errors in following ramp and acceleration inputs and at the same timeforce the response to the step disturbance input to approach zero quickly. Consider the two-degrees-of-freedom control system shown in Figure 8–31. Assume that the plant transfer function is a minimum-phase transfer function and isgiven by G p(s)=KA(s) B(s)Gp(s) Gyn=Gyd-Gp Gp Gyr=Gc2 Gyd+Gp-Gyd Gp Gp(s) Gc1(s)Y(s) R(s)D(s) Gc2(s)+++–+– Figure 8–31 Two-degrees-of-freedom control system.596 Chapter 8 / PID Controllers and Modified PID Controllers where A(s)=As+z 1 BAs+z 2 BpAs+z m B B(s)=s N As+p N±1 BAs+p N±2 BpAs+p n B where Nmay be 0, 1, 2 and n/H11350m.Assume also that G c1 is a PID controller followed by a filter 1/A(s), or andG c2 is a PID, PI, PD, I, D, or P controller followed by a filter 1/A(s). That is where some of a 2 ,b 2 , and g 2 may be zero. Then it is possible to write as (8–3) wherea,b, andgare constants. Then Because of the presence of sin the numerator, the response y(t) to a step disturbance input approaches zero as tapproaches infinity, as shown below. Since if the disturbance input is a step function of magnitude d,or and assuming the system is stable, then =0 =lim sS0 sKA(0)d sB(0) +bK y(q)=lim sS0 s c sKA(s) sB(s) +Aas+b+gs 2 BK d d sD(s) =d sY(s) =sKA(s) sB(s) +Aas+b+gs 2 BKD(s) =sKA(s) sB(s) +Aas+b+gs 2 BK Y(s) D(s)=G p 1+AG c1 +G c2 BG p =K A(s) B(s) 1+as+b+gs 2 s K B(s)G c1 +G c2 =as+b+gs 2 s1 A(s)G c1 +G c2 G c2 (s)=a 2 s+b 2 +g 2 s 2 s1 A(s)G c1 (s)=a 1 s+b 1 +g 1 s 2 s1 A(s) Openmirrors.comThe response y(t) to a step disturbance input will have the general form shown in Figure 8–32. Note that Y(s)/R(s) andY(s)/D(s) are given by Notice that the denominators of Y(s)/R(s) andY(s)/D(s) are the same. Before we choose the poles of Y(s)/R(s), we need to place the zeros of Y(s)/R(s). Zero Placement. Consider the system If we choose p(s) as p(s)=a2s2+a1s+a0=a2As+s1BAs+s2B that is, choose the zeros s=–s1ands=–s2such that, together with a2, the numerator polynomial p(s) is equal to the sum of the last three terms of the denominator polynomial—then the system will exhibit no steady-state errors in response to the stepinput, ramp input, and acceleration input. Requirement Placed on System Response Characteristics. Suppose that it is desired that the maximum overshoot in the response to the unit-step reference input bebetween arbitrarily selected upper and lower limits—for example, 2%< maximum overshoot <10% where we choose the lower limit to be slightly above zero to avoid having overdamped systems. The smaller the upper limit, the harder it is to determine the coefficient a’s. In some cases, no combination of the a’s may exist to satisfy the specification, so we must allow a higher upper limit for the maximum overshoot. We use MATLAB to search atleast one set of the a’s to satisfy the specification. As a practical computational matter, instead of searching for the a’s, we try to obtain acceptable closed-loop poles by search- ing a reasonable region in the left-half splane for each closed-loop pole. Once we determine all closed-loop poles, then all coefficients a n,an–1,p,a1,a0will be determined.Y(s) R(s)=p(s) sn+1+an sn+an-1 sn-1+p+a2 s2+a1 s+a0Y(s) R(s)=Gc1 Gp 1+AGc1+Gc2BGp, Y(s) D(s)=Gp 1+AGc1+Gc2BGp Section 8–7 / Zero-Placement Approach to Improve Response Characteristics 5970 ty Figure 8–32 Typical responsecurve to a step disturbance input.598 Chapter 8 / PID Controllers and Modified PID Controllers Determination of G c2 .Now that the coefficients of the transfer function Y(s)/R(s) are all known and Y(s)/R(s) is given by (8–4) we have Since G c1 is a PID controller and is given by Y(s)/R(s) can be written as Therefore, we choose so that (8–5) The response of this system to the unit-step reference input can be made to exhibit the maximum overshoot between the chosen upper and lower limits, such as 2%< maximum overshoot <10% The response of the system to the ramp reference input or acceleration reference input can be made to exhibit no steady-state error. The characteristic of the system of Equa- tion (8–4) is that it generally exhibits a short settling time. If we wish to further shorten the settling time, then we need to allow a larger maximum overshoot—for example, 2%< maximum overshoot <20% The controller G c2 can now be determined from Equations (8–3) and (8–5). Since G c1 +G c2 =as+b+gs 2 s1 A(s)G c1 =a 1 s+a 0 +a 2 s 2 Ks1 A(s)Kg 1 =a 2 , Ka 1 =a 1 , Kb 1 =a 0 Y(s) R(s)=KAa 1 s+b 1 +g 1 s 2 B s n+1 +a n s n +a n-1 s n-1 +p+a 2 s 2 +a 1 s+a 0 G c1 =a 1 s+b 1 +g 1 s 2 s1 A(s) =G c1 sKA(s) s n+1 +a n s n +a n-1 s n-1 +p+a 2 s 2 +a 1 s+a 0 =G c1 sKA(s) sB(s) +Aas+b+gs 2 BK Y(s) R(s)=G c1 Y(s) D(s)Y(s) R(s)=a 2 s 2 +a 1 s+a 0 s n+1 +a n s n +a n-1 s n-1 +p+a 2 s 2 +a 1 s+a 0 Openmirrors.comSection 8–7 / Zero-Placement Approach to Improve Response Characteristics 599we have (8–6) The two controllers Gc1andGc2can be determined from Equations (8–5) and (8–6). EXAMPLE 8–4 Consider the two-degrees-of-freedom control system shown in Figure 8–33. The plant transfer function is given by Design controllers and such that the maximum overshoot in the response to the unit-step reference input be less than 19 %, but more than 2 %, and the settling time be less than 1 sec. It is desired that the steady-state errors in following the ramp reference input and acceler-ation reference input be zero.The response to the unit-step disturbance input should have a smallamplitude and settle to zero quickly. To design suitable controllers and first note that To simplify the notation, let us define G c=Gc1+Gc2 Then =10 s(s+1)+10Gc Y(s) D(s)=Gp 1+Gp Gc=10 s(s+1) 1+10 s(s+1) GcY(s) D(s)=Gp 1+GpAGc1+Gc2BGc2(s), Gc1(s)Gc2(s) Gc1(s)Gp(s)=10 s(s+1)Gp(s) =AKa-a1Bs+AKb-a0B+AKg-a2Bs2 Ks 1 A(s) Gc2=cas+b+gs2 s-a1 s+a0+a2 s2 Ksd 1 A(s) Gp(s) Gc1(s)Y(s) R(s) U(s)D(s) Gc2(s)+++–+– Figure 8–33 Two-degrees-of-freedom control system.600 Chapter 8 / PID Controllers and Modified PID Controllers Second, note that Notice that the characteristic equation for Y(s)/D(s) and the one for Y(s)/R(s) are identical. We may be tempted to choose a zero of at s=–1 to cancel a pole at s=–1 of the plant However, the canceled pole s=–1 becomes a closed-loop pole of the entire system, as seen below. If we define as a PID controller such that (8–7) then The closed-loop pole at s=–1 is a slow-response pole, and if this closed-loop pole is included in the system, the settling time will not be less than 1 sec. Therefore, we should not choose as given by Equation (8–7). The design of controllers and consists of two steps. Design Step 1: We design to satisfy the requirements on the response to the step- disturbance input D(s). In this design stage, we assume that the reference input is zero. Suppose that we assume that is a PID controller of the form Then the closed-loop transfer function Y(s)/D(s) becomes Note that the presence of “ s” in the numerator of Y(s)/D(s) assures that the steady-state response to the step disturbance input is zero. Let us assume that the desired dominant closed-loop poles are complex conjugates and are given by s=–a_jb =10s s 2 (s+1)+10K(s +a)(s+b) =10 s(s+1)+10K(s +a)(s+b) s Y(s) D(s)=10 s(s+1)+10G c G c (s)=K(s +a)(s+b) sG c (s)G c (s)G c2 (s) G c1 (s)G c (s) =10s (s+1)Cs 2 +10K(s +b)D Y(s) D(s)=10 s(s+1)+10K(s +1)(s +b) sG c (s)=K(s +1)(s +b) sG c (s)G p (s).G c (s)Y(s) R(s)=G p G c1 1+G p G c =10G c1 s(s+1)+10G c Openmirrors.comSection 8–7 / Zero-Placement Approach to Improve Response Characteristics 601and the remaining closed-loop pole is real and is located at s=–c Note that in this problem there are three requirements. The first requirement is that the response to the step disturbance input damp out quickly.The second requirement is that the max- imum overshoot in the response to the unit-step reference input be between 19 %and 2 %and the settling time be less than 1 sec. The third requirement is that the steady-state errors in the re-sponses to both the ramp and acceleration reference inputs be zero. A set (or sets) of reasonable values of a, b, and cmust be searched using a computational approach. To satisfy the first requirement, we choose the search region for a, b, andcto be 2/H11349a/H113496, 2 /H11349b/H113496, 6 /H11349c/H1134912 This region is shown in Figure 8–34. If the dominant closed-loop poles s=–a_jb are located anywhere in the shaded region, the response to a step disturbance input will damp out quickly. (Thefirst requirement will be met.) Notice that the denominator of Y(s)/D(s) can be written as =s 3+(2a +c)s2+Aa2+b2+2acBs+Aa2+b2Bc =(s+a+jb)(s +a-jb)(s +c) =s3+(1+10K)s2+10K(a+b)s+10Kabs2(s+1)+10K(s +a)(s+b) 0j6 j4 j2 –j6–j4–j2–6 –4 –2 –8 –10 –12 2 sRegion for a and b Region for cjv Figure 8–34 Search regions fora, b, andc.602 Chapter 8 / PID Controllers and Modified PID Controllers Since the denominators of Y(s)/D(s) andY(s)/R(s) are the same, the denominator of Y(s)/D(s) determines also the response characteristics for the reference input. To satisfy the third require- ment, we refer to the zero-placement method and choose the closed-loop transfer function Y(s)/R(s) to be of the following form: in which case the third requirement is automatically satisfied. Our problem then becomes a search of a set or sets of desired closed-loop poles in terms ofa, b, and cin the specified region, such that the system will satisfy the requirement on the re- sponse to the unit-step reference input that the maximum overshoot be between 19 %and 2 %and the settling time be less than 1 sec. (If an acceptable set cannot be found in the search region, we need to widen the region.) In the computational search, we need to assume a reasonable step size. In this problem, we assume it to be 0.2. MATLAB Program 8–8 produces a table of sets of acceptable values of a, b, andc.Using this program, we find that the requirement on the response to the unit-step reference input is met by any of the 23 sets shown in the table in MATLAB Program 8–8. Note that the last row in the table corresponds to the last search point. This point does not satisfy the requirement and thus it should simply be ignored. (In the program written, the last search point produces the last row in the table whether or not it satisfies the requirement.)Y(s) R(s)=(2a +c)s 2 +Aa 2 +b 2 +2acBs+Aa 2 +b 2 Bc s 3 +(2a +c)s 2 +Aa 2 +b 2 +2acBs+Aa 2 +b 2 Bc MATLAB Program 8–8 t = 0:0.01:4; k = 0; for i = 1:21; a(i) = 6.2-i*0.2; for j = 1:21; b(j) = 6.2-j*0.2; for h = 1:31; c(h) = 12.2-h*0.2; num = [0 2*a(i)+c(h) a(i)^2+b(j)^2+2*a(i)*c(h) (a(i)^2+b(j)^2)*c(h)]; den = [1 2*a(i)+c(h) a(i)^2+b(j)^2+2*a(i)*c(h) (a(i)^2+b(j)^2)*c(h)]; y = step(num,den,t); m = max(y); s = 401; while y(s) > 0.98 & y(s) < 1.02; s = s-1; end; ts = (s-1)*0.01; if m < 1.19 & m > 1.02 & ts < 1.0; k = k+1; table(k,:) = [a(i) b(j) c(h) m ts]; end end end end (continues on next page ) Openmirrors.comSection 8–7 / Zero-Placement Approach to Improve Response Characteristics 603As noted above, 23 sets of variables a, b, and csatisfy the requirement. Unit-step response curves of the system with any of the 23 sets are about the same.The unit-step response curve with a=4.2, b=2, c=12 is shown in Figure 8–35(a). The maximum overshoot is 18.96 %and the settling time is 0.85 sec. Using these values of a, b, andc,the desired closed-loop poles are located at s=–4.2_j2, s=–12 Using these closed-loop poles, the denominator of Y(s)/D(s) becomes or =s3+20.4s2+122.44s +259.68 s3+(1+10K)s2+10K(a+b)s+10Kab=(s+4.2+j2)(s +4.2-j2)(s +12) s2(s+1)+10K(s +a)(s+b)table(k,:) = [a(i) b(j) c(h) m ts] table = 4.2000 2.0000 12.0000 1.1896 0.8500 4.0000 2.0000 12.0000 1.1881 0.87004.0000 2.0000 11.8000 1.1890 0.89004.0000 2.0000 11.6000 1.1899 0.90003.8000 2.2000 12.0000 1.1883 0.93003.8000 2.2000 11.8000 1.1894 0.94003.8000 2.0000 12.0000 1.1861 0.89003.8000 2.0000 11.8000 1.1872 0.91003.8000 2.0000 11.6000 1.1882 0.93003.8000 2.0000 11.4000 1.1892 0.94003.6000 2.4000 12.0000 1.1893 0.99003.6000 2.2000 12.0000 1.1867 0.96003.6000 2.2000 11.8000 1.1876 0.98003.6000 2.2000 11.6000 1.1886 0.99003.6000 2.0000 12.0000 1.1842 0.92003.6000 2.0000 11.8000 1.1852 0.94003.6000 2.0000 11.6000 1.1861 0.95003.6000 2.0000 11.4000 1.1872 0.97003.6000 2.0000 11.2000 1.1883 0.98003.4000 2.0000 12.0000 1.1820 0.94003.4000 2.0000 11.8000 1.1831 0.96003.4000 2.0000 11.6000 1.1842 0.98003.2000 2.0000 12.0000 1.1797 0.96002.0000 2.0000 6.0000 1.2163 1.8900604 Chapter 8 / PID Controllers and Modified PID Controllers By equating the coefficients of equal powers of son both sides of this last equation, we obtain 1+10K=20.4 10K(a+b)=122.44 10Kab=259.68 Output t (sec) (a)Unit-Step Response ( a = 4.2, b = 2, c = 12) 0.60.811.21.4 0.4 0.2 0 0 0.5 1 1.5 2 2.5 3 3.5 4 Figure 8–35 (a) Response to unit- step reference input (a=4.2, b=2, c=12); (b) response to unit-step disturbance input (a=4.2, b=2, c=12). (b) Output t (sec)Response to Unit-Step Disturbance Input 0.020.030.040.050.060.07 0.01 0 −0.01 0 0.5 1 1.5 2 2.5 3 3.5 4 Openmirrors.comSection 8–7 / Zero-Placement Approach to Improve Response Characteristics 605Hence Then can be written as The closed-loop transfer function Y(s)/D(s) becomes Using this expression, the response y(t) to a unit-step disturbance input can be obtained as shown in Figure 8–35(b). Figure 8–36(a) shows the response of the system to the unit-step reference input when a, b, andcare chosen as a=3.2, b=2, c=12 Figure 8–36(b) shows the response of this system when it is subjected to a unit-step disturbance input. Comparing Figures 8–35(a) and Figure 8–36(a), we find that they are about the same. How-ever, comparing Figures 8–35(b) and 8–36(b), we find the former to be a little bit better than the latter. Comparing the responses of systems with each set in the table, we conclude the first set of values (a=4.2, b=2, c=12) to be one of the best. Therefore, as the solution to this problem, we choose a=4.2, b=2, c=12 Design Step 2: Next, we determine G c1. Since Y(s)/R(s) can be given by =10sGc1 s3+20.4s2+122.44s +259.68 =10 s(s+1) Gc1 1+10 s(s+1) 1.94s2+12.244s +25.968 s Y(s) R(s)=Gp Gc1 1+Gp Gc =10s s3+20.4s2+122.44s +259.68 =10 s(s+1)+10 1.94s2+12.244s +25.968 s Y(s) D(s)=10 s(s+1)+10Gc =1.94s2+12.244s +25.968 s =KCs2+(a+b)s+abD s Gc(s)=K (s+a)(s+b) sGc(s)K=1.94, a+b=122.44 19.4, ab=259.68 19.4606 Chapter 8 / PID Controllers and Modified PID Controllers our problem becomes that of designing to satisfy the requirements on the responses to the step, ramp, and acceleration inputs. Since the numerator involves “ s”, must include an integrator to cancel this “ s”. [Although we want “ s” in the numerator of the closed-loop transfer function Y(s)/D(s) to obtain zero steady-state error to the step disturbance input, we do not want to have “ s” in the numera-G c1 (s)G c1 (s) (a) Output t (sec)Unit-Step Response ( a = 3.2, b = 2, c = 12) 0.60.811.21.4 0.4 0.2 0 0 0.5 1 1.5 2 2.5 3 3.5 4 Figure 8–36 (a) Response to unit-step reference input (a=3.2, b=2, c=12); (b) response to unit-step disturbance input (a=3.2, b=2, c=12). (b) Output t (sec)Response to Unit-Step Disturbance Input 0.020.030.040.050.060.070.080.09 0.01 0 −0.01 0 0.5 1 1.5 2 2.5 3 3.5 4 Openmirrors.comSection 8–7 / Zero-Placement Approach to Improve Response Characteristics 607tor of the closed-loop transfer function Y(s)/R(s). ] To eliminate the offset in the response to the step reference input and eliminate the steady-state errors in following the ramp reference inputand acceleration reference input, the numerator of Y(s)/R(s) must be equal to the last three terms of the denominator, as mentioned earlier. That is, or Thus, is a PID controller. Since is given as we obtain Thus, is a derivative controller. A block diagram of the designed system is shown in Figure 8–37. The closed-loop transfer function Y(s)/R(s) now becomes Y(s) R(s)=20.4s2+122.44s +259.68 s3+20.4s2+122.44s +259.68Gc2(s) =-0.1s =a1.94s +12.244 +25.968 sb-a2.04s +12.244 +25.968 sb Gc2(s)=Gc(s)-Gc1(s)Gc(s)=Gc1(s)+Gc2(s)=1.94s2+12.244s +25.968 sGc(s) Gc1(s) Gc1(s)=2.04s +12.244 +25.968 s 10sGc1(s)=20.4s2+122.44s +259.68 Y(s) R(s)D(s) Gc2(s)Gc1(s) 0.1s+–++++10 s(s+1)25.968 s2.04s+12.244 + Figure 8–37 Block diagram of thedesigned system.608 Chapter 8 / PID Controllers and Modified PID Controllers The response to the unit-ramp reference input and that to the unit-acceleration reference input are shown in Figures 8–38(a) and (b), respectively. The steady-state errors in following the ramp input and acceleration input are zero. Thus, all the requirements of the problem are satisfied. Hence, the designed controllers and are acceptable. EXAMPLE 8–5 Consider the control system shown in Figure 8–39. This is a two-degrees-of-freedom system. In the design problem considered here, we assume that the noise input N(s) is zero. Assume that the plant transfer function is given by G p (s)=5 (s+1)(s +5)G p (s)G c2 (s) G c1 (s) Unit-Ramp Response t (sec)0 0.2 0.4 0.6 0.8 1 1.2 1.4 1.6 1.8 2 Unit-Ramp Input and Output 2 00.4 0.20.60.811.21.41.61.8 (a) Output Unit-Ramp Input Figure 8–38 (a) Response to unit- ramp reference input; (b) response to unit-acceleration reference input. Unit-Acceleration Response t (sec)0 0.2 0.4 0.6 0.8 1 1.2 1.4 1.6 1.8 2 Unit-Acceleration Input and Output 2.5 00.511.52 (b) Unit-Acceleration Input Output Openmirrors.comSection 8–7 / Zero-Placement Approach to Improve Response Characteristics 609Assume also that the controller is of PID type. That is, The controller is of P or PD type. [If involves integral control action, then this will introduce a ramp component in the input signal, which is not desirable. Therefore, shouldnot include the integral control action.] Thus, we assume that where may be zero. Let us design controllers and such that the responses to the step-disturbance input and the step-reference input are of “desirable characteristics” in the sense that 1.The response to the step-disturbance input will have a small peak and eventually approach zero. (That is, there will be no steady-state error.) 2.The response to the step reference input will exhibit less than 25 %overshoot with a settling time less than 2 sec.The steady-state errors to the ramp reference input and acceleration ref-erence input should be zero. The design of this two-degrees-of-freedom control system may be carried out by following the steps 1and2below. 1.Determine so that the response to the step-disturbance input is of desirable characteristics. 2.Design so that the responses to the reference inputs are of desirable characteristics without changing the response to the step disturbance considered in step 1. Design of First, note that we assumed the noise input N(s) to be zero.To obtain the re- sponse to the step-disturbance input, we assume that the reference input is zero. Then the blockdiagram which relates Y(s) and D(s) can be drawn as shown in Figure 8–40. The transfer func- tion Y(s)/D(s) is given by Y(s) D(s)=Gp 1+Gc1 GpGc1(s):Gc2(s)Gc1(s)Gc2(s) Gc1(s)TˆdGc2(s)=KˆpA1+Tˆd sBGc2(s)Gc2(s) Gc2(s)Gc1(s)=Kpa1+1 Ti s+Td sbGc1(s)Gp(s) Gc1(s)Gc2(s) Y(s) N(s)U(s)D(s) R(s) B(s)+–++++ ++Figure 8–39 Two-degrees-of-freedom control system. D(s) Y(s) +–Gp(s) Gc1(s) Figure 8–40 Control system.610 Chapter 8 / PID Controllers and Modified PID Controllers where This controller involves one pole at the origin and two zeros. If we assume that the two zeros are located at the same place (a double zero), then can be written as Then the characteristic equation for the system becomes or s(s+1)(s+5)+5K(s+a) 2 =0 which can be rewritten as s 3 +(6+5K)s 2 +(5+10Ka)s+5Ka 2 =0 (8–8) If we place the double zero between s=–3 ands=–6, then the root-locus plot of may look like the one shown in Figure 8–41. The speed of response should be fast, but not faster than necessary, because faster response generally implies larger or more expensive components. Therefore, we may choose the dominant closed-loop poles at s=–3_j2 (Note that this choice is not unique. There are infinitely many possible closed-loop poles that we may choose from.) Since the system is of third order, there are three closed-loop poles. The third one is located on the negative real axis to the left of point s=–5. Let us substitute s=–3+j2 into Equation (8–8). (–3+j2) 3 +(6+5K)(–3+j2) 2 +(5+10Ka)(–3+j2)+5Ka 2 =0G c1 (s)G p (s)1+G c1 (s)G p (s)=1+K(s +a) 2 s5 (s+1)(s +5)=0G c1 (s)=K(s+a) 2 sG c1 (s)G c1 (s)=K p a 1+1 T i s+T d s b Root-Locus Plots of ( s + a) 2 /(s 3 + 6s 2 + 5s) with a = 3, a = 4, a = 4.5, and a = 6 Real Axis Imag Axis 2 −4 −6 −8−14 −12 −10 −8 −6 −4 −20 24 −2068 a = 6 a = 4.5 a = 4 a = 3 Figure 8–41 Root-locus plots of 5K(s+a) 2 /Cs(s+1) (s+5)Dwhen a=3, a=4, a=4.5, and a=6. Openmirrors.comSection 8–7 / Zero-Placement Approach to Improve Response Characteristics 611which can be simplified to 24+25K-30Ka+5Ka2+j(–16-60K+20Ka)=0 By equating the real part and imaginary part to zero, respectively, we obtain 24+25K-30Ka+5Ka2=0 (8–9) –16-60K+20Ka=0 (8–10) From Equation (8–10), we have (8–11) Substituting Equation (8–11) into Equation (8–9), we get a2=13 ora=3.6056 or–3.6056. Notice that the values of Kbecome K=1.3210 fora=3.6056 K=–0.1211 fora=–3.6056 Since is in the feedforward path, the gain Kshould be positive. Hence, we choose K=1.3210, a=3.6056 Then can be given by To determine and we proceed as follows: (8–12) Thus, To check the response to a unit-step disturbance input, we obtain the closed-loop transfer function Y(s)/D(s). =5s s3+12.605s2+52.63s +85.8673 =5s s(s+1)(s +5)+5K(s +a)2 Y(s) D(s)=Gp 1+Gc1 GpKp=9.5260, Ti=0.5547, Td=0.1387 =9.5260a1+1 0.5547s+0.1387sb Gc1(s)=1.3210As2+7.2112s +13B sTd , Kp ,Ti , =1.3210s2+9.5260s +17.1735 s =1.3210 (s+3.6056)2 s Gc1(s)=K (s+a)2 sGc1(s)Gc1(s)K=4 5a-15612 Chapter 8 / PID Controllers and Modified PID Controllers The response to the unit-step disturbance input is shown in Figure 8–42. The response curve seems good and acceptable. Note that the closed-loop poles are located at s=–3_j2 ands=–6.6051. The complex-conjugate closed-loop poles act as dominant closed-loop poles. Design of We now design to obtain the desired responses to the reference inputs. The closed-loop transfer function Y(s)/R(s) can be given by Zero placement. We place two zeros together with the dc gain constant such that the numera- tor is the same as the sum of the last three terms of the denominator. That is, By equating the coefficients of s 2 terms and sterms on both sides of this last equation, from which we get Therefore, (8–13) G c2 (s)=1+1.2sK ˆ p =1, T ˆ d =1.2 47.63 +5K ˆ p =52.63 6.6051 +5K ˆ p T ˆ d =12.6051=12.6051s 2 +52.63s +85.8673 A6.6051 +5K ˆ p T ˆ d Bs 2 +A47.63 +5K ˆ p Bs+85.8673 =A6.6051 +5K ˆ p T ˆ d Bs 2 +A47.63 +5K ˆ p Bs+85.8673 s 3 +12.6051s 2 +52.63s +85.8673 = c 1.321s 2 +9.526s +17.1735 s+K ˆ p A1+T ˆ d sB d 5 (s+1)(s +5) 1+1.321s 2 +9.526s +17.1735 s 5 (s+1)(s +5) Y(s) R(s)=AG c1 +G c2 BG p 1+G c1 G p G c2 (s) G c2 (s): y d (t) t (sec)Unit-Step Response of Y(s)/D(s) 0.030.040.050.060.070.080.090.1 0.02 0.01 0 0 0.5 1 1.5 2 2.5 3 Figure 8–42 Response to unit- step disturbance input. Openmirrors.comSection 8–7 / Zero-Placement Approach to Improve Response Characteristics 613With this controller the closed-loop transfer function Y(s)/R(s) becomes The response to the unit-step reference input becomes as shown in Figure 8–43(a).Y(s) R(s)=12.6051s2+52.63s +85.8673 s3+12.6051s2+52.63s +85.8673Gc2(s), (a)yr(t) t (sec)Response to Unit-Step Reference Input 0.60.811.21.4 0.4 0.2 0 0 0.2 0.4 0.6 0.8 1 1.2 1.4 1.6 1.8 2 Figure 8–43 (a) Response to unit-step reference input; (b) response to unit- ramp referenceinput; (c) response tounit-accelerationreference input. (b)yr(t) t (sec)Response to Unit-Ramp Reference Input 0.60.811.21.41.61.82 0.4 0.2 0 0 0.2 0.4 0.6 0.8 1 1.2 1.4 1.6 1.8 2Input Output614 Chapter 8 / PID Controllers and Modified PID Controllers Figure 8–43 (continued) (c) y r (t) t (sec)Response to Unit-Acceleration Reference Input 0.60.811.21.41.61.82 0.4 0.2 0 0 0.2 0.4 0.6 0.8 1 1.2 1.4 1.6 1.8 2 Input Output The response exhibits the maximum overshoot of 21 %and the settling time is approximately 1.6 sec. Figures 8–43(b) and (c) show the ramp response and acceleration response. The steady- state errors in both responses are zero.The response to the step disturbance was satisfactory.Thus, the designed controllers and given by Equations (8–12) and (8–13), respectively, are satisfactory. If the response characteristics to the unit-step reference input are not satisfactory, we need to change the location of the dominant closed-loop poles and repeat the design process. The domi- nant closed-loop poles should lie in a certain region in the left-half splane (such as 2/H11349a/H113496, 2/H11349b/H113496, 6/H11349c/H1134912). If the computational search is desired, write a computer program (sim- ilar to MATLAB Program 8–8) and execute the search process. Then a desired set or sets of val- ues of a, b, and cmay be found such that the system response to the unit-step reference input satisfies all requirements on maximum overshoot and settling time. EXAMPLE PROBLEMS AND SOLUTIONS A–8–1. Describe briefly the dynamic characteristics of the PI controller, PD controller, and PID controller. Solution. The PI controller is characterized by the transfer function The PI controller is a lag compensator. It possesses a zero at and a pole at s=0. Thus, the characteristic of the PI controller is infinite gain at zero frequency. This improves the steady-state characteristics. However, inclusion of the PI control action in the system increases thes=-1/H20862T i G c (s)=K p a 1+1 T i s b G c2 (s) G c1 (s) Openmirrors.comExample Problems and Solutions 615KE(s) U(s) 1 K0T1s 1+T1s1 1+T2s+– Figure 8–44 PID controller.type number of the compensated system by 1, and this causes the compensated system to be less stable or even makes the system unstable.Therefore, the values of must be chosen care- fully to ensure a proper transient response. By properly designing the PI controller, it is possibleto make the transient response to a step input exhibit relatively small or no overshoot.The speedof response, however, becomes much slower. This is because the PI controller, being a low-passfilter, attenuates the high-frequency components of the signal. The PD controller is a simplified version of the lead compensator. The PD controller has the transfer function where The value of K pis usually determined to satisfy the steady-state requirement. The corner frequency is chosen such that the phase lead occurs in the neighborhood of the gain crossover frequency. Although the phase margin can be increased, the magnitude of the com-pensator continues to increase for the frequency region (Thus, the PD controller is ahigh-pass filter.) Such a continued increase of the magnitude is undesirable, since it amplifieshigh-frequency noises that may be present in the system. Lead compensation can provide a sufficient phase lead, while the increase of the magnitude for the high-frequency region is very much smaller than that for PD control. Therefore, lead compensation is preferred overPD control. Because the transfer function of the PD controller involves one zero, but no pole, it is not possible to electrically realize it by passive RLC elements only. Realization of the PD controller using op amps, resistors, and capacitors is possible, but because the PD controller is a high-pass filter, as mentioned earlier, the differentiation process involved may cause serious noise problemsin some cases.There is, however, no problem if the PD controller is realized by use of the hydraulicor pneumatic elements. The PD control, as in the case of the lead compensator, improves the transient-response characteristics, improves system stability, and increases the system bandwidth, which implies fast rise time. The PID controller is a combination of the PI and PD controllers. It is a lag–lead compensator. Note that the PI control action and PD control action occur in different frequency regions. The PI control action occurs at the low-frequency region and PD control action occurs at the high- frequency region. The PID control may be used when the system requires improvements in bothtransient and steady-state performances. A–8–2. Show that the transfer function U(s)/E(s) of the PID controller shown in Figure 8–44 is Assume that the gain Kis very large compared with unity, or K/H112711.U(s) E(s)=K0T1+T2 T1c1+1 AT1+T2Bs+T1 T2 s T1+T2d1/H20862Td6v.1/H20862TdGc(s)=KpA1+Td sBGc(s),Kp and Ti616 Chapter 8 / PID Controllers and Modified PID Controllers +– +– E i (s)E(s)E o (s)Z 1 Z 2 C 1 C 2 R 1 R 2 R 4 R 3 R 5 Figure 8–45 Modified PID controller.Solution A–8–3. Consider the electronic circuit involving two operational amplifiers shown in Figure 8–45. This is a modified PID controller in that the transfer function involves an integrator and a first-order lag term. Obtain the transfer function of this PID controller. Solution. Since and we have Also, E o (s) E(s)=-R 5 R 4 E(s) E i (s)=-Z 2 Z 1 =-AR 2 C 2 s+1BAR 1 C 1 s+1B C 2 sAR 1 +R 3 +R 1 R 3 C 1 sBZ 2 =R 2 +1 C 2 sZ 1 =1 1 R 1 +C 1 s+R 3 =R 1 +R 3 +R 1 R 3 C 1 s 1+R 1 C 1 s=K 0 T 1 +T 2 T 1 c 1+1 AT 1 +T 2 Bs+T 1 T 2 s T 1 +T 2 d =K 0 a 1+1 T 1 s+T 2 s+T 2 T 1 b =K 0 a 1+1 T 1 s b A1+T 2 sB=K 0 A1+T 1 sBA1+T 2 sB T 1 s/H11216K K a 1 K 0 T 1 s 1+T 1 s1 1+T 2 s b U(s) E(s)=K 1+K a 1 K 0 T 1 s 1+T 1 s1 1+T 2 s b Openmirrors.comExample Problems and Solutions 617R(s) C(s) 1 g 1 Tds+– Figure 8–46 Approximatedifferentiator. PID controller Plant G(s)C(s) R(s)D(s) K(as+ 1) (bs+ 1) s1 s2+ 3.6s+ 9+–++ Figure 8–47 PID-controlledsystem.Consequently, Notice that R 1C1andR2C2determine the locations of the zeros of the controller, while R1,R3,and C1affect the location of the pole on the negative real axis. R5/R4adjusts the gain of the controller. A–8–4. In practice, it is impossible to realize the true differentiator. Hence, we always have to approxi- mate the true differentiator by something like One way to realize such an approximate differentiator is to utilize an integrator in the feedback path. Show that the closed-loop transfer function of the system shown in Figure 8–46 is given by the pre-ceding expression. (In the commercially available differentiator, the value of gmay be set as 0.1.) Solution. The closed-loop transfer function of the system shown in Figure 8–46 is Note that such a differentiator with first-order delay reduces the bandwidth of the closed-loop control system and reduces the detrimental effect of noise signals. A–8–5. Consider the system shown in Figure 8–47. This is a PID control of a second-order plant G(s). As- sume that disturbances D(s) enter the system as shown in the diagram. It is assumed that the ref- erence input R(s) is normally held constant, and the response characteristics to disturbances are a very important consideration in this system.C(s) R(s)=1 g 1+1 gTd s=Td s 1+gTd sTd s 1+gTd sTd s=R5 R2 R4 R3as+1 R1 C1bas+1 R2 C2b sas+R1+R3 R1 R3 C1b Eo(s) Ei(s)=Eo(s) E(s) E(s) Ei(s)=R5 R4AR1+R3BC2 AR1 C1 s+1BAR2 C2 s+1B saR1 R3 R1+R3 C1 s+1b618 Chapter 8 / PID Controllers and Modified PID Controllers Design a control system such that the response to any step disturbance will be damped out quickly (in 2 to 3 sec in terms of the 2 %settling time). Choose the configuration of the closed-loop poles such that there is a pair of dominant closed-loop poles. Then obtain the response to the unit-step disturbance input. Also, obtain the response to the unit-step reference input. Solution. The PID controller has the transfer function For the disturbance input in the absence of the reference input, the closed-loop transfer function becomes (8–14) The specification requires that the response to the unit-step disturbance be such that the settling time be 2 to 3 sec and the system have a reasonable damping. We may interpret the specification as and v n =4 rad /H20862sec for the dominant closed-loop poles.We may choose the third pole ats=–10 so that the effect of this real pole on the response is small. Then the desired charac- teristic equation can be written as (s+10)As 2 +2*0.5*4s+4 2 B=(s+10)As 2 +4s+16B=s 3 +14s 2 +56s+160 The characteristic equation for the system given by Equation (8–14) is s 3 +(3.6+Kab)s 2 +(9+Ka+Kb)s+K=0 Hence, we require 3.6+Kab=14 9+Ka+Kb=56 K=160 which yields ab=0.065, a+b=0.29375 The PID controller now becomes With this PID controller, the response to the disturbance is given by =s (s+10)As 2 +4s+16B D(s) C d (s)=s s 3 +14s 2 +56s +160 D(s) =10.4As 2 +4.5192s +15.385B s =160A0.065s 2 +0.29375s +1B s G c (s)=KCabs 2 +(a+b)s+1D sz=0.5 =s s 3 +(3.6 +Kab)s 2 +(9+Ka+Kb)s +K C d (s) D(s)=s sAs 2 +3.6s +9B+K(as +1)(bs +1)G c (s)=K(as +1)(bs +1) s Openmirrors.comExample Problems and Solutions 619Clearly, for a unit-step disturbance input, the steady-state output is zero, since The response to a unit-step disturbance input can be obtained easily with MATLAB. MATLAB Program 8–9 produces a response curve as shown in Figure 8–48(a). From the response curve, we see that the settling time is approximately 2.7 sec.The response damps out quickly.Therefore, the system designed here is acceptable.lim tSqcd(t)=lim sS0sCd(s)=lim sS0s2 (s+10)As2+4s+16B1 s=0 MATLAB Program 8–9 % ***** Response to unit-step disturbance input *****numd = [1 0]; dend = [1 14 56 160];t = 0:0.01:5;[c1,x1,t] = step(numd,dend,t);plot(t,c1)gridtitle('Response to Unit-Step Disturbance Input')xlabel('t Sec')ylabel('Output to Disturbance Input') % ***** Response to unit-step reference input *****numr = [10.4 47 160]; denr = [1 14 56 160];[c2,x2,t] = step(numr,denr,t);plot(t,c2)gridtitle('Response to Unit-Step Reference Input')xlabel('t Sec')ylabel('Output to Reference Input') For the reference input r(t), the closed-loop transfer function is The response to a unit-step reference input can also be obtained by use of MATLAB Program 8–9. The resulting response curve is shown in Figure 8–48(b).The response curve shows that the max-imum overshoot is 7.3 %and the settling time is 1.2 sec.The system has quite acceptable response characteristics. =10.4s 2+47s +160 s3+14s2+56s +160 Cr(s) R(s)=10.4As2+4.5192s +15.385B s3+14s2+56s +160620 Chapter 8 / PID Controllers and Modified PID Controllers A–8–6. Consider the system shown in Figure 8–49. It is desired to design a PID controller such that the dominant closed-loop poles are located at For the PID controller, choose a=1 and then determine the values of Kand b.Sketch the root-locus diagram for the designed system. Solution. Since G c (s)G(s) =K(s+1)(s +b) s1 s 2 +1s=-1;j13 .G c (s) Output to Disturbance Input 14 6 2 –4 8 12 4 10 0 –2 10 –3 Response to Unit-Step Disturbance Input t Sec0 0.5 5 4.5 3 3.5 4 1 1.5 2 2.5 (a) Output to Reference Input 1.2 0.6 0 0.8 1.0 0.4 0.2Response to Unit-Step Reference Input t Sec0 0.5 5 4.5 3 3.5 4 1 1.5 2 2.5 (b) Figure 8–48 (a) Response to unit-step disturbance input; (b) response to unit-step reference input. Openmirrors.comExample Problems and Solutions 621Real Axis–5 0 –1 1 –3 –4 –2Imag Axis –203 –32 –11Root-Locus Plot of Gc(s)G(s) Figure 8–50 Root-locus plot ofthe compensatedsystem.R(s) C(s) PID controller Plant Gc(s) G(s)(s+a ) (s+b) sK1 s2+ 1+– Figure 8–49 PID-controlledsystem. the sum of the angles at one of the desired closed-loop poles, from the zero at s=–1 and poles at s=0, s=j, ands=–j is 90°-143.794 °-120 °-110.104 °=–283.898 ° Hence the zero at s=–b must contribute 103.898°. This requires that the zero be located at b=0.5714 The gain constant Kcan be determined from the magnitude condition. or K=2.3333 Then the compensator can be written as follows: The open-loop transfer function becomes From this equation a root-locus plot for the compensated system can be drawn. Figure 8–50 is a root-locus plot.G c(s)G(s) =2.3333(s +1)(s +0.5714) s1 s2+1Gc(s)=2.3333(s+1)(s +0.5714) s2K(s+1)(s +0.5714) s1 s2+12 s=-1+j13=1s=-1+j13,622 Chapter 8 / PID Controllers and Modified PID Controllers The closed-loop transfer function is given by The closed-loop poles are located at and s=–0.3333. A unit-step response curve is shown in Figure 8–51. The closed-loop pole at s=–0.3333 and a zero at s=–0.5714 produce a long tail of small amplitude. A–8–7. Consider the system shown in Figure 8–52. Design a compensator such that the static velocity error constant is 4 sec −1 , phase margin is 50°, and gain margin is 10 dB or more. Plot unit-step and unit-ramp response curves of the compensated system with MATLAB.Also, draw a Nyquist plot of the compensated system with MATLAB. Using the Nyquist stability criterion, verify that the designed system is stable. Solution. Since the plant does not have an integrator, it is necessary to have an integrator in the compensator. Let us choose the compensator to be where is to be determined later. Since the static velocity error constant is specified as 4 sec −1 , we have K v =lim sS0 sG c (s)s+0.1 s 2 +1=lim sS0 sK sG ˆ c (s)s+0.1 s 2 +1=0.1K=4G ˆ c (s)G c (s)=K sG ˆ c (s), lim sS0 G ˆ c (s)=1s=-1;j13 C(s) R(s)=2.3333(s +1)(s +0.5714) s 3 +s+2.3333(s +1)(s +0.5714) Time (sec)08 12 10 4 2 6 Amplitude 0.4 0.81.2 0.6 1 0.2 0Unit-Step Response of Compensated System Figure 8–51 Unit-step response of the compensated system. G c (s)s+ 0.1 s 2 + 1 +− Figure 8–52 Control system. Openmirrors.comExample Problems and Solutions 623Thus, K= 40. Hence Next, we plot a Bode diagram of MATLAB Program 8–10 produces a Bode diagram of G(s) as shown in Figure 8–53.G(s) =40(s+0.1) s(s2+1)Gc(s)=40 sGˆc(s) We need the phase margin of 50° and gain margin of 10 dB or more. Let us choose to be Then Gc(s)will contribute up to 90° phase lead in the high-frequency region. By simple MATLAB trials, we find that a= 0.1526 gives the phase margin of 50° and gain margin of dB. +qGˆc(s)=as+1(a70)Gˆc(s)MATLAB Program 8–10 % ***** Bode Diagram ***** num = [40 4]; den = [1 0.000000001 1 0];bode(num,den)title('Bode Diagram of G(s) = 40(s+0.1)/[s(s^2+1)]') Figure 8–53 Bode diagram of G(s)=40(s+0.1)/[s(s 2+1) ]. Frequenc y (rad/sec)Bode Diagram of G(s) = 40( s + 0.1)/[ s(s2 + 1)] −200−50 −100 −1500−100Phase (deg); Magnitude (dB)0300 200 100 10−310−210−1100101624 Chapter 8 / PID Controllers and Modified PID Controllers MATLAB Program 8–11 % ***** Bode Diagram ***** num = conv([40 4],[0.1526 1]); den = [1 0.000000001 1 0]; sys = tf(num,den); w = logspace(-2,2,100); bode(sys,w) [Gm,pm,wcp,wcg] = margin(sys); GmdB = 20*log10(Gm); [GmdB,pm,wcp,wcg] ans = Inf 50.0026 NaN 8.0114 title('Bode Diagram of G(s) = 40(s+0.1)(0.1526s+1)/[s(s^2+1)]') Figure 8–54 Bode diagram of G(s)=40(s+0.1) (0.1526s+1)/ [s(s 2 +1)]. Frequenc y (rad/sec)Bode Diagram of G(s) = 40( s + 0.1)(0.1526 s + 1)/[ s(s 2 + 1)] −20050 −500 −100 −150100−50 Phase (deg); Magnitude (dB) 0100 50 10 −2 10 −1 10 0 10 1 10 2 The designed compensator has the following transfer function: G c (s)=40 sG ˆ c (s)=40(0.1526 s+1) sSee MATLAB Program 8–11 and the resulting Bode diagram shown in Figure 8–54. From this Bode diagram we see that the static velocity error constant is 4 sec −1 , phase margin is 50° and gain margin is dB. Therefore, the designed system satisfies all the requirements. +q Openmirrors.comExample Problems and Solutions 625The open-loop transfer function of the designed system is Open-loop transfer function We shall next check the unit-step response and the unit-ramp response of the designed system. The closed-loop transfer function is The closed-loop poles are located at s= /H110023.0032+j5.6573 s= /H110023.0032-j5.6573 s= /H110020.0975 MATLAB Program 8–12 will produce the unit-step response curve of the designed system.The re- sulting unit-step response curve is shown in Figure 8–55. Notice that the closed-loop pole at s=−0.0975 and the plant zero at s=−0.1 produce a long tail of small amplitude.C(s) R(s)=6.104 s2+40.6104 s+4 s3+6.104 s2+41.6104 s+4=6.104 s2+40.6104 s+4 s(s2+1)=40(0.1526 s+1) ss+0.1 s2+1 MATLAB Program 8–12 % ***** Unit-Step Response *****num = [6.104 40.6104 4]; den = [1 6.104 41.6104 4];t = 0:0.01:10;step(num,den,t)grid Figure 8–55 Unit-step response ofC(s)/R(s)=(6.104s 2+ 40.6104s+4)/(s3+ 6.104s2+41.6104s+4). Time (sec)2 1 79 6 8 10 0 4 3 5Amplitude1.4 0.8 01.2 0.4 0.21 0.6Step ResponseMATLAB Program 8–13 produces the unit-ramp response curve of the designed system. The resulting response curve is shown in Figure 8–56. 626 Chapter 8 / PID Controllers and Modified PID Controllers MATLAB Program 8–13 % ***** Unit-Ramp Response ***** num = [0 0 6.104 40.6104 4]; den = [1 6.104 41.6104 4 0]; t = 0:0.01:20; c = step(num,den,t); plot(t,c,'-.',t,t,'-') title('Unit-Ramp Response') xlabel('t(sec)') ylabel('Input Ramp Function and Output') text(3,11.5,'Input Ramp Function') text(13.8,11.2,'Output') Figure 8–56 Unit-ramp response ofC(s)/R(s)= (6.104s 2 +40.6104s+ 4)/(s 3 +6.104s 2 + 41.6104s+4). Output Input Ramp Function t (sec)4 2 14 18 12 16 20 0 8 6 10 Input Ramp Function and Output 20 8 012 18 4 216 1014 6Unit-Ramp Response Nyquist Plot. Earlier we found that the three closed-loop poles of the designed system are all in the left-half splane. Hence the designed system is stable. The purpose of plotting Nyquist diagram here is not to test the stability of the system, but to enhance our understanding of Nyquist stability analysis. For a complicated system, Nyquist plot will look complicated enough that it is not easy to count the number of encirclements of the −1+j0 point. Openmirrors.comExample Problems and Solutions 627Because the designed system involves three open-loop poles on the jwaxis, the Nyquist dia- gram will look quite complicated as we will see in what follows: Define the open-loop transfer function of the designed system as G(s) . Then Let us choose a modified Nyquist path in the splane as shown in Figure 8–57(a). The modified path encloses three open-loop poles (s=0, s=j1, s= /H11002j1). Now define s1=s+ . Then, the Nyquist path in the s1plane becomes as shown in Figure 8–57(b). In the s1plane, the open- loop transfer function has three poles in the right-half s1plane. Let us choose Since we have Open-loop transfer function in the s1plane A MATLAB program to obtain the Nyquist plot is shown in MATLAB Program 8–14. The re- sulting Nyquist plot is shown in Figure 8–58.=6.104 s12+40.48832 s1+3.5945064 s13-0.03s12+1.0003 s1-0.010001=6.104 (s12-0.02s1+0.0001 )+40.6104 (s1-0.01)+4 (s1-0.01)(s12-0.02s1+1.0001 )G(s) =G(s1-0.01)s=s1-s0, s0=0.01.s0G(s) =Gc(s)s+0.1 s2+1=6.104 s2+40.6104 s+4 s(s2+1)Figure 8–57 (a) ModifiedNyquist path in thesplane; (b) Nyquist path inthes 1plane.s plane s1 planejv (a) (b)0 s s0jv 0 s MATLAB Program 8–14 % ***** Nyquist Plot *****num = [6.104 40.48832 3.5945064]; den = [1 -0.03 1.0003 -0.010001];nyquist(num,den)v = [-1500 1500 -2500 2500]; axis(v)628 Chapter 8 / PID Controllers and Modified PID Controllers Figure 8–58 Nyquist plot. −1500 −1000 −500 0 500 1000 1500 Real AxisNyquest Diagram Imaginary Axis 2500 2000 1500 1000 500 0 −500 −1000 −1500 −2000 −2500 Figure 8–59 Redrawn Nyquist plot. Im Rev= 0+v= 0− v=−`v=+` Using the Nyquist plot obtained here, it is not easy to determine the encirclements of the −1+j0 point by the Nyquist locus. Therefore, we need to redraw this Nyquist plot qualitatively to show the details near the −1+j0 point. Such a redrawn Nyquist diagram is shown in Figure 8–59. From this diagram we find that the −1+j0 point is encircled counterclockwise three times. Hence, N/H11005−3. Since the open-loop transfer function has three poles in the right-half s 1 plane, we have P/H110053.Then, we have Z/H11005N+P /H110050.This means that there are no closed-loop poles in the right-half s 1 plane. The system is therefore stable. A–8–8. Show that the I-PD-controlled system shown in Figure 8–60(a) is equivalent to the PID-controlled system with input filter shown in Figure 8–60(b). Openmirrors.comExample Problems and Solutions 629Solution. The closed-loop transfer function C(s)/R(s) of the I-PD-controlled system is The closed-loop transfer function C(s)/R(s) of the PID-controlled system with input filter shown in Figure 8–60(b) is The closed-loop transfer functions of both systems are the same.Thus, the two systems are equivalent. A–8–9. The basic idea of the I-PD control is to avoid large control signals (which will cause a saturation phenomenon) within the system. By bringing the proportional and derivative control actions to the feedback path, it is possible to choose larger values for than those possible by thePID control scheme. Compare, qualitatively, the responses of the PID-controlled system and I-PD-controlled system to the disturbance input and to the reference input. Solution. Consider first the response of the I-PD-controlled system to the disturbance input. Since, in the I-PD control of a plant, it is possible to select larger values for than thoseof the PID-controlled case, the I-PD-controlled system will attenuate the effect of disturbance faster than the PID-controlled case. Next, consider the response of the I-PD-controlled system to a reference input. Since the I-PD-controlled system is equivalent to the PID-controlled system with input filter (refer to Prob-lemA–8–8 ), the PID-controlled system will have faster responses than the corresponding I-PD-con- trolled system, provided a saturation phenomenon does not occur in the PID-controlled system.K p and TdKp and Td =Kp Ti s Gp(s) 1+Kpa1+1 Ti s+Td sbGp(s) C(s) R(s)=1 1+Ti s+Ti Td s2 Kpa1+1 Ti s+Td sbGp(s) 1+Kpa1+1 Ti s+Td sbGp(s)C(s) R(s)=Kp Ti sGp(s) 1+Kpa1+1 Ti s+Td sbGp(s)(b)Gp(s)C(s) R(s) Kp(1++ Tds)1 Tis1 1+Tis+TiTds2+–(a)Kp TisGp(s)C(s) R(s) Kp(1+Tds)+–+– Figure 8–60 (a) I-PD-controlledsystem;(b) PID-controlledsystem with input filter.630 Chapter 8 / PID Controllers and Modified PID Controllers A–8–10. In some cases it is desirable to provide an input filter as shown in Figure 8–61(a). Notice that the input filter is outside the loop. Therefore, it does not affect the stability of the closed- loop portion of the system.An advantage of having the input filter is that the zeros of the closed-loop transfer function can be modified (canceled or replaced by other zeros) so that the closed- loop response is acceptable. Show that the configuration in Figure 8–61(a) can be modified to that shown in Figure 8–61(b), where The compensation structure shown in Figure 8–61(b) is some- times called command compensation. Solution. For the system of Figure 8–61(a), we have (8–15) For the system of Figure 8–61(b), we have Thus or (8–16) By substituting into Equation (8–16), we obtain =G f (s) G c (s)G p (s) 1+G c (s)G p (s) C(s) R(s)=CG f (s)G c (s)-G c (s)+G c (s)DG p (s) 1+G c (s)G p (s)CG f (s)-1DG c (s) G d (s)=C(s) R(s)=CG d (s)+G c (s)DG p (s) 1+G c (s)G p (s)C(s) =G p (s)EG d (s)R(s) +G c (s)CR(s) -C(s)DF C(s) =G p (s)U(s) E(s) =R(s) -C(s) U(s) =G d (s)R(s) +G c (s)E(s)C(s) R(s)=G f (s)G c (s)G p (s) 1+G c (s)G p (s)CG f (s)-1DG c (s). G d (s)=G f (s) (a) (b) G c (s)C(s) R(s) G p (s) G f (s) G c (s)C(s) R(s) E(s) G d (s) G p (s) U(s) +– +– ++ Figure 8–61 (a) Block diagram of control system with input filter; (b) modified block diagram. Openmirrors.comwhich is the same as Equation (8–15). Hence, we have shown that the systems shown in Figures 8–61(a) and (b) are equivalent. It is noted that the system shown in Figure 8–61(b) has a feedforward controller In such a case, does not affect the stability of the closed-loop portion of the system. A–8–11. A closed-loop system has the characteristic that the closed-loop transfer function is nearly equal to the inverse of the feedback transfer function whenever the open-loop gain is much greaterthan unity. The open-loop characteristic may be modified by adding an internal feedback loop with a characteristic equal to the inverse of the desired open-loop characteristic. Suppose that a unity-feedback system has the open-loop transfer function Determine the transfer function H(s) of the element in the internal feedback loop so that the inner loop becomes ineffective at both low and high frequencies. Solution. Figure 8–62(a) shows the original system. Figure 8–62(b) shows the addition of the in- ternal feedback loop around G(s). Since if the gain around the inner loop is large compared with unity, then is approximately equal to unity, and the transfer function C(s)/E(s) is approximately equal to 1/H(s). On the other hand, if the gain is much less than unity, the inner loop becomes ineffective and C(s)/E(s) becomes approximately equal to G(s). To make the inner loop ineffective at both the low- and high-frequency ranges, we require that Since, in this problem, G(jv)=K A1+jvT1BA1+jvT2B|G(jv)H(jv)|/H112701,for v/H112701 and v/H112711@G(s)H(s)@G(s)H(s) /H20862C1+G(s)H(s)DC(s) E(s)=G(s) 1+G(s)H(s)=1 H(s)G(s)H(s) 1+G(s)H(s)G(s) =K AT1 s+1BAT2 s+1BGd(s)Gd(s). Example Problems and Solutions 631(a) (b)G(s)C R G(s) H(s)C E R GH(s)1 H(s)C E R =+– +–+–+–+–Figure 8–62 (a) Control system; (b) addition of the internal feedbackloop to modify theclosed-loopcharacteristic.632 Chapter 8 / PID Controllers and Modified PID Controllers the requirement can be satisfied if H(s) is chosen to be H(s)=ks because Thus, with H(s)=ks (velocity feedback), the inner loop becomes ineffective at both the low- and high-frequency regions. It becomes effective only in the intermediate-frequency region. A–8–12. Consider the control system shown in Figure 8–63. This is the same system as that considered in Example 8–1. In that example we designed a PID controller , starting with the second method of the Ziegler–Nichols tuning rule. Here we design a PID controller using the computational approach with MATLAB. We shall determine the values of Kandaof the PID controller such that the unit-step response will exhibit the maximum overshoot between 10 %and 2 % (1.02 /H11349maximum output /H113491.10) and the settling time will be less than 3 sec.The search region is 2/H11349K/H1134950, 0.05 /H11349a/H113492 Let us choose the step size for Kto be 1 and that for ato be 0.05. Write a MATLAB program to find the first set of variables Kandathat will satisfy the given specifications. Also, write a MATLAB program to find all possible sets of variables Kandathat will satisfy the given specifications. Plot the unit-step response curves of the designed system with the chosen sets of variables Kanda. Solution. The transfer function of the plant is The closed-loop transfer function C(s)/R(s) is given by A possible MATLAB program that will produce the first set of variables Kand athat will satisfy the given specifications is given in MATLAB Program 8–15. In this program we C(s) R(s)=Ks 2 +2Kas +Ka 2 s 4 +6s 3 +(5+K)s 2 +2Kas +Ka 2 G p (s)=1 s 3 +6s 2 +5sG c (s)=K(s+a) 2 sG c (s) lim vSq G(jv)H(jv)=lim vSq Kkjv A1+jvT 1 BA1+jvT 2 B=0 lim vS0 G(jv)H(jv)=lim vS0 Kkjv A1+jvT 1 BA1+jvT 2 B=0 R(s) C(s) PID controller1 s(s+ 1) (s+ 5) +– G c (s) Figure 8–63 Control system. Openmirrors.comExample Problems and Solutions 633MATLAB Program 8–15 t = 0:0.01:5; for K = 50:-1:2; for a = 2:-0.05:0.05; num = [K 2*K*a K*a^2];den = [1 6 5+K 2*K*a K*a^2]; y = step(num,den,t);m = max(y);s = 501; while y(s) > 0.98 & y(s) < 1.02;s = s-1; end;ts = (s-1)*0.01; if m < 1.10 & m > 1.02 & ts < 3.0break;endend if m < 1.10 & m > 1.02 & ts < 3.0breakendend plot(t,y)gridtitle('Unit-Step Response')xlabel('t sec')ylabel('Output')solution = [K;a;m;ts] solution =32.0000 0.20001.09692.6400use two ‘for’ loops. The specification for the settling time is interpreted by the following four lines: . Note that for t=0 : 0.01 : 5, we have 501 computing time points. s=501 corresponds to the last computing time point. The solution obtained by this program is K=32, a=0.2 with the maximum overshoot equal to 9.69 %and the settling time equal to 2.64 sec.The resulting unit-step response curve is shown in Figure 8–64.ts63.0ts=(s-1) * 0.01s=s-1; end;s=501; while y (s)70.98 and y (s)61.02;634 Chapter 8 / PID Controllers and Modified PID Controllers Output t (sec)Unit-Step Response 1.4 1.2 1 0.8 0.6 0.4 0.2 0 0 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5 Figure 8–64 Unit-step response curve. MATLAB Program 8–16 t = 0:0.01:5; k = 0; for i = 1:49; K(i) = 51-i*1; for j = 1:40; a(j) = 2.05-j*0.05; num = [K(i) 2*K(i)*a(j) K(i)*a(j)*a(j)]; den = [1 6 5+K(i) 2*K(i)*a(j) K(i)*a(j)*a(j)]; y = step(num,den,t); m = max(y); s = 501; while y(s) > 0.98 & y(s) < 1.02; s = s-1; end; ts = (s-1)*0.01; if m < 1.10 & m > 1.02 & ts < 3.0 k = k+1; table(k,:) = [K(i) a(j) m ts]; end end end table(k,:) = [K(i) a(j) m ts] table = (continues on next page ) Next, we shall consider the case where we want to find all sets of variables that will satisfy the given specifications. A possible MATLAB program for this purpose is given in MATLAB Pro- gram 8–16. Note that in the table shown in the program, the last row of the table (k, :) or the first row of the sorttable should be ignored. (These are the last Kandavalues for searching purposes.) Openmirrors.comExample Problems and Solutions 63532.0000 0.2000 1.0969 2.6400 31.0000 0.2000 1.0890 2.690030.0000 0.2000 1.0809 2.730029.0000 0.2500 1.0952 1.780029.0000 0.2000 1.0726 2.780028.0000 0.2000 1.0639 2.830027.0000 0.2000 1.0550 2.8900 2.0000 0.0500 0.3781 5.0000 sorttable = sortrows(table,3)sorttable = 2.0000 0.0500 0.3781 5.0000 27.0000 0.2000 1.0550 2.890028.0000 0.2000 1.0639 2.830029.0000 0.2000 1.0726 2.780030.0000 0.2000 1.0809 2.730031.0000 0.2000 1.0890 2.690029.0000 0.2500 1.0952 1.780032.0000 0.2000 1.0969 2.6400 K = sorttable(7,1)K = 29 a = sorttable(7,2)a= 0.2500 num = [K 2*K*a K*a^2]; den = [1 6 5+K 2*K*a K*a^2];y = step(num,den,t);plot(t,y)gridholdCurrent plot heldK = sorttable(2,1) K= 27 a = sorttable(2,2)a= 0.2000 (continues on next page )636 Chapter 8 / PID Controllers and Modified PID Controllers From the sorttable, it seems that K=29, a=0.25 (max overshoot =9.52% , settling time =1.78 sec) and K=27, a=0.2 (max overshoot =5.5% , settling time =2.89 sec) are two of the best choices.The unit-step response curves for these two cases are shown in Figure 8–65. From these curves, we might conclude that the best choice depends on the system objective. If a small maximum overshoot is desired, K=27, a=0.2 will be the best choice. If the shorter settling time is more important than a small maximum overshoot, then K=29, a=0.25 will be the best choice. A–8–13. Consider the two-degrees-of-freedom control system shown in Figure 8–66. The plant is given by Assuming that the noise input N(s) is zero, design controllers and such that the designed system satisfies the following: 1.The response to the step disturbance input has a small amplitude and settles to zero quickly (on the order of 1 sec to 2 sec).G c2 (s) G c1 (s)G p (s)=100 s(s+1)G p (s) num = [K 2*K*a K*a^2]; den = [1 6 5+K 2*K*a K*a^2]; y = step(num,den,t); plot(t,y) title('Unit-Step Response Curves') xlabel('t (sec)') ylabel('Output') text(1.22,1.22,'K = 29, a = 0.25') text(1.22,0.72,'K = 27, a = 0.2') Output t (sec)Unit-Step Response Curves 1.4 1.2 1 0.8 0.6 0.4 0.2 0 0 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5 K= 29, a = 0.25 K= 27, a = 0.2 Figure 8–65 Unit-step response curves. Openmirrors.comExample Problems and Solutions 637Gp(s) Gc1(s)Gc2(s) Y(s) N(s)U(s)D(s) R(s) B(s)+–++++ ++Figure 8–66 Two-degrees-of-freedom control system. 2.The response to the unit-step reference input has a maximum overshoot of 25 %or less, and the settling time is 1 sec or less. 3.The steady-state errors in following ramp reference input and acceleration reference input are zero. Solution. The closed-loop transfer functions for the disturbance input and reference input are given, respectively, by Let us assume that is a PID controller and has the following form: The characteristic equation for the system is Notice that the open-loop poles are located at s=0 (a double pole) and s=–1. The zeros are located at s=–a (a double zero). In what follows, we shall use the root-locus approach to determine the values of aandK. Let us choose the dominant closed-loop poles at s=–5_j5. Then, the angle deficiency at the desired closed-loop pole at s=–5+j5 is –135 °-135 °-128.66 °+180 °=–218.66 ° The double zero at s=–a must contribute 218.66°. (Each zero must contribute 109.33°.) By a simple calculation, we find a=–3.2460 The controller is then determined as The constant Kmust be determined by use of the magnitude condition. This condition is @G c1(s)Gp(s)@s=-5+j5=1Gc1(s)=K(s +3.2460)2 sGc1(s)1+Gc1(s)Gp(s)=1+K(s +a)2 s100 s(s+1)Gc1(s)=K(s +a)2 sGc1(s) Y(s) R(s)=CGc1(s)+Gc2(s)DGp(s) 1+Gc1(s)Gp(s) Y(s) D(s)=Gp(s) 1+Gc1(s)Gp(s)638 Chapter 8 / PID Controllers and Modified PID Controllers Since we obtain The controller thus becomes (8–17) Then, the closed-loop transfer function Y(s)/D(s) is obtained as follows: The response curve when D(s) is a unit-step disturbance is shown in Figure 8–67.=100s s 3 +12.403 s 2 +74.028 s+120.148=100 s(s+1) 1+0.11403 (s+3.2460 ) 2 s100 s(s+1)Y(s) D(s)=G p (s) 1+G c1 (s)G p (s)=0.74028 +1.20148 s+0.11403 s=0.11403 s 2 +0.74028 s+1.20148 sG c1 (s)=0.11403 (s+3.2460 ) 2 sG c1 (s) =0.11403 K= 2 s 2 (s+1) 100(s +3.2460) 2 2 s=-5+j5 G c1 (s)G p (s)=K(s +3.2460) 2 s100 s(s+1) y d (t) t (sec)Response to Unit-Step Disturbance Input 0.60.811.21.41.61.82 0.4 0.2 0 0 0.5 1 1.5 2 2.5 3 3.5 4 Figure 8–67 Response to unit- step disturbance input. Openmirrors.comExample Problems and Solutions 639(a)t (sec)Response to Unit-Step Reference Input 0.60.811.21.4 0.4 0.2 0 0 0.5 1 1.5 2 2.5 3yr(t) Figure 8–68 (a) Response to unit-step reference input; (b) response to unit- ramp referenceinput; (c) response tounit-accelerationreference input.Next, we consider the responses to reference inputs. The closed-loop transfer function Y(s)/R(s) is Let us define Then To satisfy the requirements on the responses to the ramp reference input and acceleration reference input, we use the zero-placement approach. That is, we choose the numerator ofY(s)/R(s) to be the sum of the last three terms of the denominator, or from which we get (8–18) Hence, the closed-loop transfer function Y(s)/R(s) becomes as The response curves to the unit-step reference input, unit-ramp reference input, and unit- acceleration reference input are shown in Figures 8–68(a), (b), and (c), respectively.The maximumY(s) R(s)=12.403 s2+74.028 s+120.148 s3+12.403 s2+74.028 s+120.148=0.74028 +1.20148 s+0.12403 sGc(s)=0.12403 s2+0.74028 s+1.20148 s100sGc(s)=12.403 s2+74.028 s+120.148=100sGc(s) s3+12.403 s2+74.028 s+120.148Y(s) R(s)=Gc(s)Gp(s) 1+Gc1(s)Gp(s)Gc1(s)+Gc2(s)=Gc(s)Y(s) R(s)=CGc1(s)+Gc2(s)DGp(s) 1+Gc1(s)Gp(s)overshoot in the unit-step response is approximately 25 %and the settling time is approximately 1.2 sec. The steady-state errors in the ramp response and acceleration response are zero. There- fore, the designed controller given by Equation (8–18) is satisfactory. Finally, we determine Noting that G c2 (s)=G c (s)-G c1 (s)G c2 (s).G c (s) 640 Chapter 8 / PID Controllers and Modified PID Controllers (b)t (sec)Response to Unit-Ramp Reference Input 1.522.53 1 0.5 0 0 0.5 1 1.5 2 2.5 3 Input Output y r (t) (c) y r (t) t (sec)Response to Unit-Acceleration Reference Input 0.60.811.21.41.61.82 0.4 0.2 0 0 0.2 0.4 0.6 0.8 1 1.2 1.4 1.6 1.8 2 Input Output Figure 8–68 (continued) Openmirrors.comand from Equation (8–17) we obtain (8–19) Equations (8–17) and (8–19) give the transfer functions of the controllers re- spectively. The block diagram of the designed system is shown in Figure 8–69. Note that if the maximum overshoot were much higher than 25 %and/or the settling time were much larger than 1.2 sec, then we might assume a search region (such as 3/H11349a/H113496, 3/H11349b/H113496,and 6/H11349c/H1134912) and use the computational method presented in Example 8–4 to find a set or sets of variables that would give the desired response to the unit-step reference input. PROBLEMSGc1(s) and Gc2(s), =0.01s - a0.7403 +1.20148 s+0.11403sb Gc2(s)=a0.7403 +1.20148 s+0.12403sbGc1(s)=0.7403 +1.20148 s+0.11403s Problems 641100 s(s+1)0.01s Y(s)D(s) R(s) +–++++ 1.20148 s0.7403 ++ 0.11403 s Figure 8–69 Block diagram of thedesigned system. B–8–1. Consider the electronic PID controller shown in Figure 8–70. Determine the values of R 1,R2,R3,R4,C1, and C2of the controller such that the transfer function is Gc(s)=Eo(s) /H20862Ei(s) =30.3215 (s+0.65)2 s Gc(s)=39.42a1+1 3.077s+0.7692sb +– +– Ei(s)E(s)Eo(s)C1 C2 R1R2 R3R4 Figure 8–70 Electronic PID controller.642 Chapter 8 / PID Controllers and Modified PID Controllers B–8–2. Consider the system shown in Figure 8–71. Assume that disturbances D(s) enter the system as shown in the diagram. Determine parameters K, a, and bsuch that the response to the unit-step disturbance input and the response to the unit-step reference input satisfy the following specifications: The response to the step distur- bance input should attenuate rapidly with no steady-state error, and the response to the step reference input exhibits a maximum overshoot of 20 %or less and a settling time of 2 sec.B–8–3. Show that the PID-controlled system shown in Figure 8–72(a) is equivalent to the I-PD-controlled system with feedforward control shown in Figure 8–72(b). B–8–4. Consider the systems shown in Figures 8–73(a) and (b). The system shown in Figure 8–73(a) is the system designed in Example 8–1. The response to the unit-step reference input in the absence of the disturbance input is shown in Figure 8–10. The system shown in Figure 8–73(b) is the I-PD-controlled system using the same K p , as the system shown in Figure 8–73(a).T i , and T d C(s) R(s) D(s) K(as+ 1) (bs+ 1) s 2(s+ 2) (s+ 1) (s+ 10) +– ++ Figure 8–71 Control system. (a) (b) K p Tis G p (s) C(s) R(s) K p (1+T d s) K p (1+T d s) G p (s) C(s) R(s) K p (1++ T d s)1 T i s +– +– +– + Figure 8–72 (a) PID-controlled system; (b) I-PD-controlled system with feedforward control. Openmirrors.comProblems 643Obtain the response of the I-PD-controlled system to the unit-step reference input with MATLAB. Compare theunit-step response curves of the two systems. B–8–5. Referring to Problem B–8–4, obtain the response of the PID-controlled system shown in Figure 8–73(a) to the unit-step disturbance input. Show that for the disturbance input, the responses of the PID-controlled system shown in Figure 8–73(a) and ofthe I-PD-controlled system shown in Figure 8–73(b) areexactly the same. [When considering D(s) to be the input, as- sume that the reference input R(s) is zero, and vice versa.] Also, compare the closed-loop transfer function C(s)/R(s) of both systems. B–8–6. Consider the system shown in Figure 8–74.This sys- tem is subjected to three input signals: the reference input,disturbance input, and noise input. Show that the charac-teristic equation of this system is the same regardless ofwhich input signal is chosen as input. (a) (b)C(s) R(s)D(s) PID contoller39.42 (1 +1 3.077 s+ 0.7692 s)1 s(s+ 1) (s+ 5) D(s) C(s) R(s) 1+ 0.7692 s39.421 s(s+ 1) (s+ 5)1 3.077 s+–++ +–+–++ Figure 8–73 (a) PID-controlled system; (b) I-PD-controlled system. G2(s) H(s)C(s) Noise N(s)R(s)Disturbance D(s) G1(s) ++ +++– Figure 8–74 Control system.644 Chapter 8 / PID Controllers and Modified PID Controllers B–8–7. Consider the system shown in Figure 8–75. Obtain the closed-loop transfer function C(s)/R(s) for the refer- ence input and the closed-loop transfer function C(s)/D(s) for the disturbance input. When considering R(s) as the input, assume that D(s) is zero, and vice versa. B–8–8. Consider the system shown in Figure 8–76(a), where Kis an adjustable gain and G(s) andH(s) are fixedcomponents. The closed-loop transfer function for the disturbance is To minimize the effect of disturbances, the adjustable gain Kshould be chosen as large as possible. Is this true for the system in Figure 8–76(b), too?C(s) D(s)=1 1+KG(s)H(s) G 1 (s) G 2 (s)R(s) C(s)D(s) G 3 (s) H 1 (s)H 2 (s) +– +– ++ Figure 8–75 Control system. G(s)R(s) C(s) D(s)D(s) K H(s) G(s)R(s) C(s) K H(s)(a) (b) ++ +– ++ +– Figure 8–76 (a) Control system with disturbance entering in the feedforward path; (b) control system with disturbance entering in the feedback path. Openmirrors.comD(s) R(s) Y(s) N(s)Gc2 Gc1 Gc3 G1 G2 +– ––++ – ––++ ++ Problems 645B–8–9. Show that the control systems shown in Fig- ures 8–77(a), (b), and (c) are two-degrees-of-freedomsystems. In the diagrams, G c1andGc2are controllers and Gp is the plant.B–8–10. Show that the control system shown in Figure 8–78 is a three-degrees-of freedom system. The transfer func-tions G c1,Gc2,andGc3are controllers.The plant consists of transfer functions G1andG2. (c)D(s) Y(s) N(s)Gp Gc1 Gc2R(s) +++–++(b)D(s) Y(s) N(s)Gp Gc1 Gc2R(s) +–++ ++D(s) R(s) Y(s) Gp Gc1 Gc2 (a)+–++ ++ N(s) Figure 8–77 (a), (b), (c) Twodegrees-of-freedom systems. Figure 8–78 Three-degrees-of-freedom system.646 Chapter 8 / PID Controllers and Modified PID Controllers B–8–11. Consider the control system shown in Figure 8–79. Assume that the PID controller is given by It is desired that the unit-step response of the system exhibit the maximum overshoot of less than 10 %, but more than 2 % (to avoid an almost overdamped system), and the settling time be less than 2 sec. Using the computational approach presented in Section 8–4, write a MATLAB program to determine the values ofKandathat will satisfy the given specifications. Choose the search region to be 1/H11349K/H113494, 0.4 /H11349a/H113494 Choose the step size for Kand ato be 0.05. Write the program such that the nested loops start with the highest values of Kandaand step toward the lowest. Using the first-found solution, plot the unit-step response curve. B–8–12. Consider the same control system as treated in Problem B–8–11 (Figure 8–79). The PID controller is given by It is desired to determine the values of Kand asuch that the unit-step response of the system exhibits the maximumG c (s)=K(s+a) 2 sG c (s)=K(s+a) 2 sovershoot of less than 8 %, but more than 3 %, and the settling time is less than 2 sec. Choose the search region to be 2/H11349K/H113494, 0.5 /H11349a/H113493 Choose the step size for Kandato be 0.05. First, write a MATLAB program such that the nested loops in the program start with the highest values of Kand aand step toward the lowest and the computation stops when a successful set of Kandais found for the first time. Next, write a MATLAB program that will find all pos- sible sets of Kandathat will satisfy the given specifications. Among multiple sets of Kand athat satisfy the given specifications, determine the best choice.Then, plot the unit- step response curves of the system with the best choice ofKanda. B–8–13. Consider the two-degrees-of-freedom control system shown in Figure 8–80. The plant is given by Design controllers and such that the response to the unit-step disturbance input should have small amplitude and settle to zero quickly (in approximately 2 sec).The response to the unit-step reference input should be such that the maximum overshoot is 25 %(or less) and the settling time is 2 sec. Also, the steady-state errors in the response to the ramp and acceleration reference inputs should be zero.G c2 (s) G c1 (s)G p (s)=3(s+5) s(s+1)As 2 +4s+13BG p (s) R(s) C(s) PID controller1.2 (0.3s+ 1) (s+ 1) (1.2 s+ 1) +– G c (s) Figure 8–79 Control system. G p (s) G c1 (s) G c2 (s) Y(s) U(s)D(s) R(s) B(s) +– ++ ++ Figure 8–80 Two-degrees-of-freedom control system. Openmirrors.comProblems 647B–8–14. Consider the system shown in Figure 8–81. The plant is given by Determine the controllers and such that, for the step disturbance input, the response shows a small am- plitude and approaches zero quickly (in a matter of 1 to 2 sec). For the response to the unit-step reference input, it isdesired that the maximum overshoot be 20 %or less and the settling time 1 sec or less. For the ramp reference input andacceleration reference input, the steady-state errors shouldbe zero.G c2(s) Gc1(s)Gp(s)=2(s+1) s(s+3)(s +5)Gp(s)B–8–15. Consider the two-degrees-of-freedom control system shown in Figure 8–82. Design controllers and such that the response to the step disturbance input shows a small amplitude and settles to zero quickly (in 1 to2 sec) and the response to the step reference input ex- hibits 25 %or less maximum overshoot and the settling time is less than 1 sec.The steady-state error in following the rampreference input or acceleration reference input should bezero.G c2(s)Gc1(s) Gp(s) Gc1(s)Y(s) R(s) U(s)D(s) Gc2(s)+++–+– Figure 8–81 Two-degrees-of-freedom control system. 1 s2C1(s)Y(s) R(s)D(s) C2(s)+++–+– Figure 8–82 Two-degrees-of-freedom control system.9 648 Control Systems Analysis in State Space 9–1 INTRODUCTION* A modern complex system may have many inputs and many outputs, and these may be interrelated in a complicated manner.To analyze such a system, it is essential to reduce the complexity of the mathematical expressions, as well as to resort to computers for most of the tedious computations necessary in the analysis.The state-space approach to system analysis is best suited from this viewpoint. While conventional control theory is based on the input–output relationship, or trans- fer function, modern control theory is based on the description of system equations in terms of nfirst-order differential equations, which may be combined into a first-order vector-matrix differential equation.The use of vector-matrix notation greatly simplifies the mathematical representation of systems of equations.The increase in the number of state variables, the number of inputs, or the number of outputs does not increase the complexity of the equations. In fact, the analysis of complicated multiple-input, multiple- output systems can be carried out by procedures that are only slightly more compli- cated than those required for the analysis of systems of first-order scalar differential equations. This chapter and the next deal with the state-space analysis and design of control sys- tems. Basic materials of state-space analysis, including the state-space representation of * It is noted that in this book an asterisk used as a superscript of a matrix, such as A*, implies that it is a con- jugate transpose of matrix A.The conjugate transpose is the conjugate of the transpose of a matrix. For a real matrix (a matrix whose elements are all real), the conjugate transpose A* is the same as the transpose A T . Openmirrors.comSection 9–2 / State-Space Representations of Transfer-Function Systems 649systems, controllability, and observability are presented in this chapter. Useful design methods based on state-feedback control are given in Chapter 10. Outline of the Chapter. Section 9–1 has presented an introduction to state-space analysis of control systems. Section 9–2 deals with the state-space representation oftransfer-function systems. Here we present various canonical forms of state-space equa-tions. Section 9–3 discusses the transformation of system models (such as from transfer-function to state-space models, and vice versa) with MATLAB. Section 9–4 presentsthe solution of time-invariant state equations. Section 9–5 gives some useful results invector-matrix analysis that are necessary in studying the state-space analysis of controlsystems. Section 9–6 discusses the controllability of control systems and Section 9–7treats the observability of control systems. 9–2 STATE-SPACE REPRESENTATIONS OF TRANSFER-FUNCTION SYSTEMS Many techniques are available for obtaining state-space representations of transfer-function systems. In Chapter 2 we presented a few such methods. This sectionpresents state-space representations in the controllable, observable, diagonal, or Jordancanonical forms. (Methods for obtaining such state-space representations from transferfunctions are discussed in detail in Problems A–9–1 through A–9–4 .) State-Space Representations in Canonical Forms. Consider a system defined by (9–1) where uis the input and yis the output. This equation can also be written as (9–2) In what follows we shall present state-space representations of the system defined by Equation (9–1) or (9–2) in controllable canonical form, observable canonical form, anddiagonal (or Jordan) canonical form. Controllable Canonical Form. The following state-space representation is called a controllable canonical form: (9–3) Gx# 1 x# 2 /H11080 /H11080/H11080 x# n-1 x# nW=G0 0 /H11080/H11080/H11080 0 -a n1 0 /H11080/H11080/H11080 0 -a n-10 1 /H11080/H11080/H11080 0 -a n-2p p p p0 0 /H11080/H11080/H11080 1 -a 1WGx1 x2 /H11080 /H11080/H11080 x n-1 xnW+G0 0 /H11080/H11080/H11080 01WuY(s) U(s)=b0 sn+b1 sn-1+p+bn-1 s+bn sn+a1 sn-1+p+an-1 s+any(n) +a1 y(n-1) +p+an-1 y#+an y=b0 u(n) +b1 u(n-1) +p+bn-1 u#+bn u650 Chapter 9 / Control Systems Analysis in State Space (9–4) The controllable canonical form is important in discussing the pole-placement approach to control systems design. Observable Canonical Form. The following state-space representation is called an observable canonical form: (9–5) (9–6) Note that the n*n state matrix of the state equation given by Equation (9–5) is the transpose of that of the state equation defined by Equation (9–3). Diagonal Canonical Form. Consider the transfer-function system defined by Equa- tion (9–2). Here we consider the case where the denominator polynomial involves only distinct roots. For the distinct-roots case, Equation (9–2) can be written as (9–7) The diagonal canonical form of the state-space representation of this system is given by =b 0 +c 1 s+p 1 +c 2 s+p 2 +p+c n s+p n Y(s) U(s)=b 0 s n +b 1 s n-1 +p+b n-1 s+b n As+p 1 BAs+p 2 B p As+p n B y=[0 0 p 0 1] G x 1 x 2 /H11080 /H11080 /H11080 x n-1 x n W +b 0 u F x# 1 x# 2 /H11080 /H11080 /H11080 x# n V = F 0 1 /H11080 /H11080 /H11080 00 0 /H11080 /H11080 /H11080 0p p p0 0 /H11080 /H11080 /H11080 1-a n -a n-1 /H11080 /H11080 /H11080 -a 1 VF x 1 x 2 /H11080 /H11080 /H11080 x n V + F b n -a n b 0 b n-1 -a n-1 b 0 /H11080 /H11080 /H11080 b 1 -a 1 b 0 V u y=Cb n -a n b 0 /H21752b n-1 -a n-1 b 0 /H21752p/H21752b 1 -a 1 b 0 D F x 1 x 2 /H11080 /H11080 /H11080 x n V +b 0 u Openmirrors.com(9–8) (9–9) Jordan Canonical Form. Next we shall consider the case where the denominator polynomial of Equation (9–2) involves multiple roots. For this case, the precedingdiagonal canonical form must be modified into the Jordan canonical form. Suppose, forexample, that the p i’s are different from one another, except that the first three pi’s are equal, or p1=p2=p3.Then the factored form of Y(s)/U(s) becomes The partial-fraction expansion of this last equation becomesA state-space representation of this system in the Jordan canonical form is given by (9–10) (9–11) y=Cc 1 c2 p cnDFx1 x2 /H11080 /H11080/H11080 x nV+b0 uHx# 1 x# 2 x# 3 x# 4 /H11080 /H11080/H11080 x# nX=H-p1 0 00 /H11080/H11080/H11080 01 -p 1 0 p p0 1 -p1 0 /H11080/H11080/H11080 00 : 0 -p 4 0p p /H11080 /H11080 /H110800 : 00 -p nXHx1 x2 x3 x4 /H11080 /H11080/H11080 x nX+H0011 /H11080/H11080/H11080 1 XuY(s) U(s)=b0+c1 As+p1B3+c2 As+p1B2+c3 s+p1+c4 s+p4+p+cn s+pnY(s) U(s)=b0 sn+b1 sn-1+p+bn-1 s+bn As+p1B3As+p4BAs+p5BpAs+pnB y=Cc1 c2 p cnDFx1 x2 /H11080 /H11080/H11080 x nV+b0 u Fx# 1 x# 2 /H11080 /H11080/H11080 x# nV=F-p1 0-p2 /H11080 /H11080 /H110800 -pnVFx1 x2 /H11080 /H11080/H11080 x nV+F11 /H11080/H11080/H11080 1Vu Section 9–2 / State-Space Representations of Transfer-Function Systems 651652 Chapter 9 / Control Systems Analysis in State Space EXAMPLE 9–1 Consider the system given by Obtain state-space representations in the controllable canonical form, observable canonical form, and diagonal canonical form. Controllable Canonical Form: Observable Canonical Form: Diagonal Canonical Form: Eigenvalues of an n/H11547nMatrix A. The eigenvalues of an n*n matrix Aare the roots of the characteristic equation |lI-A|=0 The eigenvalues are also called the characteristic roots. Consider, for example, the following matrix A: The characteristic equation is |lI-A|= =l 3 +6l 2 +11l+6 =(l+1)(l+2)(l+3)=0 The eigenvalues of Aare the roots of the characteristic equation, or –1, –2, and–3. Diagonalization of n/H11547nMatrix. Note that if an n*n matrix Awith distinct eigenvalues is given by 3 l 0 6-1 l 110 -1 l+6 3 A= C 0 0 -61 0 -110 1 -6 S y(t) =[2 -1] B x 1 (t) x 2 (t) R B x# 1 (t) x# 2 (t) R = B -1 00 -2 RB x 1 (t) x 2 (t) R + B 1 1 R u(t) y(t) =[0 1] B x 1 (t) x 2 (t) R B x# 1 (t) x# 2 (t) R = B 0 1-2 -3 RB x 1 (t) x 2 (t) R + B 3 1 R u(t) y(t) =[3 1] B x 1 (t) x 2 (t) R B x# 1 (t) x# 2 (t) R = B 0 -21 -3 RB x 1 (t) x 2 (t) R + B 0 1 R u(t)Y(s) U(s)=s+3 s 2 +3s+2 Openmirrors.comSection 9–2 / State-Space Representations of Transfer-Function Systems 653(9–12) the transformation x=Pz, where P= l1,l2,p,ln=n distinct eigenvalues of A will transform P–1APinto the diagonal matrix, or If the matrix Adefined by Equation (9–12) involves multiple eigenvalues, then diagonalization is impossible. For example, if the 3*3 matrix A, where has the eigenvalues l1,l1,l3,then the transformation x=Sz, where will yield This is in the Jordan canonical form.S-1 AS=Cl1 0 01 l1 00 0 l3SS=C1 l1 l120 1 2l11 l3 l32SA=C0 0 -a31 0 -a20 1 -a1SP-1 AP =Fl1 0l2 /H11080 /H11080 /H110800 lnVG1 l1 l12 /H11080 /H11080/H11080 l 1n-11 l2 l22 /H11080 /H11080/H11080 l 2n-1p pp p1 l n ln2 /H11080 /H11080/H11080 l nn-1WA=G0 0 /H11080/H11080/H11080 0 -a n1 0 /H11080/H11080/H11080 0 -a n-10 1 /H11080/H11080/H11080 0 -a n-2p p p p0 0 /H11080/H11080/H11080 1 -a 1W654 Chapter 9 / Control Systems Analysis in State Space EXAMPLE 9–2 Consider the following state-space representation of a system. (9–13) (9–14) Equations (9–13) and (9–14) can be put in a standard form as (9–15) (9–16) where The eigenvalues of matrix Aare l 1 =–1, l 2 =–2, l 3 =–3 Thus, three eigenvalues are distinct. If we define a set of new state variables z 1 ,z 2 ,andz 3 by the transformation or x=Pz (9–17) where (9–18) then, by substituting Equation (9–17) into Equation (9–15), we obtain By premultiplying both sides of this last equation by P –1 ,we get (9–19) or + C 3 -3 12.5 -4 1.50.5 -1 0.5 SC 0 0 6 S u C z# 1 z# 2 z# 3 S = C 3 -3 12.5 -4 1.50.5 -1 0.5 SC 0 0 -61 0 -110 1 -6 SC 1 -1 11 -2 41 -3 9 SC z 1 z 2 z 3 S z#=P -1 APz +P -1 BuPz#=APz +BuP= C 1 l 1 l 12 1 l 2 l 22 1 l 3 l 32 S = C 1 -1 11 -2 41 -3 9 SC x 1 x 2 x 3 S = C 1 -1 11 -2 41 -3 9 SC z 1 z 2 z 3 S A= C 0 0 -61 0 -110 1 -6 S , B= C 0 0 6 S , C=[1 0 0]y=Cxx#=Ax+Bu y=[1 0 0] C x 1 x 2 x 3 S C x# 1 x# 2 x# 3 S = C 0 0 -61 0 -110 1 -6 SC x 1 x 2 x 3 S + C 0 0 6 S u Openmirrors.comSection 9–2 / State-Space Representations of Transfer-Function Systems 655Simplifying gives (9–20) Equation (9–20) is also a state equation that describes the same system as defined by Equation (9–13). The output equation, Equation (9–16), is modified to y= CPz or (9–21) Notice that the transformation matrix P, defined by Equation (9–18), modifies the coefficient matrix of zinto the diagonal matrix.As is clearly seen from Equation (9–20), the three scalar state equations are uncoupled. Notice also that the diagonal elements of the matrix P–1APin Equation (9–19) are identical with the three eigenvalues of A. It is very important to note that the eigen- values of Aand those of P–1APare identical.We shall prove this for a general case in what follows. Invariance of Eigenvalues. To prove the invariance of the eigenvalues under a linear transformation, we must show that the characteristic polynomials ∑lI-A∑and @lI-P–1AP@are identical. Since the determinant of a product is the product of the determinants, we obtain Noting that the product of the determinants @P–1@and∑P∑is the determinant of the prod- uct@P–1P@, we obtain Thus, we have proved that the eigenvalues of Aare invariant under a linear transformation. Nonuniqueness of a Set of State Variables. It has been stated that a set of state vari- ables is not unique for a given system. Suppose that x1,x2,p,xnare a set of state variables. =∑l I-A∑ @l I-P-1 AP@=@P-1 P@@l I-A@ =@P-1@@P@@l I-A@ =@P-1@@l I-A@@P@ =@P-1(l I-A) P@ @l I-P-1 AP@=@l P-1 P-P-1 AP@ =[1 1 1]Cz1 z2 z3S y=[1 0 0]C1 -1 11 -2 41 -3 9SCz1 z2 z3SCz# 1 z# 2 z# 3S=C-1 000 -2 00 0 -3SCz1 z2 z3S+C3 -6 3Su656 Chapter 9 / Control Systems Analysis in State Space Then we may take as another set of state variables any set of functions provided that, for every set of values there corresponds a unique set of values x 1 ,x 2 ,p,x n ,and vice versa. Thus, if xis a state vector, then where is also a state vector, provided the matrix Pis nonsingular. Different state vectors convey the same information about the system behavior. 9–3 TRANSFORMATION OF SYSTEM MODELS WITH MATLAB In this section we shall consider the transformation of the system model from transfer function to state space, and vice versa. We shall begin our discussion with the transformation from transfer function to state space. Let us write the closed-loop transfer function as Once we have this transfer-function expression, the MATLAB command [A, B, C, D] = tf2ss(num,den) will give a state-space representation. It is important to note that the state-space repre- sentation for any system is not unique. There are many (indeed, infinitely many) state- space representations for the same system.The MATLAB command gives one possible such state-space representation. State-Space Formulation of Transfer-Function Systems. Consider the transfer-function system (9–22) There are many (again, infinitely many) possible state-space representations for this system. One possible state-space representation is y=[1 0 0] C x 1 x 2 x 3 S +[0] u C x# 1 x# 2 x# 3 S = C 0 0 -101 0 -50 1 -6 SC x 1 x 2 x 3 S + C 0 10 -50 S uY(s) U(s)=10s +10 s 3 +6s 2 +5s+10Y(s) U(s)=numerator polynomial in s denominator polynomial in s=num denx ˆ =Pxx ˆ ,x ˆ 1 ,x ˆ 2 ,p,x ˆ n , x ˆ n =X n Ax 1 , x 2 ,p, x n B /H11080 /H11080 /H11080 x ˆ 2 =X 2 Ax 1 , x 2 ,p, x n B x ˆ 1 =X 1 Ax 1 , x 2 ,p, x n B Openmirrors.comSection 9–3 / Transformation of System Models with MATLAB 657Another possible state-space representation (among infinitely many alternatives) is (9–23) (9–24) MATLAB transforms the transfer function given by Equation (9–22) into the state-space representation given by Equations (9–23) and (9–24). For the example system consideredhere, MATLAB Program 9–1 will produce matrices A,B,C, and D. y=[0 10 10]Cx1 x2 x3S+[0] u Cx# 1 x# 2 x# 3S=C-6 10-5 01-10 00 SCx1 x2 x3S+C100 Su MATLAB Program 9–1 num = [10 10]; den = [1 6 5 10];[A,B,C,D] = tf2ss(num,den) A= -6 -5 -10 1-0-0 0-1-0 B = 1 00 C = 01 01 0 D = 0 Transformation from State Space to Transfer Function. To obtain the transfer function from state-space equations, use the following command: [num,den] = ss2tf(A,B,C,D,iu) iumust be specified for systems with more than one input. For example, if the system has three inputs (u1, u2, u3), then iumust be either 1, 2, or 3, where 1 implies u1,2 implies u2,and 3 implies u3. If the system has only one input, then either [num,den] = ss2tf(A,B,C,D) or [num,den] = ss2tf(A,B,C,D,1) may be used. (See Example 9–3 and MATLAB Program 9–2.)658 Chapter 9 / Control Systems Analysis in State Space For the case where the system has multiple inputs and multiple outputs, see Example 9–4. EXAMPLE 9–3 Obtain the transfer function of the system defined by the following state-space equations: MATLAB Program 9–2 will produce the transfer function for the given system. The transfer function obtained is given by Y(s) U(s)=25.04s +5.008 s 3 +5.0325s 2 +25.1026s +5.008 y=[1 0 0] C x 1 x 2 x 3 S C x# 1 x# 2 x# 3 S = C 0 0 -5.0081 0 -25.10260 1 -5.03247 SC x 1 x 2 x 3 S + C 0 25.04 -121.005 S u MATLAB Program 9–2 A = [0 1 0;0 0 1;-5.008 -25.1026 -5.03247]; B = [0;25.04; -121.005]; C = [1 0 0]; D = [0]; [num,den] = ss2tf(A,B,C,D) num = 0 -0.0000 25.0400 5.0080 den = 1.0000 5.0325 25.1026 5.0080 % ***** The same result can be obtained by entering the following command ***** [num,den] = ss2tf(A,B,C,D,1) num = 0 -0.0000 25.0400 5.0080 den = 1.0000 5.0325 25.1026 5.0080 Openmirrors.comSection 9–3 / Transformation of System Models with MATLAB 659EXAMPLE 9–4 Consider a system with multiple inputs and multiple outputs.When the system has more than one output, the command [NUM,den] = ss2tf(A,B,C,D,iu) produces transfer functions for all outputs to each input. (The numerator coefficients are returnedto matrix NUM with as many rows as there are outputs.) Consider the system defined by This system involves two inputs and two outputs. Four transfer functions are involved: and (When considering input u 1,we assume that input u2 is zero and vice versa.) See the output of MATLAB Program 9–3.Y2(s) /H20862U2(s). Y1(s) /H20862U2(s), Y2(s) /H20862U1(s),Y1(s) /H20862U1(s), By1 y2R=B1 00 1RBx1 x2R+B000 0RBu1 u2R Bx# 1 x# 2R=B0 -251 -4RBx1 x2R+B1 01 1RBu1 u2R MATLAB Program 9–3 A = [0 1;-25 -4]; B = [1 1;0 1];C = [1 0;0 1];D = [0 0;0 0];[NUM,den] = ss2tf(A,B,C,D,1) NUM = 01 4 0 0 -25 den = 1 4 25 [NUM,den] = ss2tf(A,B,C,D,2)NUM = 0 1.0000 5.0000 0 1.0000 -25.0000 den = 142 5 This is the MATLAB representation of the following four transfer functions: Y1(s) U2(s)=s+5 s2+4s+25, Y2(s) U2(s)=s-25 s2+4s+25 Y1(s) U1(s)=s+4 s2+4s+25, Y2(s) U1(s)=-25 s2+4s+25660 Chapter 9 / Control Systems Analysis in State Space 9–4 SOLVING THE TIME-INVARIANT STATE EQUATION In this section, we shall obtain the general solution of the linear time-invariant state equa- tion. We shall first consider the homogeneous case and then the nonhomogeneous case. Solution of Homogeneous State Equations. Before we solve vector-matrix differential equations, let us review the solution of the scalar differential equation (9–25) In solving this equation, we may assume a solution x(t) of the form x(t)=b 0 +b 1 t+b 2 t 2 +p+b k t k +p (9–26) By substituting this assumed solution into Equation (9–25), we obtain (9–27) If the assumed solution is to be the true solution, Equation (9–27) must hold for any t. Hence, equating the coefficients of the equal powers of t,we obtain The value of b 0 is determined by substituting t=0 into Equation (9–26), or x(0)=b 0 Hence, the solution x(t) can be written as We shall now solve the vector-matrix differential equation (9–28) where By analogy with the scalar case, we assume that the solution is in the form of a vector power series in t,or x(t)= b 0 +b 1 t+b 2 t 2 +p+b k t k +p (9–29) A=n*n constant matrix x=n-vectorx#=Ax =e at x(0) x(t) = a 1+at+1 2! a 2 t 2 +p+1 k! a k t k +p b x(0) b k =1 k! a k b 0 /H11080 /H11080 /H11080 b 3 =1 3 ab 2 =1 3*2 a 3 b 0 b 2 =1 2 ab 1 =1 2 a 2 b 0 b 1 =ab 0 =aAb 0 +b 1 t+b 2 t 2 +p+b k t k +pBb 1 +2b 2 t+3b 3 t 2 +p+kb k t k-1 +px#=ax Openmirrors.comSection 9–4 / Solving the Time-Invariant State Equation 661By substituting this assumed solution into Equation (9–28), we obtain (9–30) If the assumed solution is to be the true solution, Equation (9–30) must hold for all t.Thus, by equating the coefficients of like powers of ton both sides of Equation (9–30), we obtain By substituting t=0 into Equation (9–29), we obtain x(0)= b0 Thus, the solution x(t)can be written as The expression in the parentheses on the right-hand side of this last equation is an n*n matrix. Because of its similarity to the infinite power series for a scalar exponential, wecall it the matrix exponential and write In terms of the matrix exponential, the solution of Equation (9–28) can be written as (9–31) Since the matrix exponential is very important in the state-space analysis of linear systems, we shall next examine its properties. Matrix Exponential. It can be proved that the matrix exponential of an n*n matrix A, converges absolutely for all finite t.(Hence, computer calculations for evaluating the elements of e Atby using the series expansion can be easily carried out.)eAt=aq k=0Aktk k!x(t)=eAt x(0)I+At+1 2! A2t2+p+1 k! Aktk+p=eAtx(t)=aI+At+1 2! A2t2+p+1 k! Aktk+pb x(0) bk=1 k!Ak b0 /H11080 /H11080 /H11080 b3=1 3Ab2=1 3*2A3 b0 b2=1 2Ab1=1 2A2 b0 b1=Ab0=AAb0+b1 t+b2 t2+p+bk tk+pBb1+2 b2 t+3 b3 t2+p+k bk tk-1+p662 Chapter 9 / Control Systems Analysis in State Space Because of the convergence of the infinite series the series can be differentiated term by term to give The matrix exponential has the property that This can be proved as follows: In particular, if s=–t, then Thus, the inverse of is Since the inverse of always exists, is nonsingular. It is very important to remember that To prove this, note that +A 2 Bt 3 2!+AB 2 t 3 2!+B 3 t 3 3!+p =I+(A+B)t+A 2 t 2 2!+ABt 2 +B 2 t 2 2!+A 3 t 3 3! e At e Bt = a I+At+A 2 t 2 2!+A 3 t 3 3!+p ba I+Bt+B 2 t 2 2!+B 3 t 3 3!+p b e (A+B)t =I+(A+B)t+(A+B) 2 2! t 2 +(A+B) 3 3! t 3 +pe (A+B)t Ze At e Bt , ifAB ZBAe (A+B)t =e At e Bt , ifAB =BAe At e At e At . e At e At e At =e At e At =e A(t-t) =I =e A(t+s) =a q k=0 A k (t+s) k k! =a q k=0 A k a a q i=0 t i s k-i i! (k -i)! b e At e As = a a q k=0 A k t k k! ba a q k=0 A k s k k! b e A(t+s) =e At e As = c I+At+A 2 t 2 2!+p+A k-1 t k-1 (k-1)!+p d A=e At A =A c I+At+A 2 t 2 2!+p+A k-1 t k-1 (k-1)!+p d =Ae At d dt e At =A+A 2 t+A 3 t 2 2!+p+A k t k-1 (k-1)!+pg q k=0 A k t k /H20862k!, Openmirrors.comSection 9–4 / Solving the Time-Invariant State Equation 663Hence, The difference between and vanishes if AandBcommute. Laplace Transform Approach to the Solution of Homogeneous State Equations. Let us first consider the scalar case: (9–32) Taking the Laplace transform of Equation (9–32), we obtain sX(s)-x(0)=aX(s) (9–33) where Solving Equation (9–33) for X(s) gives The inverse Laplace transform of this last equation gives the solution x(t)=eatx(0) The foregoing approach to the solution of the homogeneous scalar differential equation can be extended to the homogeneous state equation: (9–34) Taking the Laplace transform of both sides of Equation (9–34), we obtain sX(s)- x(0)= AX(s) where Hence, (sI-A)X(s)= x(0) Premultiplying both sides of this last equation by (sI-A)–1,we obtain X(s)=(s I-A)–1x(0) The inverse Laplace transform of gives the solution Thus, x(t)=l–1C(sI-A)–1Dx(0) (9–35) Note that Hence, the inverse Laplace transform of (sI-A)–1gives (9–36) l-1C(s I-A)-1D=I+At+A2t2 2!+A3t3 3!+p=eAt(s I-A)-1=I s+A s2+A2 s3+px(t). X(s)X(s)=l[x].x#(t)=Ax(t)X(s) =x(0) s-a=(s-a)-1x(0)X(s) =l[x].x#=axeAteBte(A+B)t+BA2+ABA +B2 A+BAB -2 A2 B-2 AB2 3!t3+pe(A+B)t-eAteBt=BA -AB 2! t2664 Chapter 9 / Control Systems Analysis in State Space (The inverse Laplace transform of a matrix is the matrix consisting of the inverse Laplace transforms of all elements.) From Equations (9–35) and (9–36), the solution of Equation (9–34) is obtained as The importance of Equation (9–36) lies in the fact that it provides a convenient means for finding the closed solution for the matrix exponential. State-Transition Matrix. We can write the solution of the homogeneous state equation (9–37) as (9–38) where is an n*n matrix and is the unique solution of To verify this, note that and We thus confirm that Equation (9–38) is the solution of Equation (9–37). From Equations (9–31), (9–35), and (9–38), we obtain Note that From Equation (9–38), we see that the solution of Equation (9–37) is simply a transformation of the initial condition. Hence, the unique matrix is called the state- transition matrix.The state-transition matrix contains all the information about the free motions of the system defined by Equation (9–37). If the eigenvalues l 1 ,l 2 ,p, l n of the matrix Aare distinct, than will contain thenexponentials In particular, if the matrix Ais diagonal, then /H9021(t)=e At = F e l 1 t 0e l 2 t /H11080 /H11080 /H110800 e l n t V (A: diagonal )e l 1 t , e l 2 t ,p,e l n t /H9021(t)/H9021(t)/H9021 -1 (t)=e At =/H9021(-t)/H9021(t)=e At =l -1 C(s I-A) -1 Dx#(t)=/H9021# (t) x(0)=A/H9021(t) x(0)=Ax(t)x(0)=/H9021(0) x(0)=x(0)/H9021#(t)=A/H9021(t), /H9021(0)=I/H9021(t)x(t)=/H9021(t) x(0)x#=Axx(t)=e At x(0) Openmirrors.comSection 9–4 / Solving the Time-Invariant State Equation 665If there is a multiplicity in the eigenvalues—for example, if the eigenvalues of Aare l1,l1,l1,l4,l5,p,ln, then will contain, in addition to the exponentials terms like and Properties of State-Transition Matrices. We shall now summarize the important properties of the state-transition matrix For the time-invariant system for which we have the following: 2. or 3.4.5. EXAMPLE 9–5 Obtain the state-transition matrix of the following system: Obtain also the inverse of the state-transition matrix, For this system, The state-transition matrix is given by Since the inverse of (sI-A)is given by =Ds+3 (s+1)(s +2) -2 (s+1)(s +2)1 (s+1)(s +2) s (s+1)(s +2)T (s I-A)-1=1 (s+1)(s +2)Bs+3 -21 sRs I-A=Bs 00 sR-B0 -21 -3R=Bs 2-1 s+3R/H9021(t)=eAt=l-1C(s I-A)-1D/H9021(t)A=B0 -21 -3R/H9021-1(t).Bx# 1 x# 2R=B0 -21 -3RBx1 x2R/H9021(t)/H9021At2-t1B /H9021At1-t0B=/H9021At2-t0B=/H9021At1-t0B /H9021At2-t1BC/H9021(t)Dn=/H9021(nt)/H9021At1+t2B=eAAt1+t2B=eAt1eAt2=/H9021At1B /H9021At2B=/H9021At2B /H9021At1B/H9021-1(t)=/H9021(-t) /H9021(t)=eAt=Ae- AtB-1=C/H9021(-t)D-1/H9021(0)=eA0=I/H9021(t)=eAtx#=Ax/H9021(t).t2el1 t. tel1 tel1 t, el4 t, el5 t,p,eln t, /H9021(t)666 Chapter 9 / Control Systems Analysis in State Space Hence, Noting that we obtain the inverse of the state-transition matrix as follows: Solution of Nonhomogeneous State Equations. We shall begin by considering the scalar case (9–39) Let us rewrite Equation (9–39) as Multiplying both sides of this equation by e –at ,we obtain Integrating this equation between 0 and tgives or The first term on the right-hand side is the response to the initial condition and the second term is the response to the input u(t). Let us now consider the nonhomogeneous state equation described by (9–40) where By writing Equation (9–40) as and premultiplying both sides of this equation by e –At ,we obtain e At Cx#(t)-Ax(t)D=d dt Ce At x(t)D=e At Bu(t)x#(t)-Ax(t)=Bu(t) B=n*r constant matrix A=n*n constant matrix u=r-vector x=n-vectorx#=Ax+Bux(t) =e at x(0) +e at 3 t 0 e -at bu(t)dte -at x(t) -x(0) = 3 t 0 e -at bu(t)dte -at Cx#(t)-ax(t)D=d dt Ce -at x(t)D=e -at bu(t)x#-ax=bux#=ax+bu /H9021 -1 (t)=e At = B 2e t -e 2t -2e t +2e 2t e t -e 2t -e t +2e 2t R /H9021 -1 (t)=/H9021(-t), = B 2e -t -e -2t -2e -t +2e -2t e -t -e -2t -e -t +2e -2t R /H9021(t)=e At =l -1 C(s I-A) -1 D Openmirrors.comSection 9–4 / Solving the Time-Invariant State Equation 667Integrating the preceding equation between 0 and tgives or (9–41) Equation (9–41) can also be written as (9–42) where Equation (9–41) or (9–42) is the solution of Equation (9–40). The solution x(t)is clearly the sum of a term consisting of the transition of the initial state and a term arising from the input vector. Laplace Transform Approach to the Solution of Nonhomogeneous State Equations. The solution of the nonhomogeneous state equation can also be obtained by the Laplace transform approach.The Laplace transform of this last equation yields sX(s)- x(0)= AX(s)+ BU(s) or (sI-A)X(s)= x(0)+ BU(s) Premultiplying both sides of this last equation by (sI-A)–1,we obtain X(s)=(s I-A)–1x(0)+(s I-A)–1BU(s) Using the relationship given by Equation (9–36) gives X(s)=lCeAtDx(0)+lCeAtDBU(s) The inverse Laplace transform of this last equation can be obtained by use of the convolution integral as follows: Solution in Terms of Thus far we have assumed the initial time to be zero. If, however, the initial time is given by t0instead of 0,then the solution to Equation (9–40) must be modified to (9–43) x(t)=eAAt-t0B xAt0B+ 3t t0eA(t-t) Bu(t)dtxAt0B.x(t)=eAt x(0)+ 3t 0eA(t-t) Bu(t)dtx#=Ax+Bu/H9021(t)=eAt.x(t)=/H9021(t) x(0)+ 3t 0/H9021(t-t) Bu(t)dtx(t)=eAt x(0)+ 3t 0eA(t-t) Bu(t)dte- At x(t)-x(0)= 3t 0e- At Bu(t)dt668 Chapter 9 / Control Systems Analysis in State Space EXAMPLE 9–6 Obtain the time response of the following system: where u(t) is the unit-step function occurring at t=0, or u(t)=1(t) For this system, The state-transition matrix was obtained in Example 9–5 as The response to the unit-step input is then obtained as or If the initial state is zero, or x(0)= 0, then x(t)can be simplified to 9–5 SOME USEFUL RESULTS IN VECTOR-MATRIX ANALYSIS In this section we present some useful results in vector-matrix analysis that we use in Section 9–6. Specifically, we present the Cayley–Hamilton theorem, the minimal poly- nomial, Sylvester’s interpolation method for calculating and the linear independence of vectors. Cayley–Hamilton Theorem. The Cayley–Hamilton theorem is very useful in proving theorems involving matrix equations or solving problems involving matrix equations. Consider an n*n matrix Aand its characteristic equation: |lI-A|=l n +a 1 l n–1 +p+a n–1 l+a n =0 The Cayley–Hamilton theorem states that the matrix Asatisfies its own characteristic equation, or that A n +a 1 A n–1 +p+a n–1 A+a n I=0 (9–44) To prove this theorem, note that is a polynomial in lof degree n-1. That is, adj(l I-A)=B 1 l n-1 +B 2 l n-2 +p+B n-1 l+B n adj(l I-A)e At , B x 1 (t) x 2 (t) R = C 1 2-e -t +1 2e -2t e -t -e -2t SB x 1 (t) x 2 (t) R = B 2e -t -e -2t -2e -t +2e -2t e -t -e -2t -e -t +2e -2t RB x 1 (0) x 2 (0) R + B 1 2 -e -t + 1 2 e -2t e -t -e -2t R x(t)=e At x(0)+ 3 t 0 B 2e -(t-t) -e -2(t-t) -2e -(t-t) +2e -2(t-t) e -(t-t) -e -2(t-t) -e -(t-t) +2e -2(t-t) RB 0 1 R [1]dt/H9021(t)=e At = B 2e -t -e -2t -2e -t +2e -2t e -t -e -2t -e -t +2e -2t R /H9021(t)=e At A= B 0 -21 -3 R , B= B 0 1 RB x# 1 x# 2 R = B 0 -21 -3 RB x 1 x 2 R + B 0 1 R u Openmirrors.comSection 9–5 / Some Useful Results in Vector-Matrix Analysis 669where Since (lI-A)adj(lI-A)=Cadj(lI-A)D(lI-A)=|lI-A|I we obtain From this equation, we see that Aand (i=1, 2, p,n )commute. Hence, the product of(lI-A)and becomes zero if either of these is zero. If Ais substitut- ed for lin this last equation, then clearly lI-Abecomes zero. Hence, we obtain An+a1An–1+p+an–1A+anI=0 This proves the Cayley–Hamilton theorem, or Equation (9–44). Minimal Polynomial. Referring to the Cayley–Hamilton theorem, every n*n matrix Asatisfies its own characteristic equation. The characteristic equation is not, however, necessarily the scalar equation of least degree that Asatisfies.The least-degree polynomial having Aas a root is called the minimal polynomial . That is, the minimal polynomial of an n*n matrix Ais defined as the polynomial of least degree, f(l)=lm+a1lm–1+p+am–1l+am,m /H11349n such that or f(A)= Am+a1Am–1+p+am–1A+amI=0 The minimal polynomial plays an important role in the computation of polynomials in ann*n matrix. Let us suppose that a polynomial in l, is the greatest common divisor of all the elements of We can show that if the coefficient of the highest-degree terminlof is chosen as 1, then the minimal polynomial is given by (9–45) [See Problem A–9–8 for the derivation of Equation (9–45).] It is noted that the minimal polynomial of an n*n matrix Acan be determined by the following procedure: 1.Form and write the elements of as factored polynomials inl. 2.Determine as the greatest common divisor of all the elements of Choose the coefficient of the highest-degree term in lof to be 1. If there is no common divisor, 3.The minimal polynomial is then given as divided by Matrix Exponential In solving control engineering problems, it often becomes necessary to compute If matrix Ais given with all elements in numerical values, MATLAB provides a simple way to compute , where Tis a constant. e ATeAt.eAt.d(l). ∑l I-A∑ f(l)d(l)=1.d(l)adj(l I-A). d(l)adj(l I-A) adj(l I-A)f(l)f(l)=∑l I-A∑ d(l)f(l) d(l)adj(l I-A).d(l),f(A)=0,f(l)adj(l I-A)Bi =AB1 ln-1+B2 ln-2+p+Bn-1 l+BnB(l I-A) =(l I-A)AB1 ln-1+B2 ln-2+p+Bn-1 l+BnB ∑l I-A∑ I=Iln+a1 Iln-1+p+an-1 Il+an IB1=I.670 Chapter 9 / Control Systems Analysis in State Space Aside from computational methods, several analytical methods are available for the computation of We shall present three methods here. Computation of e At : Method 1. If matrix Acan be transformed into a diagonal form, then can be given by (9–46) where Pis a diagonalizing matrix for A. [For the derivation of Equation (9–46), see Problem A–9–11 .] If matrix Acan be transformed into a Jordan canonical form, then can be given by where Sis a transformation matrix that transforms matrix Ainto a Jordan canonical form J. As an example, consider the following matrix A: The characteristic equation is |lI-A|=l 3 -3l 2 +3l-1=( l-1) 3 =0 Thus, matrix Ahas a multiple eigenvalue of order 3 at It can be shown that matrix Ahas a multiple eigenvector of order 3. The transformation matrix that will transform matrix Ainto a Jordan canonical form can be given by The inverse of matrix Sis Then it can be seen that = C 1 0 01 1 00 1 1 S =J S -1 AS= C 1 -1 10 1 -20 0 1 SC 0 0 11 0 -30 1 3 SC 1 1 10 1 20 0 1 S S -1 = C 1 -1 10 1 -20 0 1 S S= C 1 1 10 1 20 0 1 S l=1.A= C 0 0 11 0 -30 1 3 S e At =Se Jt S -1 e At e At =Pe Dt P -1 =P F e l 1 t 0e l 2 t /H11080 /H11080 /H110800 e l n t V P -1 e At e At . Openmirrors.comSection 9–5 / Some Useful Results in Vector-Matrix Analysis 671Noting that we find Computation of eAt: Method 2. The second method of computing uses the Laplace transform approach. Referring to Equation (9–36), can be given as follows: Thus, to obtain first invert the matrix This results in a matrix whose elements are rational functions of s.Then take the inverse Laplace transform of each element of the matrix. EXAMPLE 9–7 Consider the following matrix A: Compute by use of the two analytical methods presented previously. Method 1. The eigenvalues of Aare 0 and –2 A necessary transformation matrix Pmay be obtained as Then, from Equation (9–46), is obtained as follows: Method 2. Since we obtain (s I-A)-1=D1 s 01 s(s+2) 1 s+2Ts I-A=Bs 00 sR-B001 -2R=Bs 0-1 s+2ReAt=B1 01 -2RBe0 00 e-2tRB1 01 2 -1 2R=B101 2A1-e-2tB e-2tReAtP=B1 01 -2RAl1=0, l2=-2B.eAtA=B0 01 -2R(s I-A). eAt,eAt=l-1C(s I-A)-1DeAteAt =Cet-tet+1 2t2et 1 2t2et tet+1 2t2ettet-t2et et-tet-t2et -3tet-t2et1 2t2et tet+1 2t2et et+2tet+1 2t2etS =C1 110 120 01 SCet 00te t et 01 2t2et tet etSC1 -1 10 1 -20 01S eAt=SeJt S-1eJt=Cet 0 0tet et 01 2t2et tet etS672 Chapter 9 / Control Systems Analysis in State Space Hence, Computation of e At : Method 3. The third method is based on Sylvester’s interpo- lation method. (For Sylvester’s interpolation formula, see Problem A–9–12 .) We shall first consider the case where the roots of the minimal polynomial of Aare distinct. Then we shall deal with the case of multiple roots. Case 1: Minimal Polynomial of AInvolves Only Distinct Roots. We shall assume that the degree of the minimal polynomial of Aism.By using Sylvester’s interpolation formula, it can be shown that can be obtained by solving the following determinant equation: (9–47) By solving Equation (9–47) for can be obtained in terms of the A k (k=0, 1, 2,p, m-1) and the (i=1, 2, 3, p,m ). [Equation (9–47) may be expanded, for ex- ample, about the last column.] Notice that solving Equation (9–47) for is the same as writing (9–48) and determining the ( k = 0 ,1 ,2 , p,m - 1 ) by solving the following set of m equations for the IfAis an n*n matrix and has distinct eigenvalues, then the number of to be determined is m=n. IfAinvolves multiple eigenvalues, but its minimal polynomial has only simple roots, however, then the number mof to be determined is less than n. Case 2: Minimal Polynomial of AInvolves Multiple Roots. As an example, consider the case where the minimal polynomial of Ainvolves three equal roots and has other roots that are all distinct. By applying Sylvester’s interpolation formula, it can be shown that can be obtained from the following determinant equation:e At Al 4 , l 5 ,p, l m BAl 1 =l 2 =l 3 Ba k (t)’sa k (t)’s a 0 (t)+a 1 (t)l m +a 2 (t)l m2 +p+a m-1 (t)l mm-1 =e l m t /H11080 /H11080 /H11080 a 0 (t)+a 1 (t)l 2 +a 2 (t)l 22 +p+a m-1 (t)l 2m-1 =e l 2 t a 0 (t)+a 1 (t)l 1 +a 2 (t)l 12 +p+a m-1 (t)l 1m-1 =e l 1 t a k (t):a k (t)e At =a 0 (t) I+a 1 (t) A+a 2 (t) A 2 +p+a m-1 (t) A m-1 e At e l i t e At e At , 7 1 1 /H11080 /H11080 /H11080 1 Il 1 l 2 /H11080 /H11080 /H11080 l m Al 12 l 22 /H11080 /H11080 /H11080 l m2 A 2 p p p pl 1m-1 l 2m-1 /H11080 /H11080 /H11080 l mm-1 A m-1 e l 1 t e l 2 t /H11080 /H11080 /H11080 e l m t e At 7 =0e At f(l) e At =l -1 C(s I-A) -1 D= B 1 0 1 2 A1-e -2t B e -2t R Openmirrors.comSection 9–5 / Some Useful Results in Vector-Matrix Analysis 673=0 (9–49) Equation (9–49) can be solved for by expanding it about the last column. It is noted that, just as in case 1, solving Equation (9–49) for is the same as writing (9–50) and determining the ak(t)’s (k= 0, 1, 2, p, m-1) from The extension to other cases where, for example, there are two or more sets of multiple roots will be apparent. Note that if the minimal polynomial of Ais not found, it is possible to substitute the characteristic polynomial for the minimal polynomial. The number ofcomputations may, of course, be increased. EXAMPLE 9–8 Consider the matrix Compute using Sylvester’s interpolation formula. From Equation (9–47), we get 31 1 Il1 l2 Ael1 t el2 t eAt3=0eAtA=B0 01 -2R a0(t)+a1(t)lm+a2(t)lm2+p+am-1(t)lmm-1=elm t /H11080 /H11080 /H11080 a0(t)+a1(t)l4+a2(t)l42+p+am-1(t)l4m-1=el4 t a0(t)+a1(t)l1+a2(t)l12+p+am-1(t)l1m-1=el1 t a1(t)+2a2(t)l1+3a3(t)l12+p+(m-1)am-1(t)l1m-2=tel1 t a2(t)+3a3(t)l1+p+(m-1)(m -2) 2am-1(t)l1m-3=t2 2el1 teAt=a0(t) I+a1(t) A+a2(t) A2+p+am-1(t) Am-1eAteAt(m-1)(m -2) 2l1m-3 (m-1)l1m-2 l1m-1 l4m-1 /H11080 /H11080/H11080 l mm-1 Am-1t2 2el1 t tel1 t el1 t el4 t /H11080 /H11080/H11080 e lmt eAt0 0 11 /H11080/H11080/H11080 1 I0 1 l 1 l4 /H11080/H11080/H11080 l m A1 2l1 l12 l42 /H11080 /H11080/H11080 l m2 A23l1 3l12 l13 l43 /H11080 /H11080/H11080 l m3 A3p p ppppppp674 Chapter 9 / Control Systems Analysis in State Space Substituting 0 for l 1 and–2forl 2 in this last equation, we obtain Expanding the determinant, we obtain or An alternative approach is to use Equation (9–48). We first determine a 0 (t)anda 1 (t)from Sincel 1 =0 andl 2 =–2, the last two equations become Solving for a 0 (t)anda 1 (t)gives Then can be written as Linear Independence of Vectors. The vectors x 1 ,x 2 ,p,x n are said to be linearly independent if where c 1 ,c 2 ,p,c n are constants, implies that Conversely, the vectors x 1 ,x 2 ,p,x n are said to be linearly dependent if and only if x i can be expressed as a linear combination of x j (j=1, 2, p,n; jZi),or x i =a n j=1 jZi c j x j c 1 =c 2 =p=c n =0c 1 x 1 +c 2 x 2 +p+c n x n =0 e At =a 0 (t) I+a 1 (t) A=I+1 2A1-e -2t B A= B 1 0 1 2 A1-e -2t B e -2t R e At a 0 (t)=1, a 1 (t)=1 2 A1-e -2t B a 0 (t)-2a 1 (t)=e -2t a 0 (t)=1 a 0 (t)+a 1 (t)l 2 =e l 2 t a 0 (t)+a 1 (t)l 1 =e l 1 t = B 1 0 1 2 A1-e -2t B e -2t R =1 2 b B 0 01 -2 R + B 2 00 2 R B 0 01 -2 R e -2t r e At = 1 2 AA+2 I-Ae -2t B-2e At +A+2 I-Ae -2t =0 3 1 1 I0 -2 A1 e -2t e At 3 =0 Openmirrors.comSection 9–6 / Controllability 675for some set of constants cj.This means that if xican be expressed as a linear combination of the other vectors in the set, it is linearly dependent on them or it is not an independentmember of the set. EXAMPLE 9–9 The vectors are linearly dependent since The vectors are linearly independent since implies that Note that if an n*n matrix is nonsingular (that is, the matrix is of rank nor the determinant is nonzero) then ncolumn (or row) vectors are linearly independent. If the n*n matrix is singular (that is, the rank of the matrix is less than nor the determinant is zero), then ncolumn (or row) vectors are linearly dependent. To demonstrate this, notice that 9–6 CONTROLLABILITY Controllability and Observability. A system is said to be controllable at time t0 if it is possible by means of an unconstrained control vector to transfer the system from any initial state x(t0)to any other state in a finite interval of time. A system is said to be observable at time t0if, with the system in state x(t0),it is possible to determine this state from the observation of the output over a finite time interval. The concepts of controllability and observability were introduced by Kalman. They play an important role in the design of control systems in state space. In fact, theconditions of controllability and observability may govern the existence of a completesolution to the control system design problem. The solution to this problem may not Cy1/H21752y2/H21752y3D=C1 231 012 22 S=nonsingular Cx1/H21752x2/H21752x3D=C1 231 012 24 S=singularc1=c2=c3=0c1 y1+c2 y2+c3 y3=0y1=C1 23S, y2=C101 S, y3=C222 Sx1+x2-x3=0x1=C1 23S, x2=C101 S, x3=C224 S676 Chapter 9 / Control Systems Analysis in State Space exist if the system considered is not controllable. Although most physical systems are controllable and observable, corresponding mathematical models may not possess the property of controllability and observability.Then it is necessary to know the conditions under which a system is controllable and observable. This section deals with controlla- bility and the next section discusses observability. In what follows, we shall first derive the condition for complete state controllability. Then we derive alternative forms of the condition for complete state controllability followed by discussions of complete output controllability. Finally, we present the concept of stabilizability. Complete State Controllability of Continuous-Time Systems. Consider the continuous-time system. (9–51) where The system described by Equation (9–51) is said to be state controllable at t=t 0 if it is possible to construct an unconstrained control signal that will transfer an initial state to any final state in a finite time interval If every state is controllable, then the system is said to be completely state controllable. We shall now derive the condition for complete state controllability.Without loss of generality, we can assume that the final state is the origin of the state space and that the initial time is zero, or t 0 =0. The solution of Equation (9–51) is Applying the definition of complete state controllability just given, we have or (9–52) Referring to Equation (9–48) or (9–50), can be written (9–53) Substituting Equation (9–53) into Equation (9–52) gives (9–54) x(0)=-a n-1 k=0 A k B 3 t 1 0 a k (t)u(t)dte -At =a n-1 k=0 a k (t) A k e -At x(0)=- 3 t 1 0 e -At Bu(t)dtxAt 1 B=0=e At 1 x(0)+ 3 t 1 0 e A(t 1 -t) Bu(t)dtx(t)=e At x(0) + 3 t 0 e A(t-t) Bu(t)dtt 0 /H11349t/H11349t 1 . B=n*1 matrix A=n*n matrix u=control signal (scalar ) x=state vector (n-vector )x#=Ax+Bu Openmirrors.comSection 9–6 / Controllability 677Let us put Then Equation (9–54) becomes (9–55) If the system is completely state controllable, then, given any initial state x(0),Equation (9–55) must be satisfied. This requires that the rank of the n*n matrix ben. From this analysis, we can state the condition for complete state controllability as fol- lows: The system given by Equation (9–51) is completely state controllable if and onlyif the vectors are linearly independent, or the n*n matrix is of rank n. The result just obtained can be extended to the case where the control vector uis r-dimensional. If the system is described by where uis an r-vector, then it can be proved that the condition for complete state controllability is that the n*nr matrix be of rank n,or contain nlinearly independent column vectors. The matrix is commonly called the controllability matrix. EXAMPLE 9–10 Consider the system given by Since the system is not completely state controllable.CB/H21752ABD=B1 01 0R=singularBx# 1 x# 2R=B1 01 -1RBx1 x2R+B1 0RuCB /H21752 AB /H21752 p /H21752 An-1 BDCB /H21752 AB /H21752 p /H21752 An-1 BDx#=Ax+BuCB /H21752 AB /H21752 p /H21752 An-1 BDB, AB,p, An-1 BCB /H21752 AB /H21752 p /H21752 An-1 BD =-CB/H21752AB/H21752p/H21752An-1 BDFb0 b1 /H11080 /H11080/H11080 b n-1V x(0)=-an-1 k=0Ak Bbk3t1 0ak(t)u(t)dt=bk678 Chapter 9 / Control Systems Analysis in State Space EXAMPLE 9–11 Consider the system given by For this case, The system is therefore completely state controllable. Alternative Form of the Condition for Complete State Controllability. Consider the system defined by (9–56) where If the eigenvectors of Aare distinct, then it is possible to find a transformation matrix Psuch that Note that if the eigenvalues of Aare distinct, then the eigenvectors of Aare distinct; how- ever, the converse is not true. For example, an n*n real symmetric matrix having multiple eigenvalues has ndistinct eigenvectors. Note also that each column of the P matrix is an eigenvector of Aassociated with Let us define (9–57) Substituting Equation (9–57) into Equation (9–56), we obtain (9–58) By defining P -1 B=F=Af ij Bz#=P -1 APz +P -1 Bux=Pzl i (i=1, 2, p,n).P -1 AP =D= F l 1 0l 2 /H11080 /H11080 /H110800 l n V B=n*r matrix A=n*n matrix u=control vector (r-vector ) x=state vector (n-vector )x#=Ax+Bu CB/H21752ABD= B 0 11 -1 R =nonsingular B x# 1 x# 2 R = B 1 21 -1 RB x 1 x 2 R + B 0 1 R [u] Openmirrors.comSection 9–6 / Controllability 679we can rewrite Equation (9–58) as If the elements of any one row of the n*r matrix Fare all zero, then the corresponding state variable cannot be controlled by any of the ui.Hence, the condition of complete state controllability is that if the eigenvectors of Aare distinct, then the system is com- pletely state controllable if and only if no row of has all zero elements. It is im-portant to note that, to apply this condition for complete state controllability, we mustput the matrix in Equation (9–58) in diagonal form. If the Amatrix in Equation (9–56) does not possess distinct eigenvectors, then diagonalization is impossible. In such a case, we may transform Ainto a Jordan canonical form. If, for example, Ahas eigenvalues and has n-3 distinct eigenvectors, then the Jordan canonical form of Ais The square submatrices on the main diagonal are called Jordan blocks. Suppose that we can find a transformation matrix Ssuch that If we define a new state vector zby (9–59) then substitution of Equation (9–59) into Equation (9–56) yields (9–60) The condition for complete state controllability of the system of Equation (9–56) may then be stated as follows: The system is completely state controllable if and only if (1) =Jz+S -1 Bu z#=S-1 ASz +S-1 Bux=SzS-1 AS=JJ=Il1 0 0 01 l1 00 1 l1 l4 01 l4 l6 /H11080 /H11080 /H110800 lnYl1 ,l1 ,l1 ,l4 ,l4 ,l6 ,p, lnP-1 APP-1 B z# n=ln zn+fn1 u1+fn2 u2+p+fnr ur /H11080 /H11080 /H11080 z# 2=l2 z2+f21 u1+f22 u2+p+f2r ur z# 1=l1 z1+f11 u1+f12 u2+p+f1r ur680 Chapter 9 / Control Systems Analysis in State Space no two Jordan blocks in Jof Equation (9–60) are associated with the same eigenvalues, (2) the elements of any row of that correspond to the last row of each Jordan block are not all zero, and (3) the elements of each row of that correspond to distinct eigenvalues are not all zero. EXAMPLE 9–12 The following systems are completely state controllable: The following systems are not completely state controllable: Condition for Complete State Controllability in the sPlane. The condition for complete state controllability can be stated in terms of transfer functions or transfer matrices. It can be proved that a necessary and sufficient condition for complete state con- trollability is that no cancellation occur in the transfer function or transfer matrix. If cancellation occurs, the system cannot be controlled in the direction of the canceled mode. EXAMPLE 9–13 Consider the following transfer function: Clearly, cancellation of the factor (s+2.5) occurs in the numerator and denominator of this transfer function. (Thus one degree of freedom is lost.) Because of this cancellation, this system is not completely state controllable.X(s) U(s)=s+2.5 (s+2.5)(s -1) E x# 1 x# 2 x# 3 x# 4 x# 5 U = E -2 0 0 01 -2 00 1 -2 -5 00 1 -5 UE x 1 x 2 x 3 x 4 x 5 U + E 4 2 1 3 0 U u C x# 1 x# 2 x# 3 S = C -1 0 01 -1 00 0 -2 SC x 1 x 2 x 3 S + C 4 0 32 0 0 SB u 1 u 2 R B x# 1 x# 2 R = B -1 00 -2 RB x 1 x 2 R + B 2 0 R u E x# 1 x# 2 x# 3 x# 4 x# 5 U = E -2 0 0 01 -2 00 1 -2 -5 00 1 -5 UE x 1 x 2 x 3 x 4 x 5 U + E 0 0 3 0 21 0 0 0 1 UB u 1 u 2 R C x# 1 x# 2 x# 3 S = C -1 0 01 -1 00 0 -2 SC x 1 x 2 x 3 S + C 0 4 3 S u B x# 1 x# 2 R = B -1 00 -2 RB x 1 x 2 R + B 2 5 R u S -1 BS -1 B Openmirrors.comSection 9–6 / Controllability 681The same conclusion can be obtained by writing this transfer function in the form of a state equation. A state-space representation is Since the rank of the matrix is 1. Therefore, we arrive at the same conclusion: The system is not completely state controllable. Output Controllability. In the practical design of a control system, we may want to control the output rather than the state of the system. Complete state controllabilityis neither necessary nor sufficient for controlling the output of the system. For thisreason, it is desirable to define separately complete output controllability. Consider the system described by (9–61) (9–62) where The system described by Equations (9–61) and (9–62) is said to be completely output controllable if it is possible to construct an unconstrained control vector u(t)that will transfer any given initial output yAt 0Bto any final output yAt1Bin a finite time interval t0/H11349t/H11349t1. It can be proved that the condition for complete output controllability is as follows: The system described by Equations (9–61) and (9–62) is completely output controllableif and only if the m*(n+1)r matrix is of rank m.(For a proof, see Problem A–9–16 .) Note that the presence of the Duterm in Equation (9–62) always helps to establish output controllability. Uncontrollable System. An uncontrollable system has a subsystem that is physically disconnected from the input.CCB /H21752 CAB /H21752 CA 2 B /H21752 p /H21752 CAn-1 B /H21752 DD D=m*r matrix C=m*n matrix B=n*r matrix A=n*n matrix y=output vector (m-vector )u=control vector (r-vector ) x=state vector (n-vector ) y=Cx+Du x#=Ax+BuCB /H21752 ABDCB/H21752ABD=B1 11 1RBx# 1 x# 2R=B0 2.51 -1.5RBx1 x2R+B1 1Ru682 Chapter 9 / Control Systems Analysis in State Space Stabilizability. For a partially controllable system, if the uncontrollable modes are stable and the unstable modes are controllable, the system is said to be stabilizable. For example, the system defined by is not state controllable.The stable mode that corresponds to the eigenvalue of –1is not controllable.The unstable mode that corresponds to the eigenvalue of 1 is controllable. Such a system can be made stable by the use of a suitable feedback. Thus this system is stabilizable. 9–7 OBSERVABILITY In this section we discuss the observability of linear systems. Consider the unforced system described by the following equations: (9–63) (9–64) where The system is said to be completely observable if every state xAt 0 Bcan be determined from the observation of y(t)over a finite time interval, The system is, there- fore, completely observable if every transition of the state eventually affects every ele- ment of the output vector.The concept of observability is useful in solving the problem of reconstructing unmeasurable state variables from measurable variables in the mini- mum possible length of time. In this section we treat only linear, time-invariant systems. Therefore, without loss of generality, we can assume that t 0 =0. The concept of observability is very important because, in practice, the difficulty encountered with state feedback control is that some of the state variables are not accessible for direct measurement, with the result that it becomes necessary to estimate the unmeasurable state variables in order to construct the control signals. It will be shown in Section 10–5 that such estimates of state variables are possible if and only if the system is completely observable. In discussing observability conditions, we consider the unforced system as given by Equations (9–63) and (9–64).The reason for this is as follows: If the system is described by then x(t)=e At x(0) + 3 t 0 e A(t-t) Bu(t)dt y=Cx+Du x#=Ax+But 0 /H11349t/H11349t 1 . C=m*n matrix A=n*n matrix y=output vector (m-vector ) x=state vector (n-vector ) y=Cx x#=Ax B x# 1 x# 2 R = B 1 00 -1 RB x 1 x 2 R + B 1 0 R u Openmirrors.comSection 9–7 / Observability 683andy(t)is Since the matrices A,B,C, and Dare known and u(t)is also known, the last two terms on the right-hand side of this last equation are known quantities. Therefore, they maybe subtracted from the observed value of y(t).Hence, for investigating a necessary and sufficient condition for complete observability, it suffices to consider the system describedby Equations (9–63) and (9–64). Complete Observability of Continuous-Time Systems. Consider the system described by Equations (9–63) and (9–64). The output vector y(t)is Referring to Equation (9–48) or (9–50), we have where nis the degree of the characteristic polynomial. [Note that Equations (9–48) and (9–50) with mreplaced by ncan be derived using the characteristic polynomial.] Hence, we obtain or (9–65) If the system is completely observable, then, given the output y(t)over a time interval x(0)is uniquely determined from Equation (9–65). It can be shown that this requires the rank of the nm*n matrix to be n.(See Problem A–9–19 for the derivation of this condition.) From this analysis, we can state the condition for complete observability as follows: The system described by Equations (9–63) and (9–64) is completely observable if andonly if the n*nm matrix is of rank nor has nlinearly independent column vectors. This matrix is called the observability matrix.CC*/H21752A*C*/H21752p/H21752(A*) n-1 C*DFC CA /H11080/H11080/H11080 CA n-1V0/H11349t/H11349t1 ,y(t)=a0(t) Cx(0)+a1(t) CAx (0)+p+an-1(t) CAn-1 x(0)y(t)=an-1 k=0ak(t) CAk x(0)eAt=an-1 k=0ak(t) Aky(t)=CeAt x(0)y(t)=CeAt x(0)+C 3t 0eA(t-t) Bu(t)dt+Du684 Chapter 9 / Control Systems Analysis in State Space EXAMPLE 9–14 Consider the system described by Is this system controllable and observable? Since the rank of the matrix is 2, the system is completely state controllable. For output controllability, let us find the rank of the matrix Since the rank of this matrix is 1. Hence, the system is completely output controllable. To test the observability condition, examine the rank of Since the rank of is 2. Hence, the system is completely observable. Conditions for Complete Observability in the s Plane. The conditions for com- plete observability can also be stated in terms of transfer functions or transfer matrices. The necessary and sufficient conditions for complete observability is that no cancella- tion occur in the transfer function or transfer matrix. If cancellation occurs, the canceled mode cannot be observed in the output. EXAMPLE 9–15 Show that the following system is not completely observable: where Note that the control function udoes not affect the complete observability of the system. To examine complete observability, we may simply set u=0. For this system, we have CC*/H21752A*C*/H21752(A*) 2 C*D= C 4 5 1-6 -7 -16 5 -1 S x= C x 1 x 2 x 3 S , A= C 0 0 -61 0 -110 1 -6 S , B= C 0 0 1 S , C=[4 5 1] y=Cx x#=Ax+BuCC*/H21752A*C*DCC*/H21752A*C*D= B 1 01 1 R [C*/H21752A*C*].CCB /H21752 CABD=[0 1]CCB /H21752 CABD.CB/H21752ABD= B 0 11 -1 R y=[1 0] B x 1 x 2 R B x# 1 x# 2 R = B 1 -21 -1 RB x 1 x 2 R + B 0 1 R u Openmirrors.comSection 9–7 / Observability 685Note that Hence, the rank of the matrix is less than 3.Therefore, the system is not completely observable. In fact, in this system, cancellation occurs in the transfer function of the system. The transfer function between X1(s)andU(s) is and the transfer function between Y(s) andX1(s)is Therefore, the transfer function between the output Y(s) and the input U(s) is Clearly, the two factors (s+1) cancel each other.This means that there are nonzero initial states x(0), which cannot be determined from the measurement of y(t). Comments. The transfer function has no cancellation if and only if the system is com- pletely state controllable and completely observable.This means that the canceled transferfunction does not carry along all the information characterizing the dynamic system. Alternative Form of the Condition for Complete Observability. Consider the system described by Equations (9–63) and (9–64), rewritten (9–66)(9–67) Suppose that the transformation matrix Ptransforms Ainto a diagonal matrix, or where Dis a diagonal matrix. Let us define Then Equations (9–66) and (9–67) can be written Hence, y(t)=CPe Dt z(0) y=CPz z#=P-1 APz =Dzx=PzP-1 AP =D y=Cx x#=AxY(s) U(s)=(s+1)(s +4) (s+1)(s +2)(s +3)Y(s) X1(s)=(s+1)(s +4)X1(s) U(s)=1 (s+1)(s +2)(s +3)CC*/H21752A*C*/H21752(A*)2 C*D34 51-6 -7 -16 5 -13=0or The system is completely observable if none of the columns of the m*n matrix CP consists of all zero elements. This is because, if the ith column of CPconsists of all zero elements, then the state variable z i (0)will not appear in the output equation and there- fore cannot be determined from observation of y(t).Thus, x(0),which is related to z(0) by the nonsingular matrix P, cannot be determined. (Remember that this test applies only if the matrix is in diagonal form.) If the matrix Acannot be transformed into a diagonal matrix, then by use of a suitable transformation matrix S, we can transform Ainto a Jordan canonical form, or where Jis in the Jordan canonical form. Let us define Then Equations (9–66) and (9–67) can be written Hence, The system is completely observable if (1) no two Jordan blocks in Jare associated with the same eigenvalues, (2) no columns of CSthat correspond to the first row of each Jordan block consist of zero elements, and (3) no columns of CSthat correspond to distinct eigenvalues consist of zero elements. To clarify condition (2), in Example 9–16 we have encircled by dashed lines the columns of CSthat correspond to the first row of each Jordan block. EXAMPLE 9–16 The following systems are completely observable. E x# 1 x# 2 x# 3 x# 4 x# 5 U = E 2 0 0 01 2 00 1 2 -3 00 1 -3 UE x 1 x 2 x 3 x 4 x 5 U , c y 1 y 2 d = B 1 01 11 10 10 0 RE x 1 x 2 x 3 x 4 x 5 U C x# 1 x# 2 x# 3 S = C 2 0 01 2 00 1 2 SC x 1 x 2 x 3 S , c y 1 y 2 d = B 3 40 00 0 RC x 1 x 2 x 3 S B x# 1 x# 2 R = B -1 00 -2 RB x 1 x 2 R , y=[1 3] B x 1 x 2 R y(t)=CSe Jt z(0) y=CSz z#=S -1 ASz =Jzx=SzS -1 AS=JP -1 APy(t)=CP F e l 1 t 0e l 2 t /H11080 /H11080 /H110800 e l n t V z(0)=CP F e l 1 t z 1 (0) e l 2 t z 2 (0) /H11080 /H11080 /H11080 e l n t z n (0) V 686 Chapter 9 / Control Systems Analysis in State Space Openmirrors.comThe following systems are not completely observable. Principle of Duality. We shall now discuss the relationship between controllability and observability. We shall introduce the principle of duality, due to Kalman, to clarifyapparent analogies between controllability and observability. Consider the system S 1described by where and the dual system S2defined by where The principle of duality states that the system S1is completely state controllable (observable) if and only if system S2is completely observable (state controllable). To verify this principle, let us write down the necessary and sufficient conditions for complete state controllability and complete observability for systems S1andS2. C*=conjugate transpose of C B*=conjugate transpose of B A*=conjugate transpose of A n=output vector (r-vector ) v=control vector (m-vector ) z=state vector (n-vector )n=B*zz#=A*z+C*v C=m*n matrix B=n*r matrix A=n*n matrix y=output vector (m-vector ) u=control vector (r-vector ) x=state vector (n-vector ) y=Cx x#=Ax+Bu Ex# 1 x# 2 x# 3 x# 4 x# 5U=E2 00 01 200 12 -3 00 1 -3 UEx1 x2 x3 x4 x5U, cy1 y2d=B1 01 11 10 00 0REx1 x2 x3 x4 x5U Cx# 1 x# 2 x# 3S=C2 001 200 12 SCx1 x2 x3S, cy1 y2d=B001 23 4RCx1 x2 x3S Bx# 1 x# 2R=B-1 00 -2RBx1 x2R, y=[0 1]Bx1 x2R Section 9–7 / Observability 687688 Chapter 9 / Control Systems Analysis in State Space For system S 1 : 1.A necessary and sufficient condition for complete state controllability is that the rank of the n*nr matrix ben. 2.A necessary and sufficient condition for complete observability is that the rank of then*nm matrix ben. For system S 2 : 1.A necessary and sufficient condition for complete state controllability is that the rank of the n*nm matrix ben. 2.A necessary and sufficient condition for complete observability is that the rank of then*nr matrix ben. By comparing these conditions, the truth of this principle is apparent. By use of this principle, the observability of a given system can be checked by testing the state con- trollability of its dual. Detectability. For a partially observable system, if the unobservable modes are stable and the observable modes are unstable, the system is said to be detectable. Note that the concept of detectability is dual to the concept of stabilizability. EXAMPLE PROBLEMS AND SOLUTIONS A–9–1. Consider the transfer function system defined by Equation (9–2), rewritten (9–68) Derive the following controllable canonical form of the state-space representation for this transfer-function system: (9–69) G x# 1 x# 2 /H11080 /H11080 /H11080 x# n-1 x# n W = G 0 0 /H11080 /H11080 /H11080 0 -a n 1 0 /H11080 /H11080 /H11080 0 -a n-1 0 1 /H11080 /H11080 /H11080 0 -a n-2 p p p p0 0 /H11080 /H11080 /H11080 1 -a 1 WG x 1 x 2 /H11080 /H11080 /H11080 x n-1 x n W + G 0 0 /H11080 /H11080 /H11080 0 1 W uY(s) U(s)=b 0 s n +b 1 s n-1 +p+b n-1 s+b n s n +a 1 s n-1 +p+a n-1 s+a n CB /H21752 AB /H21752 p /H21752 A n-1 BDCC*/H21752A*C*/H21752p/H21752(A*) n-1 C*DCC*/H21752A*C*/H21752p/H21752(A*) n-1 C*DCB /H21752 AB /H21752 p /H21752 A n-1 BD Openmirrors.comExample Problems and Solutions 689(9–70) Solution. Equation (9–68) can be written as which can be modified to (9–71) where Let us rewrite this last equation in the following form: From this last equation, the following two equations may be obtained: (9–72) (9–73) Now define state variables as follows: Then, clearly, sXn-1(s)=Xn(s) /H11080 /H11080 /H11080 sX2(s)=X3(s) sX1(s)=X2(s) Xn(s)=sn-1Q(s) Xn-1(s)=sn-2Q(s) /H11080 /H11080 /H11080 X2(s)=sQ(s) X1(s)=Q(s) +Abn-an b0BQ(s) Yˆ(s)=Ab1-a1 b0Bsn-1Q(s) +p+Abn-1-an-1 b0BsQ(s) snQ(s) =-a1 sn-1Q(s) -p-an-1 sQ(s) -an Q(s) +U(s) =U(s) sn+a1 sn-1+p+an-1 s+an=Q(s)Yˆ(s) Ab1-a1 b0Bsn-1+p+Abn-1-an-1 b0Bs+Abn-an b0BYˆ(s)=Ab1-a1 b0Bsn-1+p+Abn-1-an-1 b0Bs+Abn-an b0B sn+a1 sn-1+p+an-1 s+anU(s)Y(s) =b0 U(s) +Yˆ(s)Y(s) U(s)=b0+Ab1-a1 b0Bsn-1+p+Abn-1-an-1 b0Bs+Abn-an b0B sn+a1 sn-1+p+an-1 s+an y=Cbn-an b0/H21752bn-1-an-1 b0/H21752p/H21752b1-a1 b0DFx1 x2 /H11080 /H11080/H11080 x nV+b0 u690 Chapter 9 / Control Systems Analysis in State Space which may be rewritten as (9–74) Noting that we can rewrite Equation (9–72) as or (9–75) Also, from Equations (9–71) and (9–73), we obtain The inverse Laplace transform of this output equation becomes (9–76) Combining Equations (9–74) and (9–75) into one vector–matrix differential equation, we obtain Equation (9–69). Equation (9–76) can be rewritten as given by Equation (9–70). Equations (9–69) and (9–70) are said to be in the controllable canonical form. Figure 9–1 shows the block diagram representation of the system defined by Equations (9–69) and (9–70).y=Ab n -a n b 0 Bx 1 +Ab n-1 -a n-1 b 0 Bx 2 +p+Ab 1 -a 1 b 0 Bx n +b 0 u +Ab n -a n b 0 BX 1 (s) =b 0 U(s) +Ab 1 -a 1 b 0 BX n (s)+p+Ab n-1 -a n-1 b 0 BX 2 (s) +Ab n -a n b 0 BQ(s) Y(s) =b 0 U(s) +Ab 1 -a 1 b 0 Bs n-1 Q(s) +p+Ab n-1 -a n-1 b 0 BsQ(s)x# n =-a n x 1 -a n-1 x 2 -p-a 1 x n +usX n (s)=-a 1 X n (s)-p-a n-1 X 2 (s)-a n X 1 (s)+U(s)s n Q(s) =sX n (s), x# n-1 =x n /H11080 /H11080 /H11080 x# 2 =x 3 x# 1 =x 2 b 0 y u a 1 a 2 a n–1 a n x n–1 x n x 1 x 2 b 1 –a 1 b 0 b 2 –a 2 b 0 b n–1 –a n–1 b 0 b n –a n b 0 /H20848/H20848 /H20848 ++ ++ ++ ++ ++ ++ ++ +– Figure 9–1 Block diagram representation of the system defined by Equations (9–69) and (9–70) (controllable canonical form). Openmirrors.comExample Problems and Solutions 691A–9–2. Consider the following transfer-function system: (9–77) Derive the following observable canonical form of the state-space representation for this transfer- function system: (9–78) (9–79) Solution. Equation (9–77) can be modified into the following form: By dividing the entire equation by snand rearranging, we obtain (9–80) Now define state variables as follows: (9–81) X1 (s)=1 s Cbn U(s) -an Y(s)D X2 (s)=1 s Cbn-1 U(s) -an-1 Y(s) +X1 (s)D /H11080 /H11080 /H11080 Xn-1 (s)=1 s Cb2 U(s) -a2 Y(s) +Xn-2 (s)D Xn (s)=1 s Cb1 U(s) -a1 Y(s) +Xn-1 (s)D+1 sn-1Cbn-1 U(s) -an-1 Y(s)D+1 snCbn U(s) -an Y(s)DY(s) =b0 U(s) +1 sCb1 U(s) -a1 Y(s)D+p+sCan-1 Y(s) -bn-1 U(s)D+an Y(s) -bn U(s) =0snCY(s) -b0 U(s)D+sn-1Ca1 Y(s) -b1 U(s)D+py=[0 0 p 0 1]Gx1 x2 /H11080 /H11080/H11080 x n-1 xnW+b0 uFx# 1 x# 2 /H11080 /H11080/H11080 x# nV=F0 1 /H11080/H11080/H11080 00 0 /H11080/H11080/H11080 0p p p0 0 /H11080/H11080/H11080 1-a n -an-1 /H11080 /H11080/H11080 -a 1VFx1 x2 /H11080 /H11080/H11080 x nV+Fbn-an b0 bn-1-an-1 b0 /H11080 /H11080/H11080 b 1-a1 b0Vu Y(s) U(s)=b0 sn+b1 sn-1+p+bn-1 s+bn sn+a1 sn-1+p+an-1 s+an692 Chapter 9 / Control Systems Analysis in State Space Then Equation (9–80) can be written as (9–82) By substituting Equation (9–82) into Equation (9–81) and multiplying both sides of the equations bys, we obtain Taking the inverse Laplace transforms of the preceding nequations and writing them in the reverse order, we get Also, the inverse Laplace transform of Equation (9–82) gives Rewriting the state and output equations in the standard vector-matrix forms gives Equations (9–78) and (9–79). Figure 9–2 shows a block diagram representation of the system defined by Equations (9–78) and (9–79).y=x n +b 0 ux# n =x n-1 -a 1 x n +Ab 1 -a 1 b 0 Bux# n-1 =x n-2 -a 2 x n +Ab 2 -a 2 b 0 Bu/H11080/H11080/H11080x# 2 =x 1 -a n-1 x n +Ab n-1 -a n-1 b 0 Bux# 1 =-a n x n +Ab n -a n b 0 Bu sX 1 (s)=-a n X n (s)+Ab n -a n b 0 BU(s) sX 2 (s)=X 1 (s)-a n-1 X n (s)+Ab n-1 -a n-1 b 0 BU(s) /H11080 /H11080 /H11080 sX n-1 (s)=X n-2 (s)-a 2 X n (s)+Ab 2 -a 2 b 0 BU(s) sX n (s)=X n-1 (s)-a 1 X n (s)+Ab 1 -a 1 b 0 BU(s)Y(s) =b 0 U(s) +X n (s) yu a n–1 a 1 a n x n–1 x 1 x 2 x n b 0 b n –a n b 0 b n–1 –a n–1 b 0 b 1 –a 1 b 0 /H20848/H20848 /H20848 + – ++ – ++ – ++ Figure 9–2 Block diagram representation of the system defined by Equations (9–78) and (9–79) (observable canonical form). Openmirrors.comExample Problems and Solutions 693A–9–3. Consider the transfer-function system defined by (9–83) where Derive the state-space representation of this system in the following diagonal canonical form: (9–84) (9–85) Solution. Equation (9–83) may be written as (9–86) Define the state variables as follows: which may be rewritten as sXn(s)=-pn Xn(s)+U(s) /H11080 /H11080 /H11080 sX2(s)=-p2 X2(s)+U(s) sX1(s)=-p1 X1(s)+U(s) Xn(s)=1 s+pn U(s) /H11080 /H11080 /H11080 X2(s)=1 s+p2 U(s) X1(s)=1 s+p1 U(s)Y(s) =b0 U(s) +c1 s+p1U(s) +c2 s+p2U(s) +p+cn s+pnU(s)y=Cc1 c2 p cnDFx1 x2 /H11080 /H11080/H11080 x nV+b0 uFx# 1 x# 2 /H11080 /H11080/H11080 x# nV=F-p1 0-p2 /H11080 /H11080 /H110800 -pnVFx1 x2 /H11080 /H11080/H11080 x nV+F1 1 /H11080/H11080/H11080 1VupiZpj . =b0+c1 s+p1+c2 s+p2+p+cn s+pn Y(s) U(s)=b0 sn+b1 sn-1+p+bn-1 s+bn As+p1BAs+p2B p As+pnB694 Chapter 9 / Control Systems Analysis in State Space The inverse Laplace transforms of these equations give (9–87) These nequations make up a state equation. In terms of the state variables X 1 (s),X 2 (s),p,X n (s), Equation (9–86) can be written as The inverse Laplace transform of this last equation is (9–88) which is the output equation. Equation (9–87) can be put in the vector-matrix equation as given by Equation (9–84). Equa- tion (9–88) can be put in the form of Equation (9–85). Figure 9–3 shows a block diagram representation of the system defined by Equations (9–84) and (9–85). It is noted that if we choose the state variables as X ˆ n (s)=c n s+p n U(s) /H11080 /H11080 /H11080 X ˆ 2 (s)=c 2 s+p 2 U(s) X ˆ 1 (s)=c 1 s+p 1 U(s)y=c 1 x 1 +c 2 x 2 +p+c n x n +b 0 uY(s) =b 0 U(s) +c 1 X 1 (s)+c 2 X 2 (s)+p+c n X n (s) x# n =-p n x n +u /H11080 /H11080 /H11080 x# 2 =-p 2 x 2 +u x# 1 =-p 1 x 1 +u u y x n x 2 x 1 c 2 1 s+p 2 c 1 b 0 c n 1 s+p 1 … … 1 s+p n ++ + ++ Figure 9–3 Block diagram representation of the system defined by Equations (9–84) and (9–85) (diagonal canonical form). Openmirrors.comExample Problems and Solutions 695then we get a slightly different state-space representation. This choice of state variables gives from which we obtain (9–89) Referring to Equation (9–86), the output equation becomes from which we get (9–90) Equations (9–89) and (9–90) give the following state-space representation for the system: A–9–4. Consider the system defined by (9–91) where the system involves a triple pole at s=–p1. (We assume that, except for the first three pi’s being equal, the pi’s are different from one another.) Obtain the Jordan canonical form of the state-space representation for this system.Y(s) U(s)=b0 sn+b1 sn-1+p+bn-1 s+bn As+p1B3As+p4BAs+p5BpAs+pnBy=[1 1 p 1]Fxˆ1 xˆ2 /H11080 /H11080/H11080 x ˆnV+b0 uFxˆ# 1 xˆ# 2 /H11080 /H11080/H11080 x ˆ# nV=F-p1 0-p2 /H11080 /H11080 /H110800 -pnVFxˆ1 xˆ2 /H11080 /H11080/H11080 x ˆnV+Fc1 c2 /H11080/H11080/H11080 c nVuy=xˆ1+xˆ2+p+xˆn+b0 uY(s) =b0 U(s) +Xˆ1(s)+Xˆ2(s)+p+Xˆn(s)xˆ# n=-pn xˆn+cn u/H11080/H11080/H11080xˆ# 2=-p2 xˆ2+c2 uxˆ# 1=-p1 xˆ1+c1 u sXˆn(s)=-pn Xˆn(s)+cn U(s) /H11080 /H11080 /H11080 sXˆ2(s)=-p2 Xˆ2(s)+c2 U(s) sXˆ1(s)=-p1 Xˆ1(s)+c1 U(s)696 Chapter 9 / Control Systems Analysis in State Space Solution. The partial-fraction expansion of Equation (9–91) becomes which may be written as (9–92) Define Notice that the following relationships exist among X 1 (s),X 2 (s), and X 3 (s): Then, from the preceding definition of the state variables and the preceding relationships, we obtain sX n (s)=-p n X n (s)+U(s) /H11080 /H11080 /H11080 sX 4 (s)=-p 4 X 4 (s)+U(s) sX 3 (s)=-p 1 X 3 (s)+U(s) sX 2 (s)=-p 1 X 2 (s)+X 3 (s) sX 1 (s)=-p 1 X 1 (s)+X 2 (s)X 2 (s) X 3 (s)=1 s+p 1 X 1 (s) X 2 (s)=1 s+p 1 X n (s)=1 s+p n U(s) /H11080 /H11080 /H11080 X 4 (s)=1 s+p 4 U(s) X 3 (s)=1 s+p 1 U(s) X 2 (s)=1 As+p 1 B 2 U(s) X 1 (s)=1 As+p 1 B 3 U(s)+c 3 s+p 1 U(s) +c 4 s+p 4 U(s) +p+c n s+p n U(s)Y(s) =b 0 U(s) +c 1 As+p 1 B 3 U(s) +c 2 As+p 1 B 2 U(s)Y(s) U(s)=b 0 +c 1 As+p 1 B 3 +c 2 As+p 1 B 2 +c 3 s+p 1 +c 4 s+p 4 +p+c n s+p n Openmirrors.comExample Problems and Solutions 697The inverse Laplace transforms of the preceding nequations give The output equation, Equation (9–92), can be rewritten as The inverse Laplace transform of this output equation is Thus, the state-space representation of the system for the case when the denominator polynomial involves a triple root –p1can be given as follows: (9–93) (9–94) The state-space representation in the form given by Equations (9–93) and (9–94) is said to be in the Jordan canonical form. Figure 9–4 shows a block diagram representation of the system givenby Equations (9–93) and (9–94). A–9–5. Consider the transfer-function system Obtain a state-space representation of this system with MATLAB.Y(s) U(s)=25.04s +5.008 s3+5.03247s2+25.1026s +5.008 y=Cc1 c2 p cnDFx1 x2 /H11080 /H11080/H11080 x nV+b0 uHx# 1 x# 2 x# 3 x# 4 /H11080 /H11080/H11080 x# nX=H-p1 0 0 0 /H11080 /H11080/H11080 01 -p 1 0 p p0 1 -p1 0 /H11080 /H11080/H11080 00 /H11080 0 -p 4 0p p /H11080 /H11080 /H110800 /H11080 0 -pnXHx1 x2 x3 x4 /H11080 /H11080/H11080 x nX+H0011 /H11080/H11080/H11080 1 Xuy=c1 x1+c2 x2+c3 x3+c4 x4+p+cn xn+b0 uY(s) =b0 U(s) +c1 X1(s)+c2 X2(s)+c3 X3(s)+c4 X4(s)+p+cn Xn(s) x# n=-pn xn+u /H11080 /H11080 /H11080 x# 4=-p4 x4+u x# 3=-p1 x3+u x# 2=-p1 x2+x3 x# 1=-p1 x1+x2698 Chapter 9 / Control Systems Analysis in State Space y u c 1 1 s+p 1 1 s+p 1 1 s+p 1 c 4 1 s+p 4 c 2 c 3 x 3 x 4 x n x 2 x 1 b 0 c n … … 1 s+p n ++ ++ +++ ++ Figure 9–4 Block diagram representation of the system defined by Equations (9–93) and (9–94) (Jordan canonical form). Solution. MATLAB command [A,B,C,D] = tf2ss(num,den) will produce a state-space representation for the system. See MATLAB Program 9–4. MATLAB Program 9–4 num = [25.04 5.008]; den = [1 5.03247 25.1026 5.008]; [A,B,C,D] = tf2ss(num,den) A= -5.0325 -25.1026 -5.0080 1.0000 0 0 0 1.0000 0 B = 1 0 0 C = 0 25.0400 5.0080 D = 0 Openmirrors.comExample Problems and Solutions 699This is the MATLAB representation of the following state-space equations: A–9–6. Consider the system defined by where Obtain the response of the system to each of the following inputs: (a) The rcomponents of uare impulse functions of various magnitudes. (b) The rcomponents of uare step functions of various magnitudes. (c) The rcomponents of uare ramp functions of various magnitudes. Solution. (a)Impulse response: Referring to Equation (9–43), the solution to the given state equation is Substituting t0=0– into this solution, we obtain Let us write the impulse input u(t)as where wis a vector whose components are the magnitudes of rimpulse functions applied at t=0 . The solution of the state equation when the impulse input d(t)wis given at t=0 is (9–95) (b)Step response: Let us write the step input u(t)as u(t)=k =eAt x(0-)+eAt Bw x(t)=eAt x(0-)+ 3t 0-eA(t-t) Bd(t) wdtu(t)=d(t) wx(t)=eAt x(0-)+ 3t 0-eA(t-t) Bu(t)dtx(t)=eAAt-t0B xAt0B+ 3t t0eA(t-t) Bu(t)dt B=n*r constant matrix A=n*n constant matrix u=control vector (r-vector ) x=state vector (n-vector )x#=Ax+Bu y=[0 25.04 5.008]Cx1 x2 x3S+[0]u Cx# 1 x# 2 x# 3S=C-5.0325 10-25.1026 01-5.008 00 SCx1 x2 x3S+C100 Su700 Chapter 9 / Control Systems Analysis in State Space where kis a vector whose components are the magnitudes of rstep functions applied at t=0 . The solution to the step input at t=0 is given by IfAis nonsingular, then this last equation can be simplified to give (9–96) (c)Ramp response: Let us write the ramp input u(t)as where vis a vector whose components are magnitudes of ramp functions applied at t=0 .T he solution to the ramp input tvgiven at t=0 is IfAis nonsingular, then this last equation can be simplified to give (9–97) A–9–7. Obtain the response y(t) of the following system: where u(t) is the unit-step input occurring at t=0 ,o r u(t)=1(t) Solution. For this system The state transition matrix can be obtained as follows: /H9021(t)=e At =l -1 C(s I-A) -1 D/H9021(t)=e At A= B -1 1-0.5 0 R , B= B 0.5 0 R y=[1 0] C x 1 x 2 S B x# 1 x# 1 R = B -1 1-0.5 0 RB x 1 x 2 R + B 0.5 0 R u, B x 1 (0) x 2 (0) R = B 0 0 R =e At x(0)+CA -2 Ae At -IB-A -1 tD Bvx(t)=e At x(0)+AA -2 BAe At -I-AtB Bv=e At x(0)+e At a I 2t 2 -2 A 3!t 3 +3 A 2 4!t 4 -4 A 3 5!t 5 +p b Bv=e At x(0)+e At 3 t 0 e -At tdt Bvx(t)=e At x(0)+ 3 t 0 e A(t-t) Bt vdtu(t)=t v =e At x(0)+A -1 Ae At -IB Bk x(t)=e At x(0)+e At C-AA -1 BAe -At -IBD Bk =e At x(0)+e At a It-At 2 2!+A 2 t 3 3!-p b Bk =e At x(0)+e At c 3 t 0 a I-At+A 2 t 2 2!-p b dt d Bk x(t)=e At x(0)+ 3 t 0 e A(t-t) Bkdt Openmirrors.comExample Problems and Solutions 701Since we have Since x(0)=0andk=1, referring to Equation (9–96), we have Hence, the output y(t) can be given by A–9–8. The Cayley–Hamilton theorem states that every n*n matrix Asatisfies its own characteristic equation. The characteristic equation is not, however, necessarily the scalar equation of least degree that Asatisfies. The least-degree polynomial having Aas a root is called the minimal polynomial . That is, the minimal polynomial of an n*n matrix Ais defined as the polynomial f(l)of least degree, such that or The minimal polynomial plays an important role in the computation of polynomials in an n*n matrix. Let us suppose that d(l), a polynomial in l, is the greatest common divisor of all the elements of adj (lI-A). Show that, if the coefficient of the highest-degree term in lofd(l)is chosen as 1, then the minimal polynomial f(l)is given by Solution. By assumption, the greatest common divisor of the matrix adj (lI-A)isd(l).Therefore, adj(lI-A)=d(l)B(l)f(l)=2l I-A d(l)2f(A)=Am+a1 Am-1+p+am-1 A+am I=0f(A)=0,f(l)=lm+a1 lm-1+p+am-1 l+am , m/H11349ny(t) =[1 0]Bx1 x2R=x1=e-0.5tsin0.5t=Be-0.5tsin 0.5 t -e-0.5t(cos 0.5 t+sin 0.5 t)+1R=B0 -21 -2RB0.5e-0.5t(cos 0.5 t-sin 0.5 t)-0.5 e-0.5tsin 0.5 tR=A-1AeAt-IB Bx(t)=eAt x(0)+A-1AeAt-IB Bk =Be-0.5t(cos0.5t -sin0.5t) 2e-0.5tsin0.5t-e-0.5tsin0.5t e-0.5t(cos0.5t +sin0.5t)R /H9021(t)=eAt=l-1C(s I-A)-1D=Ds+0.5-0.5 (s+0.5)2+0.52 1 (s+0.5)2+0.52-0.5 (s+0.5)2+0.52 s+0.5+0.5 (s+0.5)2+0.52T(s I-A)-1=Bs+1 -10.5 sR-1 =1 s2+s+0.5Bs 1-0.5 s+1R702 Chapter 9 / Control Systems Analysis in State Space where the greatest common divisor of the n 2 elements (which are functions of l) of B(l)is unity. Since (lI-A)adj(lI-A)=|lI-A|I we obtain (9–98) from which we find that is divisible by d(l). Let us put (9–99) Because the coefficient of the highest-degree term in lofd(l)has been chosen to be 1, the coefficient of the highest-degree term in lofc(l)is also 1. From Equations (9–98) and (9–99), we have Hence, Note that c(l)can be written as wherea(l)is of lower degree than f(l). Since c(A)= 0andf(A)= 0, we must have a(A)= 0. Also, since f(l)is the minimal polynomial, a(l)must be identically zero, or Note that because f(A)= 0, we can write Hence, Noting that , we obtain Since the greatest common divisor of the n 2 elements of B(l)is unity, we have Therefore, Then, from this last equation and Equation (9–99), we obtain f(l)=∑l I-A∑ d(l)c(l)=f(l)g(l)=1B(l)=g(l) C(l)(l I-A) B(l)=c(l) Ic(l) I=g(l)f(l) I=g(l)(l I-A) C(l)f(l) I=(l I-A) C(l)c(l)=g(l)f(l)c(l)=g(l)f(l)+a(l)c(A)=0(l I-A) B(l)=c(l) I∑l I-A∑=d(l)c(l)∑l I-A∑d(l)(l I-A) B(l)=∑l I-A∑ I Openmirrors.comExample Problems and Solutions 703A–9–9. If an n*n matrix Ahasndistinct eigenvalues, then the minimal polynomial of Ais identical to the characteristic polynomial. Also, if the multiple eigenvalues of Aare linked in a Jordan chain, the minimal polynomial and the characteristic polynomial are identical. If, however, the multiple eigenvalues of Aare not linked in a Jordan chain, the minimal polynomial is of lower degree than the characteristic polynomial. Using the following matrices AandBas examples, verify the foregoing statements about the minimal polynomial when multiple eigenvalues are involved: Solution. First, consider the matrix A. The characteristic polynomial is given by Thus, the eigenvalues of Aare 2, 2, and 1. It can be shown that the Jordan canonical form of Ais and the multiple eigenvalues are linked in the Jordan chain as shown. To determine the minimal polynomial, let us first obtain adj (lI-A). It is given by Notice that there is no common divisor of all the elements of Hence, d(l)=1 . Thus, the minimal polynomial f(l)is identical to the characteristic polynomial, or A simple calculation proves that =C0 000 000 00 S=0=C8 0072 82128 0 1 S-5C4 0016 4 912 0 1 S+8C2 001 234 01 S-4C1 000 100 01 SA3-5 A2+8 A-4 I =l3-5l2+8l-4 f(l)=∑l I-A∑=(l-2)2(l-1)adj(l I-A).adj(l I-A)=C(l-2)(l-1) 00(l+11) (l-2)(l-1) 3(l-2)4(l-2) 0 (l-2) 2SC2 001 200 01 S∑l I-A∑=3l-2 00-1 l-2 -3-4 0 l-13=(l-2)2(l-1)A=C2 001 234 01 S, B=C2 000 230 01 S704 Chapter 9 / Control Systems Analysis in State Space but Thus, we have shown that the minimal polynomial and the characteristic polynomial of this matrix Aare the same. Next, consider the matrix B. The characteristic polynomial is given by A simple computation reveals that matrix Bhas three eigenvectors, and the Jordan canonical form of Bis given by Thus, the multiple eigenvalues are not linked.To obtain the minimal polynomial, we first compute : from which it is evident that Hence, As a check, let us compute : For the given matrix B, the degree of the minimal polynomial is lower by 1 than that of the char- acteristic polynomial.As shown here, if the multiple eigenvalues of an n*n matrix are not linked in a Jordan chain, the minimal polynomial is of lower degree than the characteristic polynomial.f(B)=B 2 -3 B+2 I= C 4 0 00 4 90 0 1 S -3 C 2 0 00 2 30 0 1 S +2 C 1 0 00 1 00 0 1 S = C 0 0 00 0 00 0 0 S =0f(B)f(l)=∑l I-B∑ d(l)=(l-2) 2 (l-1) l-2=l 2 -3l+2d(l)=l-2adj(l I-B)= C (l-2)(l-1) 0 00 (l-2)(l-1) 3(l-2)0 0 (l-2) 2 S adj(l I-B) C 2 0 00 2 00 0 1 S ∑l I-B∑= 3 l-2 0 00 l-2 -30 0 l-1 3 =(l-2) 2 (l-1)= C 0 0 013 0 00 0 0 S Z0= C 4 0 016 4 912 0 1 S -3 C 2 0 01 2 34 0 1 S +2 C 1 0 00 1 00 0 1 S A 2 -3 A+2 I Openmirrors.comExample Problems and Solutions 705A–9–10. Show that by use of the minimal polynomial, the inverse of a nonsingular matrix Acan be ex- pressed as a polynomial in Awith scalar coefficients as follows: (9–100) where a1,a2,p,amare coefficients of the minimal polynomial Then obtain the inverse of the following matrix A: Solution. For a nonsingular matrix A, its minimal polynomial f(A)can be written as where amZ0. Hence, Premultiplying by A–1, we obtain which is Equation (9–100). For the given matrix A, adj(lI-A)can be given as Clearly, there is no common divisor d(l)of all elements of adj (lI-A). Hence, d(l)=1 . Consequently, the minimal polynomial f(l)is given by Thus, the minimal polynomial f(l)is the same as the characteristic polynomial. Since the characteristic polynomial is we obtain f(l)=l3+3l2-7l-17∑l I-A∑=l3+3l2-7l-17f(l)=∑l I-A∑ d(l)=∑l I-A∑adj(/H9261I-A)=Cl2+4l+3 3l+7 l+12l+6 l2+2l-3 2-4 -2l+2 l2-7SA-1=-1 amAAm-1+a1 Am-2+p+am-2 A+am-1 IBI=- 1 am AAm+a1 Am-1+p+am-2 A2+am-1 ABf(A)=Am+a1 Am-1+p+am-1 A+am I=0A=C1 312 -1 00 -2 -3Sf(l)=lm+a1 lm-1+p+am-1 l+amA-1=-1 amAAm-1+a1 Am-2+p+am-2 A+am-1 IB706 Chapter 9 / Control Systems Analysis in State Space By identifying the coefficients a i of the minimal polynomial (which is the same as the characteristic polynomial in this case), we have The inverse of Acan then be obtained from Equation (9–100) as follows: A–9–11. Show that if matrix Acan be diagonalized, then where Pis a diagonalizing transformation matrix that transforms Ainto a diagonal matrix, or P –1 AP=D, where Dis a diagonal matrix. Show also that if matrix Acan be transformed into a Jordan canonical form, then where Sis a transformation matrix that transforms Ainto a Jordan canonical form J, or S –1 AS=J. Solution. Consider the state equation If a square matrix can be diagonalized, then a diagonalizing matrix (transformation matrix) exists and it can be obtained by a standard method. Let Pbe a diagonalizing matrix for A. Let us define Then where Dis a diagonal matrix. The solution of this last equation is Hence, x(t)=Px ˆ (t)=Pe Dt P -1 x(0)x ˆ (t)=e Dt x ˆ (0)x ˆ # =P -1 APx ˆ =Dx ˆ x=Px ˆ x#=Axe At =Se Jt S -1 e At =Pe Dt P -1 = C 3 17 7 17 1 176 17 3 17 2 17 4 17 2 17 7 17 S =1 17 C 3 7 16 -3 2-4 2 -7 S =1 17 c C 7 -2 -20 7 2-4 8 9 S +3 C 1 3 12 -1 00 -2 -3 S -7 C 1 0 00 1 00 0 1 S s A -1 =-1 a 3 AA 2 +a 1 A+a 2 IB=1 17AA 2 +3 A-7 IBa 1 =3, a 2 =-7, a 3 =-17 Openmirrors.comExample Problems and Solutions 707Noting that x(t)can also be given by the equation we obtain or (9–101) Next, we shall consider the case where matrix Amay be transformed into a Jordan canonical form. Consider again the state equation First obtain a transformation matrix Sthat will transform matrix Ainto a Jordan canonical form so that where Jis a matrix in a Jordan canonical form. Now define Then The solution of this last equation is Hence, Since the solution x(t)can also be given by the equation we obtain Note that eJtis a triangular matrix [which means that the elements below (or above, as the case may be) the principal diagonal line are zeros] whose elements are elt,telt, , and so forth. For example, if matrix Jhas the following Jordan canonical form: then eJt=Cel1 t 0 0tel1 t el1 t 01 2t2el1 t tel1 t el1 tSJ=Cl1 0 01 l1 00 1 l1S1 2t2elteAt=SeJt S-1x(t)=eAt x(0)x(t)=Sxˆ(t)=SeJt S-1 x(0)xˆ(t)=eJt xˆ(0)xˆ# =S-1 AS xˆ=Jxˆx=SxˆS-1 AS=Jx#=AxeAt=PeDt P-1=PFel1 t 0el2 t /H11080 /H11080 /H110800 eln tVP-1eAt=PeDt P-1,x(t)=eAt x(0)708 Chapter 9 / Control Systems Analysis in State Space Similarly, if then A–9–12. Consider the following polynomial in lof degree m-1 , where we assume l 1 ,l 2 ,p,l m to be distinct: where k=1, 2,p,m. Notice that Then the polynomial f(l)of degree m-1 , takes on the values fAl k Bat the points l k . This last equation is commonly called Lagrange’s interpolation formula . The polynomial f(l)of degree m-1 is determined from mindependent data fAl 1 B,fAl 2 B,p,fAl m B. That is, the polynomial f(l)passes through mpoints fAl 1 B,fAl 2 B,p,fAl m B. Since f(l)is a polynomial of degree m-1 , it is uniquely determined. Any other representations of the polynomial of degree m-1 can be reduced to the Lagrange polynomial f(l). =a m k=1 fAl k BAl-l 1 BpAl-l k-1 BAl-l k+1 BpAl-l m B Al k -l 1 BpAl k -l k-1 BAl k -l k+1 BpAl k -l m B f(l)=a m k=1 fAl k Bp k (l)p k Al i B= b 1, 0,ifi=k ifiZkp k (l)=Al-l 1 BpAl-l k-1 BAl-l k+1 BpAl-l m B Al k -l 1 BpAl k -l k-1 BAl k -l k+1 BpAl k -l m Be Jt = G e l 1 t 0 0 0te l 1 t e l 1 t 0 1 2 t 2 e l 1 t te l 1 t e l 1 t e l 4 t 0te l 4 t e l 4 t e l 6 t 00 0 e l 7 t W J= G l 1 0 0 01 l 1 00 1 l 1 l 4 01 l 4 l 6 0 l 7 W Openmirrors.comExample Problems and Solutions 709Assuming that the eigenvalues of an n*n matrix Aare distinct, substitute Aforlin the polynomial pk(l). Then we get Notice that pk(A)is a polynomial in Aof degree m-1 . Notice also that Now define (9–102) Equation (9–102) is known as Sylvester’s interpolation formula. Equation (9–102) is equivalent to the following equation: (9–103) Equations (9–102) and (9–103) are frequently used for evaluating functions f(A)of matrix A— for example, (lI-A)–1,eAt, and so forth. Note that Equation (9–103) can also be written as (9–104) Show that Equations (9–102) and (9–103) are equivalent. To simplify the arguments, assume that m=4 .71 1 /H11080/H11080/H11080 1 Il 1 l2 /H11080 /H11080/H11080 l m Al2 1 l22 /H11080 /H11080/H11080 l 2 m A2p p p ppl m-1 1 lm-1 2 /H11080 /H11080/H11080 l m-1 m Am-1fAl1B fAl2B /H11080/H11080/H11080 fAl mB f(A)7=081 l1 l2 1 /H11080 /H11080/H11080 l m-1 1 fAl1B1 l2 l2 2 /H11080 /H11080/H11080 l m-1 2 fAl2Bp pp p p1 l m l2 m /H11080 /H11080/H11080 l m-1 m fAlmBI A A2 /H11080/H11080/H11080 A m-1 f(A)8=0 =am k=1fAlkBAA-l1 IBpAA-lk-1 IBAA-lk+1 IBpAA-lm IB Alk-l1BpAlk-lk-1BAlk-lk+1BpAlk-lmB f(A)=am k=1fAlkBpk(A)pkAli IB=bI, 0,ifi=k ifiZkpk(A)=AA-l1 IB p AA-lk-1 IBAA-lk+1 IB p AA-lm IB Alk-l1BpAlk-lk-1BAlk-lk+1BpAlk-lmB710 Chapter 9 / Control Systems Analysis in State Space Solution. Equation (9–103), where m=4 , can be expanded as follows: Since and we obtain =0 +fAl 1 BCAA-l 4 IBAA-l 3 IBAA-l 2 IBAl 4 -l 3 BAl 4 -l 2 BAl 3 -l 2 BD -fAl 2 BCAA-l 4 IBAA-l 3 IBAA-l 1 IBAl 4 -l 3 BAl 4 -l 1 BAl 3 -l 1 BD +fAl 3 BCAA-l 4 IBAA-l 2 IBAA-l 1 IBAl 4 -l 2 BAl 4 -l 1 BAl 2 -l 1 BD -fAl 4 BCAA-l 3 IBAA-l 2 IBAA-l 1 IBAl 3 -l 2 BAl 3 -l 1 BAl 2 -l 1 BD ¢= f(A)CAl 4 -l 3 BAl 4 -l 2 BAl 4 -l 1 BAl 3 -l 2 BAl 3 -l 1 BAl 2 -l 1 BD 4 1 l i l 2 i l 3 i 1 l j l 2 j l 3 j 1 l k l 2 k l 3 k I A A 2 A 3 4 =AA-l k IBAA-l j IBAA-l i IBAl k -l j BAl k -l i BAl j -l i B 4 1 l 1 l 2 1 l 3 1 1 l 2 l 2 2 l 3 2 1 l 3 l 2 3 l 3 3 1 l 4 l 2 4 l 3 4 4 =Al 4 -l 3 BAl 4 -l 2 BAl 4 -l 1 BAl 3 -l 2 BAl 3 -l 1 BAl 2 -l 1 B +fAl 1 B 4 1 l 2 l 2 2 l 3 2 1 l 3 l 2 3 l 3 3 1 l 4 l 2 4 l 3 4 I A A 2 A 3 4 +fAl 3 B 4 1 l 1 l 2 1 l 3 1 1 l 2 l 2 2 l 3 2 1 l 4 l 2 4 l 3 4 I A A 2 A 3 4 -fAl 2 B 4 1 l 1 l 2 1 l 3 1 1 l 3 l 2 3 l 3 3 1 l 4 l 2 4 l 3 4 I A A 2 A 3 4 =f(A) 4 1 l 1 l 2 1 l 3 1 1 l 2 l 2 2 l 3 2 1 l 3 l 2 3 l 3 3 1 l 4 l 2 4 l 3 4 4 -fAl 4 B 4 1 l 1 l 2 1 l 3 1 1 l 2 l 2 2 l 3 2 1 l 3 l 2 3 l 3 3 I A A 2 A 3 4 ¢= 5 1 l 1 l 2 1 l 3 1 fAl 1 B1 l 2 l 2 2 l 3 2 fAl 2 B1 l 3 l 2 3 l 3 3 fAl 3 B1 l 4 l 2 4 l 3 4 fAl 4 BI A A 2 A 3 f(A) 5 Openmirrors.comExample Problems and Solutions 711Solving this last equation for f(A), we obtain where m=4 .Thus, we have shown the equivalence of Equations (9–102) and (9–103).Although we assumed m=4 , the entire argument can be extended to an arbitrary positive integer m.( F o r the case when the matrix Ainvolves multiple eigenvalues, refer to Problem A–9–13 .) A–9–13. Consider Sylvester’s interpolation formula in the form given by Equation (9–104): This formula for the determination of f(A)applies to the case where the minimal polynomial of Ainvolves only distinct roots. Suppose that the minimal polynomial of Ainvolves multiple roots. Then the rows in the determinant that correspond to the multiple roots become identical, and therefore modification of the determinant in Equation (9–104) becomes necessary. Modify the form of Sylvester’s interpolation formula given by Equation (9–104) when the minimal polynomial of Ainvolves multiple roots. In deriving a modified determinant equation, assume that there are three equal roots in the minimal polynomial of Aand that there are other roots that are distinct. Solution. Since the minimal polynomial of Ainvolves three equal roots, the minimal polynomial f(l)can be written as An arbitrary function f(A)of an n*n matrix Acan be written as where the minimal polynomial f(A)is of degree manda(A)is a polynomial in Aof degree m-1 or less. Hence we have wherea(l)is a polynomial in lof degree m-1 or less, which can thus be written as (9–105) a(l)=a0+a1 l+a2 l2+p+am-1 lm-1f(l)=g(l)f(l)+a(l)f(A)=g(A)f(A)+a(A)=Al-l1B3Al-l4BAl-l5BpAl-lmBf(l)=lm+a1 lm-1+p+am-1 l+amAl4, l5,p, lmBAl1=l2=l3B71 1 /H11080/H11080/H11080 1 Il 1 l2 /H11080 /H11080/H11080 l m Al2 1 l22 /H11080 /H11080/H11080 l 2 m A2p p p ppl m-1 1 lm-1 2 /H11080 /H11080/H11080 l m-1 m Am-1fAl1B fAl2B /H11080/H11080/H11080 fAl mB f(A)7=0 =am k=1fAlkBAA-l1 IBpAA-lk-1 IBAA-lk+1 IBpAA-lm IB Alk-l1BpAlk-lk-1BAlk-lk+1BpAlk-lmB +fAl3BAA-l1 IBAA-l2 IBAA-l4 IB Al3-l1BAl3-l2BAl3-l4B+fAl4BAA-l1 IBAA-l2 IBAA-l3 IB Al4-l1BAl4-l2BAl4-l3B f(A)=fAl1BAA-l2 IBAA-l3 IBAA-l4 IB Al1-l2BAl1-l3BAl1-l4B+fAl2BAA-l1 IBAA-l3 IBAA-l4 IB Al2-l1BAl2-l3BAl2-l4B712 Chapter 9 / Control Systems Analysis in State Space In the present case we have (9–106) By substituting l 1 ,l 4 ,p,l m forlin Equation (9–106), we obtain the following m-2 equations: (9–107) By differentiating Equation (9–106) with respect to l, we obtain (9–108) where Substitution of l 1 forlin Equation (9–108) gives Referring to Equation (9–105), this last equation becomes (9–109) Similarly, differentiating Equation (9–106) twice with respect to land substituting l 1 forl,w e obtain This last equation can be written as (9–110) Rewriting Equations (9–110), (9–109), and (9–107), we get (9–111) a 0 +a 1 l m +a 2 l 2 m +p+a m-1 l m-1 m =fAl m B/H11080/H11080/H11080a 0 +a 1 l 4 +a 2 l 2 4 +p+a m-1 l m-1 4 =fAl 4 Ba 0 +a 1 l 1 +a 2 l 2 1 +p+a m-1 l m-1 1 =fAl 1 Ba 1 +2a 2 l 1 +p+(m-1)a m-1 l m-2 1 =f¿Al 1 Ba 2 +3a 3 l 1 +p+(m-1)(m-2) 2a m-1 l m-3 1 =f–Al 1 B 2f–Al 1 B=2a 2 +6a 3 l 1 +p+(m-1)(m -2)a m-1 l m-3 1 d 2 d 2 lf(l) 2 l=l 1 =f–Al 1 B=d 2 dl 2 a(l) 2 l=l 1 f¿Al 1 B=a 1 +2a 2 l 1 +p+(m-1)a m-1 l m-2 1 d dlf(l) 2 l=l 1 =f¿Al 1 B=d dla(l) 2 l=l 1 Al-l 1 B 2 h(l)=d dl Cg(l)Al-l 1 B 3 Al-l 4 BpAl-l m BDd dlf(l)=Al-l 1 B 2 h(l)+d dla(l)fAl m B=aAl m B/H11080/H11080/H11080fAl 4 B=aAl 4 BfAl 1 B=aAl 1 B =g(l)CAl-l 1 B 3 Al-l 4 BpAl-l m BD+a(l) f(l)=g(l)f(l)+a(l) Openmirrors.comExample Problems and Solutions 713These msimultaneous equations determine the akvalues (where k=0 ,1 ,2 , p,m-1 ). Noting thatf(A)= 0because it is a minimal polynomial, we have f(A)as follows: Hence, referring to Equation (9–105), we have (9–112) where the akvalues are given in terms of fAl1B,f¿Al1B,f–Al1B,fAl4B,fAl5B,p,fAlmB. In terms of the determinant equation, f(A)can be obtained by solving the following equation: (9–113) Equation (9–113) shows the desired modification in the form of the determinant. This equation gives the form of Sylvester’s interpolation formula when the minimal polynomial of Ainvolves three equal roots. (The necessary modification of the form of the determinant for other cases willbe apparent.) A–9–14. Using Sylvester’s interpolation formula, compute e At, where Solution. Referring to Problem A–9–9 , the characteristic polynomial and the minimal polynomial are the same for this A. The minimal polynomial (characteristic polynomial) is given by Note that l1=l2=2 andl3=1 . Referring to Equation (9–112) and noting that f(A)in this problem is eAt, we have wherea0(t),a1(t), and a2(t)are determined from the equations a0(t)+a1(t)l3+a2(t)l2 3=el3 t a0(t)+a1(t)l1+a2(t)l2 1=el1 t a1(t)+2a2(t)l1=tel1 teAt=a0(t) I+a1(t) A+a2(t) A2f(l)=(l-2)2(l-1)A=C2 001 234 01 Sf–Al1B 2 f¿Al1B fAl1B fAl4B /H11080/H11080/H11080 fAl mB f(A) =00 0 11 /H11080/H11080/H11080 1 I0 1 l 1 l4 /H11080/H11080/H11080 l m A1 2l1 l2 1 l24 /H11080 /H11080/H11080 l 2 m A23l1 3l2 1 l31 l34 /H11080 /H11080/H11080 l 3 m A3p p pp p p(m-1)(m -2) 2lm-3 1 (m-1)lm-2 1 lm-1 1 lm-1 4 /H11080 /H11080/H11080 l m-1 m Am-1f(A)=a(A)=a0 I+a1 A+a2 A2+p+am-1 Am-1f(A)=g(A)f(A)+a(A)=a(A)714 Chapter 9 / Control Systems Analysis in State Space Substituting l 1 =2 , and l 3 =1 into these three equations gives Solving for a 0 (t),a 1 (t), and a 2 (t), we obtain Hence, A–9–15. Show that the system described by (9–114) (9–115) where is completely output controllable if and only if the composite m*nr matrix P, where is of rank m. (Notice that complete state controllability is neither necessary nor sufficient for complete output controllability.) Solution. Suppose that the system is output controllable and the output y(t)starting from any y(0), the initial output, can be transferred to the origin of the output space in a finite time interval 0/H11349t/H11349T. That is, (9–116) y(T) =Cx(T) =0P=CCB /H21752 CAB /H21752 CA 2 B /H21752 p /H21752 CA n-1 BD C=m*n matrix B=n*r matrix A=n*n matrix y=output vector (m-vector ) (m/H11349n) u=control vector (r-vector ) x=state vector (n-vector )y=Cxx#=Ax+Bu = C e 2t 0 012e t -12e 2t +13te 2t e 2t -3e t +3e 2t -4e t +4e 2t 0 e t S +Ae t -e 2t +te 2t B C 4 0 016 4 912 0 1 S e At =A4e t -3e 2t +2te 2t B C 1 0 00 1 00 0 1 S +A-4e t +4e 2t -3te 2t B C 2 0 01 2 34 0 1 S a 2 (t)=e t -e 2t +te 2t a 1 (t)=-4e t +4e 2t -3te 2t a 0 (t)=4e t -3e 2t +2te 2t a 0 (t)+a 1 (t)+a 2 (t)=e t a 0 (t)+2a 1 (t)+4a 2 (t)=e 2t a 1 (t)+4a 2 (t)=te 2t Openmirrors.comExample Problems and Solutions 715Since the solution of Equation (9–114) is att=T , we have (9–117) Substituting Equation (9–117) into Equation (9–116), we obtain (9–118) On the other hand, y(0)= Cx(0). Notice that the complete output controllability means that the vector Cx(0)spans the m-dimensional output space. Since eATis nonsingular, if Cx(0)spans the m-dimensional output space, so does CeATx(0), and vice versa. From Equation (9–118) we obtain Note that can be expressed as the sum of AiBj; that is, where andai(t)satisfies (p: degree of the minimal polynomial of A) andBjis the jth column of B. Therefore, we can write CeATx(0)as From this last equation, we see that is a linear combination of CAiBj (i=0, 1, 2, p, p-1; j=1, 2 ,p,r). Note that if the rank of Q, where ism, then so is the rank of P, and vice versa. [This is obvious if p=n . If p<n , then the CAhBj (where p/H11349h/H11349n-1) are linearly dependent on CBj,CABj,p,CAp-1Bj. Hence, the rank ofQ=CCB /H21752 CAB /H21752 CA2 B /H21752 p /H21752 CAp-1 BD (p/H11349n)CeAT x(0)CeAT x(0)=-ap-1 i=0ar j=1gij CAi BjeAt=ap-1 i=0ai(t) Aigij= 3T 0ai(t)uj(T-t)dt=scalar3T 0eAt Bu(T-t)dt=ap-1 i=0ar j=1gij Ai Bj1T 0eAt Bu(T-t)dt =- C 3T 0eAt Bu(T-t)dt CeAT x(0)=- CeAT 3T 0e-At Bu(t)dt =CeATcx(0)+ 3T 0e- At Bu(t)dtd=0 y(T) =Cx(T)x(T) =eATcx(0)+ 3T 0e- At Bu(t)dtdx(t)=eAtcx(0)+ 3t 0e- At Bu(t)dtd716 Chapter 9 / Control Systems Analysis in State Space Pis equal to that of Q.] If the rank of Pism, then Ce AT x(0)spans the m-dimensional output space.This means that if the rank of Pism, then Cx(0)also spans the m-dimensional output space and the system is completely output controllable. Conversely, suppose that the system is completely output controllable, but the rank of Pisk, where k<m . Then the set of all initial outputs that can be transferred to the origin is of k-dimensional space. Hence, the dimension of this set is less than m. This contradicts the as- sumption that the system is completely output controllable. This completes the proof. Note that it can be immediately proved that, in the system of Equations (9–114) and (9–115), complete state controllability on 0 /H11349t/H11349Timplies complete output controllability on 0 /H11349t/H11349T if and only if mrows of Care linearly independent. A–9–16. Discuss the state controllability of the following system: (9–119) Solution. For this system, Since we see that vectors BandABare not linearly independent and the rank of the matrix [ B/H21752AB] is 1. Therefore, the system is not completely state controllable. In fact, elimination of x 2 from Equation (9–119), or the following two simultaneous equations, yields or, in the form of a transfer function, Notice that cancellation of the factor (s+2.5) occurs in the numerator and denominator of the transfer function. Because of this cancellation, this system is not completely state controllable. This is an unstable system. Remember that stability and controllability are quite different things. There are many systems that are unstable, but are completely state controllable. A–9–17. A state-space representation of a system in the controllable canonical form is given by (9–120) (9–121) y=[0.8 1] B x 1 x 2 RB x# 1 x# 2 R = B 0 -0.41 -1.3 RB x 1 x 2 R + B 0 1 R uX 1 (s) U(s)=s+2.5 (s+2.5)(s -1)x$ 1 +1.5x# 1 -2.5x 1 =u#+2.5ux# 2 =-2x 1 +1.5x 2 +4ux# 1 =-3x 1 +x 2 +uAB = B -3 -21 1.5 RB 1 4 R = B 1 4 R A= B -3 -21 1.5 R , B= B 1 4 RB x# 1 x# 2 R = B -3 -21 1.5 RB x 1 x 2 R + B 1 4 R u Openmirrors.comExample Problems and Solutions 717The same system may be represented by the following state-space equation, which is in the observable canonical form: (9–122) (9–123) Show that the state-space representation given by Equations (9–120) and (9–121) gives a sys- tem that is state controllable, but not observable. Show, on the other hand, that the state-space rep-resentation defined by Equations (9–122) and (9–123) gives a system that is not completely statecontrollable, but is observable. Explain what causes the apparent difference in the controllabilityand observability of the same system. Solution. Consider the system defined by Equations (9–120) and (9–121). The rank of the controllability matrix is 2. Hence, the system is completely state controllable. The rank of the observability matrix is 1. Hence the system is not observable. Next consider the system defined by Equations (9–122) and (9–123). The rank of the controllability matrix is 1. Hence, the system is not completely state controllable. The rank of the observability matrix is 2. Hence, the system is observable. The apparent difference in the controllability and observability of the same system is caused by the fact that the original system has a pole-zero cancellation in the transfer function. Referring to Equation (2–29), for D=0 we have If we use Equations (9–120) and (9–121), then [Note that the same transfer function can be obtained by using Equations (9–122) and (9–123).] Clearly, cancellation occurs in this transfer function. =s+0.8 (s+0.8)(s +0.5) =1 s2+1.3s +0.4[0.8 1]Bs+1.3 -0.41 sRB01R G(s) =[0.8 1]Bs 0.4-1 s+1.3R-1 B0 1RG(s) =C(s I-A)-1 B[C*/H21752A* C*]=B0 11 -1.3R[B/H21752AB]=B0.8 1-0.4 -0.5R[C*/H21752A* C*]=B0.8 1-0.4 -0.5R[B/H21752AB]=B0 11 -1.3Ry=[0 1]Bx1 x2RBx# 1 x# 2R=B0 1-0.4 -1.3RBx1 x2R+B0.8 1Ru718 Chapter 9 / Control Systems Analysis in State Space If a pole-zero cancellation occurs in the transfer function, then the controllability and observability vary, depending on how the state variables are chosen. Remember that, to be completely state con- trollable and observable, the transfer function must not have any pole-zero cancellations. A–9–18. Prove that the system defined by where is completely observable if and only if the composite mn*n matrix P, where is of rank n. Solution. We shall first obtain the necessary condition. Suppose that Then there exists x(0)such that or Hence, we obtain, for a certain x(0), Notice that from Equation (9–48) or (9–50), we have where m(m /H11349n)is the degree of the minimal polynomial for A. Hence, for a certain x(0), we have Ce At x(0)=CCa 0 (t) I+a 1 (t) A+a 2 (t) A 2 +p+a m-1 (t) A m-1 D x(0)=0e At =a 0 (t) I+a 1 (t) A+a 2 (t) A 2 +p+a m-1 (t) A m-1 CA i x(0)=0, fori=0, 1, 2, p,n-1Px(0)= F C CA /H11080 /H11080 /H11080 CA n-1 V x(0)= F Cx(0) CAx (0) /H11080 /H11080 /H11080 CA n-1 x(0) V =0Px(0)=0rank P6nP= F C CA /H11080 /H11080 /H11080 CA n-1 V C=m*n matrix A=n*n matrix y=output vector (m-vector ) (m/H11349n) x=state vector (n-vector )y=Cxx#=Ax Openmirrors.comExample Problems and Solutions 719Consequently, for a certain x(0), which implies that, for a certain x(0),x(0)cannot be determined from y(t). Therefore, the rank of matrix Pmust be equal to n. Next we shall obtain the sufficient condition. Suppose that rank P=n . Since by premultiplying both sides of this last equation by eA*tC*, we get If we integrate this last equation from 0 to t, we obtain (9–124) Notice that the left-hand side of this equation is a known quantity. Define (9–125) Then, from Equations (9–124) and (9–125), we have (9–126) where It can be established that W(t)is a nonsingular matrix as follows: If @W(t)@were equal to 0, then which means that which implies that rank P<n . Therefore,@W(t)@Z0, or W(t)is nonsingular. Then, from Equa- tion (9–126), we obtain (9–127) andx(0)can be determined from Equation (9–127). Hence, we have proved that x(0)can be determined from y(t)if and only if rank P=n . Note that x(0)andy(t)are related by y(t)=CeAt x(0)=a0(t) Cx(0)+a1(t) CAx (0)+p+an-1(t) CAn-1 x(0)x(0)=CW(t)D-1 Q(t)CeAt x=0, for 0/H11349t/H11349t1x* WAt1B x= 3t1 07CeAt x72dt=0W(t)= 3t 0eA*t C*CeAtdtQ(t)=W(t) x(0)Q(t)= 3t 0eA*t C* y(t)dt=known quantity3t 0eA*t C* y(t)dt= 3t 0eA*t C* CeAt x(0)dteA*t C* y(t)=eA*t C* CeAt x(0)y(t)=CeAt x(0)y(t)=Cx(t)=CeAt x(0)=0720 Chapter 9 / Control Systems Analysis in State Space PROBLEMS B–9–1. Consider the following transfer-function system: Obtain the state-space representation of this system in (a) controllable canonical form and (b) observable canonical form. B–9–2. Consider the following system: Obtain a state-space representation of this system in a di- agonal canonical form. B–9–3. Consider the system defined by where Transform the system equations into the controllable canon- ical form. B–9–4. Consider the system defined by where Obtain the transfer function Y(s)/U(s) . B–9–5. Consider the following matrix A: Obtain the eigenvalues l 1 ,l 2 ,l 3 , and l 4 of the matrix A. Then obtain a transformation matrix Psuch that P -1 AP =diagAl 1 , l 2 , l 3 , l 4 BA= D 0 0 0 11 0 0 00 1 0 00 0 1 0 T A= C -1 1 00 -2 01 0 -3 S , B= C 0 0 1 S , C=[1 1 0]y=Cxx#=Ax+BuA= B 1 -42 -3 R , B= B 1 2 R , C=[1 1]y=Cxx#=Ax+Buy%+6y$+11y#+6y=6uY(s) U(s)=s+6 s 2 +5s+6B–9–6. Consider the following matrix A: Compute e At by three methods. B–9–7. Given the system equation find the solution in terms of the initial conditions x 1 (0), x 2 (0), and x 3 (0). B–9–8. Find x 1 (t)andx 2 (t)of the system described by where the initial conditions are B–9–9. Consider the following state equation and output equation: Show that the state equation can be transformed into the following form by use of a proper transformation matrix: Then obtain the output yin terms of z 1 , z 2 , and z 3 . B–9–10. Obtain a state-space representation of the follow- ing system with MATLAB: Y(s) U(s)=10.4s 2 +47s +160 s 3 +14s 2 +56s +160 C z# 1 z# 2 z# 3 S = C 0 1 00 0 1-6 -11 -6 SC z 1 z 2 z 3 S + C 1 0 0 S u y=[1 0 0] C x 1 x 2 x 3 S C x# 1 x# 2 x# 3 S = C -6 -11 -61 0 00 1 0 SC x 1 x 2 x 3 S + C 2 6 2 S u B x 1 (0) x 2 (0) R = B 1 -1 RB x# 1 x# 2 R = B 0 -31 -2 RB x 1 x 2 RC x# 1 x# 2 x# 3 S = C 2 0 01 2 00 1 2 SC x 1 x 2 x 3 S A= B 0 -21 -3 R Openmirrors.comProblems 721B–9–11. Obtain a transfer-function representation of the following system with MATLAB: B–9–12. Obtain a transfer-function representation of the following system with MATLAB: B–9–13. Consider the system defined by Is the system completely state controllable and completely observable? B–9–14. Consider the system given by Is the system completely state controllable and completely observable? Is the system completely output controllable? By1 y2R=B1 00 10 0RCx1 x2 x3S Cx# 1 x# 2 x# 3S=C2 000 230 01 SCx1 x2 x3S+C0101 01 SBu1 u2R y=[1 1 0]Cx1 x2 x3SCx# 1 x# 2 x# 3S=C-1 01-2 -1 0-2 1 -1SCx1 x2 x3S+C2 01Su y=[1 0 0]Cx1 x2 x3S Cx# 1 x# 2 x# 3S=C2 001 210 03 SCx1 x2 x3S+C0101 01 SBu1 u2R y=[0 0 1]Cx1 x2 x3S Cx# 1 x# 2 x# 3S=C0 -1 11 -1 00 00SCx1 x2 x3S+C010 SuB–9–15. Is the following system completely state control- lable and completely observable? B–9–16. Consider the system defined by Except for an obvious choice of c1=c2=c3=0 , find an example of a set of c1, c2, c3that will make the system unobservable. B–9–17. Consider the system The output is given by (a)Show that the system is not completely observable. (b)Show that the system is completely observable if the output is given by By1 y2R=B1 11 21 3RCx1 x2 x3Sy=[1 1 1]Cx1 x2 x3SCx# 1 x# 2 x# 3S=C2 000 230 01 SCx1 x2 x3S y=Cc1 c2 c3DCx1 x2 x3SCx# 1 x# 2 x# 3S=C0 0 -61 0 -110 1 -6SCx1 x2 x3S+C0 01Su y=[20 9 1]Cx1 x2 x3SCx# 1 x# 2 x# 3S=C0 0 -61 0 -110 1 -6SCx1 x2 x3S+C0 01Su10 722 Control Systems Design in State Space 10–1 INTRODUCTION This chapter discusses state-space design methods based on the pole-placement method, observers, the quadratic optimal regulator systems, and introductory aspects of robust control systems.The pole-placement method is somewhat similar to the root-locus method in that we place closed-loop poles at desired locations.The basic difference is that in the root-locus design we place only the dominant closed-loop poles at the desired locations, while in the pole-placement design we place all closed-loop poles at desired locations. We begin by presenting the basic materials on pole placement in regulator systems. We then discuss the design of state observers, followed by the design of regulator sys- tems and control systems using the pole-placement-with-state-observer approach.Then, we discuss the quadratic optimal regulator systems. Finally, we present an introduction to robust control systems. Outline of the Chapter. Section 10–1 has presented introductory material. Section 10–2 discusses the pole-placement approach to the design of control systems. We begin with the derivation of the necessary and sufficient conditions for arbitrary pole placement. Then we derive equations for the state feedback gain matrix Kfor pole placement. Section 10–3 presents the solution of the pole-placement problem with MATLAB. Section 10–4 discusses the design of servo systems using the pole-placement approach. Section 10–5 presents state observers.We discuss both full-order and minimum-order state observers. Also, transfer functions of observer controllers are derived. Section 10–6 presents the design of regulator systems with observers. Section 10–7 treats the design of control Openmirrors.comSection 10–2 / Pole Placement 723systems with observers. Section 10–8 discusses quadratic optimal regulator systems. Note that the state feedback gain matrix Kcan be obtained by both the pole-placement method and the quadratic optimal control method. Finally, Section 10–9 presents robust controlsystems. The discussions here are limited to introductory subjects only. 10–2 POLE PLACEMENT In this section we shall present a design method commonly called the pole-placement or pole-assignment technique. We assume that all state variables are measurable and are available for feedback. It will be shown that if the system considered is completely statecontrollable, then poles of the closed-loop system may be placed at any desired locationsby means of state feedback through an appropriate state feedback gain matrix. The present design technique begins with a determination of the desired closed-loop poles based on the transient-response and/or frequency-response requirements, such asspeed, damping ratio, or bandwidth, as well as steady-state requirements. Let us assume that we decide that the desired closed-loop poles are to be at s=m 1, s=m2,p, s=mn.By choosing an appropriate gain matrix for state feedback, it is pos- sible to force the system to have closed-loop poles at the desired locations, providedthat the original system is completely state controllable. In this chapter we limit our discussions to single-input, single-output systems. That is, we assume the control signal u(t) and output signal y(t) to be scalars. In the deriva- tion in this section we assume that the reference input r(t) is zero. [In Section 10–7 we discuss the case where the reference input r(t) is nonzero.] In what follows we shall prove that a necessary and sufficient condition that the closed-loop poles can be placed at any arbitrary locations in the splane is that the sys- tem be completely state controllable. Then we shall discuss methods for determiningthe required state feedback gain matrix. It is noted that when the control signal is a vector quantity, the mathematical aspects of the pole-placement scheme become complicated. We shall not discuss such a case inthis book. (When the control signal is a vector quantity, the state feedback gain matrixis not unique. It is possible to choose freely more than nparameters; that is, in addition to being able to place nclosed-loop poles properly, we have the freedom to satisfy some or all of the other requirements, if any, of the closed-loop system.) Design by Pole Placement. In the conventional approach to the design of a single- input, single-output control system, we design a controller (compensator) such that thedominant closed-loop poles have a desired damping ratio zand a desired undamped natural frequency v n.In this approach, the order of the system may be raised by 1 or 2 unless pole–zero cancellation takes place. Note that in this approach we assume the ef-fects on the responses of nondominant closed-loop poles to be negligible. Different from specifying only dominant closed-loop poles (the conventional design approach), the present pole-placement approach specifies all closed-loop poles. (There isa cost associated with placing all closed-loop poles, however, because placing all closed-loop poles requires successful measurements of all state variables or else requires the in-clusion of a state observer in the system.) There is also a requirement on the part of thesystem for the closed-loop poles to be placed at arbitrarily chosen locations.The requirementis that the system be completely state controllable. We shall prove this fact in this section.724 Chapter 10 / Control Systems Design in State Space Consider a control system (10–1) where We shall choose the control signal to be (10–2) This means that the control signal uis determined by an instantaneous state. Such a scheme is called state feedback. The 1*n matrix Kis called the state feedback gain matrix. We assume that all state variables are available for feedback. In the following analysis we assume that uis unconstrained.A block diagram for this system is shown in Figure 10–1. This closed-loop system has no input. Its objective is to maintain the zero output. Because of the disturbances that may be present, the output will deviate from zero.The nonzero output will be returned to the zero reference input because of the state feed- back scheme of the system. Such a system where the reference input is always zero is called a regulator system. (Note that if the reference input to the system is always a nonzero constant, the system is also called a regulator system.) Substituting Equation (10–2) into Equation (10–1) gives The solution of this equation is given by (10–3) where x(0) is the initial state caused by external disturbances.The stability and transient- response characteristics are determined by the eigenvalues of matrix A-BK. If matrixx(t)=e (A-BK)t x(0)x#(t)=(A-BK) x(t)u=-Kx D=constant (scalar ) C=1*n constant matrix B=n*1 constant matrix A=n*n constant matrix u=control signal (scalar )y=output signal (scalar ) x=state vector (n-vector )y=Cx+Dux#=Ax+Bu u AB C –K/H20848 ++ ++ D x x. Figure 10–1 Closed-loop control system with u=– Kx. Openmirrors.comSection 10–2 / Pole Placement 725Kis chosen properly, the matrix A-BKcan be made an asymptotically stable matrix, and for all x(0)Z0, it is possible to make x(t)approach 0astapproaches infinity. The eigenvalues of matrix A-BKare called the regulator poles. If these regulator poles are placed in the left-half splane, then x(t)approaches 0astapproaches infinity.The prob- lem of placing the regulator poles (closed-loop poles) at the desired location is called apole-placement problem. In what follows, we shall prove that arbitrary pole placement for a given system is possible if and only if the system is completely state controllable. Necessary and Sufficient Condition for Arbitrary Pole Placement We shall now prove that a necessary and sufficient condition for arbitrary pole placement is that thesystem be completely state controllable.We shall first derive the necessary condition.Webegin by proving that if the system is not completely state controllable, then there areeigenvalues of matrix A-BKthat cannot be controlled by state feedback. Suppose that the system of Equation (10–1) is not completely state controllable. Then the rank of the controllability matrix is less than n,or This means that there are qlinearly independent column vectors in the controllability matrix. Let us define such qlinearly independent column vectors as f 1,f2,p,fq.Also, let us choose n-q additional n-vectors vq+1,vq+2,p,vnsuch that is of rank n.Then it can be shown that (See Problem A–10–1 for the derivation of these equations.) Now define Then we have where Iqis a q-dimensional identity matrix and In-q is an (n-q) -dimensional identity matrix.=@s Iq-A11+B11 k1@/H11554@s In-q-A22@=0=2s Iq-A11+B11 k1 0-A12+B11 k2 s In-q-A222=2s I-cA11 0 A12 A22d+cB11 0dCk1/H21752k2D2=@s I-Aˆ+BˆKˆ@=@s I-P-1 AP +P-1 BKP@∑s I-A+BK∑=@P-1(s I-A+BK)P@Kˆ=KP =Ck1/H21752k2DAˆ=P-1 AP =cA11 0 A12 A22d, Bˆ=P-1B=cB11 0dP=Cf1/H21752f2/H21752p/H21752fq/H21752vq+1/H21752vq+2/H21752p/H21752vnDrankCB /H21752 AB /H21752 p /H21752 An-1 BD=q6n726 Chapter 10 / Control Systems Design in State Space Notice that the eigenvalues of A 22 do not depend on K. Thus, if the system is not completely state controllable, then there are eigenvalues of matrix Athat cannot be arbitrarily placed.Therefore, to place the eigenvalues of matrix A-BKarbitrarily, the system must be completely state controllable (necessary condition). Next we shall prove a sufficient condition: that is, if the system is completely state controllable, then all eigenvalues of matrix Acan be arbitrarily placed. In proving a sufficient condition, it is convenient to transform the state equation given by Equation (10–1) into the controllable canonical form. Define a transformation matrix Tby (10–4) where Mis the controllability matrix (10–5) and (10–6) where the a i ’s are coefficients of the characteristic polynomial Define a new state vector by If the rank of the controllability matrix Misn(meaning that the system is completely state controllable), then the inverse of matrix Texists, and Equation (10–1) can be modified to (10–7) where (10–8) T -1 AT = G 0 0 /H11080 /H11080 /H11080 0 -a n 1 0 /H11080 /H11080 /H11080 0 -a n-1 0 1 /H11080 /H11080 /H11080 0 -a n-2 p p p p0 0 /H11080 /H11080 /H11080 1 -a 1 W x ˆ # =T -1 ATx ˆ +T -1 Bux=Tx ˆ x ˆ ∑s I-A∑=s n +a 1 s n-1 +p+a n-1 s+a n W= G a n-1 a n-2 /H11080 /H11080 /H11080 a 1 1a n-2 a n-3 /H11080 /H11080 /H11080 1 0p p p pa 1 1 /H11080 /H11080 /H11080 0 01 0 /H11080 /H11080 /H11080 0 0 W M=CB /H21752 AB /H21752 p /H21752 A n-1 BDT=MW Openmirrors.comSection 10–2 / Pole Placement 727(10–9) [See Problems A–10–2 andA–10–3 for the derivation of Equations (10–8) and (10–9).] Equation (10–7) is in the controllable canonical form.Thus, given a state equation, Equa-tion (10–1), it can be transformed into the controllable canonical form if the system iscompletely state controllable and if we transform the state vector xinto state vector by use of the transformation matrix Tgiven by Equation (10–4). Let us choose a set of the desired eigenvalues as m 1,m2,p,mn.Then the desired characteristic equation becomes (10–10) Let us write (10–11) When is used to control the system given by Equation (10–7), the system equation becomes The characteristic equation is This characteristic equation is the same as the characteristic equation for the system, defined by Equation (10–1), when is used as the control signal. This can beseen as follows: Since the characteristic equation for this system is ∑s I-A+BK∑=@T-1(s I-A+BK) T@=@s I-T-1 AT +T-1 BKT@=0x#=Ax+Bu=(A-BK) xu=-Kx@s I-T-1 AT +T-1 BKT@=0xˆ# =T-1 ATxˆ-T-1 BKTx ˆu=-KTxˆKT =Cdn dn-1pd1DAs-m1BAs-m2B p As-mnB=sn+a1 sn-1+p+an-1 s+an=0xˆT-1 B=G0 0 /H11080/H11080/H11080 01W728 Chapter 10 / Control Systems Design in State Space Now let us simplify the characteristic equation of the system in the controllable canonical form. Referring to Equations (10–8), (10–9), and (10–11), we have (10–12) This is the characteristic equation for the system with state feedback.Therefore, it must be equal to Equation (10–10), the desired characteristic equation. By equating the coefficients of like powers of s,we get Solving the preceding equations for the d i ’s and substituting them into Equation (10–11), we obtain (10–13) Thus, if the system is completely state controllable, all eigenvalues can be arbitrarily placed by choosing matrix Kaccording to Equation (10–13) (sufficient condition). We have thus proved that a necessary and sufficient condition for arbitrary pole placement is that the system be completely state controllable. It is noted that if the system is not completely state controllable, but is stabilizable, then it is possible to make the entire system stable by placing the closed-loop poles at desired locations for qcontrollable modes.The remaining n-q uncontrollable modes are stable. So the entire system can be made stable.=Ca n -a n /H21752a n-1 -a n-1 /H21752p/H21752a 2 -a 2 /H21752a 1 -a 1 D T -1 K=Cd n d n-1 pd 1 D T -1 a n +d n =a n /H11080 /H11080 /H11080 a 2 +d 2 =a 2 a 1 +d 1 =a 1 =s n +Aa 1 +d 1 Bs n-1 +p+Aa n-1 +d n-1 Bs+Aa n +d n B=0 = 6 s 0 /H11080 /H11080 /H11080 a n +d n -1 s /H11080 /H11080 /H11080 a n-1 +d n-1 p p p0 0 /H11080 /H11080 /H11080 s+a 1 +d 1 6 = 6 s I- F 0 /H11080 /H11080 /H11080 0 -a n 1 /H11080 /H11080 /H11080 0 -a n-1 p p p0 /H11080 /H11080 /H11080 1 -a 1 V + F 0 /H11080 /H11080 /H11080 0 1 V Cd n d n-1 pd 1 D 6 @s I-T -1 AT +T -1 BKT@ Openmirrors.comSection 10–2 / Pole Placement 729Determination of Matrix K Using Transformation Matrix T. Suppose that the system is defined by and the control signal is given by The feedback gain matrix Kthat forces the eigenvalues of A-BKto be m1,m2,p,mn (desired values) can be determined by the following steps (if miis a complex eigenvalue, then its conjugate must also be an eigenvalue of A-BK): Step 1: Check the controllability condition for the system. If the system is completely state controllable, then use the following steps: Step 2: From the characteristic polynomial for matrix A, that is, determine the values of a1,a2,p,an. Step 3: Determine the transformation matrix Tthat transforms the system state equa- tion into the controllable canonical form. (If the given system equation is already in thecontrollable canonical form, then T=I.) It is not necessary to write the state equation in the controllable canonical form. All we need here is to find the matrix T.T h e transformation matrix Tis given by Equation (10–4), or where Mis given by Equation (10–5) and Wis given by Equation (10–6). Step 4: Using the desired eigenvalues (desired closed-loop poles), write the desired characteristic polynomial: and determine the values of a 1,a2,p,an. Step 5: The required state feedback gain matrix Kcan be determined from Equation (10–13), rewritten thus: Determination of Matrix K Using Direct Substitution Method. If the system is of low order ( n/H113493), direct substitution of matrix Kinto the desired characteristic polynomial may be simpler. For example, if n=3, then write the state feedback gain matrix Kas Substitute this Kmatrix into the desired characteristic polynomial and equate it to As-m1BAs-m2BAs-m3B,o r ∑s I-A+BK∑=As-m1BAs-m2BAs-m3B∑s I-A+BK∑K=Ck1 k2 k3DK=Can-an /H21752 an-1-an-1 /H21752 p /H21752 a2-a2 /H21752 a1-a1D T-1As-m1BAs-m2BpAs-mnB=sn+a1 sn-1+p+an-1 s+anT=MW∑s I-A∑=sn+a1 sn-1+p+an-1 s+anu=-Kxx#=Ax+Bu730 Chapter 10 / Control Systems Design in State Space Since both sides of this characteristic equation are polynomials in s,by equating the coefficients of the like powers of son both sides, it is possible to determine the values ofk 1 , k 2 ,and k 3 .This approach is convenient if n=2 or 3. (For n=4, 5, 6 ,p, this approach may become very tedious.) Note that if the system is not completely controllable, matrix Kcannot be determined. (No solution exists.) Determination of Matrix K Using Ackermann’s Formula. There is a well-known formula, known as Ackermann’s formula, for the determination of the state feedback gain matrix K. We shall present this formula in what follows. Consider the system where we use the state feedback control u=– Kx. We assume that the system is completely state controllable. We also assume that the desired closed-loop poles are at s=m 1 ,s=m 2 ,p,s=m n . Use of the state feedback control modifies the system equation to (10–14) Let us define The desired characteristic equation is Since the Cayley–Hamilton theorem states that satisfies its own characteristic equation, we have (10–15) We shall utilize Equation (10–15) to derive Ackermann’s formula. To simplify the derivation, we consider the case where n=3. (For any other positive integer n,the following derivation can be easily extended.) Consider the following identities: A/H33522 3 =(A-BK) 3 =A 3 -A 2 BK -ABKA/H33522-BKA/H33522 2 A/H33522 2 =(A-BK) 2 =A 2 -ABK -BKA/H33522 A/H33522=A-BK I=IfAA/H33522B=A/H33522 n +a 1 A/H33522 n-1 +p+a n-1 A/H33522+a n I=0A/H33522 =s n +a 1 s n-1 +p+a n-1 s+a n =0 ∑s I-A+BK∑=@s I-A/H33522@=As-m 1 BAs-m 2 B p As-m n BA/H33522=A-BKx#=(A-BK) xu=-Kxx#=Ax+Bu Openmirrors.comSection 10–2 / Pole Placement 731Multiplying the preceding equations in order by a3,a2,a1, and a0(where a0=1 ), respectively, and adding the results, we obtain (10–16) Referring to Equation (10–15), we have Also, we have Substituting the last two equations into Equation (10–16), we have Since we obtain (10–17) Since the system is completely state controllable, the inverse of the controllability matrix exists. Premultiplying both sides of Equation (10–17) by the inverse of the controllability matrix, we obtain Premultiplying both sides of this last equation by [0 0 1], we obtain which can be rewritten as This last equation gives the required state feedback gain matrix K. For an arbitrary positive integer n,we have (10–18) K=[0 0 p 0 1]CB /H21752 AB /H21752 p /H21752 An-1 BD-1f(A)K=[0 0 1]CB /H21752 AB /H21752 A2 BD-1f(A)[0 0 1]CB/H21752AB/H21752A2 BD-1f(A)=[0 0 1]Ca2 K+a1 KA/H33522+KA/H335222 a1 K+KA/H33522 KS=KCB/H21752AB/H21752A2 BD-1f(A)=Ca2 K+a1 KA/H33522+KA/H335222 a1 K+KA/H33522 KSCB /H21752 AB /H21752 A2 BD=CB/H21752AB/H21752A2 BDCa2 K+a1 KA/H33522+KA/H335222 a1 K+KA/H33522 KSf(A)=BAa2 K+a1 KA/H33522+KA/H335222B+ABAa1 K+KA/H33522B+A2 BKfAA/H33522B=0,fAA/H33522B=f(A)-a2 BK -a1 BKA/H33522-BKA/H335222-a1 ABK -ABKA/H33522-A2 BKa3 I+a2 A+a1 A2+A3=f(A)Z0a3 I+a2 A/H33522+a1 A/H335222+A/H335223=fAA/H33522B=0 - ABKA/H33522-BKA/H335222 =a3 I+a2 A+a1 A2+A3-a2 BK -a1 ABK -a1 BKA/H33522-A2 BK - ABKA/H33522-BKA/H335222 =a3 I+a2(A-BK)+a1AA2-ABK -BKA/H33522B+A3-A2BKa3 I+a2 A/H33522+a1 A/H335222+A/H335223732 Chapter 10 / Control Systems Design in State Space x u AB –K/H20848 ++ Figure 10–2 Regulator system. Equation (10–18) is known as Ackermann’s formula for the determination of the state feedback gain matrix K. Regulator Systems and Control Systems. Systems that include controllers can be divided into two categories: regulator systems (where the reference input is constant, including zero) and control systems (where the reference input is time varying). In what follows we shall consider regulator systems. Control systems will be treated in Section 10–7. Choosing the Locations of Desired Closed-Loop Poles. The first step in the pole-placement design approach is to choose the locations of the desired closed-loop poles. The most frequently used approach is to choose such poles based on experience in the root-locus design, placing a dominant pair of closed-loop poles and choosing other poles so that they are far to the left of the dominant closed-loop poles. Note that if we place the dominant closed-loop poles far from the jvaxis, so that the system response becomes very fast, the signals in the system become very large, with the result that the system may become nonlinear. This should be avoided. Another approach is based on the quadratic optimal control approach.This approach will determine the desired closed-loop poles such that it balances between the acceptable response and the amount of control energy required. (See Section 10–8.) Note that requiring a high-speed response implies requiring large amounts of control energy.Also, in general, increasing the speed of response requires a larger, heavier actuator, which will cost more. EXAMPLE 10–1 Consider the regulator system shown in Figure 10–2. The plant is given by where The system uses the state feedback control u=– Kx.Let us choose the desired closed-loop poles at (We make such a choice because we know from experience that such a set of closed-loop poles will result in a reasonable or acceptable transient response.) Determine the state feedback gain matrix K.s=-2+j4, s=-2-j4, s=-10A= C 0 0 -11 0 -50 1 -6 S , B= C 0 0 1 S x#=Ax+Bu Openmirrors.comSection 10–2 / Pole Placement 733First, we need to check the controllability matrix of the system. Since the controllability matrix Mis given by we find that |M|=–1, and therefore, rank M=3. Thus, the system is completely state control- lable and arbitrary pole placement is possible. Next, we shall solve this problem.We shall demonstrate each of the three methods presented in this chapter. Method 1: The first method is to use Equation (10–13).The characteristic equation for the system is Hence, The desired characteristic equation is Hence, Referring to Equation (10–13), we have where T=Ifor this problem because the given state equation is in the controllable canonical form. Then we have Method 2: By defining the desired state feedback gain matrix Kas and equating with the desired characteristic equation, we obtain =s3+14s2+60s+200=s3+A6+k3Bs2+A5+k2Bs+1+k1=3s 0 1+k1-1 s 5+k20 -1 s+6+k33∑s I-A+BK∑=3Cs 000 s 00 0 sS-C00 -11 0 -50 1 -6S+C0 01SCk1 k2 k3D3∑s I-A+BK∑K=Ck1 k2 k3D =[199 55 8] K=[200 -1/H2175260-5/H2175214-6]K=Ca3-a3 /H21752 a2-a2 /H21752 a1-a1D T-1a1=14, a2=60, a3=200 =s3+a1 s2+a2 s+a3=0 (s+2-j4)(s +2+j4)(s +10) =s3+14s2+60s +200a1=6, a2=5, a3=1=s3+a1 s2+a2 s+a3=0=s3+6s2+5s+1∑s I-A∑=3s 01-1 s 50 -1 s+63M=CB/H21752AB/H21752A2 BD=C0 010 1 -61 -6 31S734 Chapter 10 / Control Systems Design in State Space Thus, from which we obtain or Method 3: The third method is to use Ackermann’s formula. Referring to Equation (10–18), we have Since and we obtain As a matter of course, the feedback gain matrix Kobtained by the three methods are the same. With this state feedback, the closed-loop poles are placed at s=–2 ;j4ands=–10, as desired. It is noted that if the order nof the system were 4 or higher, methods 1 and 3 are recom- mended, since all matrix computations can be carried out by a computer. If method 2 is used, hand computations become necessary because a computer may not handle the characteristic equation with unknown parameters k 1 ,k 2 ,p,k n . =[199 55 8] =[0 0 1] C 5 6 16 1 01 0 0 SC 199 -8 -755 159 -438 7 117 S K=[0 0 1] C 0 0 10 1 -61 -6 31 S -1 C 199 -8 -755 159 -438 7 117 S CB/H21752AB/H21752A 2 BD= C 0 0 10 1 -61 -6 31 S = C 199 -8 -755 159 -438 7 117 S +60 C 0 0 -11 0 -50 1 -6 S +200 C 1 0 00 1 00 0 1 S = C 0 0 -11 0 -50 1 -6 S 3 +14 C 0 0 -11 0 -50 1 -6 S 2 f(A)=A 3 +14 A 2 +60 A+200 IK=[0 0 1]CB /H21752 AB /H21752 A 2 BD -1 f(A)K=[199 55 8]k 1 =199, k 2 =55, k 3 =86+k 3 =14, 5+k 2 =60, 1+k 1 =200 Openmirrors.comSection 10–3 / Solving Pole-placement Problems with MATLAB 735Comments. It is important to note that matrix Kis not unique for a given system, but depends on the desired closed-loop pole locations (which determine the speed anddamping of the response) selected. Note that the selection of the desired closed-looppoles or the desired characteristic equation is a compromise between the rapidity of theresponse of the error vector and the sensitivity to disturbances and measurement nois-es. That is, if we increase the speed of error response, then the adverse effects of distur-bances and measurement noises generally increase. If the system is of second order,then the system dynamics (response characteristics) can be precisely correlated to thelocation of the desired closed-loop poles and the zero(s) of the plant. For higher-ordersystems, the location of the closed-loop poles and the system dynamics (response char-acteristics) are not easily correlated. Hence, in determining the state feedback gain ma-trixKfor a given system, it is desirable to examine by computer simulations the response characteristics of the system for several different matrices K(based on several different desired characteristic equations) and to choose the one that gives the best overall systemperformance. 10–3 SOLVING POLE-PLACEMENT PROBLEMS WITH MATLAB Pole-placement problems can be solved easily with MATLAB. MATLAB has two commands— acker andplace —for the computation of feedback-gain matrix K.The command acker is based on Ackermann’s formula.This command applies to single-input systems only.The desired closed-loop poles can include multiple poles (poles located atthe same place). If the system involves multiple inputs, for a specified set of closed-loop poles the state-feedback gain matrix Kis not unique and we have an additional freedom (or free- doms) to choose K.There are many approaches to constructively utilize this additional freedom (or freedoms) to determine K. One common use is to maximize the stability margin.The pole placement based on this approach is called the robust pole placement.The MATLAB command for the robust pole placement is place . Although the command place can be used for both single-input and multiple-input systems, this command requires that the multiplicity of poles in the desired closed-looppoles be no greater than the rank of B. That is, if matrix Bis an n*1 matrix, the command place requires that there be no multiple poles in the set of desired closed- loop poles. For single-input systems, the commands acker andplace yield the same K. (But for multiple-input systems, one must use the command place instead of acker .) It is noted that when the single-input system is barely controllable, some computa- tional problem may occur if the command acker is used. In such a case the use of the place command is preferred, provided that no multiple poles are involved in the de- sired set of closed-loop poles. To use the command acker orplace , we first enter the following matrices in the program: Amatrix, Bmatrix, Jmatrix where Jmatrix is the matrix consisting of the desired closed-loop poles such that J=Cm 1 m2 p mnD736 Chapter 10 / Control Systems Design in State Space Then we enter K = acker(A,B,J) or K = place(A,B,J) It is noted that the command eig (A-B*K) may be used to verify that Kthus obtained gives the desired eigenvalues. EXAMPLE 10–2 Consider the same system as treated in Example 10–1. The system equation is where By using state feedback control it is desired to have the closed-loop poles at s=m i (i=1, 2, 3), where Determine the state feedback-gain matrix Kwith MATLAB. MATLAB programs that generate matrix Kare shown in MATLAB Programs 10–1 and 10–2. MATLAB Program 10–1 uses command acker and MATLAB Program 10–2 uses command place.m 1 =-2+j4, m 2 =-2-j4, m 3 =-10u=-Kx,A= C 0 0 -11 0 -50 1 -6 S , B= C 0 0 1 S x#=Ax+Bu MATLAB Program 10–1 A = [0 1 0;0 0 1;-1 -5 -6]; B = [0;0;1]; J = [-2+j*4 -2-j*4 -10]; K = acker(A,B,J) K = 199 55 8 MATLAB Program 10–2 A = [0 1 0;0 0 1;-1 -5 -6]; B = [0;0;1]; J = [-2+j*4 -2-j*4 -10]; K = place(A,B,J) place: ndigits = 15 K = 199.0000 55.0000 8.0000 Openmirrors.comSection 10–3 / Solving Pole-placement Problems with MATLAB 737EXAMPLE 10–3 Consider the same system as discussed in Example 10–1. It is desired that this regulator system have closed-loop poles at The necessary state feedback gain matrix Kwas obtained in Example 10–1 as follows: Using MATLAB, obtain the response of the system to the following initial condition: Response to Initial Condition: To obtain the response to the given initial condition x(0), we substitute u=– Kxinto the plant equation to get To plot the response curves ( x1versus t, x2versus t,and x3versus t), we may use the command initial . We first define the state-space equations for the system as follows: where we included u(a three-dimensional input vector). This uvector is considered 0in the computation of the response to the initial condition. Then we define sys = ss(A - BK, eye(3), eye(3), eye(3)) and use the initial command as follows: x = initial(sys, [1;0;0],t) where tis the time duration we want to use, such as t = 0:0.01:4; Then obtain x1, x2, andx3as follows: x1 = [1 0 0]*x'; x2 = [0 1 0]*x';x3 = [0 0 1]*x'; and use the plot command. This program is shown in MATLAB Program 10–3. The resulting response curves are shown in Figure 10–3.y=Ix+Iux#=(A-BK) x+Iux#=(A-BK) x, x(0)=C1 00Sx(0)=C1 00SK=[199 55 8]s=-2+j4, s=-2-j4, s=-10738 Chapter 10 / Control Systems Design in State Space Response to Initial Condition state variable x 1 −0.50 0.5 1 1.5 2 2.5 3 3.5 4 0 0.5 1 1.5 2 2.5 3 3.5 4 0 0.5 1 1.5 2 2.5 3 3.5 400.51 state variable x 2 −3−1 −201 state variable x 3 −100 −5510 t (sec) Figure 10–3 Response to initial condition. MATLAB Program 10–3 % Response to initial condition: A = [0 1 0;0 0 1;-1 -5 -6]; B = [0;0;1]; K = [199 55 8]; sys = ss(A-B*K, eye(3), eye(3), eye(3)); t = 0:0.01:4; x = initial(sys,[1;0;0],t); x1 = [1 0 0]*x'; x2 = [0 1 0]*x'; x3 = [0 0 1]*x'; subplot(3,1,1); plot(t,x1), grid title('Response to Initial Condition') ylabel('state variable x1') subplot(3,1,2); plot(t,x2),grid ylabel('state variable x2') subplot(3,1,3); plot(t,x3),grid xlabel('t (sec)') ylabel('state variable x3') Openmirrors.comSection 10–4 / Design of Servo Systems 739x=Ax+Bu.y=Cx x2 x3 xnk2k1 k3 knr …ux y=x1 +–+– Figure 10–4 Type 1 servo systemwhen the plant hasan integrator.10–4 DESIGN OF SERVO SYSTEMS In this section we shall discuss the pole-placement approach to the design of type 1 servo systems. Here we shall limit our systems each to have a scalar control signal uand a scalar output y. In what follows we shall first discuss a problem of designing a type 1 servo system when the plant involves an integrator.Then we shall discuss the design of a type 1 servosystem when the plant has no integrator. Design of Type 1 Servo System when the Plant Has An Integrator. Assume that the plant is defined by (10–19) (10–20) where As stated earlier, we assume that both the control signal uand the output signal yare scalars. By a proper choice of a set of state variables, it is possible to choose the outputto be equal to one of the state variables. ASee the method presented in Chapter 2 for obtaining a state-space representation of the transfer function system in which the outputybecomes equal to x 1.B Figure 10–4 shows a general configuration of the type 1 servo system when the plant has an integrator. Here we assumed that y=x1.In the present analysis we assume that C=1*n constant matrix B=n*1 constant matrix A=n*n constant matrix y=output signal (scalar ) u=control signal (scalar ) x=state vector for the plant (n-vector ) y=Cx x#=Ax+Bu740 Chapter 10 / Control Systems Design in State Space the reference input ris a step function. In this system we use the following state-feedback control scheme: (10–21) where Assume that the reference input (step function) is applied at t=0. Then, for t>0, the system dynamics can be described by Equations (10–19) and (10–21), or (10–22) We shall design the type 1 servo system such that the closed-loop poles are located at desired positions. The designed system will be an asymptotically stable system, y(q) will approach the constant value r, and u(q) will approach zero. ( ris a step input.) Notice that at steady state we have (10–23) Noting that r(t) is a step input, we have r(q)=r(t)=r (constant) for t>0. By subtracting Equation (10–23) from Equation (10–22), we obtain (10–24) Define Then Equation (10–24) becomes (10–25) Equation (10–25) describes the error dynamics. The design of the type 1 servo system here is converted to the design of an asymp- totically stable regulator system such that e(t)approaches zero, given any initial condi- tion e(0). If the system defined by Equation (10–19) is completely state controllable, then, by specifying the desired eigenvalues m 1 ,m 2 ,p,m n for the matrix A-BK, matrix Kcan be determined by the pole-placement technique presented in Section 10–2. The steady-state values of x(t)and u(t) can be found as follows: At steady state (t=q), we have, from Equation (10–22), x#(q)=0=(A-BK) x(q)+Bk 1 re#=(A-BK) ex(t)-x(q)=e(t)x#(t)-x#(q)=(A-BK)Cx(t)-x(q)Dx#(q)=(A-BK) x(q)+Bk 1 r(q)x#=Ax+Bu=(A-BK) x+Bk 1 rK=Ck 1 k 2 pk n D=-Kx+k 1 ru=-C0 k 2 k 3 pk n D F x 1 x 2 /H11080 /H11080 /H11080 x n V +k 1 Ar-x 1 B Openmirrors.comSection 10–4 / Design of Servo Systems 741Since the desired eigenvalues of A-BKare all in the left-half splane, the inverse of matrix A-BKexists. Consequently, x(q) can be determined as Also, u(q) can be obtained as (See Example 10–4 to verify this last equation.) EXAMPLE 10–4 Design a type 1 servo system when the plant transfer function has an integrator.Assume that the plant transfer function is given by The desired closed-loop poles are and s=–10. Assume that the system configuration is the same as that shown in Figure 10–4 and the reference input ris a step function. Obtain the unit-step response of the designed system. Define state variables x1, x2,andx3as follows: Then the state-space representation of the system becomes (10–26)(10–27) where Referring to Figure 10–4 and noting that n=3, the control signal uis given by (10–28) where The state-feedback gain matrix Kcan be obtained easily with MATLAB. See MATLAB Program 10–4.K=Ck 1 k2 k3Du=-Ak2 x2+k3 x3B+k1Ar-x1B=-Kx+k1 rA=C0 001 0 -20 1 -3S, B=C0 01S, C=[1 0 0] y=Cx x#=Ax+Bu x3=x# 2 x2=x# 1 x1=ys=-2;j213Y(s) U(s)=1 s(s+1)(s +2)u(q)=-Kx(q)+k1 r=0x(q)=-(A-BK)-1 Bk1 r MATLAB Program 10–4 A = [0 1 0;0 0 1;0 -2 -3]; B = [0;0;1];J = [-2+j*2*sqrt(3) -2-j*2*sqrt(3) -10];K = acker(A,B,J) K = 160.0000 54.0000 11.0000742 Chapter 10 / Control Systems Design in State Space The state feedback gain matrix Kis thus K = [160 54 11] Unit-Step Response of the Designed System: The unit-step response of the designed system can be obtained as follows: Since from Equation (10–22) the state equation for the designed system is (10–29) and the output equation is (10–30) Solving Equations (10–29) and (10–30) for y(t) when ris a unit-step function gives the unit-step response curve y(t) versus t.MATLAB Program 10–5 yields the unit-step response. The result- ing unit-step response curve is shown in Figure 10–5.y=[1 0 0] C x 1 x 2 x 3 SC x# 1 x# 2 x# 3 S = C 0 0 -1601 0 -560 1 -14 SC x 1 x 2 x 3 S + C 0 0 160 S rA-BK = C 0 0 01 0 -20 1 -3 S C 0 0 1 S [160 54 11]= C 0 0 -1601 0 -560 1 -14 S MATLAB Program 10–5 % ---------- Unit-step response ---------- % ***** Enter the state matrix, control matrix, output matrix, % and direct transmission matrix of the designed system ***** AA = [0 1 0;0 0 1;-160 -56 -14]; BB = [0;0;160]; CC = [1 0 0]; DD = [0]; % ***** Enter step command and plot command ***** t = 0:0.01:5; y = step(AA,BB,CC,DD,1,t); plot(t,y) grid title('Unit-Step Response') xlabel('t Sec') ylabel('Output y') Openmirrors.comSection 10–4 / Design of Servo Systems 743Unit-Step ResponseOutput y 00.61.2 0.8 0.4 0.21 t Sec0 3.5 1 0.5 2.5 5 4 4.5 1.5 2 3Figure 10–5 Unit-step responsecurve y(t) versus t for the system designed in Example 10–4. Note that since we have At steady state the control signal ubecomes zero. Design of Type 1 Servo System when the Plant Has No Integrator. If the plant has no integrator (type 0 plant), the basic principle of the design of a type 1 servo sys-tem is to insert an integrator in the feedforward path between the error comparatorand the plant, as shown in Figure 10–6. (The block diagram of Figure 10–6 is a basicform of the type 1 servo system where the plant has no integrator.) From the diagram,we obtain (10–31) (10–32)(10–33) (10–34) where x=state vector of the plant (n-vector ) j# =r-y=r-Cx u=-Kx+k I j y=Cx x#=Ax+Bu =-[160 54 11]Cr 00S+160r =0 u(q)=-[160 54 11]Cx1(q) x2(q) x3(q)S+160ru(q)=-Kx(q)+k1 r(q)=-Kx(q)+k1 r744 Chapter 10 / Control Systems Design in State Space We assume that the plant given by Equation (10–31) is completely state controllable.The transfer function of the plant can be given by To avoid the possibility of the inserted integrator being canceled by the zero at the origin of the plant, we assume that G p (s)has no zero at the origin. Assume that the reference input (step function) is applied at t=0. Then, for t>0, the system dynamics can be described by an equation that is a combination of Equations (10–31) and (10–34): (10–35) We shall design an asymptotically stable system such that x(q),j(q), and u(q) approach constant values, respectively. Then, at steady state, and we get y(q)=r. Notice that at steady state we have (10–36) Noting that r(t) is a step input, we have r(q)=r(t)=r (constant) for t>0. By subtracting Equation (10–36) from Equation (10–35), we obtain (10–37) B x#(t)-x#(q) j#(t)-j#(q) R = B A -C0 0 RB x(t)-x(q) j(t)-j(q) R + B B 0 R Cu(t) -u(q)D B x#(q) j#(q) R = B A -C0 0 RB x(q) j(q) R + B B 0 R u(q)+ B 0 1 R r(q)j#(t)=0, B x#(t) j#(t) R = B A -C0 0 RB x(t) j(t) R + B B 0 R u(t) + B 0 1 R r(t)G p (s)=C(s I-A) -1 BC=1*n constant matrix B=n*1 constant matrix A=n*n constant matrix r=reference input signal (step function, scalar ) j=output of the integrator (state variable of the system, scalar ) y=output signal (scalar ) u=control signal (scalar ) y K AB k I C /H20848 /H20848 x rj. ju +– +– ++ Figure 10–6 Type 1 servo system. Openmirrors.comSection 10–4 / Design of Servo Systems 745Define Then Equation (10–37) can be written as (10–38) where (10–39) Define a new (n+1) th-order error vector e(t)by -vector Then Equation (10–38) becomes (10–40) where and Equation (10–39) becomes (10–41) where The state error equation can be obtained by substituting Equation (10–41) into Equation (10–40): (10–42) If the desired eigenvalues of matrix (that is, the desired closed-loop poles) are specified as m1,m2,p,mn+1,then the state-feedback gain matrix Kand the integral gain constant kIcan be determined by the pole-placement technique presented in Section 10–2, provided that the system defined by Equation (10–40) is completely statecontrollable. Note that if the matrix has rank n+1, then the system defined by Equation (10–40) is completely state controllable. (See Problem A–10–12 .)BA -CB 0RAˆ-BˆKˆe#=AAˆ-BˆKˆBeKˆ=CK/H21752-kIDue=-KˆeAˆ=BA -C0 0R, Bˆ=BB 0Re#=Aˆe+Bˆuee(t)=Bxe(t) je(t)R=(n+1)ue(t)=-Kxe(t)+kI je(t)Bx# e(t) j# e(t)R=BA -C0 0RBxe(t) je(t)R+BB 0Rue(t) u(t) -u(q)=ue(t) j(t)-j(q)=je(t) x(t)-x(q)=xe(t)746 Chapter 10 / Control Systems Design in State Space 0 MP z umgm/H5129 sin u x x /H5129 cos u /H5129u Figure 10–8 Inverted-pendulum control system. As is usually the case, not all state variables can be directly measurable. If this is the case, we need to use a state observer. Figure 10–7 shows a block diagram of a type 1 servo system with a state observer. [In the figure, each block with an integral symbol represents an integrator (1/s) .] Detailed discussions of state observers are given in Section 10–5. EXAMPLE 10–5 Consider the inverted-pendulum control system shown in Figure 10–8. In this example, we are concerned only with the motion of the pendulum and motion of the cart in the plane of the page. It is desired to keep the inverted pendulum upright as much as possible and yet control the position of the cart—for instance, move the cart in a step fashion. To control the position of the cart, we need to build a type 1 servo system. The inverted-pendulum system mounted on a cart does not have an integrator.Therefore, we feed the position signal y(which indicates the po- sition of the cart) back to the input and insert an integrator in the feedforward path, as shown y K AB k I C /H20848 /H20848 x rj. ju Observer +– +– ++ Figure 10–7 Type 1 servo system with state observer. Openmirrors.comSection 10–4 / Design of Servo Systems 747x=Ax+Bu.y=Cx k1kI /H20848 k2 k3 k4rux y j j. +–+– Figure 10–9 Inverted-pendulumcontrol system. (Type 1 servo system when the plant has nointegrator.) in Figure 10–9.We assume that the pendulum angle uand the angular velocity are small, so that and We also assume that the numerical values for M, m, and lare given as Earlier in Example 3–6 we derived the equations for the inverted-pendulum system shown in Figure 3–6, which is the same as that in Figure 10–8. Referring to Figure 3–6, we started with the force-balance and torque-balance equations and ended up with Equations (3–20) and (3–21) to model the inverted-pendulum system. Referring to Equations (3–20) and (3–21), the equations forthe inverted-pendulum control system shown in Figure 10–8 are (10–43) (10–44) When the given numerical values are substituted, Equations (10–43) and (10–44) become (10–45) (10–46) Let us define the state variables x 1,x2,x3,andx4as Then, referring to Equations (10–45) and (10–46) and Figure 10–9 and considering the cart position xas the output of the system, we obtain the equations for the system as follows: (10–47) (10–48) (10–49)(10–50) j# =r-y=r-Cx u=-Kx+k I j y=Cx x#=Ax+Bu x4=x# x3=x x2=u# x1=ux$=0.5u-0.4905uu$=20.601u-u Mx$=u-mgu Mlu$=(M +m)gu-uM=2 kg, m=0.1 kg, l=0.5 muu#2/H112160. cosu/H112161, sinu/H11216u,u#748 Chapter 10 / Control Systems Design in State Space where For the type 1 servo system, we have the state error equation as given by Equation (10–40): (10–51) where and the control signal is given by Equation (10–41): where To obtain a reasonable speed and damping in the response of the designed system (for example, the settling time of approximately 4 ~5 sec and the maximum overshoot of 15 %~ 16% in the step response of the cart), let us choose the desired closed-loop poles at s=m i (i=1, 2, 3, 4, 5), where We shall determine the necessary state-feedback gain matrix by the use of MATLAB. Before we proceed further, we must examine the rank of matrix P, where Matrix Pis given by (10–52) The rank of this matrix can be found to be 5. Therefore, the system defined by Equation (10–51) is completely state controllable, and arbitrary pole placement is possible. MATLAB Program 10–6 produces the state feedback gain matrix K ˆ .P= B A -CB 0 R = E 0 20.601 0 -0.4905 01 0 0 0 00 0 0 0 -10 0 1 0 00 -1 0 0.5 0 U P= B A -CB 0 R m 1 =-1+j13 , m 2 =-1-j13 , m 3 =-5, m 4 =-5, m 5 =-5K ˆ =CK/H21752-k I D=Ck 1 k 2 k 3 k 4 /H21752-k I Du e =-K ˆ eA ˆ = B A -C0 0 R = E 0 20.601 0 -0.4905 01 0 0 0 00 0 0 0 -10 0 1 0 00 0 0 0 0 U , B ˆ = B B 0 R = E 0 -1 0 0.5 0 U e#=A ˆ e+B ˆ u e A= D 0 20.601 0 -0.49051 0 0 00 0 0 00 0 1 0 T , B= D 0 -1 0 0.5 T , C=[0 0 1 0] Openmirrors.comSection 10–4 / Design of Servo Systems 749MATLAB Program 10–6 A = [0 1 0 0; 20.601 0 0 0; 0 0 0 1; -0.4905 0 0 0]; B = [0;-1;0;0.5];C = [0 0 1 0];Ahat = [A zeros(4,1); -C 0];Bhat = [B;0];J = [-1+j*sqrt(3) -1-j*sqrt(3) -5 -5 -5];Khat = acker(Ahat,Bhat,J) Khat = -157.6336 -35.3733 -56.0652 -36.7466 50.9684 Thus, we get and Unit Step-Response Characteristics of the Designed System. Once we determine the feed- back gain matrix Kand the integral gain constant kI,the step response in the cart position can be obtained by solving the following equation, which is obtained by substituting Equation (10–49) into Equation (10–35): (10–53) The output y(t) of the system is x3(t),or (10–54) Define the state matrix, control matrix, output matrix, and direct transmission matrix of the system given by Equations (10–53) and (10–54) as AA, BB, CC, andDD, respectively. MATLAB Program 10–7 may be used to obtain the step-response curves of the designed system. Noticethat, to obtain the unit-step response, we entered the command [y,x,t] = step(AA,BB,CC,DD,1,t) Figure 10–10 shows curves x1versus t, x2versus t, x3(=output y)versus t, x4versus t, andx5 (=j)versus t.Notice that y(t)C=x3(t)Dhas approximately 15 %overshoot and the settling time is approximately 4.5 sec. j(t)C=x5(t)Dapproaches 1.1.This result can be derived as follows: Since or D0 000T=D0 20.601 0 -0.49051 0000 0000 010 TD00 r 0T+D0 -1 0 0.5Tu(q)x#(q)=0=Ax(q)+Bu(q)y=[0 0 1 0 0]Bx jR+[0]rBx# j#R=BA-BK -CBkI 0RBx jR+B01RrkI=-50.9684K=Ck1 k2 k3 k4D=[-157.6336 -35.3733 -56.0652 -36.7466]750 Chapter 10 / Control Systems Design in State Space MATLAB Program 10–7 %**** The following program is to obtain step response % of the inverted-pendulum system just designed ***** A = [0 1 0 0;20.601 0 0 0;0 0 0 1;-0.4905 0 0 0]; B = [0;-1;0;0.5]; C = [0 0 1 0] D = [0]; K = [-157.6336 -35.3733 -56.0652 -36.7466]; KI = -50.9684; AA = [A - B*K B*KI;-C 0]; BB = [0;0;0;0;1]; CC = [C 0]; DD = [0]; %***** To obtain response curves x1 versus t, x2 versus t, % x3 versus t, x4 versus t, and x5 versus t, separately, enter % the following command ***** t = 0:0.02:6; [y,x,t] = step(AA,BB,CC,DD,1,t); x1 = [1 0 0 0 0]*x'; x2 = [0 1 0 0 0]*x'; x3 = [0 0 1 0 0]*x'; x4 = [0 0 0 1 0]*x'; x5 = [0 0 0 0 1]*x'; subplot(3,2,1); plot(t,x1); grid title('x1 versus t') xlabel('t Sec'); ylabel('x1') subplot(3,2,2); plot(t,x2); grid title('x2 versus t') xlabel('t Sec'); ylabel('x2') subplot(3,2,3); plot(t,x3); grid title('x3 versus t') xlabel('t Sec'); ylabel('x3') subplot(3,2,4); plot(t,x4); grid title('x4 versus t') xlabel('t Sec'); ylabel('x4') subplot(3,2,5); plot(t,x5); grid title('x5 versus t') xlabel('t Sec'); ylabel('x5') Openmirrors.comSection 10–5 / State Observers 751we get Since u(q)=0, we have, from Equation (10–33), and so Hence, for r=1, we have It is noted that, as in any design problem, if the speed and damping are not quite satisfactory, then we must modify the desired characteristic equation and determine a new matrix Computersimulations must be repeated until a satisfactory result is obtained. 10–5 STATE OBSERVERS In the pole-placement approach to the design of control systems, we assumed that all state variables are available for feedback. In practice, however, not all state variables areavailable for feedback. Then we need to estimate unavailable state variables.Kˆ.j(q)=1.1j(q)=1 kI CKx(q)D=1 kI k3 x3(q)=-56.0652 -50.9684 r=1.1ru(q)=0=-Kx(q)+kI j(q)u(q)=000.2x1 versus t 06 4 2 t Sec 02 –11x3 versus t 06 4 2 0.51.5x5 versus t 06 4 201t Sec t Secx1 x3 x500.5 –0.5x2 versus t 06 4 2 t Sec 02 –11x4 versus t 06 4 2 t Secx2 x4 Figure 10–10 Curves x1versus t, x2 versus t, x3 (=output y) versus t, x4versus t,and x5 (=j) versus t.752 Chapter 10 / Control Systems Design in State Space Estimation of unmeasurable state variables is commonly called observation .A device (or a computer program) that estimates or observes the state variables is called a state observer , or simply an observer . If the state observer observes all state variables of the system, regardless of whether some state variables are available for direct measurement, it is called a full-order state observer .There are times when this will not be necessary, when we will need observation of only the unmeasurable state variables, but not of those that are directly measurable as well. For example, since the output variables are observable and they are linearly related to the state variables, we need not observe all state variables, but observe only n-m state variables, where nis the dimension of the state vector and mis the dimension of the output vector. An observer that estimates fewer than nstate variables, where nis the dimension of the state vector, is called a reduced-order state observer or, simply, a reduced-order observer . If the order of the reduced-order state observer is the minimum possible, the observer is called a minimum-order state observer orminimum-order observer . In this section, we shall discuss both the full-order state observer and the minimum-order state observer. State Observer. A state observer estimates the state variables based on the measurements of the output and control variables. Here the concept of observability discussed in Section 9–7 plays an important role. As we shall see later, state observers can be designed if and only if the observability condition is satisfied. In the following discussions of state observers, we shall use the notation to designate the observed state vector. In many practical cases, the observed state vector is used in the state feedback to generate the desired control vector. Consider the plant defined by (10–55) (10–56) The observer is a subsystem to reconstruct the state vector of the plant. The mathe- matical model of the observer is basically the same as that of the plant, except that we include an additional term that includes the estimation error to compensate for inaccuracies in matrices AandBand the lack of the initial error. The estimation error or observation error is the difference between the measured output and the estimated output.The initial error is the difference between the initial state and the initial estimated state. Thus, we define the mathematical model of the observer to be (10–57) where is the estimated state and is the estimated output.The inputs to the observer are the output yand the control input u.Matrix K e , which is called the observer gain matrix, is a weighting matrix to the correction term involving the difference between the measured output yand the estimated output This term continuously corrects the model output and improves the performance of the observer. Figure 10–11 shows the block diagram of the system and the full-order state observer.Cx/H33522.Cx/H33522x/H33522 =AA-K e CBx/H33522+Bu+K e y x /H11343 =Ax/H33522+Bu+K e (y-Cx/H33522) y=Cx x#=Ax+Bux/H33522x/H33522 Openmirrors.comSection 10–5 / State Observers 753uy y~ Full-order state observerABC Ke/H20848 ABC /H20848xx ~++ +++++– Figure 10–11 Block diagram ofsystem and full-orderstate observer, wheninput uand output y are scalars. Full-Order State Observer. The order of the state observer that will be discussed here is the same as that of the plant. Assume that the plant is defined by Equations(10–55) and (10–56) and the observer model is defined by Equation (10–57). To obtain the observer error equation, let us subtract Equation (10–57) from Equation (10–55): (10–58) Define the difference between xand as the error vector e,o r Then Equation (10–58) becomes (10–59) From Equation (10–59), we see that the dynamic behavior of the error vector is deter- mined by the eigenvalues of matrix A-K eC. If matrix A-KeCis a stable matrix, the error vector will converge to zero for any initial error vector e(0).That is, will converge to x(t)regardless of the values of x(0)and If the eigenvalues of matrix A-KeCare chosen in such a way that the dynamic behavior of the error vector is asymptotically stable and is adequately fast, then any error vector will tend to zero (theorigin) with an adequate speed. If the plant is completely observable, then it can be proved that it is possible to choose matrix K esuch that A-KeChas arbitrarily desired eigenvalues. That is, the observer gain matrix Kecan be determined to yield the desired matrix A-KeC.W e shall discuss this matter in what follows.x/H33522(0).x/H33522(t)e#=AA-Ke CBee=x-x/H33522x/H33522=AA-Ke CB(x-x/H33522)x#-x/H11343=Ax-Ax/H33522-Ke(Cx-Cx/H33522)754 Chapter 10 / Control Systems Design in State Space Dual Problem. The problem of designing a full-order observer becomes that of de- termining the observer gain matrix K e such that the error dynamics defined by Equation (10–59) are asymptotically stable with sufficient speed of response. (The asymptotic stability and the speed of response of the error dynamics are determined by the eigenvalues of matrix A-K e C.) Hence, the design of the full-order observer becomes that of determining an appropriate K e such that A-K e Chas desired eigenvalues.Thus, the problem here becomes the same as the pole-placement problem we discussed in Section 10–2. In fact, the two problems are mathematically the same. This property is called duality. Consider the system defined by In designing the full-order state observer, we may solve the dual problem, that is, solve the pole-placement problem for the dual system assuming the control signal vto be If the dual system is completely state controllable, then the state feedback gain matrix Kcan be determined such that matrix A*-C*Kwill yield a set of the desired eigenvalues. Ifm 1 ,m 2 ,p,m n are the desired eigenvalues of the state observer matrix, then by taking the same m i ’s as the desired eigenvalues of the state-feedback gain matrix of the dual system, we obtain Noting that the eigenvalues of A*-C*Kand those of A-K*Care the same, we have Comparing the characteristic polynomial and the characteristic poly- nomial for the observer system [refer to Equation (10–57)], we find that K e andK* are related by Thus, using the matrix Kdetermined by the pole-placement approach in the dual system, the observer gain matrix K e for the original system can be determined by using the relationship K e =K*. (See Problem A–10–10 for the details.) Necessary and Sufficient Condition for State Observation. As discussed, a necessary and sufficient condition for the determination of the observer gain matrix K e for the desired eigenvalues of A-K e Cis that the dual of the original system z#=A* z+C*vK e =K*@s I-AA-K e CB@@s I-(A-K* C)@@s I-(A*-C* K)@=@s I-(A-K* C)@@s I-(A*-C* K)@=As-m 1 BAs-m 2 BpAs-m n Bv=-Kzn=B* zz#=A* z+C*v y=Cx x#=Ax+Bu Openmirrors.comSection 10–5 / State Observers 755be completely state controllable. The complete state controllability condition for this dual system is that the rank of ben.This is the condition for complete observability of the original system defined by Equations (10–55) and (10–56).This means that a necessary and sufficient condition forthe observation of the state of the system defined by Equations (10–55) and (10–56) isthat the system be completely observable. Once we select the desired eigenvalues (or desired characteristic equation), the full- order state observer can be designed, provided the plant is completely observable. Thedesired eigenvalues of the characteristic equation should be chosen so that the stateobserver responds at least two to five times faster than the closed-loop systemconsidered. As stated earlier, the equation for the full-order state observer is (10–60) It is noted that thus far we have assumed the matrices A,B, and Cin the observer to be exactly the same as those of the physical plant. If there are discrepancies in A,B, andCin the observer and in the physical plant, the dynamics of the observer error are no longer governed by Equation (10–59). This means that the error may not approachzero as expected.Therefore, we need to choose K eso that the observer is stable and the error remains acceptably small in the presence of small modeling errors. Transformation Approach to Obtain State Observer Gain Matrix Ke.By following the same approach as we used in deriving the equation for the state feedbackgain matrix K, we can obtain the following equation: (10–61) where K eis an n*1 matrix, and [Refer to Problem A–10–10 for the derivation of Equation (10–61).] W=Gan-1 an-2 /H11080 /H11080/H11080 a 1 1an-2 an-3 /H11080 /H11080/H11080 10p p p pa 1 1 /H11080/H11080/H11080 001 0 /H11080/H11080/H11080 00 W N=CC*/H21752A* C*/H21752p/H21752(A*)n-1C*DQ=(WN*)-1Ke=QFan-an an-1-an-1 /H11080 /H11080/H11080 a 1-a1V=(WN*)-1Fan-an an-1-an-1 /H11080 /H11080/H11080 a 1-a1Vx/H11343=AA-Ke CBx/H33522+Bu+Ke yCC*/H21752A* C*/H21752p/H21752(A*)n-1 C*D756 Chapter 10 / Control Systems Design in State Space Direct-Substitution Approach to Obtain State Observer Gain Matrix K e . Similar to the case of pole placement, if the system is of low order, then direct substitution of matrix K e into the desired characteristic polynomial may be simpler. For example, if xis a 3-vector, then write the observer gain matrix K e as Substitute this K e matrix into the desired characteristic polynomial: By equating the coefficients of the like powers of son both sides of this last equation, we can determine the values of k e1 ,k e2 ,and k e3 .This approach is convenient if n= 1, 2, or 3, where nis the dimension of the state vector x. (Although this approach can be used when n= 4, 5, 6, p, the computations involved may become very tedious.) Another approach to the determination of the state observer gain matrix K e is to use Ackermann’s formula. This approach is presented in the following. Ackermann’s Formula. Consider the system defined by (10–62) (10–63) In Section 10–2 we derived Ackermann’s formula for pole placement for the system defined by Equation (10–62).The result was given by Equation (10–18), rewritten thus: For the dual of the system defined by Equations (10–62) and (10–63), the preceding Ackermann’s formula for pole placement is modified to (10–64) As stated earlier, the state observer gain matrix K e is given by K*, where Kis given by Equation (10–64). Thus, (10–65) K e =K*=f(A*)* G C CA /H11080 /H11080 /H11080 CA n-2 CA n-1 W -1 G 0 0 /H11080 /H11080 /H11080 0 1 W =f(A) G C CA /H11080 /H11080 /H11080 CA n-2 CA n-1 W -1 G 0 0 /H11080 /H11080 /H11080 0 1 W K=[0 0p 0 1]CC*/H21752A* C*/H21752p/H21752(A*) n-1 C*D -1 f(A*)n=B* zz#=A* z+C*vK=[0 0p 0 1]CB/H21752AB/H21752p/H21752A n-1 BD -1 f(A) y=Cx x#=Ax+Bu@s I-AA-K e CB@=As-m 1 BAs-m 2 BAs-m 3 BK e = C k e1 k e2 k e3 S Openmirrors.comSection 10–5 / State Observers 757wheref(s)is the desired characteristic polynomial for the state observer, or wherem1,m2,p,mnare the desired eigenvalues. Equation (10–65) is called Ackermann’s formula for the determination of the observer gain matrix Ke. Comments on Selecting the Best Ke.Referring to Figure 10–11, notice that the feedback signal through the observer gain matrix Keserves as a correction signal to the plant model to account for the unknowns in the plant. If significant unknowns areinvolved, the feedback signal through the matrix K eshould be relatively large. Howev- er, if the output signal is contaminated significantly by disturbances and measurementnoises, then the output yis not reliable and the feedback signal through the matrix K e should be relatively small. In determining the matrix Ke,we should carefully examine the effects of disturbances and noises involved in the output y. Remember that the observer gain matrix Kedepends on the desired characteristic equation The choice of a set of is, in many instances, not unique. As a general rule, however, the observer poles must be two to five times faster than the controller polesto make sure the observation error (estimation error) converges to zero quickly. Thismeans that the observer estimation error decays two to five times faster than does thestate vector x. Such faster decay of the observer error compared with the desired dynamics makes the controller poles dominate the system response. It is important to note that if sensor noise is considerable, we may choose the observer poles to be slower than two times the controller poles, so that the bandwidth of the sys-tem will become lower and smooth the noise. In this case the system response will bestrongly influenced by the observer poles. If the observer poles are located to the rightof the controller poles in the left-half splane, the system response will be dominated by the observer poles rather than by the control poles. In the design of the state observer, it is desirable to determine several observer gain matrices K ebased on several different desired characteristic equations. For each of the several different matrices Ke,simulation tests must be run to evaluate the resulting system performance. Then we select the best Kefrom the viewpoint of overall system performance. In many practical cases, the selection of the best matrix Keboils down to a compromise between speedy response and sensitivity to disturbances and noises. EXAMPLE 10–6 Consider the system where We use the observed state feedback such that u=-Kx/H33522A=B0 120.6 0R, B=B0 1R, C=[0 1] y=Cx x#=Ax+Bum1 , m2 ,p, mnAs-m1BAs-m2B p As-mnB=0f(s)=As-m1BAs-m2B p As-mnB758 Chapter 10 / Control Systems Design in State Space Design a full-order state observer, assuming that the system configuration is identical to that shown in Figure 10–11. Assume that the desired eigenvalues of the observer matrix are The design of the state observer reduces to the determination of an appropriate observer gain matrix K e . Let us examine the observability matrix. The rank of is 2. Hence, the system is completely observable and the determination of the desired observer gain matrix is possible. We shall solve this problem by three methods. Method 1: We shall determine the observer gain matrix by use of Equation (10–61). The given system is already in the observable canonical form. Hence, the transformation matrix Q=(WN*) –1 isI. Since the characteristic equation of the given system is we have The desired characteristic equation is Hence, Then the observer gain matrix K e can be obtained from Equation (10–61) as follows: Method 2: Referring to Equation (10–59): the characteristic equation for the observer becomes Define Then the characteristic equation becomes (10–66) =s 2 +k e2 s-20.6 +k e1 =0 2B s 00 s R B 0 120.6 0 R + B k e1 k e2 R [0 1] 2 = 2 s -1-20.6 +k e1 s+k e2 2 K e = B k e1 k e2 R @s I-A+K e C@=0e#=AA-K e CBeK e =(WN*) -1 B a 2 -a 2 a 1 -a 1 R = B 1 00 1 RB 100 +20.6 20-0 R = B 120.6 20 R a 1 =20, a 2 =100(s+10) 2 =s 2 +20s +100 =s 2 +a 1 s+a 2 =0a 1 =0, a 2 =-20.6∑s I-A∑= 2 s -1-20.6 s 2 =s 2 -20.6 =s 2 +a 1 s+a 2 =0[C*/H21752A* C*]= B 0 11 0 R m 1 =-10, m 2 =-10 Openmirrors.comSection 10–5 / State Observers 759Since the desired characteristic equation is by comparing Equation (10–66) with this last equation, we obtain or Method 3: We shall use Ackermann’s formula given by Equation (10–65): where Thus, and As a matter of course, we get the same Keregardless of the method employed. The equation for the full-order state observer is given by Equation (10–57), or Finally, it is noted that, similar to the case of pole placement, if the system order nis 4 or higher, methods 1 and 3 are preferred, because all matrix computations can be carried out by acomputer, while method 2 always requires hand computation of the characteristic equation involving unknown parameters k e1,ke2,p,ken. Effects of the Addition of the Observer on a Closed-Loop System. In the pole-placement design process, we assumed that the actual state x(t)was available for feedback. In practice, however, the actual state x(t)may not be measurable, so we will need to design an observer and use the observed state for feedback as shown in Fig-ure 10–12. The design process, therefore, becomes a two-stage process, the first stagebeing the determination of the feedback gain matrix Kto yield the desired characteristic equation and the second stage being the determination of the observer gain matrix K e to yield the desired observer characteristic equation. Let us now investigate the effects of the use of the observed state rather than the actual state x(t),on the characteristic equation of a closed-loop control system.x/H33522(t),x/H33522(t)Bx/H11343 1 x/H11343 2R=B0 1-100 -20RBx/H33522 1 x/H33522 2R+B0 1Ru+B120.6 20Ryx/H11343=AA-Ke CBx/H33522+Bu+Ke y =B120.6 20412 120.6RB011 0RB01R=B120.6 20R Ke=AA2+20A+100IBB0 11 0R-1 B0 1Rf(A)=A2+20A+100If(s)=As-m1BAs-m2B=s2+20s +100Ke=f(A)BC CAR-1 B0 1RKe=B120.6 20Rke1=120.6, ke2=20s2+20s +100 =0760 Chapter 10 / Control Systems Design in State Space Consider the completely state controllable and completely observable system defined by the equations For the state-feedback control based on the observed state With this control, the state equation becomes (10–67) The difference between the actual state x(t)and the observed state has been defined as the error e(t): Substitution of the error vector e(t)into Equation (10–67) gives (10–68) Note that the observer error equation was given by Equation (10–59), repeated here: (10–69) Combining Equations (10–68) and (10–69), we obtain (10–70) B x# e# R = B A-BK 0BK A-K e C RB x e R e#=AA-K e CBex#=(A-BK) x+BKee(t)=x(t)-x/H33522(t)x/H33522(t)x#=Ax-BK x/H33522=(A-BK) x+BK(x-x/H33522)u=-Kx/H33522x/H33522, y=Cx x#=Ax+Bu u y y~ABC K e –K/H20848 ABC /H20848xx ~ ++ ++ ++ +– Figure 10–12 Observed-state feedback control system. Openmirrors.comSection 10–5 / State Observers 761Equation (10–70) describes the dynamics of the observed-state feedback control system. The characteristic equation for the system is or Notice that the closed-loop poles of the observed-state feedback control system consist of the poles due to the pole-placement design alone and the poles due to the observerdesign alone. This means that the pole-placement design and the observer design areindependent of each other. They can be designed separately and combined to form theobserved-state feedback control system. Note that, if the order of the plant is n,then the observer is also of nth order (if the full-order state observer is used), and the resulting characteristic equation for the entire closed-loop system becomes of order 2n. Transfer Function of the Observer-Based Controller. Consider the plant defined by Assume that the plant is completely observable. Assume that we use observed-state feedback control Then, the equations for the observer are given by (10–71)(10–72) where Equation (10–71) is obtained by substituting into Equation (10–57). By taking the Laplace transform of Equation (10–71), assuming a zero initial condition, and solving for we obtain By substituting this into the Laplace transform of Equation (10–72), we obtain (10–73) Then the transfer function U(s)/ Y(s) can be obtained as Figure 10–13 shows the block diagram representation for the system. Notice that the transfer function acts as a controller for the system. Hence, we call the transfer function (10–74)U(s) -Y(s)=num den=KAs I-A+Ke C+BKB-1 KeKAs I-A+Ke C+BKB-1 KeU(s) Y(s)=-KAs I-A+Ke C+BKB-1 KeU(s) =-KAs I-A+Ke C+BKB-1Ke Y(s)X/H33522(s)X/H33522(s)=As I-A+Ke C+BKB-1 Ke Y(s)X/H33522(s),u=-Kx/H33522 u=-Kx/H33522 x/H11343=AA-Ke C-BKBx/H33522+Ke yu=-Kx/H33522. y=Cx x#=Ax+Bu@s I-A+BK@@s I-A+Ke C@=02s I-A+BK 0-BK s I-A+Ke C2=0762 Chapter 10 / Control Systems Design in State Space the observer-based controller transfer function or, simply, the observer-controller transfer function. Note that the observer-controller matrix may or may not be stable, although A-BKandA-K e Care chosen to be stable. In fact, in some cases the matrix A-K e C-BKmay be poorly stable or even unstable. EXAMPLE 10–7 Consider the design of a regulator system for the following plant: (10–75) (10–76) where Suppose that we use the pole-placement approach to the design of the system and that the desired closed-loop poles for this system are at s=m i (i=1, 2), wherem 1 =–1.8+j2.4 and m 2 =–1.8-j2.4. The state-feedback gain matrix Kfor this case can be obtained as follows: Using this state-feedback gain matrix K, the control signal uis given by Suppose that we use the observed-state feedback control instead of the actual-state feedback control, or where we choose the observer poles to be at s=–8, s=–8 Obtain the observer gain matrix K e and draw a block diagram for the observed-state feedback control system. Then obtain the transfer function for the observer controller, and draw another block diagram with the observer controller as a series controller in the feedforward path. Finally, obtain the response of the system to the following initial condition: x(0)= B 1 0 R , e(0)=x(0)-x/H33522(0)= B 0.5 0 R U(s) /H20862[-Y(s)]u=-Kx/H33522=-[29.6 3.6] B x/H33522 1 x/H33522 2 R u=-Kx=-[29.6 3.6] B x 1 x 2 R K=[29.6 3.6]A= B 0 20.61 0 R , B= B 0 1 R , C=[1 0] y=Cx x#=Ax+Bu A-K e C-BK R(s)= 0 Y(s) U(s) Plant–Y(s) K(sI– A + K e C+ BK) –1 K e +– Figure 10–13 Block diagram representation of system with a controller-observer. Openmirrors.comSection 10–5 / State Observers 763For the system defined by Equation (10–75), the characteristic polynomial is Thus, The desired characteristic polynomial for the observer is Hence, For the determination of the observer gain matrix, we use Equation (10–61), or where Hence, (10–77) Equation (10–77) gives the observer gain matrix Ke.The observer equation is given by Equation (10–60): (10–78) Since Equation (10–78) becomes or The block diagram of the system with observed-state feedback is shown in Figure 10–14(a). =B-16 -93.61 -3.6RBx/H33522 1 x/H33522 2R+B16 84.6Ry Bx/H11343 1 x/H11343 2R=bB0 20.61 0R-B16 84.6R[1 0]-B0 1R[29.6 3.6]rBx/H33522 1 x/H33522 2R+B16 84.6Ryx/H11343=AA-Ke C-BKBx/H33522+Ke yu=-Kx/H33522x/H11343=AA-Ke CBx/H33522+Bu+Ke y =B0 11 0RB84.6 16R=B16 84.6R Ke=bB0 11 0RB100 1Rr-1 B64+20.6 16-0R W=Ba1 11 0R=B011 0R N=[C*/H21752A*C*]=B1 00 1RKe=(WN*)-1Ba2-a2 a1-a1Ra1=16, a2=64 =s2+a1 s+a2 As-m1BAs-m2B=(s+8)(s +8)=s2+16s +64a1=0, a2=-20.6∑s I-A∑=2s -20.6-1 s2=s2-20.6 =s2+a1 s+a2764 Chapter 10 / Control Systems Design in State Space Referring to Equation (10–74), the transfer function of the observer-controller is As a matter of course, the same transfer function can be obtained with MATLAB. For example, MATLAB Program 10–8 produces the transfer function of the observer controller. Figure 10–14(b) shows a block diagram of the system.=778.2 s+3690.7 s 2 +19.6s+151.2=[29.6 3.6] B s+16 93.6-1 s+3.6 R -1 B 16 84.6 R U(s) -Y(s)=KAs I-A+K e C+BKB -1 K e ++ –+ R(s) = 0 Y(s) U(s) –Y(s)1 s 2 – 20.6 +– (b) u/H20848 /H20848y xx ~ CAC –KB B0 1 0 1 1 0 1 0 0 20.61 0 0 20.61 0 16 84.6 –29.6 –3.6 ++ ++ (a) 778.2 s + 3690.7 s 2 + 19.6 s + 151.2 Figure 10–14 (a) Block diagram of system with observed-state feedback; (b) block diagram of transfer- function system. Openmirrors.comSection 10–5 / State Observers 765MATLAB Program 10–8 % Obtaining transfer function of observer controller --- full-order observerA = [0 1;20.6 0]; B = [0;1];C = [1 0];K = [29.6 3.6];Ke = [16;84.6];AA = A-Ke*C-B*K;BB = Ke;CC = K;DD = 0;[num,den] = ss2tf(AA,BB,CC,DD) num = 1.0e+003* 0 0.7782 3.6907 den = 1.0000 19.6000 151.2000 The dynamics of the observed-state feedback control system just designed can be described by the following equations: For the plant, For the observer, The system, as a whole, is of fourth order. The characteristic equation for the system is The characteristic equation can also be obtained from the block diagram for the system shown in Figure 10–14(b). Since the closed-loop transfer function is Y(s) R(s)=778.2 s+3690.7 As2+19.6s+151.2BAs2-20.6B+778.2 s+3690.7=s4+19.6s3+130.6 s2+374.4 s+576 =0@s I-A+BK@@s I-A+Ke C@=As2+3.6s+9BAs2+16s+64B u=-[29.6 3.6]Bx/H33522 1 x/H33522 2R Bx/H11343 1 x/H11343 2R=B-16 -93.61 -3.6RBx/H33522 1 x/H33522 2R+B16 84.6Ry y=[1 0]Bx1 x2R Bx# 1 x# 2R=B0 20.61 0RBx1 x2R+B01Ru766 Chapter 10 / Control Systems Design in State Space MATLAB Program 10–9 A = [0 1; 20.6 0]; B = [0;1]; C = [1 0]; K = [29.6 3.6]; Ke = [16; 84.6]; sys = ss([A-B*K B*K; zeros(2,2) A-Ke*C],eye(4),eye(4),eye(4)); t = 0:0.01:4; z = initial(sys,[1;0;0.5;0],t); x1 = [1 0 0 0]*z'; x2 = [0 1 0 0]*z'; e1 = [0 0 1 0]*z'; e2 = [0 0 0 1]*z'; subplot(2,2,1); plot(t,x1 ),grid title('Response to Initial Condition') ylabel('state variable x1') subplot(2,2,2); plot(t,x2),grid title('Response to Initial Condition') ylabel('state variable x2') subplot(2,2,3); plot(t,e1),grid xlabel('t (sec)'), ylabel('error state variable e1') subplot(2,2,4); plot(t,e2),grid xlabel('t (sec)'), ylabel('error state variable e2') the characteristic equation is As a matter of course, the characteristic equation is the same for the system in state-space representation and in transfer-function representation. Finally, we shall obtain the response of the system to the following initial condition: Referring to Equation (10–70), the response to the initial condition can be determined from A MATLAB Program to obtain the response is shown in MATLAB Program 10–9.The resulting response curves are shown in Figure 10–15. B x# e# R = B A-BK 0BK A-K e C RB x e R , B x(0) e(0) R = D 1 0 0.5 0 T x(0)= B 1 0 R , e(0)= B 0.5 0 R =s 4 +19.6s 3 +130.6 s 2 +374.4 s+576 =0As 2 +19.6s+151.2BAs 2 -20.6B+778.2 s+3690.7 Openmirrors.comSection 10–5 / State Observers 767uy x y/H20848 PlantC AB –Kx~ Minimum-order observerTransformation++ Figure 10–16 Observed-statefeedback control system with a minimum-orderobserver.Minimum-Order Observer. The observers discussed thus far are designed to reconstruct all the state variables. In practice, some of the state variables may be accu-rately measured. Such accurately measurable state variables need not be estimated. Suppose that the state vector xis an n-vector and the output vector yis an m-vector that can be measured. Since moutput variables are linear combinations of the state variables, mstate variables need not be estimated. We need to estimate only n-m state variables. Then the reduced-order observer becomes an ( n-m )th-order observ- er. Such an ( n-m )th-order observer is the minimum-order observer. Figure 10–16 shows the block diagram of a system with a minimum-order observer.Response to Initial Condition Response to Initial Conditionstate variable x1 state variable x2error state variable e1 error state variable e21.5 1 0.5 0 01234 0123401234 012 t (sec) t (sec)34−0.5 −0.100.10.20.30.40.50.6 −1.5−1−0.500.5 0 −0.5 −1.5−1 −2 −2.5 Figure 10–15 Response curves toinitial condition.768 Chapter 10 / Control Systems Design in State Space It is important to note, however, that if the measurement of output variables involves significant noises and is relatively inaccurate, then the use of the full-order observer may result in a better system performance. To present the basic idea of the minimum-order observer, without undue mathe- matical complications, we shall present the case where the output is a scalar (that is, m=1 ) and derive the state equation for the minimum-order observer. Consider the system (10–79) (10–80) where the state vector xcan be partitioned into two parts x a (a scalar) and x b Can (n-1) -vectorD. Here the state variable x a is equal to the output yand thus can be directly measured, and x b is the unmeasurable portion of the state vector. Then the partitioned state and output equations become (10–81) (10–82) where From Equation (10–81), the equation for the measured portion of the state becomes or (10–83) The terms on the left-hand side of Equation (10–83) can be measured. Equation (10–83) acts as the output equation. In designing the minimum-order observer, we consider the left-hand side of Equation (10–83) to be known quantities.Thus, Equation (10–83) relates the measurable quantities and unmeasurable quantities of the state. From Equation (10–81), the equation for the unmeasured portion of the state becomes (10–84) Noting that terms A ba x a andB b uare known quantities, Equation (10–84) describes the dynamics of the unmeasured portion of the state.x# b =A ba x a +A bb x b +B b ux# a -A aa x a -B a u=A ab x b x# a =A aa x a +A ab x b +B a u B b =(n-1)*1 matrix B a =scalar A bb =(n-1)*(n-1) matrix A ba =(n-1)*1 matrix A ab =1*(n-1) matrix A aa =scalar y=[1/H217520] c x a x b d c x# a x# b d = c A aa A ba A ab A bb dc x a x b d + c B a B b d u y=Cx x#=Ax+Bu Openmirrors.comSection 10–5 / State Observers 769Full-Order State Observer Minimum-Order State Observer AAbb Bu y CAab Ke (n*1 matrix) Ke [(n-1)*1 matrix]x# a-Aaa xa-Ba uAba xa+Bb ux/H33522 b x/H33522Table 10–1 List of Necessary Substitutions for Writing the Observer Equation for the Minimum-OrderState ObserverIn what follows we shall present a method for designing a minimum-order observer. The design procedure can be simplified if we utilize the design technique developed forthe full-order state observer. Let us compare the state equation for the full-order observer with that for the minimum-order observer. The state equation for the full-order observer is and the “state equation” for the minimum-order observer isThe output equation for the full-order observer isand the “output equation” for the minimum-order observer isThe design of the minimum-order observer can be carried out as follows: First, note that the observer equation for the full-order observer was given by Equation (10–57), whichwe repeat here: (10–85) Then, making the substitutions of Table 10–1 into Equation (10–85), we obtain (10–86) where the state observer gain matrix K eis an (n-1)*1 matrix. In Equation (10–86), notice that in order to estimate , we need the derivative of xa.This presents a difficulty, because differentiation amplifies noise. If xa(=y)is noisy, the use of is unacceptable. x# ax/H33522 bx/H11343 b=AAbb-Ke AabBx/H33522 b+Aba xa+Bb u+KeAx# a-Aaa xa-Ba uBx/H11343=AA-Ke CBx/H33522+Bu+Ke yx# a-Aaa xa-Ba u=Aab xby=Cxx# b=Abb xb+Aba xa+Bb ux#=Ax+Bu770 Chapter 10 / Control Systems Design in State Space To avoid this difficulty, we eliminate in the following way. First rewrite Equation (10–86) as (10–87) Define and (10–88) Then Equation (10–87) becomes (10–89) Define Then Equation (10–89) becomes (10–90) Equation (10–90) and Equation (10–88) together define the minimum-order observer. Since where 0is a row vector consisting of (n-1) zeros, if we define then we can write in terms of and yas follows: (10–91) This equation gives the transformation from Figure 10–17 shows the block diagram of the observed-state feedback control system with the minimum-order observer, based on Equations (10–79), (10–80), (10–90), (10–91) and Next we shall derive the observer error equation. Using Equation (10–83), Equation (10–86) can be modified to (10–92) x /H11343 b =AA bb -K e A ab Bx/H33522 b +A ba x a +B b u+K e A ab x b u=-Kx/H33522.H/H33522 to x/H33522.x/H33522=C ˆ H/H33522+D ˆ yH/H33522x/H33522C ˆ = c 0 I n-1 d , D ˆ = c 1 K e d x/H33522= c x a x/H33522 b d = c y x/H33522 b d = c 0 I n-1 d Cx/H33522 b -K e yD+ c 1 K e d yy=C1/H217520D c x a x b d H /H11343 =A ˆ H/H33522+B ˆ y+F ˆ u F ˆ =B b -K e B a B ˆ =A ˆ K e +A ba -K e A aa A ˆ =A bb -K e A ab + A ba -K e A aa Dy+AB b -K e B a Bu H /H11343 =AA bb -K e A ab BH/H33522+CAA bb -K e A ab BK e x/H33522 b -K e y=x/H33522 b -K e x a =H/H33522x b -K e y=x b -K e x a =H + AB b -K e B a Bu + CAA bb -K e A ab BK e +A ba -K e A aa Dy =AA bb -K e A ab BAx/H33522 b -K e yB x /H11343 b -K e x# a =AA bb -K e A ab Bx/H33522 b +AA ba -K e A aa By+AB b -K e B a Bux# a Openmirrors.comSection 10–5 / State Observers 771u y x x/H20848 /H20848C B –K Minimum-order observer Transformation~ ~h~h.++ + ++ + + DCF ABx. ^ ^^ ^A ^ By subtracting Equation (10–92) from Equation (10–84), we obtain (10–93) Define Then Equation (10–93) becomes (10–94) This is the error equation for the minimum-order observer. Note that eis an (n-1) - vector. The error dynamics can be chosen as desired by following the technique developed for the full-order observer, provided that the rank of matrix isn-1. (This is the complete observability condition applicable to the minimum-order observer.)FAab Aab Abb /H11080 /H11080/H11080 A ab An-2 bbVe#=AAbb-Ke AabBee=xb-x/H33522 b=H-H/H33522x# b-x/H11343 b=AAbb-Ke AabBAxb-x/H33522 bBFigure 10–17 System withobserved-state feedback, where the observer is theminimum-orderobserver.772 Chapter 10 / Control Systems Design in State Space The characteristic equation for the minimum-order observer is obtained from Equation (10–94) as follows: (10–95) where are desired eigenvalues for the minimum-order observer. The observer gain matrix K e can be determined by first choosing the desired eigenvalues for the minimum-order observer [that is, by placing the roots of the characteristic equation, Equation (10–95), at the desired locations] and then using the procedure developed for the full-order observer with appropriate modifications. For example, if the formula for determining matrix K e given by Equation (10–61) is to be used, it should be modified to (10–96) where K e is an matrix and Note that are coefficients in the characteristic equation for the state equation Also, if Ackermann’s formula given by Equation (10–65) is to be used, then it should be modified to (10–97) K e =fAA bb B G A ab A ab A bb /H11080 /H11080 /H11080 A ab A n-3 bb A ab A n-2 bb W -1 G 0 0 /H11080 /H11080 /H11080 0 1 W @s I-A bb @=s n-1 +a ˆ 1 s n-2 +p+a ˆ n-2 s+a ˆ n-1 =0a ˆ 1 ,a ˆ 2 ,p,a ˆ n-2 W ˆ = G a ˆ n-2 a ˆ n-3 /H11080 /H11080 /H11080 a ˆ 1 1a ˆ n-3 a ˆ n-4 /H11080 /H11080 /H11080 1 0p p p pa ˆ 1 1 /H11080 /H11080 /H11080 0 01 0 /H11080 /H11080 /H11080 0 0 W =(n-1)*(n-1) matrixN ˆ =CA ab */H21752A bb * A ab */H21752p/H21752AA bb *B n-2 A ab *D=(n-1)*(n-1) matrix(n-1)*1K e =Q ˆ F a ˆ n-1 -a ˆ n-1 a ˆ n-2 -a ˆ n-2 /H11080 /H11080 /H11080 a ˆ 1 -a ˆ 1 V =AW ˆ N ˆ *B -1 F a ˆ n-1 -a ˆ n-1 a ˆ n-2 -a ˆ n-2 /H11080 /H11080 /H11080 a ˆ 1 -a ˆ 1 V m 1 , m 2 ,p, m n-1 =s n-1 +a ˆ 1 s n-2 +p+a ˆ n-2 s+a ˆ n-1 =0 @s I-A bb +K e A ab @=As-m 1 BAs-m 2 B p As-m n-1 B Openmirrors.comSection 10–5 / State Observers 773where Observed-State Feedback Control System with Minimum-Order Observer. For the case of the observed-state feedback control system with full-order state observer,we have shown that the closed-loop poles of the observed-state feedback control systemconsist of the poles due to the pole-placement design alone, plus the poles due to theobserver design alone. Hence, the pole-placement design and the full-order observerdesign are independent of each other. For the observed-state feedback control system with minimum-order observer, the same conclusion applies. The system characteristic equation can be derived as (10–98) (See Problem A–10–11 for the details.) The closed-loop poles of the observed-state feed- back control system with a minimum-order observer comprise the closed-loop polesdue to pole placement Cthe eigenvalues of matrix ( A-BK)Dand the closed-loop poles due to the minimum-order observer Cthe eigenvalues of matrix ( A bb-KeAab)D.There- fore, the pole-placement design and the design of the minimum-order observer areindependent of each other. Determining Observer Gain Matrix K ewith MATLAB. Because of the duality of pole-placement and observer design, the same algorithm can be applied to both thepole-placement problem and the observer-design problem. Thus, the commands acker andplace can be used to determine the observer gain matrix K e. The closed-loop poles of the observer are the eigenvalues of matrix A-KeC.T h e closed-loop poles of the pole-placement are the eigenvalues of matrix A-BK. Referring to the duality problem between the pole-placement problem and observer- design problem, we can determine Keby considering the pole-placement problem for the dual system. That is, we determine Keby placing the eigenvalues of A*-C*Keat the desired place. Since Ke=K*, for the full-order observer we use the command Ke= acker(A',C',L)' where Lis the vector of the desired eigenvalues for the observer. Similarly, for the full- order observer, we may use Ke= place(A',C',L)' provided Ldoes not include multiple poles. [In the above commands, prime ( ') indicates the transpose.] For the minimum-order (or reduced-order) observers, use the followingcommands: K e= acker(Abb',Aab',L)' or Ke= place(Abb',Aab',L)'@s I-A+BK@@s I-Abb+Ke Aab@=0fAAbbB=An-1 bb+aˆ1 An-2 bb+p+aˆn-2 Abb+aˆn-1 I774 Chapter 10 / Control Systems Design in State Space EXAMPLE 10–8 Consider the system where Let us assume that we want to place the closed-loop poles at Then the necessary state-feedback gain matrix Kcan be obtained as follows: K=[90 29 4] (See MATLAB Program 10–10 for a MATLAB computation of this matrix K.) Next, let us assume that the output ycan be measured accurately so that state variable x 1 (which is equal to y) need not be estimated. Let us design a minimum-order observer. (The minimum-order observer is of second order.) Assume that we choose the desired observer poles to be at s=–10, s=–10 Referring to Equation (10–95), the characteristic equation for the minimum-order observer is In what follows, we shall use Ackermann’s formula given by Equation (10–97). (10–99) where Since we have A bb = B 0 -111 -6 R , B a =0, B b = B 0 1 R A aa =0, A ab =[1 0], A ba = B 0 -6 R x/H33522= c x a x/H33522 b d = D x 1 x/H33522 2 x/H33522 3 T , A= D 0 0 -61 0 -110 1 -6 T , B= D 0 0 1 T fAA bb B=A 2 bb +a ˆ 1 A bb +a ˆ 2 I=A 2 bb +20A bb +100IK e =fAA bb B C A ab A ab A bb S -1 B 0 1 R =s 2 +20s +100 =0 =(s+10)(s +10) @s I-A bb +K e A ab @=As-m 1 BAs-m 2 Bs 1 =-2+j213 , s 2 =-2-j213 , s 3 =-6A= C 0 0 -61 0 -110 1 -6 S , B= C 0 0 1 S , C=[1 0 0] y=Cx x#=Ax+Bu Openmirrors.comSection 10–5 / State Observers 775MATLAB Program 10–10 A = [0 1 0;0 0 1;-6 -11 -6]; B = [0;0;1];J = [-2+j*2*sqrt(3) -2-j*2*sqrt(3) -6];K = acker(A,B,J) K = 90.0000 29.0000 4.0000 Abb = [0 1;-11 -6]; Aab = [1 0];L = [-10 -10];Ke = acker(Abb',Aab',L)' Ke = 14 5Equation (10–99) now becomes (A MATLAB computation of this Keis given in MATLAB Program 10–10.) =B89 -15414 5RB01R=B14 5R Ke=bB0 -111 -6R2 +20B0 -111 -6R+100B1 00 1RrB100 1R-1 B0 1R Referring to Equations (10–88) and (10–89), the equation for the minimum-order observer can be given by (10–100) where Noting that the equation for the minimum-order observer, Equation (10–100), becomes or Bh/H11343 2 h/H11343 3R=B-14 -161 -6RBh/H33522 2 h/H33522 3R+B-191 -260Ry+B0 1Ru+B0 -6R-B14 5R0ry+bB0 1R-B14 5R0ruBh/H11343 2 h/H11343 3R=B-14 -161 -6RBh/H33522 2 h/H33522 3R+bB-14 -161 -6RB14 5RAbb-Ke Aab=B0 -111 -6R-B14 5R[1 0]=B-14 -161 -6RH/H33522=x/H33522 b-Ke y=x/H33522 b-Ke x1H/H11343=AAbb-Ke AabBH/H33522+CAAbb-Ke AabBKe+Aba-Ke AaaDy+ABb-Ke BaBu776 Chapter 10 / Control Systems Design in State Space where or If the observed-state feedback is used, then the control signal ubecomes where Kis the state feedback gain matrix. Figure 10–18 is a block diagram showing the configu- ration of the system with observed-state feedback, where the observer is the minimum-order observer.u=-Kx/H33522=-K C x 1 x/H33522 2 x/H33522 3 SB x/H33522 2 x/H33522 3 R = B h/H33522 2 h/H33522 3 R +K e x 1 B h/H33522 2 h/H33522 3 R = B x/H33522 2 x/H33522 3 R -K e y u y x x/H20848 /H20848PlantC AB Minimum-order observer Transformation0 1 0 h ~~ ~0 1 0 0 0 1 x 1 K e x 1 1 K e 1 14 5 0 –6 14 5 –14 –16 1 –6B b – K e B a A bb – K e A ab A ba – K e A aa h~h. K e ++ + ++ + + + + [ –90–29–4 ]–K Figure 10–18 System with observed state feedback, where the observer is the minimum-order observer designed in Example 10–8. Openmirrors.comSection 10–5 / State Observers 777Transfer Function of Minimum-Order Observer-Based Controller. In the minimum-order observer equation given by Equation (10–89): define, similar to the case of the derivation of Equation (10–90), Then, the following three equations define the minimum-order oberver: (10–101)(10–102)(10–103) Since Equation (10–103) can be rewritten as (10–104) by substituting Equation (10–104) into Equation (10–101), we obtain (10–105) Define Then Equations (10–105) and (10–104) can be written as (10–106)(10–107) Equations (10–106) and (10–107) define the minimum-order observer-based controller. By considering uas the output and –yas the input, U(s)can be written as Since the input to the observer controller is –Y(s), rather than Y(s), the transfer function of the observer controller is (10–108) This transfer function can be easily obtained by using the following MATLAB statement: [num,den] = ss2tf(Atilde, Btilde, -Ctilde, -Dtilde) (10–109)U(s) -Y(s)=num den=-CC/H33522As I-A/H33522B-1B/H33522+D/H33522D =-CC/H33522As I-A/H33522B-1B/H33522+D/H33522D[-Y(s)] U(s) =CC/H33522As I-A/H33522B-1B/H33522+D/H33522DY(s) u=C/H33522H/H33522+D/H33522y H/H11343=A/H33522H/H33522+B/H33522yD/H33522=-AKa+Kb KeBC/H33522=-KbB/H33522=Bˆ-FˆAKa+Kb KeBA/H33522=Aˆ-FˆKb =AAˆ-FˆKbBH/H33522+CBˆ-FˆAKa+Kb KeBDy H/H11343=AˆH/H33522+Bˆy+FˆC-KbH/H33522-AKa+Kb KeByD =-KbH/H33522-AKa+Kb KeBy u=-Kx/H33522=-CKa KbDBy x/H33522 bR=-Ka y-Kb x/H33522 b u=-Kx/H33522 H/H33522=x/H33522 b-Ke y H/H11343=AˆH/H33522+Bˆy+Fˆu Fˆ=Bb-Ke Ba Bˆ=AˆKe+Aba-Ke Aaa Aˆ=Abb-Ke AabH/H11343=AAbb-Ke AabBH/H33522+CAAbb-Ke AabBKe+Aba-Ke AaaDy+ABb-Ke BaBu778 Chapter 10 / Control Systems Design in State Space 10–6 DESIGN OF REGULATOR SYSTEMS WITH OBSERVERS In this section we shall consider a problem of designing regulator systems by using the pole-placement-with-observer approach. Consider the regulator system shown in Figure 10–19. (The reference input is zero.) The plant transfer function is Using the pole-placement approach, design a controller such that when the system is subjected to the following initial condition: where xis the state vector for the plant and eis the observer error vector, the maximum undershoot of y(t) is 25 to 35 %and the settling time is about 4 sec.Assume that we use the minimum-order observer. (We assume that only the output yis measurable.) We shall use the following design procedure: 1.Derive a state-space model of the plant. 2.Choose the desired closed-loop poles for pole placement. Choose the desired observer poles. 3.Determine the state feedback gain matrix Kand the observer gain matrix K e . 4.Using the gain matrices KandK e obtained in step 3, derive the transfer function of the observer controller. If it is a stable controller, check the response to the given ini- tial condition. If the response is not acceptable, adjust the closed-loop pole location and/or observer pole location until an acceptable response is obtained. Design step 1: We shall derive the state-space representation of the plant. Since the plant transfer function is the corresponding differential equation is Referring to Section 2–5, let us define the state variables x 1 , x 2 ,andx 3 as follows: x 3 =x# 2 -b 2 u x 2 =x# 1 -b 1 u x 1 =y-b 0 uy%+10y$+24y#=10u#+20uY(s) U(s)=10(s +2) s(s+4)(s +6)x(0)= C 1 0 0 S , e(0)= B 1 0 R G(s) =10(s +2) s(s+4)(s +6) r= 0 y u Plant–y Controller +– Figure 10–19 Regulator system. Openmirrors.comSection 10–6 / Design of Regulator Systems with Observers 779Also, is defined by where and [See Equation (2–35) for the calculation of b’s.] Then the state-space equation and out- put equation can be obtained as Design step 2: As the first trial, let us choose the desired closed-loop poles at s=–1+j2, s=–1-j2, s=–5 and choose the desired observer poles at s=–10, s=–10 Design step 3: We shall use MATLAB to compute the state feedback gain matrix K and the observer gain matrix Ke.MATLAB Program 10–11 produces matrices KandKe. y=[1 0 0]Cx1 x2 x3S+[0]u Cx# 1 x# 2 x# 3S=C0 001 0 -240 1 -10SCx1 x2 x3S+C0 10 -80Sub3=-80. b2=10, b1=0, b0=0,=-24x2-10x3+b3 ux# 3=-a3x1-a2x2-a1x3+b3ux# 3 MATLAB Program 10–11 % Obtaining the state feedback gain matrix KA = [0 1 0;0 0 1;0 -24 -10]; B = [0;10;-80];C = [1 0 0];J = [-1+j*2 -1-j*2 -5];K = acker(A,B,J) K = 1.2500 1.2500 0.19375 % Obtaining the observer gain matrix KeAaa = 0; Aab = [1 0]; Aba = [0;0]; Abb = [0 1;-24 -10];Ba = 0; Bb = [10;-80]; L = [-10 -10];Ke = acker(Abb',Aab',L)' Ke = 10 -24780 Chapter 10 / Control Systems Design in State Space MATLAB Program 10–12 % Determination of transfer function of observer controller A = [0 1 0;0 0 1;0 -24 -10]; B = [0;10;-80]; Aaa = 0; Aab = [1 0]; Aba = [0;0]; Abb = [0 1;-24 -10]; Ba = 0; Bb = [10;-80]; Ka = 1.25; Kb = [1.25 0.19375]; Ke = [10;-24]; Ahat = Abb - Ke*Aab; Bhat = Ahat*Ke + Aba - Ke*Aaa; Fhat = Bb - Ke*Ba; Atilde = Ahat - Fhat*Kb; Btilde = Bhat - Fhat*(Ka + Kb*Ke); Ctilde = -Kb; Dtilde = -(Ka + Kb*Ke); [num,den] = ss2tf(Atilde, Btilde, -Ctilde, -Dtilde) num = 9.1000 73.5000 125.0000 den = 1.0000 17.0000 -30.0000 In the program, matrices JandLrepresent the desired closed-loop poles for pole place- ment and the desired poles for the observer, respectively. The matrices Kand K e are obtained as Design step 4: We shall determine the transfer function of the observer controller. Referring to Equation (10–108), the transfer function of the observer controller can be given by We shall use MATLAB to calculate the transfer function of the observer controller. MATLAB Program 10–12 produces this transfer function. The result is Define the system with this observer controller as System 1. Figure 10–20 shows the block diagram of System 1. =9.1(s +5.6425)(s +2.4344) (s+18.6119)(s -1.6119) G c (s)=9.1s 2 +73.5s +125 s 2 +17s -30G c (s)=U(s) -Y(s)=num den=-CC/H33522As I-A/H33522B -1 B/H33522+D/H33522D K e = B 10 -24 R K=[1.25 1.25 0.19375] Openmirrors.comSection 10–6 / Design of Regulator Systems with Observers 781MATLAB Program 10–13 % Obtaining the characteristic equation[num1,den1] = ss2tf(A-B*K,eye(3),eye(3),eye(3),1); [num2,den2] = ss2tf(Abb-Ke*Aab,eye(2),eye(2),eye(2),1);charact_eq = conv(den1,den2) charact_eq = 1.0e+003*0.0010 0.0270 0.2550 1.0250 2.0000 2.5000r= 0 y u +–9.1s2+ 73.5 s+ 125 s2+17s–3010(s+ 2) s(s+ 4) (s+ 6) Observer controller Plant The observer controller has a pole in the right-half splane (s=1.6119). The exis- tence of an open-loop right-half splane pole in the observer controller means that the system is open-loop unstable, although the closed-loop system is stable. The latter canbe seen from the characteristic equation for the system: (See MATLAB Program 10–13 for the calculation of the characteristic equation.) A disadvantage of using an unstable controller is that the system becomes unstable if the dc gain of the system becomes small. Such a control system is neither desirable noracceptable. Hence, to get a satisfactory system, we need to modify the closed-loop polelocation and/or observer pole location. =(s+1+j2)(s +1-j2)(s +5)(s +10)(s +10) =0 =s 5+27s4+255s3+1025s2+2000s +2500∑s I-A+BK∑/H11554@s I-Abb+Ke Aab@Figure 10–20 Block diagram ofSystem 1. Second trial: Let us keep the desired closed-loop poles for pole placement as before, but modify the observer pole locations as follows: s=–4.5, s=–4.5 Thus, L=[–4.5 –4.5] Using MATLAB, we find the new Keto be Ke=B-1 6.25R782 Chapter 10 / Control Systems Design in State Space MATLAB Program 10–14 % Determination of transfer function of observer controller. A = [0 1 0;0 0 1;0 -24 -10]; B = [0;10;-80]; Aaa = 0; Aab = [1 0]; Aba = [0;0]; Abb = [0 1;-24 -10]; Ba = 0; Bb = [10;-80]; Ka = 1.25; Kb = [1.25 0.19375]; Ke = [-1;6.25]; Ahat = Abb - Ke*Aab; Bhat = Ahat*Ke + Aba - Ke*Aaa; Fhat = Bb - Ke*Ba; Atilde = Ahat - Fhat*Kb; Btilde = Bhat - Fhat*(Ka + Kb*Ke); Ctilde = -Kb; Dtilde = -(Ka + Kb*Ke); [num,den] = ss2tf(Atilde,Btilde,-Ctilde,-Dtilde) num = 1.2109 11.2125 25.3125 den = 1.0000 6.0000 2.1406 Next, we shall obtain the transfer function of the observer controller. MATLAB Program 10–14 produces this transfer function as follows: =1.2109(s +5.3582)(s +3.9012) (s+5.619)(s +0.381) G c (s)=1.2109s 2 +11.2125s +25.3125 s 2 +6s+2.1406 Notice that this is a stable controller. Define the system with this observer controller as System 2. We shall proceed to obtain the response of System 2 to the given initial condition: By substituting into the state-space equation for the plant, we obtain (10–110) =Ax-BK b x- B 0 e R r =Ax-BKx +BCK a K b D B 0 e R x#=Ax-BK x/H33522=Ax-BK B x a x/H33522 b R =Ax-BK B x a x b -e R u=-Kx/H33522x(0)= C 1 0 0 S , e(0)= B 1 0 R Openmirrors.comSection 10–6 / Design of Regulator Systems with Observers 783The error equation for the minimum-order observer is (10–111) By combining Equations (10–110) and (10–111), we get with the initial condition MATLAB Program 10–15 produces the response to the given initial condition. The response curves are shown in Figure 10–21.They seem to be acceptable.Bx(0) e(0)R=E1 0010 UBx# e#R=BA-BK 0BKb Abb-Ke AabRBx eRe#=AAbb-Ke AabBe MATLAB Program 10–15 % Response to initial condition. A = [0 1 0;0 0 1;0 -24 -10]; B = [0;10;-80];K = [1.25 1.25 0.19375];Kb = [1.25 0.19375];Ke = [-1;6.25];Aab = [1 0]; Abb = [0 1;-24 -10];AA = [A-B*K B*Kb; zeros(2,3) Abb-Ke*Aab];sys = ss(AA,eye(5),eye(5),eye(5));t = 0:0.01:8;x = initial(sys,[1;0;0;1;0],t);x1 = [1 0 0 0 0]*x';x2 = [0 1 0 0 0]*x';x3 = [0 0 1 0 0]*x';e1 = [0 0 0 1 0]*x';e2 = [0 0 0 0 1]*x'; subplot(3,2,1); plot(t,x1); grid xlabel ('t (sec)'); ylabel('x1') subplot(3,2,2); plot(t,x2); grid xlabel ('t (sec)'); ylabel('x2') subplot(3,2,3); plot(t,x3); grid xlabel ('t (sec)'); ylabel('x3') subplot(3,2,4); plot(t,e1); grid xlabel('t (sec)'); ylabel('e1') subplot(3,2,5); plot(t,e2); grid xlabel('t (sec)'); ylabel('e2')784 Chapter 10 / Control Systems Design in State Space Next, we shall check the frequency-response characteristics.The Bode diagram of the open-loop system just designed is shown in Figure 10–22.The phase margin is about 40° and the gain margin is ±qdB.The Bode diagram of the closed-loop system is shown in Figure 10–23. The bandwidth of the system is approximately 3.8 rad/sec. x 1 02468 t (sec) 02468 t (sec) 02468 t (sec) 02468 t (sec) 02468 t (sec) −0.500.51 e 2 −3−2−10 x 2 −1.5−0.5 −100.5 x 3 −55 01015 e 1 01 0.51.5 Figure 10–21 Response to the given initial condition; x 1 (0)=1, x 2 (0)=0, x 3 (0)=0, e 1 (0)=1, e 2 (0)=0. Frequency (rad/sec)Bode Diagram of System 2 — Open Loop −200−150−100−50−100 Phase (deg); Magnitude (dB) −50050100 10 −3 10 −2 10 −1 10 0 10 1 10 2 Figure 10–22 Bode diagram for the open-loop transfer function of System 2. Openmirrors.comSection 10–6 / Design of Regulator Systems with Observers 785Finally, we shall compare the root-locus plots of the first system with L=[–10 –10] and the second system with L=[–4.5 –4.5]. The plot for the first system given in Figure 10–24(a) shows that the system is unstable for small dc gain and becomes stablefor large dc gain. The plot for the second system given in Figure 10–24(b), on the otherhand, shows that the system is stable for any positive dc gain.Frequency (rad/sec)Bode Diagram of System 2 — Closed Loop −200−50 −100 −1500−60−40Phase (deg); Magnitude (dB)20 −200 10−1100101102Figure 10–23 Bode diagram for theclosed-loop transfer function of System 2. Root-Locus Plot of (91 s3 + 917 s2 + 2720 s + 2500)/ (s5 + 27 s4 + 164 s3 + 108 s2− 720s) Real AxisImag Axis2 −4 −6 −8−14 −12 −10 −8 −6 −4 −20 24 −2068 (a)Root-Locus Plot of (12.109 s3 + 136.343 s2 + 477.375 s + 506.25)/ (s5 + 16 s4 + 86.1406 s3 + 165.406 s2 + 51.3744 s) Real AxisImag Axis2 −3 −4 −5−8−7−6−5−4−3−2−10 1 23 −2−10145 (b) Figure 10–24 (a) Root-locus plot of the system with observer poles at s=–10 ands=–10; (b) root-locus plot of the system with observer poles at s=–4.5 ands=–4.5.786 Chapter 10 / Control Systems Design in State Space Comments 1.In designing regulator systems, note that if the dominant controller poles are placed far to the left of the jvaxis, the elements of the state feedback gain matrix Kwill become large. Large gain values will make the actuator output become large, so that saturation may take place. Then the designed system will not behave as designed. 2.Also, by placing the observer poles far to the left of the jvaxis, the observer controller becomes unstable, although the closed-loop system is stable.An unstable observer controller is not acceptable. 3.If the observer controller becomes unstable, move the observer poles to the right in the left-half splane until the observer controller becomes stable.Also, the desired closed-loop pole locations may need to be modified. 4.Note that if the observer poles are placed far to the left of the jvaxis, the band- width of the observer will increase and will cause noise problems. If there is a serious noise problem, the observer poles should not be placed too far to the left of the jvaxis.The general requirement is that the bandwidth should be sufficiently low so that the sensor noise will not become a problem. 5.The bandwidth of the system with the minimum-order observer is higher than that of the system with the full-order observer, provided that the multiple observer poles are placed at the same place for both observers. If the sensor noise is a seri- ous problem, use of a full-order observer is recomnended. 10–7 DESIGN OF CONTROL SYSTEMS WITH OBSERVERS In Section 10–6 we discussed the design of regulator systems with observers. (The systems did not have reference or command inputs.) In this section we consider the design of control systems with observers when the systems have reference inputs or command inputs. The output of the control system must follow the input that is time varying. In following the command input, the system must exhibit satisfactory performance (a reasonable rise time, overshoot, settling time, and so on). In this section we consider control systems that are designed by use of the pole- placement-with-observer approach. Specifically, we consider control systems using observer controllers. In Section 10–6 we discussed regulator systems, whose block diagram is shown in Figure 10–25. This system has no reference input, or r=0. When the system has a reference input, several different block diagram configurations are conceivable, each having an observer controller.Two of these configurations are shown in Figures 10–26 (a) and (b); we shall consider them in this section. r= 0 y u Plant–yObserver controller +– Figure 10–25 Regulator system. Openmirrors.comSection 10–7 / Design of Control Systems with Observers 787ry Plantr+ u Observer controller+– –ur y u Plantr–yObserver controller+– (a) (b) r y uObserver controller+–1 s(s2+ 1) PlantFigure 10–27 Control system withobserver controller in the feedforward path.Configuration 1: Consider the system shown in Figure 10–27. In this system the refer- ence input is simply added at the summing point. We would like to design the observercontroller such that in the unit-step response the maximum overshoot is less than 30 % and the settling time is about 5 sec. In what follows we first design a regulator system.Then, using the observer controller designed, we simply add the reference input rat the summing point. Before we design the observer controller, we need to obtain a state-space represen- tation of the plant. Since we obtain By choosing the state variables as we get y=Cx x#=Ax+Bu x 3=y$ x2=y# x1=yy%+y#=uY(s) U(s)=1 sAs2+1BFigure 10–26 (a) Control systemwith observer controller in the feedforward path;(b) Control systemwith observercontroller in the feedback path.788 Chapter 10 / Control Systems Design in State Space where Next, we choose the desired closed-loop poles for pole placement at s=–1+j, s=–1-j, s=–8 and the desired observer poles at s=–4, s=–4 The state feedback gain matrix Kand the observer gain matrix K e can be obtained as follows: See MATLAB Program 10–16. K e = B 8 15 R K=[16 17 10]A= C 0 0 01 0 -10 1 0 S , B= C 0 0 1 S , C=[1 0 0] MATLAB Program 10–16 A = [0 1 0;0 0 1;0 -1 0]; B = [0;0;1]; J = [-1+j -1-j -8]; K = acker(A,B,J) K = 16 17 10 Aab = [1 0]; Abb = [0 1;-1 0]; L = [-4 -4]; Ke = acker(Abb',Aab',L)' Ke = 8 15 The transfer function of the observer controller is obtained by use of MATLAB Program 10–17. The result is =302(s +0.5017 +j0.772)(s +0.5017 -j0.772) (s+9+j5.6569)(s +9-j5.6569) G c (s)=302s 2 +303s +256 s 2 +18s +113 Openmirrors.comSection 10–7 / Design of Control Systems with Observers 789Figure 10–28 shows the block diagram of the regulator system just designed. Figure 10–29 shows the block diagram of a possible configuration of the control system basedon the regulator system shown in Figure 10–28. The unit-step response curve for thiscontrol system is shown in Figure 10–30.The maximum overshoot is about 28 %and the settling time is about 4.5 sec.Thus, the designed system satisfies the design requirements.MATLAB Program 10–17 % Determination of transfer function of observer controllerA = [0 1 0;0 0 1;0 -1 0]; B = [0;0;1];Aaa = 0; Aab = [1 0]; Aba = [0;0]; Abb = [0 1;-1 0];Ba = 0; Bb = [0;1];Ka = 16; Kb=[17 10];Ke = [8;15];Ahat = Abb - Ke*Aab;Bhat = Ahat*Ke + Aba - Ke*Aaa;Fhat = Bb - Ke*Ba;Atilde = Ahat - Fhat*Kb;Btilde = Bhat - Fhat*(Ka + Kb*Ke);Ctilde = -Kb;Dtilde = -(Ka + Kb*Ke);[num,den] = ss2tf(Atilde,Btilde,-Ctilde,-Dtilde) num = 302.0000 303.0000 256.0000 den = 1 18 113 y –yu –302s2+ 303s+ 256 s2+18s+113 Observer controller1 s(s2+ 1) Plant y r–y ru –+302s2+ 303s+ 256 s2+18s+1131 s(s2+ 1) Observer controller PlantFigure 10–29 Control system withobserver controller in the feedforward path.Figure 10–28 Regulator system with observer controller.790 Chapter 10 / Control Systems Design in State Space Output y t (sec)Unit-Step Response of (302s 2 + 303 s + 256)/( s 5 +18s 4 + 114 s 3 + 320 s 2 + 416 s + 256) 0.60.811.21.4 0.4 0.2 0 0123456789 1 0 Figure 10–30 Unit-step response of the control system shown in Figure 10–29. Configuration 2: A different configuration of the control system is shown in Figure 10–31. The observer controller is placed in the feedback path. The input ris introduced into the closed-loop system through the box with gain N. From this block diagram, the closed-loop transfer function is obtained as We determine the value of constant Nsuch that for a unit-step input r, the output yis unity as tapproaches infinity. Thus we choose The unit-step response of the system is shown in Figure 10–32. Notice that the maxi- mum overshoot is very small, approximately 4 %. The settling time is about 5 sec.N=256 113=2.2655Y(s) R(s)=NAs 2 +18s +113B sAs 2 +1BAs 2 +18s +113B+302s 2 +303s +256 y Nr+u –ur –+ 302s 2 + 303s+ 256 s 2 +18s+113 1 s(s 2 + 1) N Figure 10–31 Control system with observer controller in the feedback path. Openmirrors.comSection 10–7 / Design of Control Systems with Observers 791Output y t (sec)Unit-Step Response of (2.2655 s2 + 40.779 s + 256)/( s5 + 18 s4 + 114 s3 + 320 s2 + 416 s + 256) 0.60.811.21.4 0.4 0.2 0 0123456789 1 0Figure 10–32 The unit-stepresponse of the system shown inFigure 10–31. (The closed-loop poles forpole placement areats=–1 ;j, s=–8. The observer poles are at s=–4, s=–4. ) Comments. We considered two possible configurations for the closed-loop control systems using observer controllers. As stated earlier, other configurations are possible. The first configuration, which places the observer controller in the feedforward path, gen- erally gives a fairly large overshoot.The second configuration, which places the observer con-troller in the feedback path, gives a smaller overshoot.This response curve is quite similar tothat of the system designed by the pole-placement approach without using the observer con-troller. See the unit-step response curve of the system, shown in Figure 10–33, designed bythe pole-placement approach without observer. Here the desired closed-loop poles used are s=-1+j, s=-1-j, s=-8Output y t (sec)Unit-Step Response of System without Observer 0.60.811.21.4 0.4 0.2 0 0123456789 1 0Figure 10–33 The unit-stepresponse of thecontrol system designed by the pole placement approachwithout observer.(The closed-looppoles are at s=– 1;j, s=–8. )792 Chapter 10 / Control Systems Design in State Space Frequency (rad/sec) Bode Diagrams of Closed-Loop Systems −3000 −100 −200100−150−100 Phase (deg); Magnitude (dB) 50 −500 10 −1 10 0 10 1 10 2 System 1 System 2 System 1 System 2 Figure 10–34 Bode diagrams of closed-loop system 1 (shown in Figure 10–29) and closed- loop system 2 (shown in Figure 10–31). Note that, in these two systems, the rise time and settling time are determined primari- ly by the desired closed-loop poles for pole placement. (See Figures 10–32 and 10–33.) The Bode diagrams of closed-loop system 1 (shown in Figure 10–29) and closed- loop system 2 (shown in Figure 10–31) are shown in Figure 10–34. From this figure, we find that the bandwidth of system 1 is 5 rad /H20862sec and that of system 2 is 1.3 rad /H20862sec. Summary of State-Space Design Method 1.The state-space design method based on the pole-placement-combined-with- observer approach is very powerful. It is a time-domain method.The desired closed- loop poles can be arbitrarily placed, provided the plant is completely state controllable. 2.If not all state variables can be measured, an observer must be incorporated to estimate the unmeasurable state variables. 3.In designing a system using the pole-placement approach, several different sets of desired closed-loop poles need be considered, the response characteristics compared, and the best one chosen. 4.The bandwidth of the observer controller is generally large, because we choose observer poles far to the left in the splane. A large bandwidth passes high- frequency noises and causes the noise problem. 5.Adding an observer to the system generally reduces the stability margin. In some cases, an observer controller may have zero(s) in the right-half splane, which means that the controller may be stable but of nonminimum phase. In other cases, the controller may have pole(s) in the right-half splane—that is, the controller is unstable. Then the designed system may become conditionally stable. 6.When the system is designed by the pole-placement-with-observer approach, it is advisable to check the stability margins (phase margin and gain margin), using a Openmirrors.comSection 10–8 / Quadratic Optimal Regulator Systems 793frequency-response method. If the system designed has poor stability margins, it is possible that the designed system may become unstable if the mathematicalmodel involves uncertainties. 7.Note that for nth-order systems, classical design methods (root-locus and frequency-response methods) yield low-order compensators (first or second order).Since the observer-based controllers are nth-orderCor(N-m) th-order if the minimum-order observer is used Dfor an nth-order system, the designed system will become 2 nth order Cor(2n-m) th orderD. Since lower-order compensators are cheaper than higher-order ones, the designer should first apply classical methodsand, if no suitable compensators can be determined, then try the pole-placement-with-observer design approach presented in this chapter. 10–8 QUADRATIC OPTIMAL REGULATOR SYSTEMS An advantage of the quadratic optimal control method over the pole-placement method is that the former provides a systematic way of computing the state feedback control gainmatrix. Quadratic Optimal Regulator Problems. We shall now consider the optimal regulator problem that, given the system equation (10–112) determines the matrix Kof the optimal control vector (10–113) so as to minimize the performance index (10–114) where Qis a positive-definite (or positive-semidefinite) Hermitian or real symmetric matrix and Ris a positive-definite Hermitian or real symmetric matrix. Note that the second term on the right-hand side of Equation (10–114) accounts for the expenditureof the energy of the control signals. The matrices Qand Rdetermine the relative importance of the error and the expenditure of this energy. In this problem, we assumethat the control vector u(t)is unconstrained. As will be seen later, the linear control law given by Equation (10–113) is the optimal control law. Therefore, if the unknown elements of the matrix Kare determined so as to minimize the performance index, then u(t)=– Kx(t)is optimal for any initial state x(0). The block diagram showing the optimal configuration is shown in Figure 10–35.J= 3 q 0(x*Qx+u* Ru)dtu(t)=-Kx(t)x#=Ax+Bu x=Ax+ Bu.x u –KFigure 10–35 Optimal regulatorsystem.794 Chapter 10 / Control Systems Design in State Space Now let us solve the optimization problem. Substituting Equation (10–113) into Equation (10–112), we obtain In the following derivations, we assume that the matrix A-BKis stable, or that the eigenvalues of A-BKhave negative real parts. Substituting Equation (10–113) into Equation (10–114) yields Let us set where Pis a positive-definite Hermitian or real symmetric matrix. Then we obtain Comparing both sides of this last equation and noting that this equation must hold true for any x, we require that (10–115) It can be proved that if A-BKis a stable matrix, there exists a positive-definite ma- trixPthat satisfies Equation (10–115). (See Problem A–10–15 .) Hence our procedure is to determine the elements of Pfrom Equation (10–115) and see if it is positive definite. (Note that more than one matrix Pmay satisfy this equation. If the system is stable, there always exists one positive-definite matrix Pto satisfy this equation.This means that, if we solve this equation and find one positive-definite matrix P, the system is stable. Other Pmatrices that satisfy this equation are not positive definite and must be discarded.) The performance index Jcan be evaluated as Since all eigenvalues of A-BKare assumed to have negative real parts, we have Therefore, we obtain (10–116) Thus, the performance index Jcan be obtained in terms of the initial condition x(0) and P. To obtain the solution to the quadratic optimal control problem, we proceed as follows: Since Rhas been assumed to be a positive-definite Hermitian or real symmetric matrix, we can write R=T* TJ=x*(0) Px(0)x(q)S0.J= 3 q 0 x*(Q+K* RK)xdt=-x* Px 2 q 0 =-x*(q) Px(q)+x*(0) Px(0)(A-BK)* P+P(A-BK)=-(Q+K* RK)x*(Q+K* RK) x=-x#* Px-x* Px#=-x*C(A-BK)* P+P(A-BK)D xx*(Q+K*RK) x=-d dt(x*Px)= 3 q 0 x*(Q+K*RK) xdtJ= 3 q 0 (x*Qx+x*K*RKx )dtx#=Ax-BKx =(A-BK) x Openmirrors.comSection 10–8 / Quadratic Optimal Regulator Systems 795where Tis a nonsingular matrix. Then Equation (10–115) can be written as which can be rewritten as The minimization of Jwith respect to Krequires the minimization of with respect to K. (See Problem A–10–16 .) Since this last expression is nonnegative, the minimum occurs when it is zero, or when Hence, (10–117) Equation (10–117) gives the optimal matrix K.Thus, the optimal control law to the quad- ratic optimal control problem when the performance index is given by Equation (10–114)is linear and is given by The matrix Pin Equation (10–117) must satisfy Equation (10–115) or the following reduced equation: (10–118) Equation (10–118) is called the reduced-matrix Riccati equation. The design steps may be stated as follows: 1.Solve Equation (10–118), the reduced-matrix Riccati equation, for the matrix P. [If a positive-definite matrix Pexists (certain systems may not have a positive- definite matrix P), the system is stable, or matrix A-BKis stable.] 2.Substitute this matrix Pinto Equation (10–117). The resulting matrix Kis the optimal matrix. A design example based on this approach is given in Example 10–9. Note that if the matrix A-BKis stable, the present method always gives the correct result. Finally, note that if the performance index is given in terms of the output vector rather than the state vector, that is, then the index can be modified by using the output equation to (10–119) and the design steps presented in this section can be applied to obtain the optimal matrix K.J= 3q 0(x* C* QCx +u* Ru)dty=CxJ= 3q 0(y* Qy+u* Ru)dtA* P+PA -PBR-1 B* P+Q=0u(t)=-Kx(t)=-R-1 B* Px(t)K=T-1(T*)-1 B* P=R-1 B* PTK =(T*)-1 B* Px*CTK -(T*)-1 B* PD*CTK -(T*)-1 B* PD xA*P+PA +CTK -(T*)-1B *PD*CTK -(T*)-1B *PD-PBR-1B*P+Q=0(A*-K* B*) P+P(A-BK)+Q+K* T* TK =0796 Chapter 10 / Control Systems Design in State Space EXAMPLE 10–9 Consider the system shown in Figure 10–36. Assuming the control signal to be determine the optimal feedback gain matrix Ksuch that the following performance index is minimized: where (m/H113500) From Figure 10–36, we find that the state equation for the plant is where We shall demonstrate the use of the reduced-matrix Riccati equation in the design of the optimal control system. Let us solve Equation (10–118), rewritten as Noting that matrix Ais real and matrix Qis real symmetric, we see that matrix Pis a real sym- metric matrix. Hence, this last equation can be written as This equation can be simplified to B 0 p 11 0 p 12 R + B 0 0p 11 p 12 R B p 2 12 p 12 p 22 p 12 p 22 p 2 22 R + B 1 00 m R = B 0 00 0 R - B p 11 p 12 p 12 p 22 RB 0 1 R [1][0 1] B p 11 p 12 p 12 p 22 R + B 1 00 m R = B 0 00 0 R B 0 10 0 RB p 11 p 12 p 12 p 22 R + B p 11 p 12 p 12 p 22 RB 0 01 0 R A* P+PA -PBR -1 B* P+Q=0A= B 0 01 0 R , B= B 0 1 R x#=Ax+BuQ= B 1 00 m R J= 3 q 0 Ax T Qx+u 2 Bdtu(t) =-Kx(t) ux 1 Plant x 2 –K/H20848/H20848 Figure 10–36 Control system. Openmirrors.comSection 10–8 / Quadratic Optimal Regulator Systems 797from which we obtain the following three equations: Solving these three simultaneous equations for p11, p12,andp22,requiring Pto be positive definite, we obtain Referring to Equation (10–117), the optimal feedback gain matrix Kis obtained as Thus, the optimal control signal is (10–120) Note that the control law given by Equation (10–120) yields an optimal result for any initial state under the given performance index. Figure 10–37 is the block diagram for this system. Since the characteristic equation is ifm=1, the two closed-loop poles are located at These correspond to the desired closed-loop poles when m=1 . Solving Quadratic Optimal Regulator Problems with MATLAB. In MATLAB, the command lqr(A,B,Q,R)s=-0.866 +j 0.5, s=-0.866 -j 0.5∑s I-A+BK∑=s2+1m+2s+1=0u=-Kx=-x1-1m+2x2 =C1 1m+2D =Cp12 p22D =[1][0 1]Bp11 p12p12 p22R K=R-1 B* PP=Bp11 p12p12 p22R=B1m+2 11 1m+2R m+2p12-p2 22=0 p11-p12 p22=0 1-p2 12=0––ux 1Plant x2 /H20848/H20848 m + 2 /H20881Figure 10–37 Optimal control ofthe plant shown in Figure 10–36.798 Chapter 10 / Control Systems Design in State Space solves the continuous-time, linear, quadratic regulator problem and the associated Riccati equation. This command calculates the optimal feedback gain matrix Ksuch that the feedback control law minimizes the performance index subject to the constraint equation Another command [K,P,E] = lqr(A,B,Q,R) returns the gain matrix K, eigenvalue vector E, and matrix P, the unique positive-definite solution to the associated matrix Riccati equation: If matrix A-BKis a stable matrix, such a positive-definite solution Palways exists.The eigenvalue vector Egives the closed-loop poles of A-BK. It is important to note that for certain systems matrix A-BKcannot be made a sta- ble matrix, whatever Kis chosen. In such a case, there does not exist a positive-definite matrix Pfor the matrix Riccati equation. For such a case, the commands K = lqr(A,B,Q,R) [K,P,E] = lqr(A,B,Q,R) do not give the solution. See MATLAB Program 10–18. EXAMPLE 10–10 Consider the system defined by Show that the system cannot be stabilized by the state-feedback control scheme whatever matrix Kis chosen. (Notice that this system is not state controllable.) Define Then = B -1-k 1 01-k 2 2 R A-BK = B -1 01 2 R B 1 0 R Ck 1 k 2 DK=Ck 1 k 2 Du=-Kx B x# 1 x# 2 R = B -1 01 2 RB x 1 x 2 R + B 1 0 R u PA +A* P-PBR -1 B* P+Q=0x#=Ax+BuJ= 3 q 0 (x* Qx+u* Ru)dtu=-Kx Openmirrors.comSection 10–8 / Quadratic Optimal Regulator Systems 799Hence, the characteristic equation becomes The closed-loop poles are located at Since the pole at s=2 is in the right-half s plane, the system is unstable whatever Kmatrix is chosen. Hence, quadratic optimal control techniques cannot be applied to this system. Let us assume that matrices QandRin the quadratic performance index are given by and that we write MATLAB Program 10–18. The resulting MATLAB solution is K = [NaN NaN] (NaN means ‘not a number.’) Whenever the solution to a quadratic optimal control problem does not exist, MATLAB tells us that matrix Kconsists of NaN.Q=B1 00 1R, R=[1]s=-1-k1 , s=2=As+1+k1B(s-2)=0∑s I-A+BK∑=2s+1+k1 0-1+k2 s-22 MATLAB Program 10–18 % ---------- Design of quadratic optimal regulator system ---------- A = [-1 1;0 2]; B = [1;0];Q = [1 0;0 1];R = [1]; K = lqr(A,B,Q,R)Warning: Matrix is singular to working precision.K = NaN NaN % ***** If we enter the command [K,P,E] = lqr(A,B,Q,R), then *****[K,P,E] = lqr(A,B,Q,R)Warning: Matrix is singular to working precision.K = NaN NaN P= -Inf -Inf -Inf -Inf E = -2.0000 -1.4142800 Chapter 10 / Control Systems Design in State Space EXAMPLE 10–11 Consider the system described by where The performance index Jis given by where Assume that the following control uis used. Determine the optimal feedback gain matrix K. The optimal feedback gain matrix Kcan be obtained by solving the following Riccati equation for a positive-definite matrix P: The result is Substituting this Pmatrix into the following equation gives the optimal Kmatrix: Thus, the optimal control signal is given by MATLAB 10–19 also yields the solution to this problem.u=-Kx=-x 1 -x 2 =[1][0 1] B 2 11 1 R =[1 1] K=R -1 B¿ PP= B 2 11 1 R A¿ P+PA -PBR -1 B¿ P+Q=0u=-KxQ= B 1 00 1 R , R=[1]J= 3 q 0 (x¿ Qx+u¿ Ru)dtA= B 0 01 -1 R , B= B 0 1 R x#=Ax+Bu MATLAB Program 10–19 % ---------- Design of quadratic optimal regulator system ---------- A = [0 1;0 -1]; B = [0;1]; Q = [1 0; 0 1]; R = [1]; K = lqr(A,B,Q,R) K = 1.0000 1.0000 Openmirrors.comSection 10–8 / Quadratic Optimal Regulator Systems 801EXAMPLE 10–12 Consider the system given by where The performance index Jis given by where Obtain the positive-definite solution matrix Pof the Riccati equation, the optimal feedback gain matrix K, and the eigenvalues of matrix A-BK. MATLAB Program 10–20 will solve this problem.Q=C1 000 100 01 S, R=[1]J= 3q 0(x¿ Qx+u¿ Ru)dtA=C0 0 -351 0 -270 1 -9S, B=C0 01Sx#=Ax+Bu MATLAB Program 10–20 % ---------- Design of quadratic optimal regulator system ----------A = [0 1 0;0 0 1;-35 -27 -9]; B = [0;0;1];Q = [1 0 0;0 1 0;0 0 1];R = [1];[K,P,E] = lqr(A,B,Q,R) K = 0.0143 0.1107 0.0676 P= 4.2625 2.4957 0.0143 2.4957 2.8150 0.11070.0143 0.1107 0.0676 E = -5.0958 -1.9859 + 1.7110i-1.9859 - 1.7110i802 Chapter 10 / Control Systems Design in State Space Next, let us obtain the response xof the regulator system to the initial condition x(0), where With state feedback u=– Kx, the state equation for the system becomes Then the system, or sys, can be given by sys = ss(A-B*K, eye(3), eye(3), eye(3)) MATLAB Program 10–21 produces the response to the given initial condition. The response curves are shown in Figure 10–38.x#=Ax+Bu=(A-BK) xx(0)= C 1 0 0 S EXAMPLE 10–13 Consider the system shown in Figure 10–39. The plant is defined by the following state-space equations: where The control signal uis given by u=k 1 Ar-x 1 B-Ak 2 x 2 +k 3 x 3 B=k 1 r-Ak 1 x 1 +k 2 x 2 +k 3 x 3 BA= C 0 0 01 0 -20 1 -3 S , B= C 0 0 1 S , C=[1 0 0], D=[0] y=Cx+Du x#=Ax+Bu MATLAB Program 10–21 % Response to initial condition. A = [0 1 0;0 0 1;-35 -27 -9]; B = [0;0;1]; K = [0.0143 0.1107 0.0676]; sys = ss(A-B*K, eye(3),eye(3),eye(3)); t = 0:0.01:8; x = initial(sys,[1;0;0],t); x1 = [1 0 0]*x'; x2 = [0 1 0]*x'; X3 = [0 0 1]*x'; subplot(2,2,1); plot(t,x1); grid xlabel('t (sec)'); ylabel('x1') subplot(2,2,2); plot(t,x2); grid xlabel('t (sec)'); ylabel('x2) subplot(2,2,3); plot(t,x3); grid xlabel('t (sec)'); ylabel('x3') Openmirrors.comSection 10–8 / Quadratic Optimal Regulator Systems 803x1 x2x30.60.811.2 0.4 0.2 0 02468 0246802468−0.2 −3−2−101200.2 −0.2 −0.4 −0.8−0.6 −1 −1.2 t (sec) t (sec)t (sec) Figure 10–38 Response curves toinitial condition. In determining an optimal control law, we assume that the input is zero, or r=0. Let us determine the state-feedback gain matrix K, where such that the following performance index is minimized: where Q= Cq11 0 00 q22 00 0 q33S, R=1, x=Cx1 x2 x3S=Cy y# y$SJ= 3q 0(x¿ Qx+u¿ Ru)dtK=Ck1 k2 k3D +–+–x=Ax+Bu. k2 k3y=Cx k1rux x2 x3y=x1 Figure 10–39 Control system.804 Chapter 10 / Control Systems Design in State Space To get a fast response, q 11 must be sufficiently large compared with q 22 , q 33 ,andR. In this problem, we choose To solve this problem with MATLAB, we use the command K = lqr(A,B,Q,R) MATLAB Program 10–22 yields the solution to this problem.q 11 =100, q 22 =q 33 =1, R=0.01 MATLAB Program 10–22 % ---------- Design of quadratic optimal control system ---------- A = [0 1 0;0 0 1;0 -2 -3]; B = [0;0;1]; Q = [100 0 0;0 1 0;0 0 1]; R = [0.01]; K = Iqr(A,B,Q,R) K = 100.0000 53.1200 11.6711 Next we shall investigate the step-response characteristics of the designed system using the matrix Kthus determined. The state equation for the designed system is and the output equation is To obtain the unit-step response, use the following command: [y,x,t] = step(AA,BB,CC,DD) where AA=A-BK, BB=Bk 1 , CC=C, DD=D MATLAB Program 10–23 produces the unit-step response of the designed system. Figure 10–40 shows the response curves x 1 , x 2 ,andx 3 versus ton one diagram.y=Cx=[1 0 0] C x 1 x 2 x 3 S =(A-BK) x+Bk 1 r =Ax+BA-Kx+k 1 rB x#=Ax+Bu Openmirrors.comSection 10–8 / Quadratic Optimal Regulator Systems 805MATLAB Program 10–23 % ---------- Unit-step response of designed system ----------A = [0 1 0;0 0 1;0 -2 -3]; B = [0;0;1]C = [1 0 0];D = [0];K = [100.0000 53.1200 11.6711];k1 = K(1); k2 = K(2); k3 = K(3); % ***** Define the state matrix, control matrix, output matrix, % and direct transmission matrix of the designed systems as AA,% BB, CC, and DD ***** AA = A - B*K; BB = B*k1;CC = C;DD = D;t = 0:0.01:8;[y,x,t] = step (AA,BB,CC,DD,1,t); plot(t,x) gridtitle('Response Curves x1, x2, x3, versus t')xlabel('t Sec')ylabel('x1,x2,x3')text(2.6,1.35,'x1')text(1.2,1.5,'x2')text(0.6,3.5,'x3') Response Curves x1,x2,x3 versus tx1,x2,x35 –214 2 0 –13 t Sec05 2 3 1 48 6 7x3 x2x1 Figure 10–40 Response curves x1 versus t, x2versus t, andx3versus t.806 Chapter 10 / Control Systems Design in State Space Concluding Comments on Optimal Regulator Systems 1.Given any initial state x(t 0 ),the optimal regulator problem is to find an allowable control vector u(t)that transfers the state to the desired region of the state space and for which the performance index is minimized. For the existence of an optimal control vector u(t),the system must be completely state controllable. 2.The system that minimizes (or maximizes, as the case may be) the selected performance index is, by definition, optimal. Although the controller may have nothing to do with “optimality” in many practical applications, the important point is that the design based on the quadratic performance index yields a stable control system. 3.The characteristic of an optimal control law based on a quadratic performance index is that it is a linear function of the state variables, which implies that we need to feed back all state variables.This requires that all such variables be available for feedback. If not all state variables are available for feedback, then we need to employ a state observer to estimate unmeasurable state variables and use the es- timated values to generate optimal control signals. Note that the closed-loop poles of the system designed by the use of the quadratic optimal regulator approach can be found from Since these closed-loop poles correspond to the desired closed-loop poles in the pole-placement approach, the transfer functions of the observer controllers can be obtained from either Equation (10–74) if the observer is of full-order type or Equation (10–108) if the observer is of minimum-order type. 4.When the optimal control system is designed in the time domain, it is desirable to investigate the frequency-response characteristics to compensate for noise effects. The system frequency-response characteristics must be such that the system at- tenuates highly in the frequency range where noise and resonance of components are expected. (To compensate for noise effects, we must in some cases either modify the optimal configuration and accept suboptimal performance or modify the performance index.) 5.If the upper limit of integration in the performance index Jgiven by Equation (10–114) is finite, then it can be shown that the optimal control vector is still a linear function of the state variables, but with time-varying coefficients. (Therefore, the determination of the optimal control vector involves that of optimal time- varying matrices.) 10–9 ROBUST CONTROL SYSTEMS Suppose that given a control object (i.e., a system with a flexible arm) we wish to de- sign a control system. The first step in the design of a control system is to obtain a mathematical model of the control object based on the physical law. Quite often the model may be nonlinear and possibly with distributed parameters. Such a model may be difficult to analyze. It is desirable to approximate it by a linear constant-coefficient system that will approximate the actual object fairly well. Note that even though the∑s I-A+BK∑=0 Openmirrors.commodel to be used for design purposes may be a simplified one, it is necessary that such a model must include any intrinsic character of the actual object.Assuming that we canget a model that approximates the actual system quite well, we must get a simplifiedmodel for the purpose of designing the control system that will require a compensatorof lowest order possible. Thus, a model of a control object (whatever it may be) willprobably include an error in the modeling process. Note that in the frequency-responseapproach to control systems design, we use phase and gain margins to take care ofthe modeling errors. However, in the state-space approach, which is based on the dif-ferential equations of the plant dynamics, no such “margins” are involved in thedesign process. Since the actual plant differs from the model used in the design, a question arises whether the controller designed using a model will work satisfactorily with the actu-al plant. To ensure that it will do so, robust control theory has been developed sincearound 1980. Robust control theory uses the assumption that the models we use in designing con- trol systems have modeling errors.We shall present an introduction to this theory in thissection. Basically, the theory assumes that there is an uncertainty or error between theactual plant and its mathematical model and includes such uncertainty or error in thedesign process of the control system. Systems designed based on the robust control theory will possess the following properties: (1)Robust stability . The control system designed is stable in the presence of perturbation. (2)Robust performance . The control system exhibits predetermined response characteristics in the presence of perturbation. This theory requires considerations based on frequency-response analysis and time- domain analysis. Because of the mathematical complications associated with robust con-trol theory, detailed discussion of robust control theory is beyond the scope of the seniorengineering student. In this section, only introductory discussion of robust control the-ory is presented. Uncertain Elements in Plant Dynamics. The term uncertainty refers to the dif- ferences or errors between the model of the plant and the actual plant. Uncertain elements that may appear in practical systems may be classified as struc- tured uncertainty and unstructured uncertainty. An example of structured uncertainty is any parametric variation in the plant dynamics, such as variations in poles and zerosof the plant transfer function. Examples of unstructured uncertainty include frequency-dependent uncertainty, such as high-frequency modes that we normally neglect in mod-eling plant dynamics. For example, in the modeling of a flexible-arm system, the modelmay include a finite number of modes of oscillation.The modes of oscillation that are notincluded in the modeling behave as uncertainty of the system. Another example of un-certainty occurs in the linearization of a nonlinear plant. If the actual plant is nonlinearand its model is linear, then the difference acts as unstructured uncertainty. In this section we consider the case where the uncertainty is unstructured. In addi- tion we assume that the plant involves only one uncertainty. (Some plants may involvemultiple uncertain elements.) Section 10–9 / Robust Control Systems 807In the robust control theory, we define unstructured uncertainty as . Since the exact description of is unknown, we use an estimate of (as to the magnitude and phase characteristics) and use this estimate in the design of the controller that sta- bilizes the control system. Stability of a system with unstructured uncertainty can then be examined by use of the small gain theorem to be given following the definition of the norm. Norm. The norm of a stable single-input–single-output system is the largest possible amplification factor of the steady-state response to sinusoidal excitation. For a scalar (s), gives the maximum value of . It is called the norm. See Figure 10–41. In robust control theory we measure the magnitude of the transfer function by the norm. Assume that the transfer function is proper and stable. [Note that a transfer function is called proper if is limited and definite. If = 0, it is called strictly proper.] The norm of is defined by means the maximum singular value of . ( means .) Note that the singular value of a transfer function is defined by where is the ith largest eigenvalue of and it is always a non-negative real value. By making smaller, we make the effect of input won the output zsmaller. It is frequently the case that instead of using the maximum singular value , we use the inequality and limit the magnitude of (s)by .To make the magnitude of small, we choose a small and require that . 7£7 q 6g g7£7 q g £7£7 q 6g7£7 q 7£7 q £*£ l i (£*£)s i (£)=2l i (£*£) £s max s [£(jv)] s [£(jv)]7£7 q =s [£(jv)]£(s) H q £(q) £(q) £(s)£(s) H q H q /H20895£(jv)/H20895 7£7 q £H q H /H11557 H q ¢(s) ¢(s)¢(s) 808 Chapter 10 / Control Systems Design in State Space F(s) ||F|| /H11009 |F(jv)| in db v z v Figure 10–41 Bode diagram and the norm .7£7 q H q Openmirrors.comSmall-Gain Theorem. Consider the closed-loop system shown in Figure 10–42. In the figure and M(s) are stable and proper transfer functions. The small-gain theorem states that if then this closed-loop system is stable. That is, if the norm of M(s) is smaller than 1, this closed-loop system is stable. This theorem is an extension of the Nyquiststability criterion. It is important to note that the small-gain theorem gives a sufficient condition for sta- bility. That is, a system may be stable even if it does not satisfy this theorem. However,if a system satisfies the small-gain theorem, it is always stable. System with Unstructured Uncertainty. In some cases an unstructured uncer- tainty error may be considered multiplicative such that where is the true plant dynamics and Gis the model plant dynamics. In other cases an unstructured uncertainty error may be considered additive such that In either case we assume that the norm of or is bounded such thatwhere and are positive constants. EXAMPLE 10–14 Consider a control system with unstructured multiplicative uncertainty. We shall consider robust stability and robust performance of the system. (A system with unstructured additive uncertain-ty will be discussed in Problem A–10–18 .) Robust Stability. Let us define true plant dynamics G= model of plant dynamics unstructured multiplicative uncertainty We assume that is stable and its upper bound is known.We also assume that and Gare related by =G(I +¢m) G/H33522G/H33522¢m¢m=G/H33522=ga gm7¢m76gm, 7¢a76ga¢a ¢mG/H33522=G+¢aG/H33522G/H33522=G(1+¢m)¢(s) Hq7¢(s)M(s)7q61¢(s) Section 10–9 / Robust Control Systems 809/H9004(s) M(s)Figure 10–42 Closed-loop system.Consider the system shown in Figure 10–43(a). Let us examine the transfer function between point Aand point B. Notice that Figure 10–43(a) can be redrawn as shown in Figure 10-43(b).The transfer function between point Aand point Bcan be given by Define (10–121) Using Equation (10–121) we can redraw Figure 10–43(b) as Figure 10–43(c).Applying the small- gain theorem to the system consisting of and Tas shown in Figure 10–43(c), we obtain the condition for stability to be (10–122) In general, it is impossible to precisely model Therefore, let us use a scalar transfer function such that where is the largest singular value of . Consider, instead of Inequality (10–122), the following inequality: (10–123) If Inequality (10–123) holds true, Inequality (10–122) will always be satisfied. By making the norm of to be less than 1, we obtain the controller Kthat will make the system stable. Suppose that we cut the line at point Ain Figure 10–43(a). Then we obtain Figure 10–43(d). Replacing by , we obtain Figure 10–43(e). Redrawing Figure 10–43(e), we obtain Figure 10–43(f). Figure 10–43(f) is called a generalized plant diagram . Referring to Equation (10–121), Tis given by (10–124) Then Inequality (10–123) can be rewritten as (10–125) Clearly, for a stable plant model G(s), K(s)= 0 will satisfy Inequality (10–125). However, K(s)= 0 is not the desirable transfer function for the controller. To find an acceptable trans- fer function for K(s) , we may add another condition—for example, that the resulting system will have robust performance such that the system output follows the input with minimum error, or another reasonable condition. In what follows we shall obtain the condition for robust performance. ß W m K(s)G(s) 1+K(s)G(s) ß q 61T=KG 1+KGW m I ¢ m W m T H q 7W m T7 q 61¢ m (jv) s {¢ m (jv)}s {¢ m (jv)}6/H20895W m (jv)/H20895W m (jv)¢ m .7¢ m T7 q 61¢ m (1+KG) -1 KG =TKG 1+KG=(1+KG) -1 KG 810 Chapter 10 / Control Systems Design in State Space Openmirrors.comSection 10–9 / Robust Control Systems 811K (f)w uz yP Gw u y KWmI (e)yz ++–/H9004m TBA (c)G K/H9004m (d)yuBzw A ++ –/H9004m K Gyu +−A B G K/H9004m (a) (b)yuA ++ –B Figure 10–43 (a) Block diagram of a system with unstructured multiplicative uncertainty;(b)–(d) successive modifications of the block diagram of (a);(e) block diagram showing a generalized plant with unstructured multiplicative uncertainty;(f) generalized plant diagram.Robust Performance. Consider the system shown in Figure 10–44. Suppose that we want the output y(t) to follow the input r(t) as closely as possible, or we wish to have Since the transfer function Y(s)/R(s) is we have Define where Sis commonly called the sensitivity function and Tdefined by Equation (10–124) is called the complementary sensitivity function. In this robust performance problem we want to make the norm of Ssmaller than the desired transfer function or which can be written as (10–126) Combining Inequalities (10–123) and (10–126), we get where T+S=1, or (10–127) Our problem then becomes to find K(s) that will satisfy Inequality (10–127). Note that depend- ing on the chosen W m (s)andW s (s) there may be many K(s) that satisfy Inequality (10–127), or may be no K(s) that satisfies Inequality (10–127). Such a robust control problem using Inequality (10–127) is called a mixed-sensitivity problem. Figure 10–45(a) is a generalized plant diagram, where two conditions (robust stability and ro- bust performance) are specified.A simplified version of this diagram is shown in Figure 10–45(b). ∑ W m (s) K(s)G(s) 1+K(s)G(s) W s (s)1 1+K(s)G(s) ∑ q 61 g W m T W s S g q 617W s S7 q 617S7 q 6W s-1 W s -1 H q 1 1+KG=SE(s) R(s)=R(s) -Y(s) R(s)=1-Y(s) R(s)=1 1+KGY(s) R(s) = KG 1 + KGlim tSq [r(t) -y(t)] = lim tSq e(t) S0 812 Chapter 10 / Control Systems Design in State Space re y K(s) G(s) +– Figure 10–44 Closed-loop system. Openmirrors.comSection 10–9 / Robust Control Systems 813K (b)w uz yPGw u y KWmI WsI (a)yz2z1 z ++– Figure 10–45 (a) Generalized plant diagram; (b) simplfied version of the generalizedplant diagram shown in (a). Finding Transfer Function z(s)/w(s) from a Generalized Plant Diagram. Consider the generalized plant diagram shown in Figure 10–46. In this diagram w(s) is the exogenous disturbance and u(s) is the manipulated vari- able. z(s) is the controlled variable and y(s) is the observed variable. Consider this control system consisting of the generalized plant P(s) and the con- troller K(s) .The equation that relates the outputs z(s) andy(s) and the inputs w(s) and u(s) of the generalized plant P(s) is The equation that relates u(s) andy(s) is given by u(s)=K(s)y(s) Define the transfer function that relates the controlled variable z(s) to the exogenous disturbance w(s) as (s). Then z(s) =£ (s)w(s)£Bz(s) y(s)R=BP11 P21P12 P22RBw(s) u(s)RNote that can be determined as follows: Since z(s)=P 11 w(s)+P 12 u(s) y(s)=P 21 w(s)+P 22 u(s) u(s)=K(s)y(s) we obtain y(s)=P 21 w(s)+P 22 K(s)y(s) Hence or Therefore, Hence, (10–128) EXAMPLE 10–15 Let us determine the Pmatrix in the generalized plant diagram of the control system considered in Example 10–14. We derived Inequality (10–125) for the control system to be robust stable. Rewriting Inequality (10–125), we have (10–129) g W m KG 1+KG g q 61£(s)=P 11 +P 12 K(s)[I -P 22 K(s)] -1 P 21 ={P 11 +P 12 K(s)[I -P 22 K(s)] -1 P 21 }w(s)z(s) =P 11 w(s) +P 12 K(s)[I -P 22 K(s)] -1 P 21 w(s) y(s) =[I-P 22 K(s)] -1 P 21 w(s)[I-P 22 K(s)]y(s) =P 21 w(s) £(s) 814 Chapter 10 / Control Systems Design in State Space K(s)P(s) w uz yP 11 P 21 P 12 P 22 Figure 10–46 A generalized plant diagram. Openmirrors.comIf we define (10–130) then Inequality (10–129) can be written as Referring to Equation (10–128), rewritten as notice that if we choose the generalized plant Pmatrix as (10–131) Then we obtain which is exactly the same as in Equation (10–130). We derived in Example 10–14 that if we wished to have the output yfollow the input ras close as possible, we needed to make the norm of (s), where (10–132) less than 1. [See Inequality (10–126).] Note that the controlled variable zis related to the exogenous disturbance wby and referring to Equation (10–128) Notice that if we choose the Pmatrix as (10–133) then we obtain which is the same as in Equation (10–132). £2 =Ws c1 1+KGd =Ws c1-KG 1+KGd =Ws-WsKG(I +KG)-1 £= P11+P12K(I -P22K)-1P21P=cWs-WsG I -Gd£(s)=P11+P12K(I -P22K)-1P21z=£ (s)w£2=Ws I+KG£2 Hq£1 =WmKG(I +KG)-1£= P11+P12K(I -P22K)-1P21P=c0WmG I-Gd£= P11+P12K(I -P22K)-1P217£17q61£1=WmKG 1+KG Section 10–9 / Robust Control Systems 815If both the robust stability and robust performance conditions are required, the control sys- tem must satisfy the condition given by Inequality (10–127), rewritten as (10–134) For the Pmatrix, we combine Equations (10–133) and (10–131) and get (10–135) If we construct P(s) as given by Equation (10–135), then the problem of designing a control system to satisfy both robust stability and robust performance conditions can be formulated by using the generalized plant represented by Equation (10–135). As mentioned earlier, such a problem is called a mixed-sensitivity problem. By using the generalized plant given by Equation (10–135) we are able to determine the controller K(s) that satisfies Inequality (10–134). The generalized plant diagram for the system considered in Example 10–14 becomes as shown in Figure 10–47. HInfinity Control Problem. To design a controller Kof a control system to sat- isfy various stability and performance specifications, we utilize the concept of the gen- eralized plant. As mentioned earlier a generalized plant is a linear model consisting of a model of the plant and weighting functions corresponding to the specifications for the required performance. Referring to the generalized plant shown in Figure 10–48, the Hinfinity control problem is a problem to design a controller Kthat will make the norm of the transfer function from the exogenous disturbance wto the controlled variable zless than a specified value.H q P= C W s 0 I-W s G W m G -G S∑ W m KG 1+KG W s 1 1+KG ∑ 61 816 Chapter 10 / Control Systems Design in State Space Kw u z 2 yO IW m G −G z 1 W s −W s G Figure 10–47 Generalized plant of the system discussed in Example 10–15. Openmirrors.comThe reason to use generalized plants, rather than individual block diagrams of con- trol systems, is that a number of control systems with uncertain elements have beendesigned using generalized plants and, consequently, established design approachesusing such plants are available. Note that any weighting function, such as W(s) , is an important parameter to in- fluence the resulting controller K(s) . In fact, the goodness of the resulting designed system depends on the choice of the weighting function or functions used in the de-sign process. Note that the controller that is the solution to the Hinfinity control problem is com- monly called the Hinfinity controller. Solving Robust Control Problems. There are three established approaches to solve robust control problems. They are Solve robust control problems by deriving the Riccati equations and solving them. 2.Solve robust control problems by using the linear matrix inequality approach. 3.Solve robust control problems that involve structural uncertainties by using the analysis and synthesis approach. Solving robust control problems by use of any of the above methods requires a broad mathematical background. In this section we have presented only an introduction to the robust control theory. Solving any robust control problem requires mathematical background beyond thescope of the senior engineering student. Therefore, an interested reader may take agraduate-level control course at an established college or university and study this sub-ject in detail. EXAMPLE PROBLEMS AND SOLUTIONS A–10–1. Consider the system defined by Suppose that this system is not completely state controllable.Then the rank of the controllability matrix is less than n,or (10–136) rankCB /H21752 AB /H21752 p /H21752 An-1 BD=q6nx#=Ax+Bumm Example Problems and Solutions 817Kw uz yGeneralized plant Figure 10–48 A generalized plantdiagram.This means that there are qlinearly independent column vectors in the controllability matrix. Let us define such qlinearly independent column vectors as f 1 ,f 2 ,p,f q .Also, let us choose n-q additional n-vectors v q+1 ,v q+2 ,p,v n such that is of rank n.By using matrix Pas the transformation matrix, define Show that can be given by where A 11 is a q*q matrix, A 12 is a q*(n-q) matrix, A 22 is an (n-q)*(n-q) matrix, and 0is an (n-q)*q matrix. Show also that matrix can be given by where B 11 is a q*1 matrix and 0is an (n-q)*1 matrix. Solution. Notice that or (10–137) Also, (10–138) Since we have qlinearly independent column vectors f 1 ,f 2 ,p,f q ,we can use the Cayley–Hamilton theorem to express vectors Af 1 ,Af 2 ,p,Af q in terms of these qvectors. That is, Af q =a 1q f 1 +a 2q f 2 +p+a qq f q /H11080/H11080/H11080Af 2 =a 12 f 1 +a 22 f 2 +p+a q2 f q Af 1 =a 11 f 1 +a 21 f 2 +p+a q1 f q B=PB ˆ =Cf 1 /H21752f 2 /H21752p/H21752f q /H21752v q+1 /H21752p/H21752v n D A ˆ CAf 1 /H21752Af 2 /H21752p/H21752Af q /H21752Av q+1 /H21752p/H21752Av n DAP =PA ˆ B ˆ = c B 11 0 d B ˆ A ˆ = c A 11 0 A 12 A 22 d A ˆ P -1 AP =A ˆ , P -1 B=B ˆ P=Cf 1 /H21752f 2 /H21752p/H21752f q /H21752v q+1 /H21752v q+2 /H21752p/H21752v n D 818 Chapter 10 / Control Systems Design in State Space Openmirrors.comExample Problems and Solutions 819Hence, Equation (10–137) may be written as follows: Define Then Equation (10–137) can be written as =Cf1/H21752f2/H21752p/H21752fq/H21752vq+1/H21752p/H21752vnDcA11 0 A12 A22dCAf1/H21752Af2/H21752p/H21752Afq/H21752Avq+1/H21752p/H21752AvnD Eaq+1q+1 /H11080 /H11080/H11080 a nq+1p paq+1n /H11080 /H11080/H11080 a nnU=A22 E0 /H11080/H11080/H11080 0p p0 /H11080/H11080/H11080 0 U=A21=(n-q)*q zero matrix Fa1q+1 a2q+1 /H11080 /H11080/H11080 a qq+1p p pa1n a2n /H11080 /H11080/H11080 a qnV=A12 Fa11 a21 /H11080 /H11080/H11080 a q1pp pa 1q a2q /H11080 /H11080/H11080 a qqV=A11=Cf1/H21752f2/H21752p/H21752fq/H21752vq+1/H21752p/H21752vnD a11 a21 /H11080 /H11080/H11080 a q1 0 /H11080/H11080/H11080 0p p p p pa 1q a2q /H11080 /H11080/H11080 a qq 0 /H11080/H11080/H11080 0a 1q+1 a2q+1 /H11080 /H11080/H11080 a qq+1 aq+1q+1 /H11080 /H11080/H11080 a nq+1p p p p pa1n a2n /H11080 /H11080/H11080 a qn aq+1n /H11080 /H11080/H11080 a nnCAf1/H21752Af2/H21752p/H21752Afq/H21752Avq+1/H21752p/H21752AvnDThus, Hence, Next, referring to Equation (10–138), we have (10–139) Referring to Equation (10–136), notice that vector Bcan be written in terms of qlinearly independent column vectors f 1 ,f 2 ,p,f q .Thus, we have Consequently, Equation (10–139) may be written as follows: Thus, where A–10–2. Consider a completely state controllable system Define the controllability matrix as M: M=CB /H21752 AB /H21752 p /H21752 A n-1 BDx#=Ax+BuB 11 = F b 11 b 21 /H11080 /H11080 /H11080 b q1 V B ˆ = c B 11 0 d b 11 f 1 +b 21 f 2 +p+b q1 f q =Cf 1 /H21752f 2 /H21752p/H21752f q /H21752v q+1 /H21752p/H21752v n Db 11 b 21 /H11080 /H11080 /H11080 b q1 0 /H11080 /H11080 /H11080 0B=b 11 f 1 +b 21 f 2 +p+b q1 f q B=Cf 1 /H21752f 2 /H21752p/H21752f q /H21752v q+1 /H21752p/H21752v n D B ˆ P -1 AP =A ˆ = c A 11 0 A 12 A 22 d AP =P c A 11 0 A 12 A 22 d 820 Chapter 10 / Control Systems Design in State Space Openmirrors.comShow that where a1,a2,p,anare the coefficients of the characteristic polynomial Solution. Let us consider the case where n=3. We shall show that (10–140) The left-hand side of Equation (10–140) is The right-hand side of Equation (10–140) is (10–141) The Cayley–Hamilton theorem states that matrix Asatisfies its own characteristic equation or, in the case of n=3, (10–142) Using Equation (10–142), the third column of the right-hand side of Equation (10–141) becomes Thus, Equation (10–141) becomes Hence, the left-hand side and the right-hand side of Equation (10–140) are the same. We have thus shown that Equation (10–140) is true. Consequently, The preceding derivation can be easily extended to the general case of any positive integer n. A–10–3. Consider a completely state controllable system Define M=CB /H21752 AB /H21752 p /H21752 An-1 BDx#=Ax+BuM-1 AM =C0 100 01-a 3 -a2 -a1SCB/H21752AB/H21752A2 BDC0 100 01-a 3 -a2 -a1S=CAB/H21752A2 B/H21752A3 BD-a3 B-a2 AB -a1 A2 B=A-a3 I-a2 A-a1 A2BB=A3 BA3+a1 A2+a2 A+a3 I=0CB/H21752AB/H21752A2 BDC0 100 01-a 3 -a2 -a1S=CAB/H21752A2 B/H21752-a3 B-a2 AB -a1 A2 BDAM =ACB /H21752 AB /H21752 A2 BD=CAB /H21752 A2 B /H21752 A3 BDAM =MC0 100 01-a 3 -a2 -a1S∑s I-A∑=sn+a1 sn-1+p+an-1 s+anM-1 AM =G0 10 /H11080/H11080/H11080 00 01 /H11080/H11080/H11080 0p pp p0 00 /H11080/H11080/H11080 1-a n -an-1 -an-2 /H11080 /H11080/H11080 -a 1W Example Problems and Solutions 821822 Chapter 10 / Control Systems Design in State Space and where the a i ’s are coefficients of the characteristic polynomial Define also Show that Solution. Let us consider the case where n=3. We shall show that (10–143) Referring to Problem A–10–2 , we have Hence, Equation (10–143) can be rewritten as Therefore, we need to show that (10–144) The left-hand side of Equation (10–144) is C 0 1 00 0 1-a 3 -a 2 -a 1 SC a 2 a 1 1a 1 1 01 0 0 S = C -a 3 0 00 a 1 10 1 0 SC 0 1 00 0 1-a 3 -a 2 -a 1 S W=W C 0 0 -a 3 1 0 -a 2 0 1 -a 1 S W -1 C 0 1 00 0 1-a 3 -a 2 -a 1 S W= C 0 0 -a 3 1 0 -a 2 0 1 -a 1 S M -1 AM = C 0 1 00 0 1-a 3 -a 2 -a 1 S T -1 AT =(MW ) -1 A(MW )=W -1 (M -1 AM) W= C 0 0 -a 3 1 0 -a 2 0 1 -a 1 S T -1 AT = G 0 0 /H11080 /H11080 /H11080 0 -a n 1 0 /H11080 /H11080 /H11080 0 -a n-1 0 1 /H11080 /H11080 /H11080 0 -a n-2 p p p p0 0 /H11080 /H11080 /H11080 1 -a 1 W , T -1 B= G 0 0 /H11080 /H11080 /H11080 0 1 W T=MW∑s I-A∑=s n +a 1 s n-1 +p+a n-1 s+a n W= G a n-1 a n-2 /H11080 /H11080 /H11080 a 1 1a n-2 a n-3 /H11080 /H11080 /H11080 1 0p p p pa 1 1 /H11080 /H11080 /H11080 0 01 0 /H11080 /H11080 /H11080 0 0 W Openmirrors.comExample Problems and Solutions 823The right-hand side of Equation (10–144) is Clearly, Equation (10–144) holds true. Thus, we have shown thatNext, we shall show that (10–145) Note that Equation (10–145) can be written as Noting that we have The derivation shown here can be easily extended to the general case of any positive integer n. A–10–4. Consider the state equation where The rank of the controllability matrix M, is 2.Thus, the system is completely state controllable.Transform the given state equation into the controllable canonical form. Solution. Since =s 2+2s+1=s2+a1 s+a2 ∑s I-A∑=2s-1 4-1 s+32=(s-1)(s +3)+4M=CB/H21752ABD=B0 22 -6RA=B1 -41 -3R, B=B0 2Rx#=Ax+BuT-1 B=C0 01STC001 S=CB/H21752AB/H21752A2 BDCa2 a1 1a1 1 01 00SC001 S=CB/H21752AB/H21752A2 BDC1 00S=BB=TC0 01S=MWC0 01ST-1 B=C0 01ST-1 AT =C0 0 -a31 0 -a20 1 -a1SCa2 a1 1a1 1 01 00SC00 -a 31 0 -a20 1 -a1S=C-a3 0 00 a1 10 10S824 Chapter 10 / Control Systems Design in State Space we have Define where Then and Define Then the state equation becomes Since and we have which is in the controllable canonical form. A–10–5. Consider a system defined by where A= B 0 -21 -3 R , B= B 0 2 R , C=[1 0] y=Cx x#=Ax+Bu B x ˆ # 1 x ˆ # 2 R = B 0 -11 -2 RB x ˆ 1 x ˆ 2 R + B 0 1 R uT -1 B= B 0.5 0.50 0.5 RB 0 2 R = B 0 1 R T -1 AT = B 0.5 0.50 0.5 RB 1 -41 -3 RB 2 -20 2 R = B 0 -11 -2 R x ˆ # =T -1 ATx ˆ +T -1 Bux=Tx ˆ T -1 = B 0.5 0.50 0.5 R T= B 0 22 -6 RB 2 11 0 R = B 2 -20 2 R M= B 0 22 -6 R , W= B 2 11 0 R T=MWa 1 =2, a 2 =1 Openmirrors.comExample Problems and Solutions 825The characteristic equation of the system is The eigenvalues of matrix Aare–1and–2. It is desired to have eigenvalues at –3and –5by using a state-feedback control u=– Kx. Determine the necessary feedback gain matrix Kand the control signal u. Solution. The given system is completely state controllable, since the rank of is 2. Hence, arbitrary pole placement is possible. Since the characteristic equation of the original system is we have The desired characteristic equation is Hence,It is important to point out that the original state equation is not in the controllable canonical form, because matrix Bis not Hence, the transformation matrix Tmust be determined. Hence, Referring to Equation (10–13), the necessary feedback gain matrix is given by Thus, the control signal ubecomes u=-Kx=-[6.5 2.5]Bx1 x2R =C15-2/H217528-3DB0.5 00 0.5R=[6.5 2.5] K=Ca2-a2/H21752a1-a1D T-1T-1=B0.5 00 0.5RT=MW =CB/H21752ABDBa1 11 0R=B022 -6RB3 11 0R=B200 2RB0 1Ra1=8, a2=15(s+3)(s +5)=s2+8s+15=s2+a1 s+a2=0a1=3, a2=2s2+3s+2=s2+a1 s+a2=0M=CB/H21752ABD=B0 22 -6R∑s I-A∑=2s 2-1 s+32=s2+3s+2=(s+1)(s +2)=0826 Chapter 10 / Control Systems Design in State Space A–10–6. A regulator system has a plant Define state variables as By use of the state-feedback control u=– Kx, it is desired to place the closed-loop poles at Obtain the necessary state-feedback gain matrix Kwith MATLAB. Solution. The state-space equations for the system become Hence, (Note that, for the pole placement, matrices Cand Ddo not affect the state-feedback gain matrix K.) Two MATLAB programs for obtaining state-feedback gain matrix Kare given in MATLAB Programs 10–24 and 10–25. C=[1 0 0], D=[0] A= C 0 0 -61 0 -110 1 -6 S , B= C 0 0 10 S y=[1 0 0] C x 1 x 2 x 3 S +0u C x# 1 x# 2 x# 3 S = C 0 0 -61 0 -110 1 -6 SC x 1 x 2 x 3 S + C 0 0 10 S us=-2+j213 , s=-2-j213 , s=-10 x 3 =x# 2 x 2 =x# 1 x 1 =yY(s) U(s)=10 (s+1)(s +2)(s +3) MATLAB Program 10–24 A = [0 1 0;0 0 1;-6 -11 -6]; B = [0;0;10]; J = [-2+j*2*sqrt(3) -2-j*2*sqrt(3) -10]; K = acker(A,B,J) K = 15.4000 4.5000 0.8000 Openmirrors.comExample Problems and Solutions 827A–10–7. Consider a completely observable system Define the observability matrix as N: Show that (10–146) where a1,a2,p,anare the coefficients of the characteristic polynomial Solution. Let us consider the case where n=3. Then Equation (10–146) can be written as (10–147) Equation (10–147) may be rewritten as (10–148) We shall show that Equation (10–148) holds true. The left-hand side of Equation (10–148) is (10–149) N*A=CC CA CA2S A=CCA CA2 CA3SN* A=C0 0 -a31 0 -a20 1 -a1S N*N*A(N*)-1=C0 0 -a31 0 -a20 1 -a1S∑s I-A∑=sn+a1 sn-1+p+an-1 s+anN* A(N*)-1=G0 0 /H11080/H11080/H11080 0 -a n1 0 /H11080/H11080/H11080 0 a n-10 1 /H11080/H11080/H11080 0 -a n-2p p p p0 0 /H11080/H11080/H11080 1 -a 1WN=CC*/H21752A*C*/H21752p/H21752(A*)n-1 C*D y=Cx x#=AxMATLAB Program 10–25 A = [0 1 0;0 0 1; -6 -11 -6]; B = [0;0;10];J = [-2+j*2*sqrt(3) -2-J*2*Sqrt(3) -10];K = place(A,B,J)place: ndigits= 15 K = 15.4000 4.5000 0.8000828 Chapter 10 / Control Systems Design in State Space The right-hand side of Equation (10–148) is (10–150) The Cayley–Hamilton theorem states that matrix Asatisfies its own characteristic equation, or Hence, Thus, the right-hand side of Equation (10–150) becomes the same as the right-hand side of Equation (10–149). Consequently, which is Equation (10–148). This last equation can be modified to The derivation presented here can be extended to the general case of any positive integer n. A–10–8. Consider a completely observable system defined by (10–151) (10–152) Define and where the a’s are coefficients of the characteristic polynomial Define also Q=(WN*) -1 ∑s I-A∑=s n +a 1 s n-1 +p+a n-1 s+a n W= G a n-1 a n-2 /H11080 /H11080 /H11080 a 1 1a n-2 a n-3 /H11080 /H11080 /H11080 1 0p p p pa 1 1 /H11080 /H11080 /H11080 0 01 0 /H11080 /H11080 /H11080 0 0 W N=CC*/H21752A* C*/H21752p/H21752(A*) n-1 C*D y=Cx+Du x#=Ax+BuN*A(N*) -1 = C 0 0 -a 3 1 0 -a 2 0 1 -a 1 S N*A= C 0 0 -a 3 1 0 -a 2 0 1 -a 1 S N*-a 1 CA 2 -a 2 CA -a 3 C=CA 3 A 3 +a 1 A 2 +a 2 A+a 3 I=0 = C CA CA 2 -a 3 C-a 2 CA -a 1 CA 2 S C 0 0 -a 3 1 0 -a 2 0 1 -a 1 S N*= C 0 0 -a 3 1 0 -a 2 0 1 -a 1 SC C CA CA 2 S Openmirrors.comExample Problems and Solutions 829Show that where the bk’s (k=0, 1, 2, p,n)are those coefficients appearing in the numerator of the transfer function when C(sI-A)–1B+D is written as follows: where D=b0. Solution. Let us consider the case where n=3. We shall show that (10–153) Note that, by referring to Problem A–10–7 , we have Hence, we need to show that or (10–154) WC0 0 -a31 0 -a20 1 -a1S =C0 100 01-a 3 -a2 -a1SWWC0 0 -a31 0 -a20 1 -a1S W-1=C0 100 01-a 3 -a2 -a1S(WN*) A(WN*)-1=WCN* A(N*)-1D W-1=WC0 0 -a31 0 -a20 1 -a1S W-1Q-1 AQ =(WN*) A(WN*)-1=C0 100 01-a 3 -a2 -a1SC(s I-A)-1 B+D=b0 sn+b1 sn-1+p+bn-1 s+bn sn+a1 sn-1+p+an-1 s+anQ-1 B=Fbn-an b0 bn-1-an-1 b0 /H11080 /H11080/H11080 b 1-a1 b0VCQ =[0 0p 0 1]Q-1 AQ =G0 10 /H11080/H11080/H11080 00 01 /H11080/H11080/H11080 0p pp p0 00 /H11080/H11080/H11080 1-a n -an-1 -an-2 /H11080 /H11080/H11080 -a 1W830 Chapter 10 / Control Systems Design in State Space The left-hand side of Equation (10–154) is The right-hand side of Equation (10–154) is Thus, we see that Equation (10–154) holds true. Hence, we have proved Equation (10–153). Next we shall show that or Notice that Hence, we have shown that Next define Then Equation (10–151) becomes (10–155) and Equation (10–152) becomes (10–156) Referring to Equation (10–153) ,Equation (10–155) becomes C x ˆ # 1 x ˆ # 2 x ˆ # 3 S = C 0 1 00 0 1-a 3 -a 2 -a 1 SC x ˆ 1 x ˆ 2 x ˆ 3 S + C g 3 g 2 g 1 S uy=CQx ˆ +Dux ˆ # =Q -1 AQx ˆ +Q -1 Bux=Qx ˆ [0 0 1]=C(WN* ) -1 =CQ =[1 0 0] C C CA CA 2 S =C[0 0 1](WN* )=[0 0 1] C a 2 a 1 1a 1 1 01 0 0 SC C CA CA 2 S C(WN*) -1 =[0 0 1]CQ =[0 0 1]= C -a 3 0 00 a 1 10 1 0 SC 0 1 00 0 1-a 3 -a 2 -a 1 S W= C 0 1 00 0 1-a 3 -a 2 -a 1 SC a 2 a 1 1a 1 1 01 0 0 S = C -a 3 0 00 a 1 10 1 0 S W C 0 0 -a 3 1 0 -a 2 0 1 -a 1 S = C a 2 a 1 1a 1 1 01 0 0 SC 0 0 -a 3 1 0 -a 2 0 1 -a 1 S Openmirrors.comExample Problems and Solutions 831where The transfer function G(s) for the system defined by Equations (10–155) and (10–156) is Noting that we have Note that D=b0.Since we have Hence, Thus, we have shown that Note that what we have derived here can be easily extended to the case when nis any positive integer. A–10–9. Consider a system defined by y=Cxx#=Ax+BuQ-1 B=Cg3 g2 g1S=Cb3-a3 b0 b2-a2 b0 b1-a1 b0Sg1=b1-a1 b0 ,g2=b2-a2 b0 ,g3=b3-a3 b0=b0 s3+b1 s2+b2 s+b3 s3+a1 s2+a2 s+a3=b0 s3+Ag1+a1 b0Bs2+Ag2+a2 b0Bs+g3+a3 b0 s3+a1 s2+a2 s+a3=g1 s2+g2 s+g3 s3+a1 s2+a2 s+a3+b0G(s) =1 s3+a1 s2+a2 s+a3C1 s s2DCg3 g2 g1S+DCs -1 00 s -1a3 a2 s+a1S-1 =1 s3+a1 s2+a2 s+a3Cs2+a1 s+a2 s+a1 1-a3 s2+a1 s s-a3 s -a2 s-a3 s2SG(s) =[0 0 1]Cs -1 00 s -1a3 a2 s+a1S-1 Cg3 g2 g1S+DCQ =[0 0 1]G(s) =CQAs I-Q-1 AQB-1 Q-1 B+DCg3 g2 g1S=Q-1 B832 Chapter 10 / Control Systems Design in State Space where The rank of the observability matrix N, is 2. Hence, the system is completely observable. Transform the system equations into the ob- servable canonical form. Solution. Since we have Define where Then and Define Then the state equation becomes or (10–157) The output equation becomes y=CQx ˆ = B 0 1-1 -2 RB x ˆ 1 x ˆ 2 R + B 0 2 R u B x ˆ # 1 x ˆ # 2 R = B -1 10 1 RB 1 -41 -3 RB -1 10 1 RB x ˆ 1 x ˆ 2 R + B -1 10 1 RB 0 2 R ux ˆ # =Q -1 AQx ˆ +Q -1 Bux=Qx ˆ Q -1 = B -1 10 1 R Q= b B 2 11 0 RB 1 -31 -2 R r -1 = B -1 10 1 R -1 = B -1 10 1 R N= B 1 1-3 -2 R , W= B a 1 11 0 R = B 2 11 0 R Q=(WN*) -1 a 1 =2, a 2 =1∑s I-A∑=s 2 +2s+1=s 2 +a 1 s+a 2 N=CC*/H21752A* C*D= B 1 1-3 -2 R A= B 1 -41 -3 R , B= B 0 2 R , C=[1 1] Openmirrors.comExample Problems and Solutions 833or (10–158) Equations (10–157) and (10–158) are in the observable canonical form. A–10–10. For the system defined by consider the problem of designing a state observer such that the desired eigenvalues for the observer gain matrix are m1,m2,p,mn. Show that the observer gain matrix given by Equation (10–61), rewritten as (10–159) can be obtained from Equation (10–13) by considering the dual problem. That is, the matrix Ke can be determined by considering the pole-placement problem for the dual system, obtaining the state-feedback gain matrix K, and taking its conjugate transpose, or Ke=K*. Solution. The dual of the given system is (10–160) Using the state-feedback control Equation (10–160) becomes Equation (10–13), which is rewritten here, is (10–161) where For the original system, the observability matrix is Hence, matrix Tcan also be written as Since we have and (T*)-1=(WN*)-1T*=W* N*=WN*W=W*,T=NWCC*/H21752A* C*/H21752p/H21752(A*)n-1 C*D=NT=MW =CC*/H21752A* C*/H21752p/H21752(A*)n-1 C*D WK=Can-an /H21752 an-1-an-1 /H21752 p /H21752 a2-a2 /H21752 a1-a1D T-1z#=(A*-C* K) zv=-Kzn=B* zz#=A* z+C* vKe=(WN*)-1Fan-an an-1-an-1 /H11080 /H11080 /H11080 a1-a1V y=Cx x#=Ax+Buy=[1 1]B-1 10 1RBxˆ1 xˆ2R=[0 1]Bxˆ1 xˆ2R834 Chapter 10 / Control Systems Design in State Space Taking the conjugate transpose of both sides of Equation (10–146), we have Since K e =K*, this last equation is the same as Equation (10–159). Thus, we obtained Equation (10–159) by considering the dual problem. A–10–11. Consider an observed-state feedback control system with a minimum-order observer described by the following equations: (10–162) (10–163) where Ax a is the state variable that can be directly measured, and corresponds to the observed state variables.B Show that the closed-loop poles of the system comprise the closed-loop poles due to pole placementCthe eigenvalues of matrix ( A-BK)] and the closed-loop poles due to the minimum- order observer [the eigenvalues of matrix Solution. The error equation for the minimum-order observer may be derived as given by Equation (10–94), rewritten thus: (10–164) where From Equations (10–162) and (10–163), we obtain (10–165) Combining Equations (10–164) and (10–165) and writing we obtain (10–166) Equation (10–166) describes the dynamics of the observed-state feedback control system with a minimum-order observer. The characteristic equation for this system is or @s I-A+BK@@s I-A bb +K e A ab @=0 2 s I-A+BK 0-BK b s I-A bb +K e A ab 2 =0 B x# e# R = B A-BK 0BK b A bb -K e A ab RB x e R K=CK a /H21752K b D =Ax-BK e x- c 0 e d f =(A-BK) x+BK c 0 e d x#=Ax-BK x/H33522=Ax-BK c x a x/H33522 b d =Ax-BK c x a x b -e d e=x b -x/H33522 b e#=AA bb -K e A ab B eAA bb -K e A ab BDx/H33522 b x= c x a x b d , x/H33522= c x a x/H33522 b d u=-Kx/H33522 y=Cx x#=Ax+BuK*=AT -1 B* F a n -a n a n-1 -a n-1 /H11080 /H11080 /H11080 a 1 -a 1 V =(T*) -1 F a n -a n a n-1 -a n-1 /H11080 /H11080 /H11080 a 1 -a 1 V =(WN*) -1 F a n -a n a n-1 -a n-1 /H11080 /H11080 /H11080 a 1 -a 1 V Openmirrors.comExample Problems and Solutions 835The closed-loop poles of the observed-state feedback control system with a minimum-order observer consist of the closed-loop poles due to pole placement and the closed-loop poles due tothe minimum-order observer. (Therefore, the pole-placement design and the design of theminimum-order observer are independent of each other.) A–10–12. Consider a completely state controllable system defined by (10–167) where Suppose that the rank of the following matrix isn+1 . Show that the system defined by (10–168) where is completely state controllable. Solution. Define Because the system given by Equation (10–167) is completely state controllable, the rank of matrix Misn. Then the rank of isn+1. Consider the following equation: (10–169) Since matrix is of rank n+1, the left-hand side of Equation (10–169) is of rank n+1. Therefore, the right-hand side of Equation (10–169) is also of rank n+1. Since =CA ˆ Bˆ/H21752Aˆ2 Bˆ/H21752p/H21752Aˆn Bˆ/H21752BˆD=BAB -CB/H21752 /H21752A2 B -CAB/H21752p/H21752 /H21752p/H21752An B -CAn-1 B/H21752 /H21752B 0RBAM -CMB 0R=BACB/H21752AB/H21752p/H21752An-1 BD -CCB/H21752AB/H21752p/H21752An-1 BDB 0RBA -CB 0RBA -CB 0RBM 00 1R=BAM -CMB 0RBM 00 1RM=CB /H21752 AB /H21752 p /H21752 An-1 BDAˆ=BA -C0 0R, Bˆ=BB 0R , ue=u(t) -u(q)e#=Aˆe+BˆueBA -CB 0R(n+1)*(n+1)C=1*n constant matrixB=n*1 constant matrixA=n*n constant matrixy=output signal (scalar )u=control signal (scalar )x=state vector (n-vector ) y=Cx x#=Ax+Bu836 Chapter 10 / Control Systems Design in State Space we find that the rank of isn+1. Thus, the system defined by Equation (10–168) is completely state controllable. A–10–13. Consider the system shown in Figure 10–49. Using the pole-placement-with-observer approach, design a regulator system such that the system will maintain the zero position Ay 1 =0 andy 2 =0B in the presence of disturbances. Choose the desired closed-loop poles for the pole-placement part to be and the desired poles for the minimum-order observer to be First, determine the state feedback gain matrix Kand observer gain matrix K e .Then, obtain the response of the system to an arbitrary initial condition—for example, where e 1 ande 2 are defined by Assume that m 1 =1 kg,m 2 =2 kg,k=36 N/H20862m, and b=0.6 N-s /H20862m. Solution. The equations for the system are By substituting the given numerical values for m 1 , m 2 , k,andband simplifying, we obtain Let us choose the state variables as follows: x 4 =y# 2 x 3 =y# 1 x 2 =y 2 x 1 =y 1 y$ 2 =18y 1 -18y 2 +0.3y# 1 -0.3y# 2 y$ 1 =-36y 1 +36y 2 -0.6y# 1 +0.6y# 2 +u m 2 y$ 2 =kAy 1 -y 2 B+bAy# 1 -y# 2 B m 1 y$ 1 =kAy 2 -y 1 B+bAy# 2 -y# 1 B+u e 2 =y 2 -y/H33522 2 e 1 =y 1 -y/H33522 1 e 1 (0)=0.1, e 2 (0)=0.05y 1 (0)=0.1, y 2 (0)=0, y# 1 (0)=0, y# 2 (0)=0s=-15, s=-16s=-2+j213 , s=-2-j213 , s=-10, s=-10CB ˆ /H21752A ˆ B ˆ /H21752A ˆ 2 B ˆ /H21752p/H21752A ˆ n B ˆ D m 1 m 2 y 1 y 2 u k b Regulator Figure 10–49 Mechanical system. Openmirrors.comExample Problems and Solutions 837Then, the state-space equations become Define The state feedback gain matrix Kand observer gain matrix Kecan be obtained easily by use of MATLAB as follows: (See MATLAB Program 10–26.) Ke=B14.4 0.30.6 15.7RK=[130.4444 -41.5556 23.1000 15.4185 ]A=E0 0 -36 180 0 36 -181 0 -0.6 0.30 1 0.6 -0.3U=CAaa AbaAab AbbS, B=E0 0 /H21753 10U=CBa /H21753 BbSBy1 y2R=B1 00 10 00 0RDx1 x2 x3 x4TDx# 1 x# 2 x# 3 x# 4T=D0 0 -36 180 0 36 -181 0 -0.6 0.30 10.6 -0.3TDx1 x2 x3 x4T+D0 010Tu MATLAB Program 10–26 A = [0 0 1 0;0 0 0 1;-36 36 -0.6 0.6;18 -18 0.3 -0.3]; B = [0;0;1;0];J = [-2+j*2*sqrt(3) -2-j*2*sqrt(3) -10 -10];K = acker(A,B,J) K = 130.4444 -41.5556 23.1000 15.4185 Aab = [1 0;0 1]; Abb = [-0.6 0.6;0.3 -0.3];L = [-15 -16];Ke = place(Abb',Aab',L)'place: ndigits= 15 Ke = 14.4000 0.6000 0.3000 15.7000 Response to Initial Condition: Next, we obtain the response of the designed system to the given initial condition. Since x/H33522=Bxa x/H33522 bR=By x/H33522 bRu=-Kx/H33522x#=Ax+Buwe have (10–170) Note that where Then, Equation (10–170) can be written as (10–171) Since, from Equation (10–94), we have (10–172) by combining Equations (10–171) and (10–172) into one equation, we have The state matrix here is a 6*6 matrix. The response of the system to the given initial condition can be obtained easily with MATLAB. (See MATLAB Program 10–27.) The resulting response curves are shown in Figure 10–50. The response curves seem to be acceptable. c x# e# d = c A-BK 0 BKF A bb -K e A ab dc x e d e#=AA bb -K e A ab B ex#=(A-BK) x+BKFeF= c 0 I d x-x/H33522= c x a x b d c x a x/H33522 b d = c 0 x b -x/H33522 b d = c 0 e d = c 0 I d e=Fex#=Ax-BK x/H33522=(A-BK) x+BKAx-x/H33522B 838 Chapter 10 / Control Systems Design in State Space x 1 01234 t (sec) 01234 t (sec) 01234 t (sec) 01234 t (sec) 01234 t (sec) −0.0500.1 0.050.15 e 1 00.050.1 01234 t (sec) e 2 00.020.040.06 x 2 −0.020.02 00.040.06 x 3 −0.6−0.2 −0.400.2 x 4 −0.20.1 0 −0.10.2 Response to initial condition Response to initial condition Figure 10–50 Response curves to initial condition. Openmirrors.comExample Problems and Solutions 839MATLAB Program 10–27 % Response to initial condition A = [0 0 1 0;0 0 0 1;-36 36 -0.6 0.6;18 -18 0.3 -0.3]; B = [0;0;1;0];K = [130.4444 -41.5556 23.1000 15.4185];Ke = [14.4 0.6;0.3 15.7];F = [0 0;0 0;1 0;0 1];Aab = [1 0;0 1];Abb = [-0.6 0.6;0.3 -0.3];AA = [A-B*K B*K*F; zeros(2,4) Abb-Ke*Aab];sys = ss(AA,eye(6),eye(6),eye(6));t = 0:0.01:4;y = initial(sys,[0.1;0;0;0;0.1;0.05],t);x1 = [1 0 0 0 0 0]*y';x2 = [0 1 0 0 0 0]*y';x3 = [0 0 1 0 0 0]*y';x4 = [0 0 0 1 0 0]*y';e1 = [0 0 0 0 1 0]*y';e2 = [0 0 0 0 0 1]*y'; subplot(3,2,1); plot(t,x1); grid; title('Response to initial condition'), xlabel('t (sec)'); ylabel('x1')subplot(3,2,2); plot(t,x2); grid; title('Response to initial condition'),xlabel('t (sec)'); ylabel('x2')subplot(3,2,3); plot(t,x3); grid; xlabel('t (sec)'); ylabel('x3')subplot(3,2,4); plot(t,x4); grid; xlabel('t (sec)'); ylabel('x4')subplot(3,2,5); plot(t,e1); grid; xlabel('t (sec)');ylabel('e1')subplot(3,2,6); plot(t,e2); grid; xlabel('t (sec)'); ylabel('e2') r=0 y u –yObserver controller+–4 s(s+ 2) PlantFigure 10–51 Regulator system.A–10–14. Consider the system shown in Figure 10–51. Design both the full-order and minimum-order observers for the plant. Assume that the desired closed-loop poles for the pole-placement part are located at Assume also that the desired observer poles are located at (a)s=–8, s=–8 for the full-order observer (b)s=–8 for the minimum-order observer Compare the responses to the initial conditions specified below: (a) for the full-order observer: x1(0)=1, x2(0)=0, e1(0)=1, e2(0)=0s=-2+j213, s=-2-j213840 Chapter 10 / Control Systems Design in State Space (b) for the minimum-order observer: Also, compare the bandwidths of both systems. Solution. We first determine the state-space representation of the system. By defining state variables x 1 andx 2 as we obtain For the pole-placement part, we determine the state feedback gain matrix K. Using MATLAB, we find Kto be K=[4 0.5] (See MATLAB Program 10–28.) Next, we determine the observer gain matrix K e for the full-order observer. Using MATLAB, we find K e to be (See MATLAB Program 10–28.)K e = B 14 36 R y=[1 0] B x 1 x 2 R B x# 1 x# 2 R = B 0 01 -2 RB x 1 x 2 R + B 0 4 R u x 2 =y# x 1 =yx 1 (0)=1, x 2 (0)=0, e 1 (0)=1 MATLAB Program 10–28 % Obtaining matrices K and Ke. A = [0 1;0 -2]; B = [0;4]; C = [1 0]; J = [-2+j*2*sqrt(3) -2-j*2*sqrt(3)]; L = [-8 -8]; K = acker(A,B,J) K = 4.0000 0.5000 Ke = acker(A',C',L)' Ke = 14 36 Now we find the response of this system to the given initial condition. Referring to Equation (10–70), we have This equation defines the dynamics of the designed system using the full-order observer. MATLAB Program 10–29 produces the response to the given initial condition.The resulting response curves are shown in Figure 10–52. B x# e# R = B A-BK 0BK A-K e C RB x e R Openmirrors.comExample Problems and Solutions 841MATLAB Program 10–29 % Response to initial condition ---- full-order observer A = [0 1;0 -2]; B = [0;4];C = [1 0];K = [4 0.5];Ke = [14;36];AA = [A-B*K B*K; zeros(2,2) A-Ke*C];sys = ss(AA, eye(4), eye(4), eye(4));t = 0:0.01:8;x = initial(sys, [1;0;1;0],t);x1 = [1 0 0 0]*x';x2 = [0 1 0 0]*x';e1 = [0 0 1 0]*x';e2 = [0 0 0 1]*x'; subplot(2,2,1); plot(t,x1); grid xlabel('t (sec)'); ylabel('x1') subplot(2,2,2); plot(t,x2); grid xlabel('t (sec)'); ylabel('x2') subplot(2,2,3); plot(t,e1); grid xlabel('t (sec)'); ylabel('e1') subplot(2,2,4); plot(t,e2); grid xlabel('t (sec)'); ylabel('e2')x1 x2e1 e20.40.60.81 0.2 0 −0.2 02468 0246802468−0.4 0.60.811.2 0.4 0.2 0 −0.201 −1 −2 −0.50 −1 −1.5−3 −2t (sec) t (sec)02468 t (sec)t (sec) Figure 10–52 Response curves toinitial condition.842 Chapter 10 / Control Systems Design in State Space MATLAB Program 10–31 % Obtaining Ke ---- minimum-order observer Aab = [1]; Abb = [-2]; LL = [-8]; Ke = acker(Abb',Aab',LL)' Ke = 6 MATLAB Program 10–30 % Determination of transfer function of observer controller ---- full-order observer A = [0 1;0 -2]; B = [0;4]; C = [1 0]; K = [4 0.5]; Ke = [14;36]; [num,den] = ss2tf(A-Ke*C-B*K, Ke,K,0) num = 0 74.0000 256.0000 den = 1 18 108 To obtain the transfer function of the observer controller, we use MATLAB. MATLAB Program 10–30 produces this transfer function. The result is num den=74s+256 s 2 +18s+108=74(s+3.4595 ) (s+9+j5.1962 )(s+9-j5.1962 ) Next, we obtain the observer gain matrix K e for the minimum-order observer. MATLAB Program 10–31 produces K e .The result is K e =6 The response of the system with minimum-order observer to the initial condition can be ob- tained as follows: By substituting into the plant equation given by Equation (10–79) u=-Kx/H33522 Openmirrors.comExample Problems and Solutions 843MATLAB Program 10–32 % Response to intial condition ---- minimum-order observer A = [0 1;0 -2]; B = [0;4];K = [4 0.5];Kb = 0.5;Ke = 6;Aab = 1; Abb = -2;AA = [A-B*K B*Kb; zeros(1,2) Abb-Ke*Aab];sys = ss(AA,eye(3),eye(3),eye(3));t = 0:0.01:8;x = initial(sys,[1;0;1],t);x1 = [1 0 0]*x';x2 = [0 1 0]*x';e = [0 0 1]*x'; subplot(2,2,1); plot(t,x1); grid xlabel('t (sec)'); ylabel('x1') subplot(2,2,2); plot(t,x2); grid xlabel('t (sec)'); ylabel('x2') subplot(2,2,3); plot(t,e); grid xlabel('t (sec)'); ylabel('e')we find or The error equation is Hence the system dynamics are defined by Based on this last equation, MATLAB Program 10–32 produces the response to the given initial condition. The resulting response curves are shown in Figure 10–53.Bx# e#R=BA-BK 0BKb Abb-Ke AabRBx eRe#=AAbb-Ke AabB ex#=(A-BK) x+BKb e=(A-BK) x+BCKa KbDB0 eRx#=Ax-BK x/H33522=Ax-BKx +BK(x-x/H33522)844 Chapter 10 / Control Systems Design in State Space e 0246800.20.40.60.81 t (sec) x 1 x 2 0.60.811.2 0.4 0.2 0 02468 02468−0.200.5 −0.5 −1 −2−1.5 −2.5 t (sec) t (sec) Figure 10–53 Response curves to initial condition. The transfer function of the observer controller, when the system uses the minimum-order observer, can be obtained by use of MATLAB Program 10–33. The result is num den=7s+32 s+10=7(s+4.5714 ) s+10 MATLAB Program 10–33 % Determination of transfer function of observer controller ---- minimum-order observer A = [0 1;0 -2]; B = [0;4]; Aaa = 0; Aab = 1; Aba = 0; Abb = -2; Ba = 0; Bb = 4; Ka = 4; Kb = 0.5; Ke = 6; Ahat = Abb - Ke*Aab; Bhat = Ahat*Ke + Aba - Ke*Aaa; Fhat = Bb - Ke*Ba; Atilde = Ahat - Fhat*Kb; Btilde = Bhat - Fhat*(Ka + Kb*Ke); Ctilde = -Kb; Dtilde = -(Ka + Kb*Ke); [num,den] = ss2tf(Atilde, Btilde, -Ctilde, -Dtilde) num = 7 32 den = 1 10 Openmirrors.comExample Problems and Solutions 845The observer controller is clearly a lead compensator. The Bode diagrams of System 1 (closed-loop system with full-order observer) and of Sys- tem 2 (closed-loop system with minimum-order observer) are shown in Figure 10–54. Clearly, thebandwidth of System 2 is wider than that of System 1. System 1 has a better high-frequency noise-rejection characteristic than System 2. A–10–15. Consider the system where xis a state vector ( n-vector) and Ais an n*n constant matrix. We assume that Ais non- singular. Prove that if the equilibrium state x=0of the system is asymptotically stable (that is, if Ais a stable matrix), then there exists a positive-definite Hermitian matrix Psuch that where Qis a positive-definite Hermitian matrix. Solution. The matrix differential equation. has the solution Integrating both sides of this matrix differential equation from t=0 tot=q, we obtain X(q)-X(0)=A* a 3q 0Xdtb+a 3q 0Xdtb AX=eA* t QeAtX#=A* X+XA, X(0)=QA* P+PA =-Qx#=AxFrequency (rad/sec)Bode Diagrams of Systems −300−100 −200 −250−50 −1500−100−50Phase (deg); Magnitude (dB)50 0 10−1100101102System 1System 2 System 1System 2Figure 10–54 Bode diagrams of System 1(system with full-order observer) and System 2 (system with minimum-order observer).System 1= (296s+1024) /H20862 (s 4+20s3+144s2 +512s+1024 ); System 2= (28s+128) /H20862 (s3+12s2+48s+128 ).846 Chapter 10 / Control Systems Design in State Space Noting that Ais a stable matrix and, therefore, we obtain Let us put Note that the elements of are finite sums of terms like where the l i are the eigenvalues of Aandm i is the multiplicity of l i .Since the l i possess negative real parts, exists. Note that Thus Pis Hermitian (or symmetric if Pis a real matrix). We have thus shown that for a stable A and for a positive-definite Hermitian matrix Q, there exists a Hermitian matrix Psuch that We now need to prove that Pis positive definite. Consider the following Her- mitian form: Hence, Pis positive definite. This completes the proof. A–10–16. Consider the control system described by (10–173) where Assuming the linear control law (10–174) determine the constants k 1 andk 2 so that the following performance index is minimized: J= 3 q 0 x T xdtu=-Kx=-k 1 x 1 -k 2 x 2 A= B 0 01 0 R , B= B 0 1 R x#=Ax+Bu=0, for x=0= 3 q 0 Ae At xB* QAe At xBdt70, for xZ0x* Px=x* 3 q 0 e A* t Qe At dtxA* P+PA =-Q.P*= 3 q 0 e A* t Qe At dt=P3 q 0 e A* t Qe At dtte l i t p,t m i -1 e l i t , e l i t , e At P= 3 q 0 Xdt= 3 q 0 e A* t Qe At dt-X(0)=-Q=A* a 3 q 0 Xdt b + a 3 q 0 Xdt b AX(q)=0, Openmirrors.comExample Problems and Solutions 847Consider only the case where the initial condition is Choose the undamped natural frequency to be 2 rad /H20862sec. Solution. Substituting Equation (10–174) into Equation (10–173), we obtain or (10–175) Thus, Elimination of x2from Equation (10–175) yields Since the undamped natural frequency is specified as 2 rad /H20862sec, we obtain Therefore, is a stable matrix if k2>0. Our problem now is to determine the value of k2so that the performance index is minimized, where the matrix Pis determined from Equation (10–115), rewritten Since in this system Q=IandR=0, this last equation can be simplified to (10–176) Since the system involves only real vectors and real matrices, Pbecomes a real symmetric matrix. Then Equation (10–176) can be written as B0 1-4 -k2RBp11 p12p12 p22R+Bp11 p12p12 p22RB0 -41 -k2R=B-1 00 -1R(A-BK)* P+P(A-BK)=-I(A-BK)* P+P(A-BK)=-(Q+K* RK)J= 3q 0xT xdt=xT(0) P(0) x(0)A-BKA-BK =B0 -41 -k2Rk1=4x$ 1+k2 x# 1+k1 x1=0A-BK =B0 -k11 -k2R =B0 -k11 -k2RBx1 x2R Bx# 1 x# 2R=B0 01 0RBx1 x2R+B01RC-k1 x1-k2 x2Dx#=Ax-BKxx(0)=Bc 0R848 Chapter 10 / Control Systems Design in State Space Solving for the matrix P, we obtain The performance index is then (10–177) To minimize J, we differentiate Jwith respect to k 2 and set equal to zero as follows: Hence, With this value of k 2 ,we have Thus, the minimum value of Jis obtained by substi- tuting into Equation (10–177), or The designed system has the control law The designed system is optimal in that it results in a minimum value for the performance index J under the assumed initial condition. A–10–17. Consider the same inverted-pendulum system as discussed in Example 10–5.The system is shown in Figure 10–8, where M=2 kg,m=0.1 kg, and l=0.5 m. The block diagram for the system is shown in Figure 10–9. The system equations are given by j# =r-y=r-Cxu=-Kx+k I jy=Cxx#=Ax+Buu=-4x 1 -120 x 2 J min =15 2 c 2 k 2 =120 0 2 J/H208620k 2 2 70.k 2 =120 0J 0k 2 = a -5 2k 2 2 +1 8 b c 2 =00J/H208620k 2 = a 5 2k 2 +k 2 8 b c 2 =[c 0] B p 11 p 12 p 12 p 22 RB c 0 R =p 11 c 2 J=x T (0) Px(0)P= B p 11 p 12 p 12 p 22 R = D 5 2k 2 +k 2 8 1 81 8 5 8k 2 T Openmirrors.comExample Problems and Solutions 849where Referring to Equation (10–51), the error equation for the system is given by where and the control signal is given by Equation (10–41): where Using MATLAB, determine the state feedback gain matrix such that the following performance index Jis minimized: J= 3q 0(e* Qe+u* Ru)dtKˆx=Dx1 x2 x3 x4T=Du u# x x#Te=Bxe jeR=Bx(t)-x(q) j(t)-j(q)RKˆ=CK/H21752-kID=Ck1 k2 k3 k4/H21752-kIDue=-KˆeAˆ=BA -C0 0R=E0 20.601 0 -0.4905 01 0 0000 0 00 -10 0 1000 0 000 U, Bˆ=BB 0R=E0 -1 0 0.5 0Ue#=Aˆe+BˆueA=D0 20.601 0 -0.49051 0000 0000 010 T , B=D0 -1 0 0.5T, C=[0 0 1 0]850 Chapter 10 / Control Systems Design in State Space where Obtain the unit-step response of the system designed. Solution. A MATLAB program to determine is given in MATLAB Program 10–34.The result is k 1 =-188.0799, k 2 =-37.0738, k 3 =-26.6767, k 4 =-30.5824, k I =-10.0000K ˆ Q= E 100 0 0 0 00 1 0 0 00 0 1 0 00 0 0 1 00 0 0 0 1 U , R=0.01 MATLAB Program 10–34 % Design of quadratic optimal control system A = [0 1 0 0;20.601 0 0 0;0 0 0 1;-0.4905 0 0 0]; B = [0;-1;0;0.5]; C = [0 0 1 0]; D = [0]; Ahat = [A zeros(4,1);-C 0]; Bhat = [B;0]; Q = [100 0 0 0 0;0 1 0 0 0;0 0 1 0 0;0 0 0 1 0;0 0 0 0 1]; R = [0.01]; Khat = lqr(Ahat,Bhat,Q,R) Khat = -188.0799 -37.0738 -26.6767 -30.5824 10.0000 Unit-Step Response .Once we have determined the feedback gain matrix Kand the integral gain constant k I ,we can determine the unit-step response of the designed system.The system equation is (10–178) [Refer to Equation (10–35).] Since Equation (10–178) can be written as follows: (10–179) The output equation is y=[C 0] B x j R +[0]r B x# j# R = B A-BK -CBk I 0 RB x j R + B 0 1 R ru=-Kx+k I j B x# j# R = B A -C0 0 RB x j R + B B 0 R u+ B 0 1 R r Openmirrors.comMATLAB Program 10–35 gives the unit-step response of the system given by Equation (10–179). The resulting response curves are presented in Figure 10–55. It shows response curves versus t, versus t, versus t, versus t,and versus t,where the input r(t) to the cart is a unit-step function All initial conditions are set equal to zero. Figure 10–56 is an enlarged version of the cart position versus t.The cart moves backward a very small amount for the first 0.6 sec or so. (Notice that the cart velocity isnegative for the first 0.4 sec.) This is due to the fact that the inverted-pendulum-on-the-cart system is a nonminimum-phase system.yC=x 3(t)DCr(t) =1 mD.jC=x5(t)D y#C=x4(t)D yC=x3(t)D u# C=x2(t)DuC=x1(t)D Example Problems and Solutions 851MATLAB Program 10–35 % Unit-step responseA = [0 1 0 0;20.601 0 0 0;0 0 0 1;-0.4905 0 0 0]; B = [0;-1;0;0.5];C = [0 0 1 0];D = [0];K = [-188.0799 -37.0738 -26.6767 -30.5824];kI = -10.0000;AA = [A-B*K B*kI; -C 0];BB = [0;0;0;0;1];CC= [C 0];DD = D;t = 0:0.01:10;[y,x,t] = step(AA,BB,CC,DD,1,t);x1 = [1 0 0 0 0]*x';x2 = [0 1 0 0 0]*x';x3 = [0 0 1 0 0]*x';x4 = [0 0 0 1 0]*x';x5 = [0 0 0 0 1]*x'; subplot(3,2,1); plot(t,x1); grid; xlabel('t (sec)'); ylabel('x1') subplot(3,2,2); plot(t,x2); grid; xlabel('t (sec)'); ylabel('x2') subplot(3,2,3); plot(t,x3); grid; xlabel('t (sec)'); ylabel('x3') subplot(3,2,4); plot(t,x4); grid; xlabel('t (sec)'); ylabel('x4') subplot(3,2,5); plot(t,x5); grid; xlabel('t (sec)'); ylabel('x5') Comparing the step-response characteristics of this system with those of Example 10–5, we notice that the response of the present system is less oscillatory and exhibits less maximum overshoot in the position response Ax3versus tB. The system designed by use of the quadratic optimal regulator approach generally gives such characteristics—less oscillatory and well damped.852 Chapter 10 / Control Systems Design in State Space x 1 02468 1 0 t (sec) 02468 1 0 t (sec) 02468 1 0 t (sec) 02468 1 0 t (sec) 02468 1 0 t (sec) −0.0200.020.04 x 5 0123 x 2 −0.050.05 00.10.15 x 3 −0.50.5 011.5 x 4 −0.20.2 00.40.6 Figure 10–55 Response curves to a unit-step input. Cart Position x 3 versus t Cart Position x 3 t (sec)0123456789 1 01.2 1 0.8 0.6 0.4 0.2 0 −0.2 Figure 10–56 Cart position versus t curve. A–10–18. Consider the stability of a system with unstructured additive uncertainty as shown in Figure 10–57(a). Define true plant dynamics G= model of plant dynamics unstructured additive uncertainty ¢ a =G/H33522= Openmirrors.comExample Problems and Solutions 853Gw u KWaI yz −+ K (f) (e)w uz yPG K/H9004a (d)uzw −+/H9004a TaBA (c)G K/H9004a (a)y uA ++ –B/H9004a K Gyu +−A B (b) Figure 10–57 (a) Block diagram of a system with unstructured additive uncertainty;(b)–(d) successive modifications of the block diagram of (a);(e) block diagram showing a generalized plant with unstructured additive uncertainty;(f) generalized plant diagram.854 Chapter 10 / Control Systems Design in State Space Assume that is stable and its upper bound is known.Assume also that and Gare related by =G+ a Obtain the condition that the controller Kmust satisfy for robust stability. Also, obtain a gener- alized plant diagram for this system. Solution. Let us obtain the transfer function between point Aand point Bin Figure 10–57(a). Redrawing Figure 10–57(a), we obtain Figure 10–57(b).Then the transfer function between points AandBcan be obtained as Define Then Figure 10–57(b) can be redrawn as Figure 10–57(c). By using the small-gain theorem, the con- dition for the robust stability of the closed-loop system can be obtained as (10–180) Since it is impossible to model precisely, we need to find a scalar transfer function such that for all v and use this instead of a . Then, the condition for the robust stability of the closed-loop system can be given by (10–181) If Inequality (10–181) holds true, then it is evident that Inequality (10–180) also holds true. So this is the condition to guarantee the robust stability of the designed system. In Figure 10–57(e), a in Figure 10–57(d) was replaced by . To summarize, if we make the norm of the transfer function from wtozto be less than 1, the controller Kthat satisfies Inequality (10–181) can be determined. Figure 10–57(e) can be redrawn as that shown in Figure 10–57(f), which is the generalized plant diagram for the system considered. Note that for this problem the matrix that relates the controlled variable zand the exoge- nous disturbance wis given by Noting that u(s)=K(s)y(s) and referring to Equation (10–128), is given by the elements of the Pmatrix as follows: To make this equal to we may choose P 11 =0, P 12 =W a , P 21 =I, and P 22 =/H11002G. Then, the Pmatrix for this problem can be obtained as P= B 0 IW a -G R W a K(I +GK) -1 , £(s)£(s)=P 11 +P 12 K(I -P 22 K) -1 P 21 £(s)z=£ (s)w =(W a T a )w=[W a K(I +GK) -1 ]w£H q W a I¢7W a T a 7 q 61¢ W a (jv)s {¢ a (jv)}6/H20895W a (jv)/H20895W a (jv) ¢ a 7¢ a T a 7 q 61K(1 +GK) -1 =T a K 1+GK =K(1 +GK) -1 ¢ G/H33522G/H33522¢ a Openmirrors.comProblems 855x=Ax+Bu.y=Cx x2 x3k2k1 k3r ux y=x1 +–+– Figure 10–58 Type 1 servo system.PROBLEMS B–10–1. Consider the system defined by where Transform the system equations into (a) controllable canon- ical form and (b) observable canonical form. B–10–2. Consider the system defined by where Transform the system equations into the observable canon- ical form. B–10–3. Consider the system defined by where By using the state-feedback control it is desired to have the closed-loop poles at Deter-mine the state-feedback gain matrix K. B–10–4. Solve Problem B–10–3 with MATLAB.s=-10. s=-2;j4,u=-Kx,A= C0 0 -11 0 -50 1 -6S, B=C0 11S x#=Ax+BuA=C-1 100 -2 01 0 -3S, B=C0 11S, C=[1 1 1] y=Cx x#=Ax+BuC=[1 1 0] A=C-1 100 -2 01 0 -3S, B=C0 01S, y=Cx x#=Ax+BuB–10–5. Consider the system defined by Show that this system cannot be stabilized by the state- feedback control whatever matrix Kis chosen. B–10–6. A regulator system has a plant Define state variables as By use of the state-feedback control it is desired to place the closed-loop poles at Determine the necessary state-feedback gain matrix K. B–10–7. Solve Problem B–10–6 with MATLAB. B–10–8. Consider the type 1 servo system shown in Figure 10–58. Matrices A,B, and Cin Figure 10–58 are given by Determine the feedback gain constants k1, k2,and k3such that the closed-loop poles are located at Obtain the unit-step response and plot the output y(t)-versus- tcurve.s=-2+j4, s=-2-j4, s=-10A=C0 001 0 -50 1 -6S, B=C0 01S, C=[1 0 0]s=-2+j213, s=-2-j213, s=-10u=-Kx, x3=x# 2 x2=x# 1 x1=yY(s) U(s)=10 (s+1)(s +2)(s +3)u=-Kx,Bx# 1 x# 2R=B0 01 2RBx1 x2R+B10Ru856 Chapter 10 / Control Systems Design in State Space B–10–9. Consider the inverted-pendulum system shown in Figure 10–59. Assume that M=2 kg, m=0.5 kg, l=1 m Define state variables as and output variables as Derive the state-space equations for this system. It is desired to have closed-loop poles at Determine the state-feedback gain matrix K. Using the state-feedback gain matrix Kthus determined, examine the performance of the system by computer simu- lation.Write a MATLAB program to obtain the response of the system to an arbitrary initial condition. Obtain the response curves x 1 (t)versus t, x 2 (t)versus t, x 3 (t)versus t, andx 4 (t)versus tfor the following set of initial condition: x 1 (0)=0, x 2 (0)=0, x 3 (0)=0, x 4 (0)=1 m/H20862ss=-4+j4, s=-4-j4, s=-20, s=-20y 1 =u=x 1 , y 2 =x=x 3 x 1 =u, x 2 =u# , x 3 =x, x 4 =x#where Design a full-order state observer. The desired observer poles are s=–5 ands=–5. B–10–11. Consider the system defined by where Design a full-order state observer, assuming that the desired poles for the observer are located at s=–10, s=–10, s=–15 B–10–12. Consider the system defined by Given the set of desired poles for the observer to be design a full-order observer. B–10–13. Consider the double integrator system defined by If we choose the state variables as then the state-space representation for the system becomes as follows: y=[1 0] B x 1 x 2 R B x# 1 x# 2 R = B 0 01 0 RB x 1 x 2 R + B 0 1 R u x 2 =y# x 1 =yy$=us=-5+j513 , s=-5-j513 , s=-10y=[1 0 0] C x 1 x 2 x 3 S + C 0 0 1.244 S u C x# 1 x# 2 x# 3 S = C 0 0 1.2441 0 0.39560 1 -3.145 SC x 1 x 2 x 3 S A= C 0 0 -51 0 -60 1 0 S , B= C 0 0 1 S , C=[1 0 0] y=Cx x#=Ax+BuA= B -1 11 -2 R , C=[1 0] 0 MP z umgm/H5129 sin u x x /H5129 cos u /H5129u Figure 10–59 Inverted-pendulum system. B–10–10. Consider the system defined by y=Cx x#=Ax Openmirrors.comProblems 857Y(s) R(s) U(s)Observer controller+–s2+ 2s+ 50 s(s+ 4) (s+ 6) Figure 10–60 Control system with observer controller in thefeedforward path.It is desired to design a regulator for this system. Using the pole-placement-with-observer approach, design an observercontroller. Choose the desired closed-loop poles for the pole- placement part to be s=–0.7071+j0.7071, s=–0.7071-j0.7071 and assuming that we use a minimum-order observer, choose the desired observer pole at s=–5 B–10–14. Consider the system where Design a regulator system by the pole-placement-with- observer approach. Assume that the desired closed-looppoles for pole placement are located at s=–1+j, s=–1-j, s=–5 The desired observer poles are located at s=–6, s=–6, s=–6 Also, obtain the transfer function of the observer controller. B–10–15. Using the pole-placement-with-observer approach, design observer controllers (one with a full-order observer andthe other with a minimum-order observer) for the systemshown in Figure 10–60. The desired closed-loop poles for the pole-placement part are s=–1+j2, s=–1-j2, s=–5A= C0 0 -61 0 -110 1 -6S, B=C0 01S, C=[1 0 0] y=Cx x#=Ax+BuThe desired observer poles are s=–10, s=–10, s=–10 for the full-order observer s=–10, s=–10 for the minimum-order observer. Compare the unit-step responses of the designed systems. Compare also the bandwidths of both systems. B–10–16. Using the pole-placement-with-observer approach, design the control systems shown in Figures 10–61(a) and (b). Assume that the desired closed-loop poles for the pole place-ment are located at s=–2+j2, s=–2-j2 and the desired observer poles are located at s=–8, s=–8 Obtain the transfer function of the observer controller. Compare the unit-step responses of both systems. [In System(b), determine the constant Nso that the steady-state out- puty(q) is unity when the input is a unit-step input.] Y(s) R(s)Observer controller+–1 s(s+ 1) 1 s(s+ 1)Y(s) Observer controller+– (b)R(s) N(a) Plant Figure 10–61 Control systems with observer controller: (a) observer controller in the feedforward path; (b) observer controller in the feedback path. B–10–17. Consider the system defined by where a=adjustable parameter 70A=C0 0 -11 0 -20 1 -aSx#=Ax858 Chapter 10 / Control Systems Design in State Space Determine the value of the parameter aso as to minimize the following performance index: Assume that the initial state x(0) is given by B–10–18. Consider the system shown in Figure 10–62. Determine the value of the gain Kso that the damping ratio zof the closed-loop system is equal to 0.5. Then determine also the undamped natural frequency v n of the closed-loop system. Assuming that e(0)=1 and evaluate 3 q 0 e 2 (t)dte#(0)=0,x(0)= C c 1 0 0 S J= 3 q 0 x T xdtB–10–21. Consider the inverted-pendulum system shown in Figure 10–59. It is desired to design a regulator system that will maintain the inverted pendulum in a vertical po- sition in the presence of disturbances in terms of angle u and/or angular velocity The regulator system is required to return the cart to its reference position at the end of each control process. (There is no reference input to the cart.) The state-space equation for the system is given by where We shall use the state-feedback control scheme Using MATLAB, determine the state-feedback gain matrix such that the following performance index Jis minimized: where Then obtain the system response to the following initial condition: Plot response curves uversus t,versus t, xversus t,and versus t.x#u# D x 1 (0) x 2 (0) x 3 (0) x 4 (0) T = D 0.1 0 0 0 T Q= D 100 0 0 00 1 0 00 0 1 00 0 0 1 T , R=1J= 3 q 0 Ax* Qx+u* RuBdtK=Ck 1 k 2 k 3 k 4 Du=-KxB= D 0 -1 0 0.5 T , x= D u u# x x# T A= D 0 20.601 0 -0.49051 0 0 00 0 0 00 0 1 0 T x#=Ax+Buu#. +– r= 0 c u e K5 (s+ 1) (2 s+ 1) Figure 10–62 Control system. B–10–19. Determine the optimal control signal ufor the system defined by where such that the following performance index is minimized: B–10–20. Consider the system It is desired to find the optimal control signal usuch that the performance index is minimized. Determine the optimal signal u(t).J= 3 q 0 Ax T Qx+u 2 Bdt, Q= B 1 00 m RB x# 1 x# 2 R = B 0 01 0 RB x 1 x 2 R + B 0 1 R uJ= 3 q 0 Ax T x+u 2 BdtA= B 0 01 -1 R , B= B 0 1 R x#=Ax+Bu Openmirrors.comA 859Appendix Appendix A first presents the complex variable and complex function.Then it presents tables of Laplace transform pairs and properties of Laplace transforms. Finally, it presentsfrequently used Laplace transform theorems and Laplace transforms of pulse functionand impulse function. Complex Variable. A complex number has a real part and an imaginary part, both of which are constant. If the real part and/or imaginary part are variables, a complexquantity is called a complex variable . In the Laplace transformation we use the notation sas a complex variable; that is, wheresis the real part and vis the imaginary part. Complex Function. A complex function G(s) , a function of s, has a real part and an imaginary part or where G xand Gyare real quantities. The magnitude of G(s) is and the angleuofG(s) is The angle is measured counterclockwise from the pos- itive real axis. The complex conjugate of G(s) is Complex functions commonly encountered in linear control systems analysis are single-valued functions of sand are uniquely determined for a given value of s.G–(s)=Gx-jGy .tan-1 AGy/H20862GxB.2Gx2+Gy2,G(s) =Gx+jGys=s+jvLaplace Transform TablesA complex function G(s) is said to be analytic in a region if G(s) and all its deriva- tives exist in that region. The derivative of an analytic function G(s) is given by Since can approach zero along an infinite number of different paths. It can be shown, but is stated without a proof here, that if the derivatives taken along two particular paths, that is, and are equal, then the deriva- tive is unique for any other path and so the derivative exists. For a particular path (which means that the path is parallel to the real axis), For another particular path (which means that the path is parallel to the imaginary axis), If these two values of the derivative are equal, or if the following two conditions are satisfied, then the derivative dG(s)/ dsis uniquely determined.These two conditions are known as the Cauchy–Riemann conditions. If these conditions are satisfied, the func- tion G(s) is analytic. As an example, consider the following G(s) : Then G(s+jv)=1 s+jv+1=G x +jG y G(s) =1 s+10G x 0s=0G y 0v and 0G y 0s=-0G x 0v0G x 0s+j0G y 0s=0G y 0v-j0G x 0vd dsG(s) =lim j¢vS0 a ¢G x j¢v+j¢G y j¢v b =-j0G x 0v+¢G y 0v¢s=j¢vd dsG(s) =lim ¢sS0 a ¢G x ¢s+j¢G y ¢s b =0G x 0s+j0G y 0s¢s=¢s¢s=¢s+j¢v¢s=j¢v, ¢s=¢s¢s=¢s+j¢v, ¢sd dsG(s) =lim ¢sS0 G(s +¢s)-G(s) ¢s=lim ¢sS0 ¢G ¢s 860 Appendix A / Laplace Transform Tables Openmirrors.comwhere It can be seen that, except at s=–1 ( that is, s=–1 ,v=0) ,G(s) satisfies the Cauchy–Riemann conditions: Hence G(s)=1/(s+1) is analytic in the entire splane except at s=–1 . The deriva- tivedG(s)/ ds, except at s=1 , is found to be Note that the derivative of an analytic function can be obtained simply by differentiat- ingG(s) with respect to s. In this example, Points in the splane at which the function G(s) is analytic are called ordinary points, while points in the splane at which the function G(s) is not analytic are called singular points. Singular points at which the function G(s) or its derivatives approach infinity are called poles . Singular points at which the function G(s) equals zero are called zeros . IfG(s) approaches infinity as sapproaches –pand if the function forn=1 ,2 ,3 , p has a finite, nonzero value at s=–p , then s=–p is called a pole of order n. If n=1 , the pole is called a simple pole. If n=2 ,3 ,p, the pole is called a second-order pole, a third-order pole, and so on. To illustrate, consider the complex function G(s) =K(s +2)(s +10) s(s+1)(s +5)(s +15)2G(s)(s +p)n,d dsa1 s+1b=-1 (s+1)2=-1 (s+jv+1)2=-1 (s+1)2d dsG(s) =0Gx 0s+j0Gy 0s=0Gy 0v-j0Gx dv0Gy 0s=-0Gx 0v=2v(s+1) C(s+1)2+v2D20Gx 0s=0Gy 0v=v2-(s+1)2 C(s+1)2+v2D2Gx=s+1 (s+1)2+v2 and Gy=-v (s+1)2+v2 Appendix A / Laplace Transform Tables 861G(s) has zeros at s=–2, s=–10 , simple poles at s=0, s=–1, s=–5 , and a double pole (multiple pole of order 2) at s=–15 . Note that G(s) becomes zero at s= q. Since for large values of s G(s) possesses a triple zero (multiple zero of order 3) at s= q. If points at infinity are included, G(s) has the same number of poles as zeros.To summarize, G(s) has five zeros (s=–2, s=–10, s= q,s= q,s= q)and five poles (s=0, s=–1, s=–5, s=–15, s=–15) . Laplace Transformation. Let us define f(t)= a function of time tsuch that f(t)=0 fort<0 s= a complex variable l=an operational symbol indicating that the quantity that it prefixes is to be transformed by the Laplace integral F(s)= Laplace transform of f(t) Then the Laplace transform of f(t) is given by The reverse process of finding the time function f(t) from the Laplace transform F(s) is called the inverse Laplace transformation .The notation for the inverse Laplace trans- formation is l –1 , and the inverse Laplace transform can be found from F(s) by the fol- lowing inversion integral: where c, the abscissa of convergence, is a real constant and is chosen larger than the real parts of all singular points of F(s) .Thus, the path of integration is parallel to the jvaxis and is displaced by the amount cfrom it.This path of integration is to the right of all sin- gular points. Evaluating the inversion integral appears complicated. In practice, we seldom use this integral for finding f(t). We frequently use the partial-fraction expansion method given in Appendix B. In what follows we give Table A–1, which presents Laplace transform pairs of com- monly encountered functions, and Table A–2, which presents properties of Laplace transforms.l -1 CF(s)D=f(t) =1 2pj3 c+jq c-jq F(s)e st ds, fort70lCf(t)D=F(s) = 3 q 0 e -st dtCf(t)D= 3 q 0 f(t)e -st dt1 q 0 e -st dtG(s)/H11216K s 3 862 Appendix A / Laplace Transform Tables Openmirrors.comAppendix A / Laplace Transform Tables 863f(t) F(s) 1 Unit impulse d(t) 1 2 Unit step 1(t) 3 t 4 5 tn(n=1, 2, 3, p) 6 e–at 7 te–at 8 9 tne–at(n=1, 2, 3, p) 10 sin vt 11 cos vt 12 sinh vt 13 cosh vt 14 15 16 171 s(s+a)(s +b)1 abc1+1 a-bAbe-at-ae-btBds (s+a)(s +b)1 b-aAbe-bt-ae-atB1 (s+a)(s +b)1 b-aAe-at-e-btB1 s(s+a)1 aA1-e-atBs s2-v2v s2-v2s s2+v2v s2+v2n! (s+a)n+11 (s+a)n1 (n-1)!tn-1e-at (n=1, 2, 3, p)1 (s+a)21 s+an! sn+11 sntn-1 (n-1)! (n=1, 2, 3, p)1 s21 sTable A–1 Laplace Transform Pairs (continues on next page )864 Appendix A / Laplace Transform Tables 18 19 20 e –at sinvt 21 e –at cosvt 22 23 24 25 1- cosvt 26 vt-sinvt 27 sin vt-vtcosvt 28 29 tcosvt 30 31s 2 As 2 +v 2 B 2 1 2v(sinvt+vtcosvt)s As 2 +v 2 1 BAs 2 +v 2 2 B1 v 2 2 -v 2 1 Acosv 1 t-cosv 2 tB Av 2 1 Zv 2 2 Bs 2 -v 2 As 2 +v 2 B 2 s As 2 +v 2 B 2 1 2vtsinvt2v 3 As 2 +v 2 B 2 v 3 s 2 As 2 +v 2 Bv 2 sAs 2 +v 2 B(06z61, 06f6p/H208622)v 2 n sAs 2 +2zv n s+v 2 n B f=tan -1 21-z 2 z1-1 21-z 2 e -zv n t sin Av n 21-z 2 t+fB(06z61, 06f6p/H208622)s s 2 +2zv n s+v 2 n f=tan -1 21-z 2 z-1 21-z 2 e -zv n t sin Av n 21-z 2 t-fBv 2 n s 2 +2zv n s+v 2 n v n 21-z 2 e -zv n t sinv n 21-z 2 t (06z61)s+a (s+a) 2 +v 2 v (s+a) 2 +v 2 1 s 2 (s+a)1 a 2 Aat-1+e -at B1 s(s+a) 2 1 a 2 A1-e -at -ate -at B Table A–1 (continued ) Openmirrors.comAppendix A / Laplace Transform Tables 8651 2 3 4 5 where 6 7 8 9 10 11 12 13 14 15 16 17 18 lCf(t)g(t)D=1 2pj3c+jq c-jqF(p)G(s -p)dplc 3t 0f1(t-t)f2(t)dtd=F1(s)F2(s)lcfa1 abd=aF(as)lc1 tf(t)d= 3q sF(s) ds if lim tS01 tf(t) existslCtnf(t)D=(-1)ndn dsnF(s) (n=1, 2, 3, p)lCt2f(t)D=d2 ds2F(s)lCtf(t)D=-dF(s) dslCf(t-a)1(t -a)D=e-asF(s) a/H113500lCe-atf(t)D=F(s +a)3q 0f(t) dt=lim sS0F(s) if 3q 0f(t) dt existslc 3t 0f(t) dtd=F(s) sl;c 3p 3f(t)( dt)nd=F(s) sn+an k=11 sn-k+1c 3p 3f(t)( dt)kd t=0 ;l;c 3f(t) dtd=F(s) s+1 sc 3f(t) dtd t=0 ;f(t)(k-1) =dk-1 dtk-1f(t)l;cdn dtnf(t)d=snF(s) -an k=1sn-kf(0 ;)(k-1)l;cd2 dt2f(t)d=s2F(s) -sf(0 ;)-f# (0 ;)l;cd dtf(t)d=sF(s) -f(0 ;)lCf1(t);f2(t)D=F1(s);F2(s)lCAf(t)D=AF(s)Table A–2 Properties of Laplace TransformsFinally, we present two frequently used theorems, together with Laplace transforms of the pulse function and impulse function. 866 Appendix A / Laplace Transform Tables Initial value theorem Final value theorem Pulse function Impulse function =As s=A=lim t 0 S0 d dt 0 [A(1-e -st 0 )] d dt 0 (t 0 s) =0, for t60,t 0 6tlCg(t)D=lim t 0 S0 c A t 0 s(1-e -st 0 ) d g(t) =lim t 0 S0 A t 0 , for 0 6t6t 0 lCf(t)D=A t 0 s-A t 0 se -st 0 f(t) =A t 0 1(t)-A t 0 1(t-t 0 )f(q)=lim tSq f(t)=lim sS0 sF(s)f(0+)=lim tS0+ f(t)=lim sSq sF(s) Openmirrors.comB 867Appendix Before we present MATLAB approach to the partial-fraction expansions of transfer functions, we discuss the manual approach to the partial-fraction expansions of transferfunctions. Partial-Fraction Expansion when F(s) Involves Distinct Poles Only. Consider F(s) written in the factored form form<n where p 1,p2,p,pnandz1,z2,p,zmare either real or complex quantities, but for each com- plex piorzjthere will occur the complex conjugate of piorzj, respectively. If F(s) involves distinct poles only, then it can be expanded into a sum of simple partial fractions as follows: (B–1) where ak(k=1, 2,p,n) are constants.The coefficient akis called the residue at the pole ats=–pk. The value of akcan be found by multiplying both sides of Equation (B–1) byAs+pkBand letting s=–pk, which gives =ak+p+ak s+pkAs+pkB+p+an s+pnAs+pkBR s=-pkcAs+pkBB(s) A(s)d s=-pk=ca1 s+p1 As+pkB+a2 s+p2As+pkBF(s) =B(s) A(s)=a1 s+p1+a2 s+p2+p+an s+pnF(s) =B(s) A(s)=KAs+z1BAs+z2BpAs+zmB As+p1BAs+p2BpAs+pnB,Partial-Fraction ExpansionWe see that all the expanded terms drop out with the exception of a k . Thus the residue a k is found from Note that, since f(t) is a real function of time, if p 1 andp 2 are complex conjugates, then the residues a 1 anda 2 are also complex conjugates. Only one of the conjugates, a 1 ora 2 , needs to be evaluated, because the other is known automatically. Since f(t) is obtained as fort/H113500 EXAMPLE B–1 Find the inverse Laplace transform of The partial-fraction expansion of F(s) is where a 1 anda 2 are found as Thus fort/H113500 EXAMPLE B–2 Obtain the inverse Laplace transform of Here, since the degree of the numerator polynomial is higher than that of the denominator poly- nomial, we must divide the numerator by the denominator. G(s) =s+2+s+3 (s+1)(s+2)G(s) =s 3 +5s 2 +9s+7 (s+1)(s+2)=2e -t -e -2t ,=l -1 c 2 s+1 d +l -1 c -1 s+2 d f(t) =l -1 CF(s)Da 2 = c (s+2)s+3 (s+1)(s +2) d s=-2 = c s+3 s+1 d s=-2 =-1a 1 = c (s+1)s+3 (s+1)(s +2) d s=-1 = c s+3 s+2 d s=-1 =2F(s) =s+3 (s+1)(s +2)=a 1 s+1+a 2 s+2F(s) =s+3 (s+1)(s +2) f(t) =l -1 CF(s)D=a 1 e -p 1 t +a 2 e -p 2 t +p+a n e -p n t ,l -1 c a k s+p k d =a k e -p k t a k = c As+p k BB(s) A(s) d s=-p k 868 Appendix B / Partial-Fraction Expansion Openmirrors.comNote that the Laplace transform of the unit-impulse function d(t)is 1 and that the Laplace transform of dd(t)/ dtiss. The third term on the right-hand side of this last equation is F(s) in Example B–1. So the inverse Laplace transform of G(s) is given as fort/H113500– EXAMPLE B–3 Find the inverse Laplace transform of Notice that the denominator polynomial can be factored as If the function F(s) involves a pair of complex-conjugate poles, it is convenient not to expand F(s) into the usual partial fractions but to expand it into the sum of a damped sine and a damped cosine function. Noting that s2+2s+5=(s+1)2+22and referring to the Laplace transforms of e–atsinvt ande–atcosvt, rewritten thus, the given F(s) can be written as a sum of a damped sine and a damped cosine function: It follows that fort/H113500 Partial-Fraction Expansion when F(s) Involves Multiple Poles. Instead of dis- cussing the general case, we shall use an example to show how to obtain the partial-fraction expansion of F(s) . Consider the following F(s) : The partial-fraction expansion of this F(s) involves three terms, F(s) =B(s) A(s)=b1 s+1+b2 (s+1)2+b3 (s+1)3F(s) =s2+2s+3 (s+1)3 =5e-tsin2t+2e-tcos2t, =5l-1c2 (s+1)2+22d+2l-1cs+1 (s+1)2+22d f(t) =l-1CF(s)D =5 2 (s+1)2+22+2 s+1 (s+1)2+22 F(s) =2s+12 s2+2s+5=10+2(s+1) (s+1)2+22lCe-atcosvtD=s+a (s+a)2+v2lCe-atsinvtD=v (s+a)2+v2s2+2s+5=(s+1+j2)(s +1-j2)F(s) =2s+12 s2+2s+5g(t) =d dtd(t)+2d(t)+2e-t-e-2t, Appendix B / Partial-Fraction Expansion 869where b 3 ,b 2 , and b 1 are determined as follows. By multiplying both sides of this last equation by (s+1) 3 , we have (B–2) Then letting s=–1 , Equation (B–2) gives Also, differentiation of both sides of Equation (B–2) with respect to syields (B–3) If we let s=–1 in Equation (B–3), then By differentiating both sides of Equation (B–3) with respect to s, the result is From the preceding analysis it can be seen that the values of b 3 ,b 2 , and b 1 are found systematically as follows: =1 2 (2) =1 =1 2! c d 2 ds 2 As 2 +2s+3B d s=-1 b 1 =1 2! e d 2 ds 2 c (s+1) 3 B(s) A(s) d f s=-1 =0 =(2s+2) s=-1 = c d ds As 2 +2s+3B d s=-1 b 2 = e d ds c (s+1) 3 B(s) A(s) d f s=-1 =2 =As 2 +2s+3B s=-1 b 3 = c (s+1) 3 B(s) A(s) d s=-1 d 2 ds 2 c (s+1) 3 B(s) A(s) d =2b 1 d ds c (s+1) 3 B(s) A(s) d s=-1 =b 2 d ds c (s+1) 3 B(s) A(s) d =b 2 +2b 1 (s+1) c (s+1) 3 B(s) A(s) d s=-1 =b 3 (s+1) 3 B(s) A(s)=b 1 (s+1) 2 +b 2 (s+1)+b 3 870 Appendix B / Partial-Fraction Expansion Openmirrors.comWe thus obtain fort/H113500 Comments. For complicated functions with denominators involving higher-order polynomials, partial-fraction expansion may be quite time consuming. In such a case,use of MATLAB is recommended. Partial-Fraction Expansion with MATLAB. MATLAB has a command to obtain the partial-fraction expansion of B(s)/A(s) . Consider the following function B(s)/A(s) : where some of a iandbjmay be zero. In MATLAB row vectors num and den specify the coefficients of the numerator and denominator of the transfer function. That is, num = [b0b1... bn] den = [1 a1... an] The command [r,p,k] = residue(num,den) finds the residues ( r), poles ( p), and direct terms ( k) of a partial-fraction expansion of the ratio of two polynomials B(s) andA(s) . The partial-fraction expansion of B(s)/A(s) is given by (B–4) Comparing Equations (B–1) and (B–4), we note that p(1)=–p1, p(2)=–p2,p, p(n)=–pn;r(1)=a1, r(2)=a2,p,r(n)=an.[k(s) is a direct term.] EXAMPLE B–4 Consider the following transfer function, B(s) A(s)=2s3+5s2+3s+6 s3+6s2+11s +6B(s) A(s)=r(1) s-p(1)+r(2) s-p(2)+p+r(n) s-p(n)+k(s)B(s) A(s)=num den=b0 sn+b1 sn-1+p+bn sn+a1 sn-1+p+an =A1+t2Be-t, =e-t+0+t2e-t =l-1c1 s+1d+l-1c0 (s+1)2d+l-1c2 (s+1)3d f(t) =l-1CF(s)D Appendix B / Partial-Fraction Expansion 871For this function, num= [2 5 3 6] den = [1 6 11 6] The command [r,p,k] = residue(num,den) gives the following result: 872 Appendix B / Partial-Fraction Expansion [r,p,k] = residue(num,den) r = -6.0000 -4.0000 3.0000 p = -3.0000 -2.0000 -1.0000 k = 2 (Note that the residues are returned in column vector r, the pole locations in column vector p, and the direct term in row vector k.) This is the MATLAB representation of the following partial- fraction expansion of B(s)/A(s) : Note that if p(j)=p(j+1)= p=p(j+m-1) Cthat is, p j =p j+1 =p=p j+m-1 D, the pole p(j) is a pole of multiplicity m. In such a case, the expansion includes terms of the form For details, see Example B–5.r(j) s-p(j)+r(j+1) Cs-p(j)D 2 +p+r(j+m-1) Cs-p(j)D m =-6 s+3+-4 s+2+3 s+1+2 B(s) A(s)=2s 3 +5s 2 +3s+6 s 3 +6s 2 +11s +6 Openmirrors.comEXAMPLE B–5 Expand the following B(s)/A(s) into partial fractions with MATLAB. For this function, we have num = [1 2 3] den = [1 3 3 1] The command [r,p,k] = residue(num,den) gives the result shown next:B(s) A(s)=s2+2s+3 (s+1)3=s2+2s+3 s3+3s2+3s+1 Appendix B / Partial-Fraction Expansion 873It is the MATLAB representation of the following partial-fraction expansion of B(s)/A(s) : Note that the direct term kis zero.B(s) A(s)=1 s+1+0 (s+1)2+2 (s+1)3num = [1 2 3]; den = [1 3 3 1];[r,p,k] = residue(num,den) r = 1.0000 0.00002.0000 p = -1.0000 -1.0000-1.0000 k = []C 874 Appendix In this appendix we first review the determinant of a matrix, then we define the adjoint matrix, the inverse of a matrix, and the derivative and integral of a matrix. Determinant of a Matrix. For each square matrix, there exists a determinant.The determinant of a square matrix Ais usually written as or det A. The determinant has the following properties: 1.If any two consecutive rows or columns are interchanged, the determinant changes its sign. 2.If any row or any column consists only of zeros, then the value of the dererminant is zero. 3.If the elements of any row (or any column) are exactly ktimes those of another row (or another column), then the value of the determinant is zero. 4.If, to any row (or any column), any constant times another row (or column) is added, the value of the determinant remains unchanged. 5.If a determinant is multiplied by a constant, then only one row (or one column) is multiplied by that constant. Note, however, that the determinant of ktimes an n*n matrix Aisk n times the determinant of A, or @kA@=k n @A@@A@ Vector-Matrix Algebra Openmirrors.comThis is because 6.The determinant of the product of two square matrices AandBis the product of determinants, or IfB=n*m matrix and C=m*n matrix, then det(In+BC)= det(Im+CB) If andD=m*m matrix, then where S=D-CA/H110021 B. If , then where T=A-BD/H110021C. If or then Rank of Matrix. A matrix Ais said to have rank mif there exists an m*m sub- matrix MofAsuch that the determinant of Mis nonzero and the determinant of every r*r submatrix (where ) of Ais zero. As an example, consider the following matrix: A=D12 34 01 -10 10 1211 02Tr/H11350m+1detcAB 0Dd=detA/H11080detDdetcA0 CDd=detA/H11080detDC=0, B=0detcAB CDd=detD/H11080detTDZ0detcAB CDd=detA/H11080detSAZ0@AB@=@A@@B@kA=Dka11 ka12 p ka1m ka21ka22 p ka2m oo o kan1kan2p kanmT Appendix C / Vector-Matrix Algebra 875Note that =0 . One of a number of largest submatrices whose determinant is not equal to zero is Hence, the rank of the matrix Ais 3. Minor M ij .If the ith row and jth column are deleted from an n*n matrix A, the resulting matrix is an (n-1)*(n-1) matrix. The determinant of this (n-1) /H11003 (n-1) matrix is called the minor M ij of the matrix A. Cofactor A ij .The cofactor A ij of the element a ij of the n*n matrix Ais defined by the equation A ij =( /H110021) i/H11001j M ij That is, the cofactor A ij of the element a ij is(/H110021) i/H11001j times the determinant of the matrix formed by deleting the ith row and the jth column from A. Note that the cofactor A ij of the element a ij is the coefficient of the term a ij in the expansion of the determinant , since it can be shown that If are replaced by then because the determinant of Ain this case possesses two identical rows. Hence, we obtain Similarly, Adjoint Matrix .The matrix Bwhose element in the ith row and jth column equals A ji is called the adjoint of Aand is denoted by adj A,o r B=(b ij )=(A ji )= adjA That is, the adjoint of Ais the transpose of the matrix whose elements are the cofactors ofA,o r adjA= D A 11 A 21 p A n1 A 12 A 22 p A n2 oo o A 1n A 2n p A nm T a n k=1 a ki A kj =d ij @A@a n k=1 a jk A ik =d ji @A@a j1 A i1 +a j2 A i2 +p+a jn A in =0 iZja j1 ,a j2 ,p,a jn , a i1 ,a i2 ,p,a in a i1 A i1 +a i2 A i2 +p+a in A in =@A@@A@ C 1 2 3 01 -1 10 1 S @A@ 876 Appendix C / Vector-Matrix Algebra Openmirrors.comNote that the element of the jth row and ith column of the product A(adjA)is Hence, A(adjA)is a diagonal matrix with diagonal elements equal to , or A(adjA)= I Similarly, the element in the jth row and ith column of the product (adjA)Ais Hence, we have the relationship A(adjA)=( adjA)A= I (C–1) Thus where Aijis the cofactor of aijof the matrix A. Thus, the terms in the ith column of A/H110021 are l/ times the cofactors of the ith row of the original matrix A. For example, if then the adjoint of Aand the determinant are respectively found to be@A@A=C1 2 0 3-1-2 1 0 -3S@A@GA11 @A@A21 @A@pAn1 @A@ A12 @A@A22 @A@pAn2 @A@ oo o A1n @A@A2n @A@pAnn @A@W A-1=adjA @A@=@A@an k=1bjkaki=an k=1Akjaki=dij@A@@A@@A@an k=1ajkbki=an k=1ajkAik=dji@A@ Appendix C / Vector-Matrix Algebra 877G W adjA= =C3 6 -4 7-3 2 1 2 -7S`3-1 1 0` -`12 10` `1 23-1`-`3-2 1-3` `1 0 1-3` -`1 0 3-2``-1-2 0 -3` -`2 0 0-3` ` 2 0 -1-2`and =17 Hence, the inverse of Ais In what follows, we give formulas for finding inverse matrices for the 2*2 matrix and the 3*3 matrix. For the 2*2 matrix the inverse matrix is given by For the 3*3 matrix the inverse matrix is given byA= C abc def ghi S where@A@Z0A -1 =1 ad-bc c d-b -ca d A= c ab cd d where ad-bcZ0A -1 =adjA @A@= C 3 176 17-4 17 7 17-3 172 17 1 172 17-7 17 S @A@ 878 Appendix C / Vector-Matrix Algebra G W ` de gh ` - ` ab gh ` ` ab de ` ` df gi ` ` ac gi ` - ` ac df ` A -1 =1 @A@ ` ef hi ` - ` bc hi ` ` bc ef ` Note that There are several more useful formulas available. Assume that A=n*n matrix, B=n*m matrix, C=m*n matrix, and D=m*m matrix. Then [A+BC] -1 =A -1 -A -1 B[I m +CA -1 B] -1 CA -1 (A -1 )*=(A*) -1 (A -1 )¿=(A¿) -1 (A -1 ) -1 =A Openmirrors.comIf and then If then If thenFinally, we present the MATLAB approach to obtain the inverse of a square matrix. If all elements of the matrix are given as numerical values, this approach is best. MATLAB Approach to Obtain the Inverse of a Square Matrix. The inverse of a square matrix Acan be obtained with the command inv(A) For example, if matrix Ais given by then the inverse of matrix Ais obtained as follows:A= C112 340125ScAB CDd-1 =cT-1-T-1 BD-1 -D-1 CT-1D-1+D-1 CT-1 BD-1d@D@Z0,T=A-BD-1 C, and @T@Z0,cAB CDd-1 =cA-1+A-1 BS-1 CA-1-A-1 BS-1 -S-1 CA-1S-1d@A@Z0,S=D-CA-1B,@S@Z0,cA0 CDd-1 =cA-10 -D-1 CA-1D-1dcAB 0Dd-1 =cA-1-A-1BD-1 0D-1d@D@Z0, @A@Z0 Appendix C / Vector-Matrix Algebra 879A = [1 1 2;3 4 0;1 2 5]; inv(A) ans = 2.2222 /H110020.1111 /H110020.8889 /H110021.6667 0.3333 0.6667 0.2222 /H110020.1111 0.1111That is MATLAB Is Case Sensitive. It is important to note that MATLAB is case sen- sitive.That is, MATLAB distinguishes between upper- and lowercase letters.Thus, xand Xare not the same variable. All function names must be in lowercase, such as inv(A) , eig(A) , and poly(A) . Differentiation and Integration of Matrices. The derivative of an n*m matrix A(t)is defined to be the n*m matrix, each element of which is the derivative of the corresponding element of the original matrix, provided that all the elements a ij (t)have derivatives with respect to t. That is, Similarly, the integral of an n*m matrix A(t)is defined to be Differentiation of the Product of Two Matrices. If the matrices A(t)andB(t) can be differentiated with respect to t, then Here again the multiplication of A(t)anddB(t)/dt [ordA(t)/dt andB(t)] is, in gener- al, not commutative.d dt[A(t)B(t)] =dA(t) dtB(t)+A(t)dB(t) dt G 3a 11 (t) dt 3a 12 (t) dt p 3a 1m (t) dt 3a 21 (t) dt 3a 22 (t) dt p 3a 2m (t) dt oo o 3a n1 (t) dt 3a 2n (t) dt p 3a nm (t) dt W 3A(t) dt = a 3a ij (t) dt b = G d dta 11 (t)d dta 12 (t) pd dta 1m (t) d dta 21 (t)d dta 22 (t) pd dta 2m (t) oo o d dta n1 (t)d dta n2 (t) pd dta nm (t) W d dt A(t)= a d dt a ij (t) b =A -1 = C 2.2222 -0.1111 -0.8889 -1.6667 0.3333 0.6667 0.2222 -0.1111 0.1111 S 880 Appendix C / Vector-Matrix Algebra Openmirrors.comDifferentiation of A21(t).If a matrix A(t)and its inverse A/H110021(t)are differen- tiable with respect to t, then the derivative of A/H110021(t)is given by The derivative may be obtained by differentiating A(t)A/H110021(t)with respect to t. Since and we obtainor dA -1(t) dt=-A-1(t)dA(t) dtA-1(t)A(t)dA-1(t) dt=-dA(t) dtA-1(t)d dt[A(t)A-1(t)] =d dtI=0d dt[A(t)A-1(t)] =dA(t) dtA-1(t)+A(t)dA-1(t) dtdA-1(t) dt=-A-1(t)dA(t) dtA-1(t) Appendix C / Vector-Matrix Algebra 881R 882 References A–1 Anderson, B. D. O., and J. B. Moore, Linear Optimal Control . Upper Saddle River, NJ: Prentice Hall, 1971. A–2 Athans, M., and P . L. Falb, Optimal Control: An Introduction to the Theory and Its Appli- cations . New York: McGraw-Hill Book Company, 1965. B–1 Barnet, S., “Matrices, Polynomials, and Linear Time-Invariant Systems,” IEEE Trans. Automatic Control ,AC-18 (1973), pp. 1–10. B–2 Bayliss, L. E., Living Control Systems. London: English Universities Press Limited, 1966. B–3 Bellman, R., Introduction to Matrix Analysis . New York: McGraw-Hill Book Company, B–4 Bode, H. W., Network Analysis and Feedback Design . New York: Van Nostrand Reinhold, B–5 Brogan, W. L., Modern Control Theory . Upper Saddle River, NJ: Prentice Hall, 1985. B–6 Butman, S., and R. Sivan (Sussman),“On Cancellations, Controllability and Observability,” IEEE Trans. Automatic Control ,AC-9 (1964), pp. 317–8. C–1 Campbell, D. P , Process Dynamics . New York: John Wiley & Sons, Inc., 1958. C–2 Cannon, R., Dynamics of Physical Systems . New York: McGraw-Hill Book Company, 1967. C–3 Chang, P . M., and S. Jayasuriya, “An Evaluation of Several Controller Synthesis Method- ologies Using a Rotating Flexible Beam as a Test Bed,” ASME J. Dynamic Systems, Measurement, and Control ,117(1995), pp. 360–73. C–4 Cheng, D. K., Analysis of Linear Systems . Reading, MA: Addison-Wesley Publishing Company, Inc., 1959. C–5 Churchill, R.V ., Operational Mathematics , 3rd ed. New York: McGraw-Hill Book Company, Openmirrors.comC–6 Coddington, E.A., and N. Levinson, Theory of Ordinary Differential Equations . New York: McGraw-Hill Book Company, 1955. C–7 Craig, J. J., Introduction to Robotics, Mechanics and Control . Reading, MA:AddisonWesley Publishing Company, Inc., 1986. C–8 Cunningham, W J., Introduction to Nonlinear Analysis. New York: McGraw-Hill Book Company, 1958. D–1 Dorf, R. C., and R. H. Bishop, Modern Control Systems , 9th ed. Upper Saddle River, NJ: Prentice Hall, 2001. E–1 Enns, M., J. R. Greenwood III, J. E. Matheson, and F. T. Thompson, “Practical Aspects of State-Space Methods Part I: System Formulation and Reduction,” IEEE Trans. Military Electronics ,MIL-8 (1964), pp. 81–93. E–2 Evans, W. R., “Graphical Analysis of Control Systems,” AIEE Trans. Part II ,67(1948), pp. 547-51. E–3 Evans, W. R., “Control System Synthesis by Root Locus Method,” AIEE Trans Part II ,69 (1950), pp. 66–9. E–4 Evans,W. R.,“The Use of Zeros and Poles for Frequency Response or Transient Response,” ASME Trans .76(1954), pp. 1135–44. E–5 Evans, W. R., Control System Dynamics . New York: McGraw-Hill Book Company, 1954. F–1 Franklin, G. F, J. D. Powell, and A. Emami-Naeini, Feedback Control of Dynamic Systems , 3rd ed. Reading, MA: Addison-Wesley Publishing Company, Inc., 1994. F–2 Friedland, B., Control System Design . New York: McGraw-Hill Book Company, 1986. F–3 Fu, K. S., R. C. Gonzalez, and C. S. G. Lee, Robotics: Control, Sensing, Vision, and Intelli- gence. New York: McGraw-Hill Book Company, 1987. G–1 Gantmacher, F. R., Theory of Matrices , Vols. I and II. NewYork: Chelsea Publishing Company, Inc., 1959. G–2 Gardner, M. F, and J. L. Barnes, Transients in Linear Systems. New York: John Wiley & Sons, Inc., 1942. G–3 Gibson, J. E., Nonlinear Automatic Control . New York: McGraw-Hill Book Company, 1963. G–4 Gilbert, E. G.,“Controllability and Observability in Multivariable Control Systems,” J.SIAM Control , ser. A, 1(1963) , pp. 128–51. G–5 Graham, D., and R. C. Lathrop, “The Synthesis of Optimum Response: Criteria and Stan- dard Forms,” AIEE Trans. Part II ,72(1953), pp. 273–88. H–1 Hahn, W., Theory and Application of Liapunov’s Direct Method . Upper Saddle River, NJ: Prentice Hall, 1963. H–2 Halmos, P . R., Finite Dimensional Vector Spaces. New York:Van Nostrand Reinhold, 1958. H–3 Higdon, D. T., and R. H. Cannon, Jr., “On the Control of Unstable Multiple-Output Mechanical Systems,” ASME Paper no. 63-WA-148 , 1963. I–1 Irwin, J. D., Basic Engineering Circuit Analysis . New York: Macmillan, Inc., 1984. J–1 Jayasuriya, S., “Frequency Domain Design for Robust Performance Under Parametric, Unstructured, or Mixed Uncertainties,” ASME J. Dynamic Systems, Measurement, and Control ,115(1993), pp. 439–51. K–1 Kailath, T., Linear Systems . Upper Saddle River, NJ: Prentice Hall, 1980. K–2 Kalman, R. E., “Contributions to the Theory of Optimal Control,” Bol. Soc Mat. Mex. ,5 (1960), pp. 102–19. K–3 Kalman, R. E.,“On the General Theory of Control Systems,” Proc. First Intern. Cong. IFAC, Moscow , 1960, Automatic and Remote Control . London: Butterworths & Company Limited, 1961, pp. 481–92. References 883K–4 Kalman, R. E.,“Canonical Structure of Linear Dynamical Systems,” Proc. Natl. Acad. Sci., USA ,48(1962), pp. 596–600. K–5 Kalman, R. E., “When Is a Linear Control System Optimal?” ASMEJ. Basic Engineering , ser. D, 86(1964), pp. 51–60. K–6 Kalman, R. E., and J. E. Bertram, “Control System Analysis and Design via the Second Method of Lyapunov: I Continuous-Time Systems,” ASME J. Basic Engineering , ser. D, 82 (1960), pp. 371–93. K–7 Kalman, R. E.,Y. C. Ho, and K. S. Narendra,“Controllability of Linear Dynamic Systems,” inContributions to Differential Equations ,Vol. 1. New York:Wiley-Interscience Publishers, Inc., 1962. K–8 Kautsky, J., and N. Nichols, “Robust Pole Assignment in Linear State Feedback,” Intern. J. Control ,41(1985), pp 1129–55. K–9 Kreindler, E., and P . E. Sarachick, “On the Concepts of Controllability and Observability of Linear Systems,” IEEE Trans. Automatic Control ,AC-9 (1964), pp. 129–36. K–10 Kuo, B. C., Automatic Control Systems , 6th ed. Upper Saddle River, NJ: Prentice Hall, 1991. L–1 LaSalle, J. P , and S. Lefschetz, Stability by Liapunov’s Direct Method with Applications . New York: Academic Press, Inc., 1961. L–2 Levin, W. S., The Control Handbook . Boca Raton, FL: CRC Press, 1996. L–3 Levin, W. S. Control System Fundamentals . Boca Raton, FL: CRC Press, 2000. L–4 Luenberger, D. G.,“Observing the State of a Linear System,” IEEE Trans. Military Electr ., MIL-8 (1964), pp. 74–80. L–5 Luenberger, D. G., “An Introduction to Observers,” IEEE Trans. Automatic Control , AC-16 (1971), pp. 596–602. L–6 Lur’e,A. I., and E. N. Rozenvasser,“On Methods of Constructing Liapunov Functions in the Theory of Nonlinear Control Systems,” Proc. First Intern. Cong. IFAC , Moscow, 1960, Auto- matic and Remote Control . London: Butterworths & Company Limited, 1961, pp. 928–33. M–1 MathWorks, Inc., The Student Edition of MATLAB , version 5. Upper Saddle River, NJ: Prentice Hall, 1997. M–2 Melbourne, W. G., “Three Dimensional Optimum Thrust Trajectories for Power-Limited Propulsion Systems,” ARS J .,31(1961), pp. 1723–8. M–3 Melbourne,W. G., and C. G. Sauer, Jr.,“Optimum Interplanetary Rendezvous with Power- Limited Vehicles,” AIAA J .,1(1963), pp. 54–60. M–4 Minorsky, N., Nonlinear Oscillations . New York: Van Nostrand Reinhold, 1962. M–5 Monopoli, R.V .,“Controller Design for Nonlinear and Time-Varying Plants,” NASA CR152 , Jan., 1965. N–1 Noble, B., and J. Daniel, Applied Linear Algebra , 2nd ed. Upper Saddle River, NJ: Prentice Hall, 1977. N–2 Nyquist, H., “Regeneration Theory,” Bell System Tech. J .,11(1932), pp. 126–47. O–1 Ogata, K., State Space Analysis of Control Systems . Upper Saddle River, NJ: Prentice Hall, O–2 Ogata, K., Solving Control Engineering Problems with MATLAB . Upper Saddle River, NJ: Prentice Hall, 1994. O–3 Ogata, K., Designing Linear Control Systems with MATLAB . Upper Saddle River, NJ: Prentice Hall, 1994. O–4 Ogata, K., Discrete-Time Control Systems , 2nd ed. Upper Saddle River, NJ: Prentice Hall, O–5 Ogata, K., System Dynamics , 4th ed. Upper Saddle River, NJ: Prentice Hall, 2004. 884 References Openmirrors.comO–6 Ogata, K., MATLAB for Control Engineers. Upper Saddle River, NJ: Pearson Prentice Hall, 2008. P–1 Phillips, C. L., and R. D. Harbor, Feedback Control Systems . Upper Saddle River, NJ: Pren- tice Hall, 1988. P–2 Pontryagin, L. S., V . G. Boltyanskii, R. V . Gamkrelidze, and E. F. Mishchenko, The Mathematical Theory of Optimal Processes . New York: John Wiley & Sons, Inc., 1962. R–1 Rekasius, Z.V .,“A General Performance Index for Analytical Design of Control Systems,” IRE Trans. Automatic Control ,AC-6 (1961), pp. 217–22. R–2 Rowell, G., and D.Wormley, System Dynamics . Upper Saddle River, NJ: Prentice Hall, 1997. S–1 Schultz, W. C., and V . C. Rideout, “Control System Performance Measures: Past, Present, and Future,” IRE Trans. Automatic Control ,AC-6 (1961), pp. 22–35. S–2 Smith, R. J., Electronics: Circuits and Devices , 2d ed. New York: John Wiley & Sons, Inc., 1980. S–3 Staats, P . F. “A Survey of Adaptive Control Topics,” Plan B paper , Dept. of Mech. Eng., University of Minnesota, March 1966. S–4 Strang, G., Linear Algebra and Its Applications . New York: Academic Press, Inc., 1976. T–1 Truxal, J. G., Automatic Feedback Systems Synthesis . New York: McGraw-Hill Book Company, 1955. U–1 Umez-Eronini, E., System Dynamics and Control . Pacific Grove, CA: Brooks /H20862Cole Publishing Company, 1999. V–1 Valkenburg, M. E., Network Analysis. Upper Saddle River, NJ: Prentice Hall, 1974. V–2 Van Landingham, H. F., and W. A. Blackwell, “Controller Design for Nonlinear and Time-Varying Plants,” Educational Monograph , College of Engineering, Oklahoma State University, 1967. W–1 Webster, J. G., Wiley Encyclopedia of Electrical and Electronics Engineering , Vol. 4. New York: John Wiley & Sons, Inc., 1999. W–2 Wilcox, R. B., “Analysis and Synthesis of Dynamic Performance of Industrial Organizations—The Application of Feedback Control Techniques to Organizational Sys-tems,” IRE Trans. Automatic Control ,AC-7 (1962), pp. 55–67. W–3 Willems, J. C., and S. K. Mitter, “Controllability, Observability, Pole Allocation, and State Reconstruction,” IEEE Trans. Automatic Control ,AC-16 (1971), pp. 582–95. W–4 Wojcik, C. K.,“Analytical Representation of the Root Locus,” ASME J. Basic Engineering , ser. D, 86(1964), pp. 37–43. W–5 Wonham,W. M.,“On Pole Assignment in Multi-Input Controllable Linear Systems,” IEEE Trans. Automatic Control ,AC-12 (1967), pp. 660–65. Z–1 Zhou, K., J. C. Doyle, and K. Glover, Robust and Optimal Control. Upper Saddle River, NJ: Prentice Hall, 1996. Z–2 Zhou, K., and J. C. Doyle, Essentials of Robust Control, Upper Saddle River, NJ: Prentice Hall, 1998. Z–3 Ziegler, J. G., and N. B. Nichols, “Optimum Settings for Automatic Controllers,” ASME Trans .64(1942), pp. 759–68. Z–4 Ziegler, J. G., and N. B. Nichols,“Process Lags in Automatic Control Circuits,” ASME Trans . 65(1943), pp. 433–44. References 885I 886 Index A Absolute stability, 160 Ackermann’s formula: for observer gain matrix, 756–57 for pole placement, 730–31 Actuating error, 8 Actuator, 21–22 Adjoint matrix, 876 Air heating system, 150 Aircraft elevator control system, 156 Analytic function, 860 Angle: of arrival, 286 of departure, 280, 286 Angle condition, 271 Asymptotes: Bode diagram, 406–07 root loci, 274–75, 284–85 Attenuation, 165 Attitude-rate control system, 386 Automatic controller, 21 Automobile suspension system, 86 Auxiliary polynomial, 216 B Back emf, 95 constant, 95 Bandwidth, 474, 539 Basic control actions: integral, 24 on-off, 22 proportional, 24 proportional-plus-derivative, 25 proportional-plus-integral, 24 proportional-plus-integral-plus- derivative, 35 two-position, 22–23 Bleed-type relay, 111 Block, 17 Block diagram, 17–18 reduction, 27–28, 48 Bode diagram, 403 error in asymptotic expression of, 403 of first-order factors, 406–07, 409 general procedure for plotting, 413 plotting with MATLAB, 422–25 of quadratic factors, 410–12 of system defined in state space, 426–27 Branch point, 18 Break frequency, 406 Breakaway point, 275–76, 285–86, 351 Break-in point, 276, 281, 285–86, 351 Bridged-T networks, 90, 520 Business system, 5 Openmirrors.comIndex 887C Canonical forms: controllable, 649 diagonal, 650 Jordan, 651, 653observable, 650 Capacitance: of pressure system, 107–09of thermal system, 137of water tank, 103 Cancellation of poles and zeros, 288 Cascaded system, 20 Cascaded transfer function, 20Cauchy–Riemann conditions, 860–61Cauchy’s theorem, 526Cayley–Hamilton theorem, 668, 701Characteristic equation, 652Characteristic polynomial, 34Characteristic roots, 652 Circular root locus, 282 Classical control theory, 2Classification of control systems, 225Closed-loop control system, 8Closed-loop system, 20Closed-loop frequency response, 477Closed-loop frequency response curves: desirable shapes of, 492undesirable shapes of, 492 Closed-loop transfer function, 19–20Cofactor, 876 Command compensation, 630 Compensation: feedback, 308parallel, 308series, 308 Compensator: lag, 323, 503–04lag–lead, 332–34, 511–13lead, 312–13, 495–96 Complete observability, 683–84 conditions for, 684–85 in the splane, 684 Complete output controllablility, 714Complete state controllability, 676–81 in the splane, 680–81 Complex-conjugate poles: cancellation of undesirable, 520 Complex function, 859 Complex impedence, 75 Complex variable, 859Computational optimization approach to design PID controller, 583–89 Conditional stability, 299–300, 510–11Conditionally stable system, 299–300, 458, 510–11 Conduction heat transfer, 137Conformal mapping, 447, 462–64 Conical water tank system, 152 Constant-gain loci, 302–03 Constant-magnitude loci (M circles), 478–79 Constant phase-angle loci (N circles), 480–81 Constant v nloci, 296 Constant zlines, 298 Constant zloci, 296 Control actions, 21 Control signal, 3 Controllability, 675–81 matrix, 677output, 681 Controllable canonical form, 649, 688Controlled variable, 3Controller, 22Convection heat transfer, 137Conventional control theory, 29 Convolution, integral, 16 Corner frequency, 406Critically damped system, 167Cutoff frequency, 474Cutoff rate, 475 D Damped natural frequency, 167Damper, 64, 132Damping ratio, 165 lines of constant, 296 Dashpot, 64, 132–33Dead space, 43Decade, 405Decibel, 403 Delay time, 169–70 Derivative control action, 118–20, 222Derivative gain, 84Derivative time, 25, 61Detectability, 688Determinant, 874Diagonal canonical form, 694Diagonalization of n*nmatrix, 652 Differential amplifier, 78 Differential gap, 23, 24 Differentiating system, 231Differentiation: of inverse matrix, 881of matrix, 880of product of two matrices, 880 Differentiator: approximate, 617 Direct transmission matrix, 31Disturbance, 3, 26 Dominant closed-loop poles, 182 Duality, 754E e At : computation of, 670–71 Eigenvalue, 652 invariance of, 655 Electromagnetic valve, 23 Electronic controller, 77, 83 Engineering organizational system, 5–6 Equivalent moment of inertia, 234 Equivalent spring constant, 64 Equivalent viscous-friction coefficient, 65, 234 Evans, W. R., 2, 11, 269 Exponential response curve, 162 F Feedback compensation, 308–09, 342, 519 Feedback control, 3 Feedback control system, 7 Feedback system, 20 Feedforward transfer function, 19 Final value theorem, 866 First-order lag circuit, 80 First-order system, 161–64 unit-impulse response of, 163 unit-ramp response of, 162–63 unit-step response of, 161–62 Flapper, 110 valve, 156 Fluid systems: mathematical modeling of, 100 Free-body diagram, 69–70 Frequency response, 398 correlation between step response and, 471–74 lag compensation based on, 502–11 lag–lead compensation based on, 511–17 lead compensation based on, 493–502 Full-order state observer, 752–53 Functional block, 17 G Gain crossover frequency, 467–69 Gain margin, 464–67 Gas constant, 108 for air, 142 universal, 108 Gear train, 232 system, 232–34 Generalized plant, 813, 815–17 diagram, 810–16, 853–54 H H infinity control problem, 816 H infinity norm, 6, 808 888 Index Hazen, 2, 11 High-pass filter, 495 Higher-order systems, 179 transient response of, 180–81 Hurwitz determinants, 252–58 Hurwitz stability criterion, 252–53, 255–58 equivalence of Routh’s stability criterion and, 255–57 Hydraulic controller: integral, 130 jet-pipe, 147 proportional, 131 proportional-plus-derivative, 134–35 proportional-plus-integral, 133–34 proportional-plus-integral-plus- derivative, 135–36 Hydraulic servo system, 124–25 Hydraulic servomotor, 128, 130, 156 Hydraulic system, 106, 123–39, 149 advantages and disadvantages of, 124 compared with pneumatic system, 106 I Ideal gas law, 108 Impedance: approach to obtain transfer function, 75–76 Impulse function, 866 Impulse response, 163, 178–79, 195–97 function, 16–17 Industrial controllers, 22 Initial condition: response to, 203–11 Initial value theorem, 866 Input filter, 261, 630 Input matrix, 31 Integral control, 220 Integral control action, 24–25, 218 Integral controller, 22 Integral gain, 61 Integral time, 25, 61 Integration of matrix, 880 Inverse Laplace transform: partial-fraction expansion method for obtaining, 867–73 Inverse Laplace transformation, 862 Inverse of a matrix: MATLAB approach to obtain, 879 Inverse polar plot, 461–62, 537–38 Inverted-pendulum system, 68–72, 98 Inverted-pendulum control system, 746–51 Inverting amplifier, 78 I-PD control, 591–92 I-PD-controlled system, 592, 628–29, 643 with feedforward control, 642 Openmirrors.comIndex 889J Jet-pipe controller, 146–47 Jordan blocks, 679Jordan canonical form, 651, 695, 706–07 K Kalman, R. E., 12, 675Kirchhoff’s current law, 72Kirchhoff’s loop law, 72Kirchhoff’s node law, 72Kirchhoff’s voltage law, 72 L Lag compensation, 321Lag compensator, 311, 321, 502 Bode diagram of, 503 design by frequency-response method, 502–11 design by root-locus method, 321, 323polar plot of, 503 Lag network, 82, 542Lag–lead compensation, 330, 335, 338, 377, 511–18 Lag–lead compensator: Bode diagram of, 558design by frequency-response method, 513–17 design by root-locus method, 331–32, 380–82 electronic, 330–32polar plot of, 512 Lag–lead network: electronic, 330–32mechanical, 366 Lagrange polynomial, 708 Lagrange’s interpolation formula, 708 Laminar-flow resistance, 102Laplace transform, 862 properties of, 865table of, 863–64 Lead compensator, 311, 493 Bode diagram of, 494 design by frequency-response method, 493–502 design by root-locus method, 311–18polar plot of, 494 Lead, lag, and lag–lead compensators: comparison of, 517–18 Lead network, 542 electronic, 82mechanical, 365 Lead time, 5Linear approximation: of nonlinear mathematical models, 43 Linear system, 14 constant coefficient, 14Linear time-invariant system, 14, 164 Linear time-varying system, 14Linearization: of nonlinear systems, 43 Liquid-level control system, 157 Liquid-level systems, 101, 103–04, 140–41 Log-magnitude curves of quadratic transfer function, 411 Logarithmic decrement, 237Logarithmic plot, 403Log-magnitude versus phase plot, 403, 443–44 LRC circuit, 72–73 M M circles, 478–79 a family of constant, 479 Magnitude condition, 271 Manipulated variable, 3Mapping theorem, 448–49 Mathematical model, 13 MATLAB commands: MATLAB: obtaining maximum overshoot with, 194 obtaining peak time with, 194 obtaining response to initial condition with, 266 partial-fraction expansion with, 871–73 plotting Bode diagram with, 422–23plotting root loci with, 290–91writing text in diagrams with, 188–89 [A,B,C,D] = tf2ss(num,den), 40, 656, 698 bode(A,B,C,D), 422, 426 bode(A,B,C,D,iu), 426–27 bode(A,B,C,D,iu,w), 422 bode(A,B,C,D,w), 422 bode(num,den), 422bode(num,den,w), 422, 425, 551 bode(sys), 422 bode(sys,w), 552 c = step(num,den,t), 190 for loop, 243, 249, 584[Gm,pm,wcp,wcg,] = margin(sys), 468–69 gtext ('text'), 189 impulse(A,B,C,D), 195 impulse(num, den), 195initial(A,B,C,D,[initial condition],t), 209 inv(A), 879 K = acker(A,B,J), 736 K = lqr(A,B,Q,R), 798 K = place(A,B,J), 736MATLAB commands (Cont. ) K e = acker(A',C',L)', 773 K e = acker(Abb,Aab,L)', 773 K e = place(A',C',L)', 773 K e = place(Abb',Aab',L)', 773 [K,P,E] = lqr(A,B,Q,R), 798 [K,r] = rlocfind(num,den), 303 logspace(d1,d2), 422 logspace(d1,d2,n), 422–23 lqr(A,B,Q,R), 797 lsim(A,B,C,D,u,t), 201 lsim(num,den,r,t), 201 magdB = 20*log10(mag), 422 [mag,phase,w] = bode(A,B,C,D), 422 [mag,phase,w] = bode(A,B,C,D,iu,w), 422 [mag,phase,w] = bode(A,B,C,D,w), 422 [mag,phase,w] = bode(num,den), 422 [mag,phase,w] = bode(num,den,w), 422, 476 [mag,phase,w] = bode(sys), 422 [mag,phase,w] = bode(sys,w), 476 mesh, 192 mesh(y), 192, 249 mesh(y'), 192, 249 [Mp,k] = max(mag), 476 NaN, 799 [num,den] = feedback(num1,den1, num2,den2), 20–21 [num,den] = parallel(num1,den1, num2,den2), 20–21 [num,den] = series(num1,den1, num2,den2), 20–21 [num,den] = ss2tf(A,B,C,D), 41, 657 [num,den] = ss2tf(A,B,C,D,iu), 41–42, 58, 657 [NUM,den] = ss2tf(A,B,C,D,iu), 59, 659 nyquist(A,B,C,D), 436, 441–42 nyquist(A,B,C,D,iu), 441 nyquist(A,B,C,D,iu,w), 436, 441 nyquist(A,B,C,D,w), 436 nyquist(num,den), 436 nyquist(num, den,w), 436 nyquist(sys), 436 polar(theta,r), 545 printsys(num,den), 20–21, 189 printsys(num,den,'s'), 189 r = abs(z), 544 [r,p,k] = residue(num,den), 239, 871–72 [re,im,w] = nyquist(A,B,C,D), 436 [re,im,w] = nyquist(A,B,C,D,iu,w), 436 [re,im,w] = nyquist(A,B,C,D,w), 436 [re,im,w] = nyquist(num,den), 436 [re,im,w] = nyquist(num,den,w), 436 890 Index [re,im,w] = nyquist(sys), 436 residue, 867 resonant_frequency = w(k), 476 resonant_peak = 20*log10(Mp), 476 rlocfind, 303 rlocus(A,B,C,D), 295 rlocus(A,B,C,D,K), 290, 295 rlocus(num,den), 290–91 rlocus(num,den,K), 290 sgrid, 297 sortsolution, 584 step(A,B,C,D), 184, 186 step(A,B,C,D,iu), 184 step(num,den), 184 step(num,den,t), 184 step(sys), 184 sys = ss(A,B,C,D), 184 sys = tf(num,den), 184 text, 188 theta = angle(z), 544 w = logspace(d2,d3,100), 425 y = lsim(A,B,C,D,u,t), 201 y = lsim(num,den,r,t), 201 [y, x, t] = impulse(A,B,C,D), 195 [y, x, t] = impulse(A,B,C,D,iu), 195 [y, x, t] = impulse(A,B,C,D,iu,t), 195 [y, x, t] = impulse(num,den), 195 [y, x, t] = impulse(num,den,t), 195 [y, x, t] = step(A,B,C,D,iu), 184 [y, x, t] = step(A,B,C,D,iu,t), 184 [y, x, t] = step(num,den,t), 184, 190 z = re+j*im, 544 End of MATLAB commands Matrix exponential, 661, 669–674 closed solution for, 663 Matrix Riccati equation, 798, 800 Maximum overshoot: in unit-impulse response, 179 in unit-step response, 170, 172 versuszcurve, 174 Maximum percent overshoot, 170 Maximum phase lead angle, 494, 498 Measuring element, 21 Mechanical lag–lead system, 366 Mechanical lead system, 365 Mechanical vibratory system, 236 Mercury thermometer system, 151 Minimal polynomial, 669, 704–06 Minimum-order observer, 767–77 based controller, 777 Minimum-order state observer, 752 Minimum-phase system, 415–16 Minimum-phase transfer function, 415 Minor, 876 Modern control theory, 7, 29 versus conventional control theory, 29 Openmirrors.comIndex 891Motor torque constant, 95 Motorcycle suspension system, 87 Multiple-loop system, 458–59 N N circles, 480–81 a family of constant, 481 Newton’s second law, 66Nichols, 2, 11, 398Nichols chart, 482–85Nichols plots, 403 Nonbleed-type relay, 111 Nonhomogeneous state equation: solution of, 666–67 Noninverting amplifier, 79 Nonlinear mathematical models: linear approximation of, 43–45 Nonlinear system, 43 Nonminimum-phase systems, 300–01, 415, 417 Nonminimum-phase transfer function, 415, 488 Nonuniqueness: of a set of state variables, 655 Nozzle-flapper amplifier, 110 Number-decibel conversion line, 404Nyquist, H., 2, 11, 398 Nyquist path, 545 Nyquist plot, 403, 439–40, 443 of positive-feedback system, 535–37 of system defined in state space, 440–43 Nyquist stability analysis, 454–62 Nyquist stability criterion, 445–54 applied to inverse polar plots, 461–62 O Observability, 675, 682–88 complete, 683–85 matrix, 653 Observable canonical form, 650, 692 Observation, 752 Observed-state feedback control system, 761 Observer, 753 design of control system with, 786–93 full-order, 753 mathematical model of, 752 minimum-order, 767–73 Observer-based controller: transfer function of, 761 Observer controller: in the feedback path of control system, 787, 790–93 in the feedforward path of control system, 787–90 Observer-controller matrix, 762Observer-controller transfer function, 761–62 Observer error equation, 753Observer gain matrix, 755 MATLAB determination of, 773 Octave, 405Offset, 258On-off control action, 22–23On-off controller, 22 One-degree-of-freedom control system, 593 op amps, 78Open-loop control system, 8 advantages of, 9disadvantages of, 9 Open-loop frequency response curves: reshaping of, 493 Open-loop transfer function, 19 Operational amplifier, 78 Operational amplifier circuits, 93–94 for lead or lag compensator:table of, 85 Optimal regulator problem, 806Ordinary point, 861Orthogonality: of root loci and constant gain loci, 301–02 Output controllability, 681 Output equation, 31 Output matrix, 31Overdamped system, 168–69Overlapped spool valve, 146Overlapped valve, 130 P Parallel compensation, 308–09, 342–43Partial-fraction expansion, 867–73 with MATLAB, 871–73 PD control, 373 PD controller, 614–15Peak time, 170, 172, 193Performance index, 793Performance specifications, 9Phase crossover frequency, 467–69Phase margin, 464–67 versuszcurve, 472 PI controller, 2, 614–15PI-D control, 590–92 PID control system, 572–77, 583, 587, 617–21, 628–29, 642–43 basic, 590with input filter, 629two-degrees-of-freedom, 592–95 PID controller, 567, 577, 614–16, 620, 632 modified, 616using operational amplifiers, 83–84Pilot valve, 124, 130 PI-PD control, 592 PID-PD control, 592 Plant, 3 Pneumatic actuating valve, 117–18 Pneumatic controllers, 144–45, 154–55 Pneumatic nozzle-flapper amplifier, 110 Pneumatic on-off controller, 115 Pneumatic pressure system, 142 Pneumatic proportional controller, 112–16 force-balance type, 115–16 force-distance type, 112–15 Pneumatic proportional-plus-derivative controller, 119–20 Pneumatic proportional-plus-integral control action, 120–22 Pneumatic proportional-plus-integral- plus-derivative control action, 122–23 Pneumatic relay, 111 bleed type, 111 nonbleed type, 111 reverse acting, 112 Pneumatic systems, 106–23, 153 compared with hydraulic system, 106 Pneumatic two-position controller, 115 Polar grids, 297 Polar plot, 403, 427–28, 430, 432 Pole: 861 of order n, 861 simple, 861 Pole assignment technique, 723 Pole-placement: necessary and sufficient conditions for arbitrary, 725 Pole placement problem, 723–35 solving with MATLAB, 735–36 Positive-feedback system: Nyquist plot for, 536–37 root loci for, 303–07 Positional servo system, 95–97 Pressure system, 107, 109 Principle of duality, 687 Principle of superposition, 43 Process, 3 Proportional control, 219 Proportional control action, 24 Proportional controller, 22 Proportional gain, 25, 61 Proportional-plus-derivative control: of second-order system, 224 of system with inertia load, 223 Proportional-plus-derivative control action, 25 Proportional-plus-derivative controller, 22, 542 892 Index Proportional-plus-integral control action, 24 Proportional-plus-integral controller, 22, 121, 542 Proportional-plus-integral-plus- derivative control action, 25 Proportional-plus-integral-plus- derivative controller, 22 Pulse function, 866 Q Quadratic factor, 410 log-magnitude curves of, 411 phase-angle curves of, 411 Quadratic optimal control problem: MATLAB solution of, 804 Quadratic optimal regulator system, 793–95 MATLAB design of, 797 R Ramp response, 197 Rank of matrix, 875 Reduced-matrix Riccati equation, 795–97 Reduced-order observer, 752 Reduced-order state observer, 752 Reference input, 21 Regulator system with observer controller, 778–86, 789 Relative stability, 160, 217, 462 Residue, 867 Residue theorem, 527 Resistance: gas-flow, 107 laminar-flow, 101–02 of pressure system, 107, 109 of thermal system, 137 turbulent-flow, 102 Resonant frequency, 430, 470 Resonant peak, 413, 430, 470 versuszcurve, 413 Resonant peak magnitude, 413, 470 Response: to arbitrary input, 201 to initial condition, 203–11 to torque disturbance, 221 Reverse-acting relay, 112 Riccati equation, 795 Rise time, 169–171 obtaining with MATLAB, 193–94 Robust control: system, 16, 806–17 theory, 2, 7 Robust performance, 7, 807, 812 Robust pole placement, 735 Robust stability, 7, 807, 809 Openmirrors.comIndex 893Root loci: general rules for constructing, 283–87for positive-feedback system, 303–07 Root locus, 271 method, 269–70 Routh’s stability criterion, 212–18 S Schwarz matrix, 268Second-order system, 164 impulse response of, 178–79standard form of, 166 step response of, 165–75transient-response specification of, 171 unit-step response curves of, 169 Sensor, 21Series compensation, 308–09, 342Servo system, 95, 164–65 design of, 739–51with tachometer feedback, 268with velocity feedback, 175–77 Servomechanism, 2 Set point, 21Set-point kick, 590Settling time, 170, 172–73 obtaining with MATLAB, 194versuszcurve, 174 Sign inverter, 79Simple pole, 861Singular points, 861 Sinusoidal signal generator, 486 Sinusoidal transfer function, 401Small gain theorem, 809Space vehicle control system, 367, 538–39Speed control system, 4, 148Spool valve: linealized mathematical model of, 127 Spring-loaded pendulum system, 98Spring-mass-dashpot system, 66Square-law nonlinearity, 43 S-shaped curve, 569 Stability analysis, 454–62 in the complex plane, 182 Stabilizability, 688Stack controller, 115Standard second-order system, 189State, 29State controllability: complete, 676, 678, 680 State equation, 31 solution of homogeneous, 660solution of nonhomogeneous, 666–67Laplace transform solution of, 663 State-feedback gain matrix, 724 MATLAB approach to determine, 735–36State matrix, 31 State observation: necessary and sufficient conditions for, 754–55 State observer, 751–77 design with MATLAB, 773 type 1 servo system with, 746 State observer gain matrix: 755 Ackermann’s formula to obtain, 756–57direct substitution approach to obtain, 756 transformation approach to obtain, 755 State space, 30State-space equation, 30 correlation between transfer function and, 649, 656 solution of, 660 State-space representation: in canonical forms, 649ofnth order system, 36–39 State-transition matrix, 664 properties of, 665 State variable, 29State vector, 30 Static acceleration error constant, 228, 421 determination of, 421–22 Static position error constant, 226, 419 Static velocity error constant, 227, 420 Steady-state error, 160, 226 for unit parabolic input, 229 for unit ramp input, 228 in terms of gain K, 230 Steady-state response, 160Step response, 699–700 of second-order system, 165–69 Summing point, 18Suspension system: automobile, 86–87motorcycle, 87 Sylvester’s interpolation formula, 673, 709–713 System, 3Sytem types, 419 type 0, 225, 230, 419, 433, 487–88type 1, 225, 230, 420, 433, 487–88type 2, 225, 230, 421, 433, 487–88 System response to initial condition: MATLAB approach to obtain, 203–11 T Tachometer, 176 feedback, 343 Taylor series expansion, 43–45Temperature control systems, 4–5 Test signals, 159 Text: writing on the graphic screen, 188 Thermal capacitance, 137 Thermal resistance, 137 Thermal systems, 100,136–39 Thermometer system, 151–52 Three-degrees-of-freedom system, 645 Three-dimensional plot, 192 of unit-step response curves with MATLAB, 191–93 Traffic control system, 8 Transfer function, 15 of cascaded elements, 73–74 of cascaded systems, 20 closed-loop, 20 of closed-loop system, 20 experimental determination of, 489–90 expression in terms of A,B,C, and D,3 4 of feedback system, 19 feedforward, 19 of minimum-order observer-based controller, 777 of nonloading cascaded elements, 77 observer-controller, 762, 780–82 open-loop, 19 of parallel systems, 20 sinusoidal, 401 Transfer matrix, 35 Transformation: from state space to transfer function, 41–42, 657 from transfer function to state space, 40–41, 656 Transient response, 160 analysis with MATLAB, 183–211 of higher-order system, 180 specifications, 169, 171 Transport lag, 417 phase angle characteristics of, 417 Turbulent-flow resistance, 102 Two-degrees-of-freedom control system, 593–95, 599–614, 636–41, 646–47 Two-position control action, 22–23 Two-position controller, 22 Type 0 system, 225, 230, 488 log-magnitude curve for, 419, 488 polar plot of, 433 Type 1 servo system: design of, 743–51 pole-placement design of, 739–46 Type 1 system, 420 log-magnitude curve for, 420, 488 polar plot of, 433 894 Index Type 2 system, 421 log-magnitude curve for, 421, 488 polar plot of, 433 U Uncontrollable system, 681 Undamped natural frequency, 165 Underdamped system, 166–67 Underlapped spool valve, 146 Unit acceleration input, 247 Unit-impulse response: of first-order system, 163 of second-order system, 178 Unit-impulse response curves: a family of, 178 obtained by use of MATLAB, 196–97 Unit-ramp response: of first-order system, 162–63 of second-order system, 197–200 of system defined in state space, 199–200 Unit-step response: of first-order system, 161 of second-order system, 163, 167, 169 Universal gas constant, 108 Unstructured uncertainty: additive, 852–53 multiplicative, 809 system with, 809 V Valve: overlapped, 130 underlapped, 130 zero-lapped, 130 Valve coefficient, 127 Vectors: linear dependence of, 674 linear independence of, 674 Velocity error, 227 Velocity feedback, 176, 343, 519 W Watt’s speed governor, 4 Weighting function, 17 Z Zero, 861 of order m, 862 Zero-lapped valve, 130 Zero placement, 595, 597, 612 approach to improve response charac- teristics, 595–97 Ziegler–Nichols tuning rules, 11, 568–77 first method, 569–70 second method, 570–71 Openmirrors.com